{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.5", "generated_at": "2026-02-25T11:43:54.959750Z", "invocation_id": "018b6ac7-2ce2-4353-82d6-a845258025e0", "invocation_started_at": "2026-02-25T11:43:19.794506Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.615896Z", "completed_at": "2026-02-25T11:43:43.724395Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:43.727171Z", "completed_at": "2026-02-25T11:43:43.727211Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2460799217224121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.stg_order_items", "compiled": true, "compiled_code": "\n\n/*\n  STAGING MODEL: stg_order_items\n  \n  Purpose: Clean order line item data\n  Source: Olist Brazilian E-commerce\n  \n  Transformations:\n  - Rename columns\n  - Calculate item total (price + freight)\n  - Generate surrogate key for unique identification\n*/\n\nwith source as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\n),\n\nrenamed as (\n    select\n        -- Surrogate Key (composite primary key)\n        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,\n        \n        -- Foreign Keys\n        order_id,\n        product_id,\n        seller_id,\n        \n        -- Item Position\n        order_item_id as item_sequence,\n        \n        -- Pricing\n        cast(price as numeric) as item_price,\n        cast(freight_value as numeric) as item_freight,\n        \n        -- Derived: Total for this item\n        cast(price as numeric) + cast(freight_value as numeric) as item_total,\n        \n        -- Shipping date\n        cast(shipping_limit_date as timestamp) as shipping_limit_at\n\n    from source\n)\n\nselect * from renamed\n\nlimit 1000", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.605078Z", "completed_at": "2026-02-25T11:43:43.725135Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:43.727940Z", "completed_at": "2026-02-25T11:43:43.727962Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.31176304817199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.stg_customers", "compiled": true, "compiled_code": "\n\n/*\n  STAGING MODEL: stg_customers\n  \n  Purpose: Clean and standardize customer data\n  Source: Olist Brazilian E-commerce\n  \n  Transformations:\n  - Standardize location data\n  - Clean state codes\n*/\n\nwith source as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\n),\n\nrenamed as (\n    select\n        -- Primary Key\n        customer_id,\n        \n        -- Alternative Key (same customer across orders)\n        customer_unique_id,\n        \n        -- Location\n        lower(trim(customer_city)) as customer_city,\n        upper(trim(customer_state)) as customer_state,\n        cast(customer_zip_code_prefix as string) as customer_zip_code,\n        \n        -- Derived: Region classification\n        case upper(trim(customer_state))\n            when 'SP' then 'Southeast'\n            when 'RJ' then 'Southeast'\n            when 'MG' then 'Southeast'\n            when 'ES' then 'Southeast'\n            when 'PR' then 'South'\n            when 'SC' then 'South'\n            when 'RS' then 'South'\n            when 'BA' then 'Northeast'\n            when 'PE' then 'Northeast'\n            when 'CE' then 'Northeast'\n            when 'MA' then 'Northeast'\n            when 'PB' then 'Northeast'\n            when 'RN' then 'Northeast'\n            when 'PI' then 'Northeast'\n            when 'AL' then 'Northeast'\n            when 'SE' then 'Northeast'\n            when 'GO' then 'Central-West'\n            when 'DF' then 'Central-West'\n            when 'MT' then 'Central-West'\n            when 'MS' then 'Central-West'\n            else 'North'\n        end as customer_region\n\n    from source\n)\n\nselect * from renamed\n\nlimit 1000", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.638995Z", "completed_at": "2026-02-25T11:43:43.725733Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:43.728690Z", "completed_at": "2026-02-25T11:43:43.728710Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3734300136566162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.stg_orders", "compiled": true, "compiled_code": "\n\n/*\n  STAGING MODEL: stg_orders\n  \n  Purpose: Clean and standardize raw order data\n  Source: Olist Brazilian E-commerce (10K orders sample)\n  \n  Transformations:\n  - Rename columns to consistent naming convention\n  - Cast timestamps to proper types\n  - Calculate delivery metrics\n  - Add late delivery flag\n*/\n\nwith source as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\n),\n\nrenamed as (\n    select\n        -- Primary Key\n        order_id,\n        \n        -- Foreign Keys\n        customer_id,\n        \n        -- Order Status\n        order_status,\n        case\n    when order_status = 'delivered' then 'Completed'\n    when order_status = 'canceled' then 'Canceled'\n    else 'In Progress'\nend as order_status_group,\n        \n        -- Timestamps (cast to proper types)\n        cast(order_purchase_timestamp as timestamp) as ordered_at,\n        cast(order_approved_at as timestamp) as approved_at,\n        cast(order_delivered_carrier_date as timestamp) as shipped_at,\n        cast(order_delivered_customer_date as timestamp) as delivered_at,\n        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,\n        \n        -- Derived: Order date (for partitioning)\n        date(cast(order_purchase_timestamp as timestamp)) as order_date,\n        \n        -- Derived: Delivery time in days\n        case \n            when order_delivered_customer_date is not null \n            then date_diff(\n                date(cast(order_delivered_customer_date as timestamp)),\n                date(cast(order_purchase_timestamp as timestamp)),\n                day\n            )\n        end as delivery_days,\n        \n        -- Derived: Is delivery late?\n        case\n            when order_delivered_customer_date is not null \n                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)\n            then true\n            else false\n        end as is_late_delivery,\n        \n        -- Derived: Days late (if late)\n        case\n            when order_delivered_customer_date is not null \n                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)\n            then date_diff(\n                date(cast(order_delivered_customer_date as timestamp)),\n                date(cast(order_estimated_delivery_date as timestamp)),\n                day\n            )\n            else 0\n        end as days_late\n\n    from source\n)\n\nselect * from renamed\n\n-- Limit in dev for faster iteration\nlimit 1000", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.927113Z", "completed_at": "2026-02-25T11:43:43.952650Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:43.967183Z", "completed_at": "2026-02-25T11:43:43.967212Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.17486214637756348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.stg_product_categories", "compiled": true, "compiled_code": "\n/*\n  STAGING MODEL: stg_product_categories\n  Purpose: Product category translation (Portuguese \u2192 English)\n  Source: Olist Brazilian E-commerce\n*/\nwith source as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_source`.`product_category_name_translation`\n),\nrenamed as (\n    select\n        -- Portuguese name (join key)\n        string_field_0 as category_name_pt,\n        -- English translation\n        string_field_1 as category_name_en,\n        -- Derived: Category group\n        case\n            when string_field_1 in ('computers', 'computers_accessories', 'electronics', 'tablets_printing_image', 'telephony', 'fixed_telephony')\n                then 'Electronics'\n            when string_field_1 in ('furniture_decor', 'furniture_living_room', 'furniture_bedroom', 'furniture_mattress_and_upholstery', 'office_furniture', 'home_comfort', 'home_comfort_2', 'home_confort')\n                then 'Furniture'\n            when string_field_1 in ('health_beauty', 'perfumery', 'diapers_and_hygiene')\n                then 'Health & Beauty'\n            when string_field_1 in ('sports_leisure', 'toys', 'baby', 'fashion_bags_accessories', 'fashion_shoes', 'fashion_sport', 'fashion_underwear_beach', 'fashio_female_clothing', 'fashion_male_clothing', 'fashion_childrens_clothes')\n                then 'Fashion & Lifestyle'\n            when string_field_1 in ('housewares', 'kitchen_dining_laundry_garden_furniture', 'garden_tools', 'flowers', 'la_cuisine')\n                then 'Home & Garden'\n            else 'Other'\n        end as category_group\n    from source\n)\nselect * from renamed", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_product_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.937847Z", "completed_at": "2026-02-25T11:43:43.969012Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.033167Z", "completed_at": "2026-02-25T11:43:44.033201Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17580723762512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.stg_products", "compiled": true, "compiled_code": "\n\n/*\n  STAGING MODEL: stg_products\n  \n  Purpose: Clean product catalog data\n  Source: Olist Brazilian E-commerce\n  \n  Transformations:\n  - Calculate product volume\n  - Classify product size\n*/\n\nwith source as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_source`.`products`\n),\n\nrenamed as (\n    select\n        -- Primary Key\n        product_id,\n        \n        -- Category (Portuguese - join with translation table)\n        product_category_name as category_name_pt,\n        \n        -- Dimensions\n        cast(product_weight_g as numeric) as weight_grams,\n        cast(product_length_cm as numeric) as length_cm,\n        cast(product_height_cm as numeric) as height_cm,\n        cast(product_width_cm as numeric) as width_cm,\n        \n        -- Derived: Volume in cubic cm\n        cast(product_length_cm as numeric) \n            * cast(product_height_cm as numeric) \n            * cast(product_width_cm as numeric) as volume_cm3,\n        \n        -- Derived: Size classification\n        case\n            when cast(product_weight_g as numeric) < 500 then 'Small'\n            when cast(product_weight_g as numeric) < 2000 then 'Medium'\n            when cast(product_weight_g as numeric) < 10000 then 'Large'\n            else 'Extra Large'\n        end as size_category,\n        \n        -- Product description stats\n        product_name_lenght as name_length,\n        product_description_lenght as description_length,\n        product_photos_qty as photo_count\n\n    from source\n)\n\nselect * from renamed\n\nlimit 1000", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.127945Z", "completed_at": "2026-02-25T11:43:44.131959Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.134573Z", "completed_at": "2026-02-25T11:43:44.134608Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09252715110778809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_advanced_olist.customers", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.947611Z", "completed_at": "2026-02-25T11:43:44.132882Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.135409Z", "completed_at": "2026-02-25T11:43:44.135429Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3304269313812256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0", "compiled": true, "compiled_code": "", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.111365Z", "completed_at": "2026-02-25T11:43:44.273737Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.283895Z", "completed_at": "2026-02-25T11:43:44.283917Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.24230384826660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0", "compiled": true, "compiled_code": "", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.274494Z", "completed_at": "2026-02-25T11:43:44.278115Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.284623Z", "completed_at": "2026-02-25T11:43:44.284639Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14113616943359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_advanced_olist.order_items", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.279096Z", "completed_at": "2026-02-25T11:43:44.283072Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.285290Z", "completed_at": "2026-02-25T11:43:44.285308Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2032151222229004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_advanced_olist.orders", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.480194Z", "completed_at": "2026-02-25T11:43:44.486911Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.492533Z", "completed_at": "2026-02-25T11:43:44.492552Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11083412170410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_advanced_olist.product_category_name_translation", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.488381Z", "completed_at": "2026-02-25T11:43:44.491804Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.516157Z", "completed_at": "2026-02-25T11:43:44.516189Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17177391052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_advanced_olist.products", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.493265Z", "completed_at": "2026-02-25T11:43:44.652342Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.654695Z", "completed_at": "2026-02-25T11:43:44.654710Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2422029972076416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_source_customers_customer_state__2.c12080cc5c", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n    length(\n        customer_state\n    ) = 2 as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_source_expect_6c7908a69ef8e827e38ab27047049956`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.722443Z", "completed_at": "2026-02-25T11:43:44.755945Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.758802Z", "completed_at": "2026-02-25T11:43:44.758820Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.17740416526794434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_source_order_items_freight_value__1000__0.87b012a026", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and freight_value >= 0 and freight_value <= 1000\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_source_expect_5f19db14015851f8d17beac55a954f20`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.742053Z", "completed_at": "2026-02-25T11:43:44.757567Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.760812Z", "completed_at": "2026-02-25T11:43:44.760831Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.24164795875549316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_source_order_items_price__10000__0.ad851237c9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and price >= 0 and price <= 10000\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_source_expect_1bc1465a66b968ebb0c51d54418c5465`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.761739Z", "completed_at": "2026-02-25T11:43:44.895509Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:44.898095Z", "completed_at": "2026-02-25T11:43:44.898110Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22343206405639648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_source_products_product_weight_g__100000__0.55732c33ff", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and product_weight_g >= 0 and product_weight_g <= 100000\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_source`.`products`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_source_expect_ac5e3eaa1cfefd320687dee0bff9cfed`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.989064Z", "completed_at": "2026-02-25T11:43:45.083324Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.101218Z", "completed_at": "2026-02-25T11:43:45.101272Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1846320629119873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_accepted_values_raw_olist_source_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.b69c457885", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_status as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\n    group by order_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_accepted_values_raw_oli_5d5243ee918426683371a63d07d3686f`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.084974Z", "completed_at": "2026-02-25T11:43:45.165788Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.169187Z", "completed_at": "2026-02-25T11:43:45.169209Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22283697128295898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_customers_customer_city.91d687a823", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\nwhere customer_city is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_customers_customer_city`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.238285Z", "completed_at": "2026-02-25T11:43:45.254573Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.256006Z", "completed_at": "2026-02-25T11:43:45.256025Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15749502182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_customers_customer_id.b4d296c3f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\nwhere customer_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_customers_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.256878Z", "completed_at": "2026-02-25T11:43:45.333359Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.342335Z", "completed_at": "2026-02-25T11:43:45.342354Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1547088623046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_customers_customer_state.bd11b9ab82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\nwhere customer_state is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_customers_customer_state`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.333944Z", "completed_at": "2026-02-25T11:43:45.406523Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.409416Z", "completed_at": "2026-02-25T11:43:45.409436Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14339089393615723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_customers_customer_unique_id.17d3c45f84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\nwhere customer_unique_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_customers_customer_unique_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.477510Z", "completed_at": "2026-02-25T11:43:45.498607Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.499680Z", "completed_at": "2026-02-25T11:43:45.499699Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15155410766601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_order_items_freight_value.c32093ad7f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\nwhere freight_value is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_order_items_freight_value`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.489411Z", "completed_at": "2026-02-25T11:43:45.500932Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.565484Z", "completed_at": "2026-02-25T11:43:45.565503Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14292192459106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_order_items_order_id.aec00a1b1c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\nwhere order_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_order_items_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.634878Z", "completed_at": "2026-02-25T11:43:45.656872Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.658290Z", "completed_at": "2026-02-25T11:43:45.658310Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09076309204101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_order_items_order_item_id.9d2c41949b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\nwhere order_item_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_order_items_order_item_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.646079Z", "completed_at": "2026-02-25T11:43:45.659292Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.660051Z", "completed_at": "2026-02-25T11:43:45.660069Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1497480869293213, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_order_items_price.57ade50ca5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\nwhere price is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_order_items_price`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:44.900923Z", "completed_at": "2026-02-25T11:43:45.820427Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.822534Z", "completed_at": "2026-02-25T11:43:45.822554Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.9302468299865723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_source_orders_order_purchase_timestamp__timestamp.8d02e75ba2", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('ORDER_ID' as string) as relation_column,\n            cast('STRING' as string) as relation_column_type\n        union all\n        \n        select\n            cast('CUSTOMER_ID' as string) as relation_column,\n            cast('STRING' as string) as relation_column_type\n        union all\n        \n        select\n            cast('ORDER_STATUS' as string) as relation_column,\n            cast('STRING' as string) as relation_column_type\n        union all\n        \n        select\n            cast('ORDER_PURCHASE_TIMESTAMP' as string) as relation_column,\n            cast('DATETIME' as string) as relation_column_type\n        union all\n        \n        select\n            cast('ORDER_APPROVED_AT' as string) as relation_column,\n            cast('DATETIME' as string) as relation_column_type\n        union all\n        \n        select\n            cast('ORDER_DELIVERED_CARRIER_DATE' as string) as relation_column,\n            cast('DATETIME' as string) as relation_column_type\n        union all\n        \n        select\n            cast('ORDER_DELIVERED_CUSTOMER_DATE' as string) as relation_column,\n            cast('DATETIME' as string) as relation_column_type\n        union all\n        \n        select\n            cast('ORDER_ESTIMATED_DELIVERY_DATE' as string) as relation_column,\n            cast('DATETIME' as string) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ORDER_PURCHASE_TIMESTAMP'\n            and\n            relation_column_type not in ('TIMESTAMP')\n\n    )\n    select *\n    from test_data", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_source_expect_e6890fb3bad56676ba1bfbabf466ceb6`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.789883Z", "completed_at": "2026-02-25T11:43:45.818970Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.821447Z", "completed_at": "2026-02-25T11:43:45.821473Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10125589370727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_order_items_product_id.8c9007bfda", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`order_items`\nwhere product_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_order_items_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.808281Z", "completed_at": "2026-02-25T11:43:45.822777Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.827571Z", "completed_at": "2026-02-25T11:43:45.827589Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16822195053100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_orders_customer_id.0a0a6b3bd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\nwhere customer_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_orders_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.962108Z", "completed_at": "2026-02-25T11:43:45.985046Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.995470Z", "completed_at": "2026-02-25T11:43:45.995490Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1035928726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_orders_order_id.066cf66251", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\nwhere order_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_orders_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.971533Z", "completed_at": "2026-02-25T11:43:45.994773Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:45.996656Z", "completed_at": "2026-02-25T11:43:45.996675Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16511821746826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_orders_order_purchase_timestamp.e25bdf28ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\nwhere order_purchase_timestamp is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_sour_ac65a6d27170bc42e4e7d41dd0a8793b`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:45.986269Z", "completed_at": "2026-02-25T11:43:45.997516Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.061740Z", "completed_at": "2026-02-25T11:43:46.061760Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22765588760375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_orders_order_status.5d7ac870bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\nwhere order_status is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_orders_order_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.193346Z", "completed_at": "2026-02-25T11:43:46.204609Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.223990Z", "completed_at": "2026-02-25T11:43:46.224011Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09956502914428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_product_category_name_translation_string_field_0.bfd17fd2eb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`product_category_name_translation`\nwhere string_field_0 is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_sour_0fab1a06831451c61f5a3f1ca7ad60fc`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.205202Z", "completed_at": "2026-02-25T11:43:46.225711Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.288386Z", "completed_at": "2026-02-25T11:43:46.288405Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16088485717773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_product_category_name_translation_string_field_1.5b9b9fd36e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`product_category_name_translation`\nwhere string_field_1 is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_sour_dda9048df9959018775c582a75624d73`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.214032Z", "completed_at": "2026-02-25T11:43:46.286161Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.289175Z", "completed_at": "2026-02-25T11:43:46.289192Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.21388912200927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_not_null_raw_olist_source_products_product_id.a752ec2254", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_source`.`products`\nwhere product_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_not_null_raw_olist_source_products_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.423436Z", "completed_at": "2026-02-25T11:43:46.451924Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.458833Z", "completed_at": "2026-02-25T11:43:46.458864Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10900592803955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_unique_raw_olist_source_customers_customer_id.3227d1258c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_source`.`customers`\n  where customer_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_unique_raw_olist_source_customers_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.436422Z", "completed_at": "2026-02-25T11:43:46.459722Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.461334Z", "completed_at": "2026-02-25T11:43:46.461356Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16651511192321777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_unique_raw_olist_source_orders_order_id.fa180cf7e3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_source`.`orders`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_unique_raw_olist_source_orders_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.446541Z", "completed_at": "2026-02-25T11:43:46.524726Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.527415Z", "completed_at": "2026-02-25T11:43:46.527433Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.23042774200439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_unique_raw_olist_source_product_category_name_translation_string_field_0.72e7af6ef3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select string_field_0 as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_source`.`product_category_name_translation`\n  where string_field_0 is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_unique_raw_olist_source_400253c5893c924437206e9cc8c731b6`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.660300Z", "completed_at": "2026-02-25T11:43:46.690314Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.692190Z", "completed_at": "2026-02-25T11:43:46.692209Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10277390480041504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.source_unique_raw_olist_source_products_product_id.540d43a1ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_source`.`products`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`source_unique_raw_olist_source_products_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.669602Z", "completed_at": "2026-02-25T11:43:46.692887Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.756917Z", "completed_at": "2026-02-25T11:43:46.756944Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16564297676086426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a", "compiled": true, "compiled_code": "\n\nselect\n    item_freight as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere item_freight < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.679584Z", "completed_at": "2026-02-25T11:43:46.693787Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.759412Z", "completed_at": "2026-02-25T11:43:46.759432Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22695422172546387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242", "compiled": true, "compiled_code": "\n\nselect\n    item_price as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere item_price <= 0\n   or item_price is null\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_positive_stg_order_items_item_price`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.891929Z", "completed_at": "2026-02-25T11:43:46.922085Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.923232Z", "completed_at": "2026-02-25T11:43:46.923257Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10149407386779785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25", "compiled": true, "compiled_code": "\n\nselect\n    item_total as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere item_total <= 0\n   or item_total is null\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_positive_stg_order_items_item_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.901846Z", "completed_at": "2026-02-25T11:43:46.987146Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.990050Z", "completed_at": "2026-02-25T11:43:46.990069Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1672370433807373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere item_freight is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_order_items_item_freight`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:46.913794Z", "completed_at": "2026-02-25T11:43:46.989491Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:46.992091Z", "completed_at": "2026-02-25T11:43:46.992110Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.229766845703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere item_price is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_order_items_item_price`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.122797Z", "completed_at": "2026-02-25T11:43:47.135568Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.145789Z", "completed_at": "2026-02-25T11:43:47.145810Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.22495079040527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere item_total is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_order_items_item_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.137416Z", "completed_at": "2026-02-25T11:43:47.156260Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.219246Z", "completed_at": "2026-02-25T11:43:47.219265Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15196990966796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere order_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_order_items_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.146695Z", "completed_at": "2026-02-25T11:43:47.220764Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.285725Z", "completed_at": "2026-02-25T11:43:47.285741Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2247762680053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere order_item_key is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_order_items_order_item_key`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.288568Z", "completed_at": "2026-02-25T11:43:47.362390Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.377108Z", "completed_at": "2026-02-25T11:43:47.377137Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.22059392929077148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\nwhere product_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_order_items_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.443446Z", "completed_at": "2026-02-25T11:43:47.449313Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.452776Z", "completed_at": "2026-02-25T11:43:47.452796Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15421414375305176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_advanced_olist.customers_snapshot", "compiled": true, "compiled_code": "\n\n\n\n/*\n  SNAPSHOT: customers_snapshot\n  \n  Purpose: Track historical changes to customer data (SCD Type 2)\n  \n  Strategy: 'check' - monitors specified columns for changes\n  \n  Tracked columns:\n  - customer_city\n  - customer_state  \n  - customer_zip_code\n  \n  Added columns:\n  - dbt_valid_from: When this version became active\n  - dbt_valid_to: When this version was superseded (NULL = current)\n  - dbt_scd_id: Unique identifier for this version\n  \n  Usage:\n    dbt snapshot\n*/\n\nselect\n    customer_id,\n    customer_unique_id,\n    customer_city,\n    customer_state,\n    customer_zip_code,\n    customer_region,\n    current_timestamp() as _snapshot_at\n\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n", "relation_name": "`arcane-pillar-485809-b6`.`snapshots`.`customers_snapshot`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.363905Z", "completed_at": "2026-02-25T11:43:47.450263Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.453504Z", "completed_at": "2026-02-25T11:43:47.453518Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22194623947143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_item_key as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n  where order_item_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_stg_order_items_order_item_key`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.585508Z", "completed_at": "2026-02-25T11:43:47.602705Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.620676Z", "completed_at": "2026-02-25T11:43:47.620696Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.23322391510009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_region as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n    group by customer_region\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Southeast','South','Northeast','Central-West','North'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.612086Z", "completed_at": "2026-02-25T11:43:47.622357Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.688943Z", "completed_at": "2026-02-25T11:43:47.688979Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1546039581298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\nwhere customer_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_customers_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.603414Z", "completed_at": "2026-02-25T11:43:47.623192Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.689826Z", "completed_at": "2026-02-25T11:43:47.689845Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22021222114562988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n    length(\n        customer_state\n    ) = 2 as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.824583Z", "completed_at": "2026-02-25T11:43:47.855281Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.858266Z", "completed_at": "2026-02-25T11:43:47.858287Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10349893569946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\nwhere customer_region is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_customers_customer_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.835082Z", "completed_at": "2026-02-25T11:43:47.857138Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.859751Z", "completed_at": "2026-02-25T11:43:47.859765Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16344094276428223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\nwhere customer_state is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_customers_customer_state`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:47.846814Z", "completed_at": "2026-02-25T11:43:47.859148Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:47.860796Z", "completed_at": "2026-02-25T11:43:47.860814Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22992181777954102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\nwhere customer_unique_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.060768Z", "completed_at": "2026-02-25T11:43:48.095471Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.096508Z", "completed_at": "2026-02-25T11:43:48.096527Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11077213287353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n  where customer_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_stg_customers_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.087269Z", "completed_at": "2026-02-25T11:43:48.098004Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.164372Z", "completed_at": "2026-02-25T11:43:48.164399Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17151594161987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_status as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n    group by order_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.068785Z", "completed_at": "2026-02-25T11:43:48.166987Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.229835Z", "completed_at": "2026-02-25T11:43:48.229864Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.23977875709533691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.int_orders_enriched", "compiled": true, "compiled_code": "\n\n/*\n  INTERMEDIATE MODEL: int_orders_enriched\n  \n  Purpose: Enrich orders with aggregated item data and customer info\n  \n  Joins:\n  - stg_orders (base)\n  - stg_order_items (aggregated)\n  - stg_customers (customer details)\n*/\n\nwith orders as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n),\n\norder_items as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n),\n\ncustomers as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n),\n\norder_totals as (\n    select\n        order_id,\n        count(*) as item_count,\n        count(distinct product_id) as unique_products,\n        sum(item_price) as subtotal,\n        sum(item_freight) as freight_total,\n        sum(item_total) as order_total,\n        avg(item_price) as avg_item_price,\n        max(item_price) as max_item_price\n    from order_items\n    group by 1\n),\n\nenriched as (\n    select\n        o.order_id,\n        o.order_status,\n        o.ordered_at,\n        o.order_date,\n        o.approved_at,\n        o.shipped_at,\n        o.delivered_at,\n        o.estimated_delivery_at,\n        o.delivery_days,\n        o.is_late_delivery,\n        o.days_late,\n\n        o.customer_id,\n        c.customer_unique_id,\n        c.customer_city,\n        c.customer_state,\n        c.customer_region,\n\n        coalesce(ot.item_count, 0) as item_count,\n        coalesce(ot.unique_products, 0) as unique_products,\n        coalesce(ot.subtotal, 0) as subtotal,\n        coalesce(ot.freight_total, 0) as freight_total,\n        coalesce(ot.order_total, 0) as order_total,\n        coalesce(ot.avg_item_price, 0) as avg_item_price,\n        coalesce(ot.max_item_price, 0) as max_item_price,\n\n        case\n            when coalesce(ot.order_total, 0) < 50 then 'Small'\n            when coalesce(ot.order_total, 0) < 200 then 'Medium'\n            when coalesce(ot.order_total, 0) < 500 then 'Large'\n            else 'Premium'\n        end as order_size_bucket,\n\n        extract(year from o.order_date) as order_year,\n    extract(month from o.order_date) as order_month,\n    extract(quarter from o.order_date) as order_quarter,\n    extract(week from o.order_date) as order_week,\n    extract(dayofweek from o.order_date) as order_day_of_week,\n    case \n        when extract(dayofweek from o.order_date) in (1, 7) then true \n        else false \n    end as is_weekend\n\n\n    from orders o\n    left join customers c on o.customer_id = c.customer_id\n    left join order_totals ot on o.order_id = ot.order_id\n)\n\nselect * from enriched", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.297495Z", "completed_at": "2026-02-25T11:43:48.315539Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.329559Z", "completed_at": "2026-02-25T11:43:48.329575Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16132092475891113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.assert_delivery_dates_logical", "compiled": true, "compiled_code": "/*\n  SINGULAR TEST: assert_delivery_dates_logical\n  \n  Purpose: Delivery dates should follow logical order\n  \n  Business Rules:\n  - approved_at >= ordered_at\n  - shipped_at >= approved_at (if exists)\n  - delivered_at >= shipped_at (if exists)\n  \n  Test PASSES if query returns 0 rows\n*/\n\nwith orders as (\n    select\n        order_id,\n        ordered_at,\n        approved_at,\n        shipped_at,\n        delivered_at\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n),\n\ndate_violations as (\n    select\n        order_id,\n        case\n            when approved_at < ordered_at then 'Approved before ordered'\n            when shipped_at < approved_at then 'Shipped before approved'\n            when delivered_at < shipped_at then 'Delivered before shipped'\n            when delivered_at < ordered_at then 'Delivered before ordered'\n        end as violation_type,\n        ordered_at,\n        approved_at,\n        shipped_at,\n        delivered_at\n    from orders\n    where \n        (approved_at is not null and approved_at < ordered_at)\n        or (shipped_at is not null and approved_at is not null and shipped_at < approved_at)\n        or (delivered_at is not null and shipped_at is not null and delivered_at < shipped_at)\n        or (delivered_at is not null and delivered_at < ordered_at)\n)\n\nselect * from date_violations", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`assert_delivery_dates_logical`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.308278Z", "completed_at": "2026-02-25T11:43:48.328958Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.330820Z", "completed_at": "2026-02-25T11:43:48.330838Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16345882415771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.assert_orders_have_items", "compiled": true, "compiled_code": "\n\n/*\n  SINGULAR TEST: assert_orders_have_items\n  Purpose: Every order should have at least one line item\n  Business Rule: An order without items indicates data integrity issue\n  Test PASSES if this query returns 0 rows\n  Test FAILS if any orders exist without items\n  \n  Note: Sample data may have orphaned records - set to warn\n*/\nwith orders as (\n    select order_id from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n),\norder_items as (\n    select distinct order_id from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n),\norders_without_items as (\n    select\n        o.order_id\n    from orders o\n    left join order_items oi on o.order_id = oi.order_id\n    where oi.order_id is null\n)\nselect\n    order_id,\n    'Order has no items' as failure_reason\nfrom orders_without_items", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`assert_orders_have_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.316734Z", "completed_at": "2026-02-25T11:43:48.332125Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.395754Z", "completed_at": "2026-02-25T11:43:48.395772Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2160811424255371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and delivery_days >= 0 and delivery_days <= 180\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n    where\n        delivery_days is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.527141Z", "completed_at": "2026-02-25T11:43:48.547425Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.554038Z", "completed_at": "2026-02-25T11:43:48.554063Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16066718101501465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\nwhere customer_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_orders_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.538251Z", "completed_at": "2026-02-25T11:43:48.559093Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.623438Z", "completed_at": "2026-02-25T11:43:48.623457Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16409611701965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\nwhere is_late_delivery is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.548685Z", "completed_at": "2026-02-25T11:43:48.624200Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.626121Z", "completed_at": "2026-02-25T11:43:48.626139Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21691608428955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\nwhere order_date is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_orders_order_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.755289Z", "completed_at": "2026-02-25T11:43:48.766104Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.768357Z", "completed_at": "2026-02-25T11:43:48.768376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16486096382141113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\nwhere order_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_orders_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.769263Z", "completed_at": "2026-02-25T11:43:48.855686Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.857885Z", "completed_at": "2026-02-25T11:43:48.857902Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15710806846618652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\nwhere order_status is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_orders_order_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.782436Z", "completed_at": "2026-02-25T11:43:48.856328Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:48.858821Z", "completed_at": "2026-02-25T11:43:48.858840Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22354602813720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\nwhere ordered_at is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_orders_ordered_at`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:48.922849Z", "completed_at": "2026-02-25T11:43:49.003503Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.005568Z", "completed_at": "2026-02-25T11:43:49.005586Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.23047304153442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select order_id as from_field\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n    where order_id is not null\n),\n\nparent as (\n    select order_id as to_field\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.006451Z", "completed_at": "2026-02-25T11:43:49.089599Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.091640Z", "completed_at": "2026-02-25T11:43:49.091660Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16141891479492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.018273Z", "completed_at": "2026-02-25T11:43:49.093176Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.164199Z", "completed_at": "2026-02-25T11:43:49.164219Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2261638641357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_orders`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_stg_orders_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.094321Z", "completed_at": "2026-02-25T11:43:49.166969Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.229863Z", "completed_at": "2026-02-25T11:43:49.229882Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21494698524475098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_product_categories`\nwhere category_group is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_product_categories_category_group`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.231088Z", "completed_at": "2026-02-25T11:43:49.308081Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.310464Z", "completed_at": "2026-02-25T11:43:49.310484Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.21713519096374512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_product_categories`\nwhere category_name_en is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.311343Z", "completed_at": "2026-02-25T11:43:49.393676Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.395801Z", "completed_at": "2026-02-25T11:43:49.395818Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16412091255187988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_product_categories`\nwhere category_name_pt is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.385302Z", "completed_at": "2026-02-25T11:43:49.397186Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.469244Z", "completed_at": "2026-02-25T11:43:49.469271Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.22689509391784668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select category_name_pt as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_product_categories`\n  where category_name_pt is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.398220Z", "completed_at": "2026-02-25T11:43:49.538709Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.554035Z", "completed_at": "2026-02-25T11:43:49.554055Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22273612022399902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.int_products_enriched", "compiled": true, "compiled_code": "\n\n/*\n  INTERMEDIATE MODEL: int_products_enriched\n  \n  Purpose: Enrich products with category translations and sales metrics\n*/\n\nwith products as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products`\n),\n\ncategories as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_product_categories`\n),\n\norder_items as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n),\n\n-- Calculate product-level sales metrics\nproduct_sales as (\n    select\n        product_id,\n        count(distinct order_id) as times_ordered,\n        sum(item_price) as total_revenue,\n        avg(item_price) as avg_selling_price,\n        min(item_price) as min_selling_price,\n        max(item_price) as max_selling_price\n    from order_items\n    group by 1\n),\n\n-- Join products with categories and sales\nenriched as (\n    select\n        -- Product info\n        p.product_id,\n        p.category_name_pt,\n        coalesce(c.category_name_en, 'Unknown') as category_name,\n        coalesce(c.category_group, 'Other') as category_group,\n        \n        -- Dimensions\n        p.weight_grams,\n        p.length_cm,\n        p.height_cm,\n        p.width_cm,\n        p.volume_cm3,\n        p.size_category,\n        \n        -- Product listing quality\n        p.name_length,\n        p.description_length,\n        p.photo_count,\n        \n        -- Derived: Listing quality score (0-100)\n        (\n            case when p.name_length > 0 then 20 else 0 end +\n            case when p.description_length > 100 then 30 else p.description_length * 0.3 end +\n            case when p.photo_count >= 3 then 50 else p.photo_count * 15 end\n        ) as listing_quality_score,\n        \n        -- Sales metrics\n        coalesce(ps.times_ordered, 0) as times_ordered,\n        coalesce(ps.total_revenue, 0) as total_revenue,\n        coalesce(ps.avg_selling_price, 0) as avg_selling_price,\n        \n        -- Derived: Product popularity tier\n        case\n            when coalesce(ps.times_ordered, 0) = 0 then 'Never Sold'\n            when ps.times_ordered < 5 then 'Low'\n            when ps.times_ordered < 20 then 'Medium'\n            when ps.times_ordered < 50 then 'High'\n            else 'Top Seller'\n        end as popularity_tier\n\n    from products p\n    left join categories c on p.category_name_pt = c.category_name_pt\n    left join product_sales ps on p.product_id = ps.product_id\n)\n\nselect * from enriched", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_products_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.540507Z", "completed_at": "2026-02-25T11:43:49.620163Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.629954Z", "completed_at": "2026-02-25T11:43:49.629970Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1603248119354248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        size_category as value_field,\n        count(*) as n_records\n\n    from (select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products` where size_category is not null) dbt_subquery\n    group by size_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Small','Medium','Large','Extra Large'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.622324Z", "completed_at": "2026-02-25T11:43:49.693729Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.696510Z", "completed_at": "2026-02-25T11:43:49.696526Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2174978256225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890", "compiled": true, "compiled_code": "\n\nselect\n    weight_grams as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products`\nwhere weight_grams < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.697287Z", "completed_at": "2026-02-25T11:43:49.774808Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.777203Z", "completed_at": "2026-02-25T11:43:49.777220Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.21923518180847168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products`\nwhere product_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_stg_products_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.778359Z", "completed_at": "2026-02-25T11:43:49.859868Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.862361Z", "completed_at": "2026-02-25T11:43:49.862381Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15286684036254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.851943Z", "completed_at": "2026-02-25T11:43:49.864141Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:49.927314Z", "completed_at": "2026-02-25T11:43:49.927336Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.22523188591003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_products`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_stg_products_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:49.928033Z", "completed_at": "2026-02-25T11:43:50.005692Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.007831Z", "completed_at": "2026-02-25T11:43:50.007850Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22617077827453613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.dim_customers", "compiled": true, "compiled_code": "\n\n/*\n  MART: dim_customers\n  \n  Purpose: Customer dimension with lifetime metrics and segmentation\n  \n  Business Logic:\n  - One row per customer\n  - Lifetime value calculated from delivered orders only\n  - Customer segments based on value and frequency\n  \n  Data Contract: Enforced in _marts.yml\n*/\n\nwith orders as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\n    where order_status = 'delivered'  -- Only count completed orders\n),\n\ncustomers as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_customers`\n),\n\n-- Calculate customer metrics\ncustomer_metrics as (\n    select\n        customer_id,\n        customer_unique_id,\n        \n        -- Order counts\n        count(distinct order_id) as lifetime_orders,\n        \n        -- Revenue metrics\n        sum(order_total) as lifetime_revenue,\n        avg(order_total) as avg_order_value,\n        max(order_total) as max_order_value,\n        sum(item_count) as lifetime_items,\n        \n        -- Time metrics\n        min(order_date) as first_order_date,\n        max(order_date) as last_order_date,\n        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,\n        \n        -- Delivery metrics\n        avg(delivery_days) as avg_delivery_days,\n        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,\n        \n        -- Favorite region (most orders)\n        max(customer_region) as primary_region\n\n    from orders\n    group by 1, 2\n),\n\n-- Build final dimension\nfinal as (\n    select\n        -- Surrogate Key\n        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,\n        \n        -- Natural Keys\n        c.customer_id,\n        c.customer_unique_id,\n        \n        -- Location\n        c.customer_city,\n        c.customer_state,\n        c.customer_zip_code,\n        c.customer_region,\n        \n        -- Metrics (with defaults for customers without orders)\n        coalesce(m.lifetime_orders, 0) as lifetime_orders,\n        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,\n        coalesce(m.avg_order_value, 0) as avg_order_value,\n        coalesce(m.max_order_value, 0) as max_order_value,\n        coalesce(m.lifetime_items, 0) as lifetime_items,\n        m.first_order_date,\n        m.last_order_date,\n        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,\n        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,\n        coalesce(m.late_deliveries, 0) as late_deliveries,\n        \n        -- Customer Segmentation\n        case\n            when coalesce(m.lifetime_revenue, 0) >= 500 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'\n            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'\n            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'\n            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'\n            else 'No Orders'\n        end as customer_segment,\n        \n        -- Frequency Classification\n        case\n            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'\n            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'\n            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'\n            else 'Never Purchased'\n        end as purchase_frequency,\n        \n        -- Risk: Late delivery rate\n        case\n            when coalesce(m.lifetime_orders, 0) = 0 then 0\n            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)\n        end as late_delivery_rate,\n        \n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from customers c\n    left join customer_metrics m on c.customer_id = m.customer_id\n)\n\nselect * from final", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.008642Z", "completed_at": "2026-02-25T11:43:50.090906Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.093822Z", "completed_at": "2026-02-25T11:43:50.093842Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15377402305603027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.assert_order_total_matches_items", "compiled": true, "compiled_code": "/*\n  SINGULAR TEST: assert_order_total_matches_items\n  \n  Purpose: Order total should equal sum of item totals (within tolerance)\n  \n  Business Rule: Order total = sum(item_price + item_freight) for all items\n  \n  Tolerance: 1 BRL to account for rounding\n  \n  Test PASSES if query returns 0 rows\n*/\n\nwith order_totals_from_items as (\n    select\n        order_id,\n        sum(item_total) as calculated_total\n    from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n    group by 1\n),\n\norder_totals_from_orders as (\n    select\n        order_id,\n        order_total\n    from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\n),\n\nmismatches as (\n    select\n        o.order_id,\n        o.order_total as reported_total,\n        i.calculated_total,\n        abs(o.order_total - i.calculated_total) as difference\n    from order_totals_from_orders o\n    inner join order_totals_from_items i on o.order_id = i.order_id\n    where abs(o.order_total - i.calculated_total) > 1  -- 1 BRL tolerance\n)\n\nselect\n    order_id,\n    reported_total,\n    calculated_total,\n    round(difference, 2) as difference_brl,\n    'Order total does not match sum of items' as failure_reason\nfrom mismatches", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`assert_order_total_matches_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.017912Z", "completed_at": "2026-02-25T11:43:50.094446Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.156606Z", "completed_at": "2026-02-25T11:43:50.156634Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21641111373901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and item_count >= 0 and item_count <= 100\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.224635Z", "completed_at": "2026-02-25T11:43:50.239712Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.249602Z", "completed_at": "2026-02-25T11:43:50.249619Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.22801804542541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf", "compiled": true, "compiled_code": "\n\nselect\n    order_total as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\nwhere order_total < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.240604Z", "completed_at": "2026-02-25T11:43:50.259861Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.322123Z", "completed_at": "2026-02-25T11:43:50.322154Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15005111694335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\nwhere item_count is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_int_orders_enriched_item_count`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.250782Z", "completed_at": "2026-02-25T11:43:50.324387Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.387468Z", "completed_at": "2026-02-25T11:43:50.387485Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21284699440002441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\nwhere order_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_int_orders_enriched_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.454420Z", "completed_at": "2026-02-25T11:43:50.472978Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.474801Z", "completed_at": "2026-02-25T11:43:50.474821Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1585078239440918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\nwhere order_total is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_int_orders_enriched_order_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.464955Z", "completed_at": "2026-02-25T11:43:50.475747Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.547941Z", "completed_at": "2026-02-25T11:43:50.547963Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1595752239227295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_int_orders_enriched_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.476363Z", "completed_at": "2026-02-25T11:43:50.550929Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.614295Z", "completed_at": "2026-02-25T11:43:50.614315Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21499204635620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.fct_orders", "compiled": true, "compiled_code": "\n\n/*\n  MART: fct_orders\n  \n  Purpose: Order fact table for analytics and BI\n  \n  Features:\n  - Incremental materialization for large datasets\n  - Partitioned by order_date for BigQuery efficiency\n  - Clustered for common filter patterns\n  \n  Grain: One row per order\n*/\n\nwith orders as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_orders_enriched`\n),\n\nproducts as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_products_enriched`\n),\n\norder_items as (\n    select * from `arcane-pillar-485809-b6`.`raw_olist_staging`.`stg_order_items`\n),\n\n-- Get primary category per order (highest value item)\norder_categories as (\n    select\n        oi.order_id,\n        p.category_name,\n        p.category_group,\n        row_number() over (\n            partition by oi.order_id \n            order by oi.item_total desc\n        ) as rank\n    from order_items oi\n    left join products p on oi.product_id = p.product_id\n),\n\nprimary_category as (\n    select\n        order_id,\n        category_name as primary_category,\n        category_group as primary_category_group\n    from order_categories\n    where rank = 1\n),\n\n-- Build fact table\nfinal as (\n    select\n        -- Keys\n        o.order_id,\n        o.customer_id,\n        \n        -- Order Details\n        o.order_status,\n        o.order_date,\n        o.ordered_at,\n        o.approved_at,\n        o.shipped_at,\n        o.delivered_at,\n        o.estimated_delivery_at,\n        \n        -- Time dimensions\n        o.order_year,\n        o.order_month,\n        o.order_quarter,\n        o.order_week,\n        o.order_day_of_week,\n        o.is_weekend,\n        \n        -- Customer Location\n        o.customer_city,\n        o.customer_state,\n        o.customer_region,\n        \n        -- Product Info\n        coalesce(pc.primary_category, 'Unknown') as primary_category,\n        coalesce(pc.primary_category_group, 'Other') as primary_category_group,\n        \n        -- Measures\n        o.item_count,\n        o.unique_products,\n        o.subtotal,\n        o.freight_total,\n        o.order_total,\n        o.avg_item_price,\n        \n        -- Delivery Metrics\n        o.delivery_days,\n        o.is_late_delivery,\n        o.days_late,\n        \n        -- Derived Classifications\n        o.order_size_bucket,\n        \n        -- SLA Compliance\n        case\n            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'\n            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'\n            when o.order_status = 'canceled' then 'Canceled'\n            else 'In Progress'\n        end as delivery_sla_status,\n        \n        -- Metadata\n        current_timestamp() as _loaded_at\n\n    from orders o\n    left join primary_category pc on o.order_id = pc.order_id\n)\n\nselect * from final", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.680310Z", "completed_at": "2026-02-25T11:43:50.695913Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.706744Z", "completed_at": "2026-02-25T11:43:50.706764Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16764521598815918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and listing_quality_score >= 0 and listing_quality_score <= 100\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_products_enriched`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.696854Z", "completed_at": "2026-02-25T11:43:50.716348Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.777937Z", "completed_at": "2026-02-25T11:43:50.777968Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15175294876098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_products_enriched`\nwhere category_name is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_int_products_enriched_category_name`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.707751Z", "completed_at": "2026-02-25T11:43:50.780292Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.844734Z", "completed_at": "2026-02-25T11:43:50.844754Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21526885032653809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_products_enriched`\nwhere product_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_int_products_enriched_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.912600Z", "completed_at": "2026-02-25T11:43:50.931326Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:50.963244Z", "completed_at": "2026-02-25T11:43:50.963264Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2665719985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_intermediate`.`int_products_enriched`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_int_products_enriched_product_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.964148Z", "completed_at": "2026-02-25T11:43:51.114677Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.119460Z", "completed_at": "2026-02-25T11:43:51.119479Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.27730679512023926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_region as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    group by customer_region\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Southeast','South','Northeast','Central-West','North'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.122188Z", "completed_at": "2026-02-25T11:43:51.212448Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.229047Z", "completed_at": "2026-02-25T11:43:51.229069Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.18062210083007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'VIP','High Value','Medium Value','Low Value','No Orders'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.213115Z", "completed_at": "2026-02-25T11:43:51.293837Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.294916Z", "completed_at": "2026-02-25T11:43:51.294936Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15389394760131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        purchase_frequency as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    group by purchase_frequency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Frequent','Repeat','One-Time','Never Purchased'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.371471Z", "completed_at": "2026-02-25T11:43:51.389259Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.390131Z", "completed_at": "2026-02-25T11:43:51.390150Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09075403213500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.assert_vip_customer_criteria", "compiled": true, "compiled_code": "/*\n  SINGULAR TEST: assert_vip_customer_criteria\n  \n  Purpose: VIP customers must meet the defined criteria\n  \n  Business Rule: VIP = lifetime_revenue >= 500 AND lifetime_orders >= 3\n  \n  Test PASSES if query returns 0 rows\n*/\n\nwith vip_customers as (\n    select\n        customer_id,\n        customer_segment,\n        lifetime_revenue,\n        lifetime_orders\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    where customer_segment = 'VIP'\n),\n\ninvalid_vips as (\n    select\n        customer_id,\n        lifetime_revenue,\n        lifetime_orders,\n        'VIP but does not meet criteria' as violation\n    from vip_customers\n    where lifetime_revenue < 500\n       or lifetime_orders < 3\n),\n\nshould_be_vips as (\n    select\n        customer_id,\n        customer_segment,\n        lifetime_revenue,\n        lifetime_orders,\n        'Should be VIP but is not' as violation\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    where lifetime_revenue >= 500\n      and lifetime_orders >= 3\n      and customer_segment != 'VIP'\n)\n\nselect * from invalid_vips\nunion all\nselect customer_id, lifetime_revenue, lifetime_orders, violation from should_be_vips", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`assert_vip_customer_criteria`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.380017Z", "completed_at": "2026-02-25T11:43:51.390781Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.391833Z", "completed_at": "2026-02-25T11:43:51.391852Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15607213973999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n    length(\n        customer_state\n    ) = 2 as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.530559Z", "completed_at": "2026-02-25T11:43:51.554801Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.555970Z", "completed_at": "2026-02-25T11:43:51.555988Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09468698501586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and late_delivery_rate >= 0 and late_delivery_rate <= 100\n)\n as expression\n\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.542154Z", "completed_at": "2026-02-25T11:43:51.556803Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.622215Z", "completed_at": "2026-02-25T11:43:51.622238Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1642758846282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178", "compiled": true, "compiled_code": "\n\nselect\n    avg_order_value as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere avg_order_value < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.688438Z", "completed_at": "2026-02-25T11:43:51.699615Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.701703Z", "completed_at": "2026-02-25T11:43:51.701796Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14900994300842285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e", "compiled": true, "compiled_code": "\n\nselect\n    customer_lifespan_days as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_lifespan_days < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.703029Z", "completed_at": "2026-02-25T11:43:51.775403Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.777142Z", "completed_at": "2026-02-25T11:43:51.777171Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15096330642700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a", "compiled": true, "compiled_code": "\n\nselect\n    late_deliveries as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere late_deliveries < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.779270Z", "completed_at": "2026-02-25T11:43:51.860186Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.863082Z", "completed_at": "2026-02-25T11:43:51.863103Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1526479721069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159", "compiled": true, "compiled_code": "\n\nselect\n    lifetime_items as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere lifetime_items < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:51.854610Z", "completed_at": "2026-02-25T11:43:51.927892Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:51.929934Z", "completed_at": "2026-02-25T11:43:51.929952Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14170598983764648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8", "compiled": true, "compiled_code": "\n\nselect\n    lifetime_orders as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere lifetime_orders < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:50.925617Z", "completed_at": "2026-02-25T11:43:52.014789Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.025251Z", "completed_at": "2026-02-25T11:43:52.025269Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.116529941558838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_advanced_olist.compare_customers", "compiled": true, "compiled_code": "-- ============================================================\n-- ANALYSIS: Compare Model Versions with Audit Helper\n-- ============================================================\n-- \n-- Use this analysis to compare two versions of a model.\n-- Great for validating refactoring or debugging issues.\n--\n-- Run: dbt compile --select compare_customers\n-- Then copy the compiled SQL to BigQuery\n-- ============================================================\n\n\n\n-- Compare current vs itself (in real use, compare to old version)\n\n\n\n\n\n\n\n\n\n\n\n\nwith a as (\n\n    \nselect\n\n  \n\n   \n    `customer_key` \n    \n      , \n     \n   \n    `customer_id` \n    \n      , \n     \n   \n    `customer_unique_id` \n    \n      , \n     \n   \n    `customer_city` \n    \n      , \n     \n   \n    `customer_state` \n    \n      , \n     \n   \n    `customer_zip_code` \n    \n      , \n     \n   \n    `customer_region` \n    \n      , \n     \n   \n    `lifetime_orders` \n    \n      , \n     \n   \n    `lifetime_revenue` \n    \n      , \n     \n   \n    `avg_order_value` \n    \n      , \n     \n   \n    `max_order_value` \n    \n      , \n     \n   \n    `lifetime_items` \n    \n      , \n     \n   \n    `first_order_date` \n    \n      , \n     \n   \n    `last_order_date` \n    \n      , \n     \n   \n    `customer_lifespan_days` \n    \n      , \n     \n   \n    `avg_delivery_days` \n    \n      , \n     \n   \n    `late_deliveries` \n    \n      , \n     \n   \n    `customer_segment` \n    \n      , \n     \n   \n    `purchase_frequency` \n    \n      , \n     \n   \n    `late_delivery_rate` \n     \n  \n\n\n\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n\n\n),\n\nb as (\n\n    \nselect\n\n  \n\n   \n    `customer_key` \n    \n      , \n     \n   \n    `customer_id` \n    \n      , \n     \n   \n    `customer_unique_id` \n    \n      , \n     \n   \n    `customer_city` \n    \n      , \n     \n   \n    `customer_state` \n    \n      , \n     \n   \n    `customer_zip_code` \n    \n      , \n     \n   \n    `customer_region` \n    \n      , \n     \n   \n    `lifetime_orders` \n    \n      , \n     \n   \n    `lifetime_revenue` \n    \n      , \n     \n   \n    `avg_order_value` \n    \n      , \n     \n   \n    `max_order_value` \n    \n      , \n     \n   \n    `lifetime_items` \n    \n      , \n     \n   \n    `first_order_date` \n    \n      , \n     \n   \n    `last_order_date` \n    \n      , \n     \n   \n    `customer_lifespan_days` \n    \n      , \n     \n   \n    `avg_delivery_days` \n    \n      , \n     \n   \n    `late_deliveries` \n    \n      , \n     \n   \n    `customer_segment` \n    \n      , \n     \n   \n    `purchase_frequency` \n    \n      , \n     \n   \n    `late_delivery_rate` \n     \n  \n\n\n\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n\n\n),\n\na_intersect_b as (\n\n    select * from a\n    \n\n    intersect distinct\n\n\n    select * from b\n\n),\n\na_except_b as (\n\n    select * from a\n    \n\n    except distinct\n\n\n    select * from b\n\n),\n\nb_except_a as (\n\n    select * from b\n    \n\n    except distinct\n\n\n    select * from a\n\n),\n\nall_records as (\n\n    select\n        *,\n        true as in_a,\n        true as in_b\n    from a_intersect_b\n\n    union all\n\n    select\n        *,\n        true as in_a,\n        false as in_b\n    from a_except_b\n\n    union all\n\n    select\n        *,\n        false as in_a,\n        true as in_b\n    from b_except_a\n\n),\n\nsummary_stats as (\n\n    select\n\n        in_a,\n        in_b,\n        count(*) as count\n\n    from all_records\n    group by 1, 2\n\n),\n\nfinal as (\n\n    select\n\n        *,\n        round(100.0 * count / sum(count) over (), 2) as percent_of_total\n\n    from summary_stats\n    order by in_a desc, in_b desc\n\n)\n\nselect * from final\n\n\n\n\n```\n\n-- ============================================================\n-- INTERPRETATION:\n-- \n-- in_a | in_b | count | meaning\n-- -----|------|-------|--------\n-- true | true | 9000  | Matching rows (good!)\n-- true | false| 100   | Rows only in A (deleted in B?)\n-- false| true | 50    | Rows only in B (new in B?)\n--\n-- ============================================================", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.015581Z", "completed_at": "2026-02-25T11:43:52.038049Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.039962Z", "completed_at": "2026-02-25T11:43:52.039978Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09790182113647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e", "compiled": true, "compiled_code": "\n\nselect\n    lifetime_revenue as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere lifetime_revenue < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.029756Z", "completed_at": "2026-02-25T11:43:52.040795Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.042647Z", "completed_at": "2026-02-25T11:43:52.042664Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16809797286987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c", "compiled": true, "compiled_code": "\n\nselect\n    max_order_value as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere max_order_value < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.112147Z", "completed_at": "2026-02-25T11:43:52.185357Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.194316Z", "completed_at": "2026-02-25T11:43:52.194335Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21591496467590332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere avg_order_value is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_avg_order_value`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.186040Z", "completed_at": "2026-02-25T11:43:52.196349Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.266847Z", "completed_at": "2026-02-25T11:43:52.266867Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15060186386108398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_city is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_city`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.258885Z", "completed_at": "2026-02-25T11:43:52.333445Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.340430Z", "completed_at": "2026-02-25T11:43:52.340453Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.214277982711792, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.335085Z", "completed_at": "2026-02-25T11:43:52.410856Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.422278Z", "completed_at": "2026-02-25T11:43:52.422341Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22803092002868652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_key is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_key`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.412987Z", "completed_at": "2026-02-25T11:43:52.495789Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.498182Z", "completed_at": "2026-02-25T11:43:52.498201Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2215099334716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_region is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_region`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.425483Z", "completed_at": "2026-02-25T11:43:52.501079Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.567898Z", "completed_at": "2026-02-25T11:43:52.567917Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.21530675888061523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_segment is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_segment`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.568877Z", "completed_at": "2026-02-25T11:43:52.640934Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.643690Z", "completed_at": "2026-02-25T11:43:52.643710Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21926188468933105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_state is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_state`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.645391Z", "completed_at": "2026-02-25T11:43:52.731098Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.733621Z", "completed_at": "2026-02-25T11:43:52.733640Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16973066329956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere customer_unique_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.721484Z", "completed_at": "2026-02-25T11:43:52.735246Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.808550Z", "completed_at": "2026-02-25T11:43:52.808586Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2346949577331543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere lifetime_items is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_lifetime_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.736385Z", "completed_at": "2026-02-25T11:43:52.876566Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.880444Z", "completed_at": "2026-02-25T11:43:52.880465Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2158517837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere lifetime_orders is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.952415Z", "completed_at": "2026-02-25T11:43:52.973905Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:52.976494Z", "completed_at": "2026-02-25T11:43:52.976518Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16659212112426758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere lifetime_revenue is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.962170Z", "completed_at": "2026-02-25T11:43:52.987001Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.049770Z", "completed_at": "2026-02-25T11:43:53.049790Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16331076622009277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere max_order_value is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_max_order_value`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:52.978154Z", "completed_at": "2026-02-25T11:43:53.050475Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.114593Z", "completed_at": "2026-02-25T11:43:53.114612Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21811795234680176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\nwhere purchase_frequency is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.182733Z", "completed_at": "2026-02-25T11:43:53.201005Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.215437Z", "completed_at": "2026-02-25T11:43:53.215458Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1657731533050537, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n  where customer_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_dim_customers_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.192495Z", "completed_at": "2026-02-25T11:43:53.216607Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.218303Z", "completed_at": "2026-02-25T11:43:53.218324Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16551804542541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_key as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n  where customer_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_dim_customers_customer_key`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.202607Z", "completed_at": "2026-02-25T11:43:53.282775Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.347777Z", "completed_at": "2026-02-25T11:43:53.347807Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22395610809326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        delivery_sla_status as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\n    group by delivery_sla_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Met','Missed','Canceled','In Progress'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.417793Z", "completed_at": "2026-02-25T11:43:53.445650Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.456352Z", "completed_at": "2026-02-25T11:43:53.456374Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17305994033813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_size_bucket as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\n    group by order_size_bucket\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Small','Medium','Large','Premium'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.432127Z", "completed_at": "2026-02-25T11:43:53.457215Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.522830Z", "completed_at": "2026-02-25T11:43:53.522849Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.17404961585998535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_status as value_field,\n        count(*) as n_records\n\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\n    group by order_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'\n)\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.446668Z", "completed_at": "2026-02-25T11:43:53.520451Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.523954Z", "completed_at": "2026-02-25T11:43:53.523972Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.23050189018249512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20", "compiled": true, "compiled_code": "\n\nselect\n    freight_total as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere freight_total < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.668986Z", "completed_at": "2026-02-25T11:43:53.691228Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.701327Z", "completed_at": "2026-02-25T11:43:53.701348Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.23153114318847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4", "compiled": true, "compiled_code": "\n\nselect\n    subtotal as failing_value,\n    count(*) as row_count\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere subtotal < 0\ngroup by 1\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.681030Z", "completed_at": "2026-02-25T11:43:53.702336Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.703400Z", "completed_at": "2026-02-25T11:43:53.703417Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1607499122619629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere customer_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_customer_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.692594Z", "completed_at": "2026-02-25T11:43:53.829830Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.832649Z", "completed_at": "2026-02-25T11:43:53.832668Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.22045636177062988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere delivery_sla_status is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.900640Z", "completed_at": "2026-02-25T11:43:53.924740Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.926099Z", "completed_at": "2026-02-25T11:43:53.926118Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16519665718078613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere freight_total is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_freight_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.913903Z", "completed_at": "2026-02-25T11:43:53.926735Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:53.936421Z", "completed_at": "2026-02-25T11:43:53.936443Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.228956937789917, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere item_count is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_item_count`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:53.927483Z", "completed_at": "2026-02-25T11:43:54.001390Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.064243Z", "completed_at": "2026-02-25T11:43:54.064263Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21280193328857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere order_date is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_order_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.067034Z", "completed_at": "2026-02-25T11:43:54.141279Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.154337Z", "completed_at": "2026-02-25T11:43:54.154355Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16591906547546387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere order_id is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_order_id`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.142062Z", "completed_at": "2026-02-25T11:43:54.163338Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.229226Z", "completed_at": "2026-02-25T11:43:54.229244Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.17858290672302246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere order_status is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_order_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.155215Z", "completed_at": "2026-02-25T11:43:54.229942Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.315117Z", "completed_at": "2026-02-25T11:43:54.315147Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2463512420654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere order_total is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_order_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:43.551131Z", "completed_at": "2026-02-25T11:43:54.388702Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.399957Z", "completed_at": "2026-02-25T11:43:54.399976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.859928846359253, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_advanced_olist.dim_date", "compiled": true, "compiled_code": "\n\nwith date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1096\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n        datetime_add(\n            cast( cast('2016-01-01' as date) as datetime),\n        interval row_number() over (order by 1) - 1 day\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2019-01-01' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_key,\n        extract(year from date_day) as year,\n        extract(month from date_day) as month,\n        extract(quarter from date_day) as quarter,\n        extract(week from date_day) as week_of_year,\n        extract(dayofweek from date_day) as day_of_week,\n        format_date('%A', date_day) as day_name,\n        format_date('%B', date_day) as month_name,\n        case \n            when extract(dayofweek from date_day) in (1, 7) then true \n            else false \n        end as is_weekend\n    from date_spine\n)\n\nselect * from final", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.390520Z", "completed_at": "2026-02-25T11:43:54.416218Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.419760Z", "completed_at": "2026-02-25T11:43:54.419779Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.17964601516723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere ordered_at is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_ordered_at`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.406950Z", "completed_at": "2026-02-25T11:43:54.427855Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.498721Z", "completed_at": "2026-02-25T11:43:54.498741Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.18429303169250488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere primary_category is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_primary_category`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.422394Z", "completed_at": "2026-02-25T11:43:54.509276Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.575900Z", "completed_at": "2026-02-25T11:43:54.575920Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.23703408241271973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere primary_category_group is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_primary_category_group`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.499768Z", "completed_at": "2026-02-25T11:43:54.577899Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.644635Z", "completed_at": "2026-02-25T11:43:54.644651Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30445408821105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere subtotal is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_subtotal`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.645449Z", "completed_at": "2026-02-25T11:43:54.739524Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.741879Z", "completed_at": "2026-02-25T11:43:54.741898Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.24153399467468262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\nwhere unique_products is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`not_null_fct_orders_unique_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.727060Z", "completed_at": "2026-02-25T11:43:54.742562Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.752120Z", "completed_at": "2026-02-25T11:43:54.752145Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.30739903450012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from `arcane-pillar-485809-b6`.`raw_olist_marts`.`dim_customers`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-25T11:43:54.743258Z", "completed_at": "2026-02-25T11:43:54.885928Z"}, {"name": "execute", "started_at": "2026-02-25T11:43:54.888407Z", "completed_at": "2026-02-25T11:43:54.888424Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2146768569946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `arcane-pillar-485809-b6`.`raw_olist_marts`.`fct_orders`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": "`arcane-pillar-485809-b6`.`raw_olist_dbt_test__audit`.`unique_fct_orders_order_id`", "batch_results": null}], "elapsed_time": 13.092926979064941, "args": {"compile": true, "populate_cache": true, "print": true, "require_batched_execution_for_custom_microbatch_strategy": false, "introspect": true, "project_dir": "/Users/harjeetkalsi/Advance-DBT", "require_explicit_package_overrides_for_builtin_materializations": true, "require_nested_cumulative_type_params": false, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "use_fast_test_edges": false, "select": [], "upload_to_artifacts_ingest_api": false, "use_colors": true, "partial_parse_file_diff": true, "log_level": "info", "version_check": true, "exclude": [], "profiles_dir": "/Users/harjeetkalsi/.dbt", "source_freshness_run_project_hooks": true, "state_modified_compare_more_unrendered_values": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "show_all_deprecations": false, "indirect_selection": "eager", "printer_width": 80, "macro_debugging": false, "require_all_warnings_handled_by_warn_error": false, "require_ref_searches_node_package_before_root": false, "write_json": true, "log_level_file": "debug", "invocation_command": "dbt docs generate", "log_format_file": "debug", "defer": false, "log_format": "default", "which": "generate", "log_file_max_bytes": 10485760, "require_unique_project_resource_names": false, "require_resource_names_without_spaces": true, "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "validate_macro_args": false, "static": false, "static_parser": true, "favor_state": false, "empty_catalog": false, "send_anonymous_usage_stats": true, "require_generic_test_arguments_property": true, "log_path": "/Users/harjeetkalsi/Advance-DBT/logs", "partial_parse": true, "quiet": false, "strict_mode": false, "cache_selected_only": false, "vars": {}}}