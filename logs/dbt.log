[0m12:42:10.529584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015677CF4F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015677AF4FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015677CF65D0>]}


============================== 12:42:10.537059 | d4dfd3cc-c7a3-4d09-8ad9-73b74500b58f ==============================
[0m12:42:10.537059 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:42:10.539193 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m12:42:10.869922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4dfd3cc-c7a3-4d09-8ad9-73b74500b58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015678256FD0>]}
[0m12:42:11.806547 [debug] [MainThread]: Command `dbt clean` succeeded at 12:42:11.806547 after 1.43 seconds
[0m12:42:11.806547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015677AE5DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015671D346D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015671D34250>]}
[0m12:42:11.808983 [debug] [MainThread]: Flushing usage events
[0m12:42:14.301308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:40.210141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536CF6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536CF5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536CE6E10>]}


============================== 12:42:40.215799 | da091883-dc72-47c9-a797-6c7081ff02b0 ==============================
[0m12:42:40.215799 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:42:40.217709 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m12:42:40.551311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026537230290>]}
[0m12:42:41.266465 [debug] [MainThread]: Set downloads directory='C:\Users\HP\AppData\Local\Temp\dbt-downloads-6097uh5_'
[0m12:42:41.269044 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:42:42.409917 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:42:42.416155 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:42:42.660524 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:42:42.709677 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m12:42:43.216133 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m12:42:43.231649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m12:42:43.925141 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m12:42:43.933169 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:42:44.153803 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:42:44.175669 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:42:44.546490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:42:44.547494 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m12:42:44.556760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536D52990>]}
[0m12:42:44.597138 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:42:56.079269 [info ] [MainThread]: Installed from version 1.1.1
[0m12:42:56.083862 [info ] [MainThread]: Updated version available: 1.3.3
[0m12:42:56.092698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026537245390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265355089D0>]}
[0m12:42:56.094002 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m12:43:00.514669 [info ] [MainThread]: Installed from version 0.10.3
[0m12:43:00.517270 [info ] [MainThread]: Updated version available: 0.10.10
[0m12:43:00.523642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653728BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653734A590>]}
[0m12:43:00.525028 [info ] [MainThread]: Installing dbt-labs/audit_helper
[0m12:43:01.549348 [info ] [MainThread]: Installed from version 0.9.0
[0m12:43:01.562794 [info ] [MainThread]: Updated version available: 0.12.2
[0m12:43:01.573058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026537289890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265372A2090>]}
[0m12:43:01.576091 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:43:06.327948 [info ] [MainThread]: Installed from version 0.12.1
[0m12:43:06.331427 [info ] [MainThread]: Updated version available: 0.14.0
[0m12:43:06.335459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002653734A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026537233350>]}
[0m12:43:06.337849 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:43:07.604335 [info ] [MainThread]: Installed from version 0.10.1
[0m12:43:07.606374 [info ] [MainThread]: Up to date!
[0m12:43:07.608555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da091883-dc72-47c9-a797-6c7081ff02b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536DE6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536DE4850>]}
[0m12:43:07.610224 [info ] [MainThread]: 
[0m12:43:07.611222 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'metaplane/dbt_expectations', 'dbt-labs/audit_helper', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m12:43:07.621037 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageRedirectDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:43:07.639296 [debug] [MainThread]: Command `dbt deps` succeeded at 12:43:07.639296 after 27.58 seconds
[0m12:43:07.639296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026536D5CF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026530D34190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026530D346D0>]}
[0m12:43:07.639296 [debug] [MainThread]: Flushing usage events
[0m12:43:09.189792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:33.025462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018055AF5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018055AF4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018055AF4690>]}


============================== 12:43:33.032551 | a8d73830-680e-495a-b594-ea256649aca4 ==============================
[0m12:43:33.032551 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:43:33.035242 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select dim_date', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m12:43:40.117269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806B603C90>]}
[0m12:43:40.268080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000180511E4390>]}
[0m12:43:40.268080 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:43:41.789056 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:43:41.797343 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:43:41.799727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806BB289D0>]}
[0m12:43:49.249665 [info ] [MainThread]: ============================================================
[0m12:43:49.252190 [info ] [MainThread]: DBT RUN STARTED
[0m12:43:49.253783 [info ] [MainThread]: Target: dev
[0m12:43:49.255780 [info ] [MainThread]: Project: dbt_advanced_olist
[0m12:43:49.258328 [info ] [MainThread]: Time: 2025-12-24 12:43:49
[0m12:43:49.261238 [info ] [MainThread]: ============================================================
[0m12:43:49.304108 [info ] [MainThread]: ============================================================
[0m12:43:49.305506 [info ] [MainThread]: DBT RUN COMPLETED
[0m12:43:49.307501 [info ] [MainThread]: Success: 0
[0m12:43:49.311552 [info ] [MainThread]: Errors: 0
[0m12:43:49.315471 [info ] [MainThread]: Skipped: 0
[0m12:43:49.316802 [info ] [MainThread]: Total: 0
[0m12:43:49.318449 [info ] [MainThread]: ============================================================
[0m12:43:50.051879 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test
`dbt_expectations.expect_column_values_to_be_between`. Arguments to generic
tests should be nested under the `arguments` property.`
[0m12:43:50.054791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806C812990>]}
[0m12:43:52.896119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806D113B10>]}
[0m12:43:53.319357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m12:43:53.325848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m12:43:53.395386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806BB300D0>]}
[0m12:43:53.397800 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m12:43:53.398797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806BB48250>]}
[0m12:43:53.400969 [info ] [MainThread]: 
[0m12:43:53.407720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:53.411373 [info ] [MainThread]: 
[0m12:43:53.413090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:43:53.415748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m12:43:53.418533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:55.486805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m12:43:55.489349 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m12:43:55.490408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:55.492404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m12:43:55.494284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:55.495281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m12:43:55.550908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:55.558292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:57.011898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_snapshots, now list_big-query-dbt-481111_dbt_dev_yourname_seeds)
[0m12:43:57.014378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:57.069822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_intermediate, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m12:43:57.073342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:58.482769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806D1B3F10>]}
[0m12:43:58.505463 [info ] [MainThread]: ============================================================
[0m12:43:58.508644 [info ] [MainThread]: DBT RUN STARTED
[0m12:43:58.511223 [info ] [MainThread]: Target: dev
[0m12:43:58.514261 [info ] [MainThread]: Project: dbt_advanced_olist
[0m12:43:58.516790 [info ] [MainThread]: Time: 2025-12-24 12:43:58
[0m12:43:58.517787 [info ] [MainThread]: ============================================================
[0m12:43:58.520781 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m12:43:58.532490 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m12:43:58.538724 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.05s]
[0m12:43:58.545470 [info ] [MainThread]: 
[0m12:43:58.548157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:58.567406 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m12:43:58.569824 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dev_yourname_marts.dim_date ................... [RUN]
[0m12:43:58.571760 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m12:43:58.575199 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m12:43:58.618314 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m12:43:58.619724 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:00.374000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d62d6220-3665-4a0b-956a-062567c6b8f1&page=queryresults
[0m12:44:02.333450 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m12:44:02.339440 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m12:44:02.447996 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m12:44:02.459310 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(order_date, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m12:44:03.467284 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dbb59392-4a58-40a9-8fe6-0d97eea66152&page=queryresults
[0m12:44:03.811250 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dbb59392-4a58-40a9-8fe6-0d97eea66152&page=queryresults
[0m12:44:03.826993 [debug] [Thread-1 (]: Database Error in model dim_date (models\marts\dim_date.sql)
  Unrecognized name: order_date at [7:29]
  compiled code at target\run\dbt_advanced_olist\models\marts\dim_date.sql
[0m12:44:03.835032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d73830-680e-495a-b594-ea256649aca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806DD7B910>]}
[0m12:44:03.837759 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_dev_yourname_marts.dim_date .......... [[31mERROR[0m in 5.26s]
[0m12:44:03.843975 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m12:44:03.846208 [debug] [Thread-7 (]: Marking all children of 'model.dbt_advanced_olist.dim_date' to be skipped because of status 'error'.  Reason: Database Error in model dim_date (models\marts\dim_date.sql)
  Unrecognized name: order_date at [7:29]
  compiled code at target\run\dbt_advanced_olist\models\marts\dim_date.sql.
[0m12:44:03.851078 [info ] [MainThread]: 
[0m12:44:03.864660 [info ] [MainThread]: ============================================================
[0m12:44:03.867378 [info ] [MainThread]: DBT RUN COMPLETED
[0m12:44:03.869911 [info ] [MainThread]: Success: 0
[0m12:44:03.871057 [info ] [MainThread]: Errors: 1
[0m12:44:03.874498 [info ] [MainThread]: Skipped: 0
[0m12:44:03.878109 [info ] [MainThread]: Total: 1
[0m12:44:03.882242 [info ] [MainThread]: ============================================================
[0m12:44:03.887255 [info ] [MainThread]: FAILED MODELS:
[0m12:44:03.889404 [info ] [MainThread]:   - dim_date: Database Error in model dim_date (models\marts\dim_date.sql)
  Unrecognized name: order_date at [7:29]
  compiled code at target\run\dbt_advanced_olist\models\marts\dim_date.sql
[0m12:44:03.894780 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m12:44:03.897700 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m12:44:03.901062 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.05s]
[0m12:44:03.903720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:03.911577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:03.914454 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m12:44:03.917560 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m12:44:03.918558 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m12:44:03.919651 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m12:44:03.920650 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m12:44:03.921667 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_date' was properly closed.
[0m12:44:03.922665 [info ] [MainThread]: 
[0m12:44:03.927581 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m12:44:03.932032 [debug] [MainThread]: Command end result
[0m12:44:04.418794 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m12:44:04.426010 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m12:44:04.445046 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m12:44:04.446044 [info ] [MainThread]: 
[0m12:44:04.448838 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:44:04.451060 [info ] [MainThread]: 
[0m12:44:04.452123 [error] [MainThread]: [31mFailure in model dim_date (models\marts\dim_date.sql)[0m
[0m12:44:04.454379 [error] [MainThread]:   Database Error in model dim_date (models\marts\dim_date.sql)
  Unrecognized name: order_date at [7:29]
  compiled code at target\run\dbt_advanced_olist\models\marts\dim_date.sql
[0m12:44:04.459132 [info ] [MainThread]: 
[0m12:44:04.462261 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\marts\dim_date.sql
[0m12:44:04.464258 [info ] [MainThread]: 
[0m12:44:04.466284 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m12:44:04.468637 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 29 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:44:04.475417 [debug] [MainThread]: Command `dbt run` failed at 12:44:04.471670 after 31.58 seconds
[0m12:44:04.477647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804FB34650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001804FB34390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001806DDDF510>]}
[0m12:44:04.480740 [debug] [MainThread]: Flushing usage events
[0m12:44:06.857626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:50.539541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC94F6A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC94F5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC94F5DD0>]}


============================== 12:56:50.598252 | 391ec220-c318-47a0-854d-b013a0930166 ==============================
[0m12:56:50.598252 [info ] [MainThread]: Running with dbt=1.10.15
[0m12:56:50.604512 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_date', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m12:57:29.896346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEDEF1C410>]}
[0m12:57:30.023443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC4CE4210>]}
[0m12:57:30.027351 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m12:57:32.130903 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m12:57:35.439134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:35.439134 [debug] [MainThread]: Partial parsing: updated file: dbt_advanced_olist://models\marts\dim_date.sql
[0m12:57:36.287872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEDF9DA590>]}
[0m12:57:36.806334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m12:57:36.812069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m12:57:37.422036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC5199F90>]}
[0m12:57:37.424899 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m12:57:37.426470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEDEF07E10>]}
[0m12:57:37.439174 [info ] [MainThread]: 
[0m12:57:37.445248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:57:37.448090 [info ] [MainThread]: 
[0m12:57:37.451189 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:37.458922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m12:57:37.460140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:39.704805 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m12:57:39.708059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m12:57:39.709772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:39.712216 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m12:57:39.713828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:39.716487 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m12:57:39.790581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:39.834459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:40.989081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_intermediate, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m12:57:40.995911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:41.054074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit)
[0m12:57:41.056750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:42.250177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEDFF25DD0>]}
[0m12:57:42.290665 [info ] [MainThread]: ============================================================
[0m12:57:42.293523 [info ] [MainThread]: DBT RUN STARTED
[0m12:57:42.295846 [info ] [MainThread]: Target: dev
[0m12:57:42.298041 [info ] [MainThread]: Project: dbt_advanced_olist
[0m12:57:42.303188 [info ] [MainThread]: Time: 2025-12-24 12:57:42
[0m12:57:42.306184 [info ] [MainThread]: ============================================================
[0m12:57:42.308739 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m12:57:42.321982 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m12:57:42.325089 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.07s]
[0m12:57:42.328080 [info ] [MainThread]: 
[0m12:57:42.329688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:42.391199 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m12:57:42.393654 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dev_yourname_marts.dim_date ................... [RUN]
[0m12:57:42.396725 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m12:57:42.398722 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m12:57:42.428952 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m12:57:42.431859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:44.200093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a4ecbf8c-902f-468a-a2ec-566bb8b70436&page=queryresults
[0m12:57:45.641422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m12:57:45.669429 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m12:57:45.770232 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m12:57:45.778027 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(date_key, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m12:57:46.350951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c9b6a6f1-b856-4cd8-8056-4ba21f429797&page=queryresults
[0m12:57:51.681812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '391ec220-c318-47a0-854d-b013a0930166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEDFBFF990>]}
[0m12:57:51.687707 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dev_yourname_marts.dim_date .............. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 9.28s]
[0m12:57:51.688768 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m12:57:51.719627 [info ] [MainThread]: 
[0m12:57:51.750043 [info ] [MainThread]: ============================================================
[0m12:57:51.754985 [info ] [MainThread]: DBT RUN COMPLETED
[0m12:57:51.756320 [info ] [MainThread]: Success: 1
[0m12:57:51.758827 [info ] [MainThread]: Errors: 0
[0m12:57:51.760825 [info ] [MainThread]: Skipped: 0
[0m12:57:51.762955 [info ] [MainThread]: Total: 1
[0m12:57:51.765306 [info ] [MainThread]: ============================================================
[0m12:57:51.770170 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m12:57:51.773977 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m12:57:51.776322 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.05s]
[0m12:57:51.778351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:51.780402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:51.780402 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m12:57:51.787710 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m12:57:51.788804 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m12:57:51.789802 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m12:57:51.791599 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m12:57:51.791599 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_date' was properly closed.
[0m12:57:51.807349 [info ] [MainThread]: 
[0m12:57:51.813942 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 14.34 seconds (14.34s).
[0m12:57:51.821141 [debug] [MainThread]: Command end result
[0m12:57:52.034448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m12:57:52.042111 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m12:57:52.058516 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m12:57:52.059512 [info ] [MainThread]: 
[0m12:57:52.061559 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:52.063398 [info ] [MainThread]: 
[0m12:57:52.065887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:57:52.070267 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:52.070267 after 61.87 seconds
[0m12:57:52.072118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC9526050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC9525610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEC95274D0>]}
[0m12:57:52.073141 [debug] [MainThread]: Flushing usage events
[0m12:57:53.923288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:16.209621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB724F7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB724F4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB724F63D0>]}


============================== 13:03:16.214611 | 0c059624-1d97-4673-965a-a16eaa79ec6e ==============================
[0m13:03:16.214611 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:03:16.216927 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt show --select dim_date --limit 10', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m13:05:32.079948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c059624-1d97-4673-965a-a16eaa79ec6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB07D753D0>]}
[0m13:05:32.193709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c059624-1d97-4673-965a-a16eaa79ec6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6DC04E90>]}
[0m13:05:36.156682 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:05:41.483030 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:06:32.460728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:06:32.461726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:06:32.636259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c059624-1d97-4673-965a-a16eaa79ec6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08BBC450>]}
[0m13:06:33.307332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:06:33.390725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:06:33.432719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c059624-1d97-4673-965a-a16eaa79ec6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB00C85390>]}
[0m13:06:33.434714 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m13:06:33.436801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c059624-1d97-4673-965a-a16eaa79ec6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6E656190>]}
[0m13:06:33.441814 [info ] [MainThread]: 
[0m13:06:33.443694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:06:33.444688 [info ] [MainThread]: 
[0m13:06:33.446683 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:06:33.581165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m13:06:33.582165 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m13:06:33.584155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:33.585151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m13:06:33.586147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:33.586916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m13:06:33.587940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:33.589940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:37.563845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit)
[0m13:06:37.565842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_snapshots, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m13:06:37.574812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:37.577191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:39.449146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c059624-1d97-4673-965a-a16eaa79ec6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB08AABFD0>]}
[0m13:06:39.451142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:39.774657 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m13:06:39.827164 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m13:06:39.829168 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m13:06:39.890033 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m13:06:39.891032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:06:42.085433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:490e9af8-b06e-4528-862a-3021f219bb50&page=queryresults
[0m13:06:49.687353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m13:06:49.691294 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m13:06:49.719218 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
  

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
  
  limit 10
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m13:06:50.597479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0dd95db7-fea9-495a-9a44-508e553f2d7a&page=queryresults
[0m13:06:52.200793 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m13:06:54.150329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:54.151327 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m13:06:54.152325 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m13:06:54.153320 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m13:06:54.154320 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m13:06:54.155323 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_date' was properly closed.
[0m13:06:54.157311 [debug] [MainThread]: Command end result
[0m13:06:54.533657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:06:54.536648 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:06:54.547621 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m13:06:54.548617 [info ] [MainThread]: Previewing node 'dim_date':
|   date_key | year | month | quarter | week_of_year | day_of_week | ... |
| ---------- | ---- | ----- | ------- | ------------ | ----------- | --- |
| 2016-01-01 | 2016 |     1 |       1 |            0 |           6 | ... |
| 2016-01-02 | 2016 |     1 |       1 |            0 |           7 | ... |
| 2016-01-03 | 2016 |     1 |       1 |            1 |           1 | ... |
| 2016-01-04 | 2016 |     1 |       1 |            1 |           2 | ... |
| 2016-01-05 | 2016 |     1 |       1 |            1 |           3 | ... |
| 2016-01-06 | 2016 |     1 |       1 |            1 |           4 | ... |
| 2016-01-07 | 2016 |     1 |       1 |            1 |           5 | ... |
| 2016-01-08 | 2016 |     1 |       1 |            1 |           6 | ... |
| 2016-01-09 | 2016 |     1 |       1 |            1 |           7 | ... |
| 2016-01-10 | 2016 |     1 |       1 |            2 |           1 | ... |

[0m13:06:54.552606 [debug] [MainThread]: Command `dbt show` succeeded at 13:06:54.552606 after 218.46 seconds
[0m13:06:54.553603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB724E21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB72557990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6C6F5B90>]}
[0m13:06:54.554601 [debug] [MainThread]: Flushing usage events
[0m13:06:58.984294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:34.218152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A4F6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A2F1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A4F5C90>]}


============================== 13:12:34.349589 | be6ff3de-22d4-4cef-b692-92b846e10f00 ==============================
[0m13:12:34.349589 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:12:34.350585 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'invocation_command': 'dbt run --select dim_customers', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m13:13:31.977439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF600C67D0>]}
[0m13:13:32.112111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF45C046D0>]}
[0m13:13:32.113105 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:13:36.509775 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:13:44.806919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:44.807917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:44.972475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF60BF3ED0>]}
[0m13:13:45.321541 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:13:45.324533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:13:46.289825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF605E31D0>]}
[0m13:13:46.290817 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m13:13:46.291786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A4EFED0>]}
[0m13:13:46.299766 [info ] [MainThread]: 
[0m13:13:46.303756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:46.305751 [info ] [MainThread]: 
[0m13:13:46.310739 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:13:46.312762 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m13:13:46.313729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:48.003327 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m13:13:48.006322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:48.008313 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m13:13:48.010304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m13:13:48.020306 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m13:13:48.056627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:48.058622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:48.059620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:49.116792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_staging, now list_big-query-dbt-481111_snapshots)
[0m13:13:49.120301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:49.203191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_intermediate)
[0m13:13:49.204182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:50.334405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF46196090>]}
[0m13:13:50.379283 [info ] [MainThread]: ============================================================
[0m13:13:50.380919 [info ] [MainThread]: DBT RUN STARTED
[0m13:13:50.381696 [info ] [MainThread]: Target: dev
[0m13:13:50.384694 [info ] [MainThread]: Project: dbt_advanced_olist
[0m13:13:50.386688 [info ] [MainThread]: Time: 2025-12-24 13:13:50
[0m13:13:50.387685 [info ] [MainThread]: ============================================================
[0m13:13:50.389681 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m13:13:50.397689 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m13:13:50.399656 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.06s]
[0m13:13:50.402645 [info ] [MainThread]: 
[0m13:13:50.404643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:50.705005 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m13:13:50.706004 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dev_yourname_marts.dim_customers .............. [RUN]
[0m13:13:50.707998 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_customers'
[0m13:13:50.708995 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m13:13:50.746892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m13:13:50.948224 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m13:13:50.989113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:52.148155 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m13:13:53.079460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a283f4b1-3cd4-4547-b104-c9ed0c4d2566&page=queryresults
[0m13:13:53.464679 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m13:13:53.467675 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m13:13:54.034004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:15b89c3c-7bdb-4d8a-bd32-a186b7f56732&page=queryresults
[0m13:13:54.502683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m13:13:54.505677 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m13:13:55.324249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:58b23aab-be78-4597-9756-b5dc31fe31a7&page=queryresults
[0m13:13:58.958882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be6ff3de-22d4-4cef-b692-92b846e10f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF48109010>]}
[0m13:13:58.959879 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dev_yourname_marts.dim_customers ......... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 8.25s]
[0m13:13:58.961701 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m13:13:58.963296 [info ] [MainThread]: 
[0m13:13:58.987269 [info ] [MainThread]: ============================================================
[0m13:13:58.989232 [info ] [MainThread]: DBT RUN COMPLETED
[0m13:13:58.989860 [info ] [MainThread]: Success: 1
[0m13:13:58.991330 [info ] [MainThread]: Errors: 0
[0m13:13:58.992456 [info ] [MainThread]: Skipped: 0
[0m13:13:58.993869 [info ] [MainThread]: Total: 1
[0m13:13:58.995867 [info ] [MainThread]: ============================================================
[0m13:13:58.997862 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m13:13:59.000854 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m13:13:59.003848 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.04s]
[0m13:13:59.005842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:59.008833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:59.008833 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m13:13:59.009831 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m13:13:59.010828 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m13:13:59.011825 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m13:13:59.011825 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m13:13:59.012823 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_customers' was properly closed.
[0m13:13:59.021799 [info ] [MainThread]: 
[0m13:13:59.023792 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 12.70 seconds (12.70s).
[0m13:13:59.026786 [debug] [MainThread]: Command end result
[0m13:13:59.171398 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:13:59.175386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:13:59.185362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m13:13:59.186359 [info ] [MainThread]: 
[0m13:13:59.187204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:59.188463 [info ] [MainThread]: 
[0m13:13:59.189692 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:13:59.191779 [debug] [MainThread]: Command `dbt run` succeeded at 13:13:59.191779 after 85.48 seconds
[0m13:13:59.192776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A553010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A553D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4A553A90>]}
[0m13:13:59.193773 [debug] [MainThread]: Flushing usage events
[0m13:14:00.441255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:01.738290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B41F5AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B41F6E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B41F4810>]}


============================== 13:22:01.740693 | 52b36fc7-9947-4e67-b9d5-8f2a3a650c1b ==============================
[0m13:22:01.740693 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:22:01.740693 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select dim_customers', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m13:23:01.920796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7C9B10350>]}
[0m13:23:02.029510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF8E4110>]}
[0m13:23:02.030542 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:23:03.547490 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:23:06.773639 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:23:06.776633 [debug] [MainThread]: Partial parsing: deleted file: dbt_advanced_olist://models\marts\dim_customers_baseline.sql
[0m13:23:07.136160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7CA21AD50>]}
[0m13:23:07.560027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:23:07.566045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:23:08.007922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7CA8FF5D0>]}
[0m13:23:08.008921 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m13:23:08.011913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B41EFD90>]}
[0m13:23:08.021902 [info ] [MainThread]: 
[0m13:23:08.022837 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:08.023930 [info ] [MainThread]: 
[0m13:23:08.024806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:08.029799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m13:23:08.031790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:09.616675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m13:23:09.617673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:09.619670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m13:23:09.620664 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m13:23:09.625650 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m13:23:09.673521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:09.675553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:09.678511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:10.804507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_marts, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m13:23:10.808496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:10.879307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_snapshots, now list_big-query-dbt-481111_dbt_dev_yourname_intermediate)
[0m13:23:10.880305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:12.047787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7B3A53C50>]}
[0m13:23:12.070017 [info ] [MainThread]: ============================================================
[0m13:23:12.071980 [info ] [MainThread]: DBT RUN STARTED
[0m13:23:12.072581 [info ] [MainThread]: Target: dev
[0m13:23:12.073765 [info ] [MainThread]: Project: dbt_advanced_olist
[0m13:23:12.074765 [info ] [MainThread]: Time: 2025-12-24 13:23:12
[0m13:23:12.076970 [info ] [MainThread]: ============================================================
[0m13:23:12.079962 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m13:23:12.084947 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m13:23:12.086245 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.04s]
[0m13:23:12.087664 [info ] [MainThread]: 
[0m13:23:12.088581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:12.399284 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m13:23:12.401280 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dev_yourname_marts.dim_customers .............. [RUN]
[0m13:23:12.437184 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_customers'
[0m13:23:12.439179 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m13:23:12.517968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m13:23:12.538911 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m13:23:12.661584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:13.891944 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m13:23:14.733146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4e797389-1a93-43fb-a5f6-d20f89e16dca&page=queryresults
[0m13:23:15.179106 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m13:23:15.180976 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m13:23:15.725576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1502ee91-a932-44d7-83e1-4c96807fa927&page=queryresults
[0m13:23:16.132011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m13:23:16.134983 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m13:23:16.892712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:41855ec1-622c-4f3e-b958-bab93b373e42&page=queryresults
[0m13:23:20.221094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b36fc7-9947-4e67-b9d5-8f2a3a650c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7CABC0590>]}
[0m13:23:20.222122 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dev_yourname_marts.dim_customers ......... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 7.78s]
[0m13:23:20.223089 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m13:23:20.227079 [info ] [MainThread]: 
[0m13:23:20.248023 [info ] [MainThread]: ============================================================
[0m13:23:20.248999 [info ] [MainThread]: DBT RUN COMPLETED
[0m13:23:20.249933 [info ] [MainThread]: Success: 1
[0m13:23:20.251026 [info ] [MainThread]: Errors: 0
[0m13:23:20.252065 [info ] [MainThread]: Skipped: 0
[0m13:23:20.253198 [info ] [MainThread]: Total: 1
[0m13:23:20.254164 [info ] [MainThread]: ============================================================
[0m13:23:20.257160 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m13:23:20.260152 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m13:23:20.262147 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.03s]
[0m13:23:20.263007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:20.266037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:20.267032 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m13:23:20.268033 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m13:23:20.268033 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m13:23:20.268995 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m13:23:20.270024 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m13:23:20.270024 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_customers' was properly closed.
[0m13:23:20.283988 [info ] [MainThread]: 
[0m13:23:20.285950 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 12.25 seconds (12.25s).
[0m13:23:20.288971 [debug] [MainThread]: Command end result
[0m13:23:20.434553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:23:20.438557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:23:20.449512 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m13:23:20.450510 [info ] [MainThread]: 
[0m13:23:20.451507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:20.452532 [info ] [MainThread]: 
[0m13:23:20.453957 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:23:20.456047 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:20.456047 after 79.45 seconds
[0m13:23:20.457044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AE234350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AE234190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AE234390>]}
[0m13:23:20.459040 [debug] [MainThread]: Flushing usage events
[0m13:23:22.694379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:44.950190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DC49F4B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DC49F73D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DC49F6650>]}


============================== 13:34:45.056044 | c8f38871-647e-4a62-8057-824119e62d57 ==============================
[0m13:34:45.056044 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:34:45.058928 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'invocation_command': 'dbt ls --select state:modified+ --state prod-artifacts/', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m13:36:03.164013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8f38871-647e-4a62-8057-824119e62d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DDA614250>]}
[0m13:36:03.307657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8f38871-647e-4a62-8057-824119e62d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DC01E4C10>]}
[0m13:36:03.309627 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:36:06.739811 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:36:28.415194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:28.416188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:28.627619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8f38871-647e-4a62-8057-824119e62d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DDA659E50>]}
[0m13:36:29.044654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:36:29.066972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:36:33.168273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8f38871-647e-4a62-8057-824119e62d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DDAB66510>]}
[0m13:36:33.169268 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m13:36:33.171263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f38871-647e-4a62-8057-824119e62d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DC48CF4D0>]}
[0m13:36:33.181237 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m13:36:33.182232 [warn ] [MainThread]: No nodes selected!
[0m13:36:33.188218 [debug] [MainThread]: Command `dbt ls` succeeded at 13:36:33.187221 after 108.82 seconds
[0m13:36:33.189215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DBEB345D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DBEB34410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013DBEB34690>]}
[0m13:36:33.193204 [debug] [MainThread]: Flushing usage events
[0m13:36:34.932793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:35.053420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5FDF5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5FDF4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5FDF7290>]}


============================== 13:45:35.150479 | 66a91576-33b9-449c-9cad-496ee6b84d5c ==============================
[0m13:45:35.150479 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:45:35.152412 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt ls --select state:modified+ --state prod-artifacts/', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m13:47:46.306755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66a91576-33b9-449c-9cad-496ee6b84d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D75ACDDD0>]}
[0m13:47:46.668589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66a91576-33b9-449c-9cad-496ee6b84d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D5B5E4AD0>]}
[0m13:47:46.670591 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:47:55.154156 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:48:11.915730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:48:11.917679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:48:12.367551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66a91576-33b9-449c-9cad-496ee6b84d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D764EC090>]}
[0m13:48:13.389160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:48:13.411589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:48:15.900835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66a91576-33b9-449c-9cad-496ee6b84d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D75F6AB50>]}
[0m13:48:15.902829 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m13:48:15.907818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66a91576-33b9-449c-9cad-496ee6b84d5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D762467D0>]}
[0m13:48:15.933747 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m13:48:15.937736 [warn ] [MainThread]: No nodes selected!
[0m13:48:15.951697 [debug] [MainThread]: Command `dbt ls` succeeded at 13:48:15.951697 after 161.17 seconds
[0m13:48:15.964664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D59E34910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D59E34410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D59E34690>]}
[0m13:48:15.967977 [debug] [MainThread]: Flushing usage events
[0m13:48:19.341512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:47.892397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384EBF7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384EBF51D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384EBF70D0>]}


============================== 13:49:47.950132 | d67eef38-ae5e-4db4-b086-f5163a9b65a4 ==============================
[0m13:49:47.950132 [info ] [MainThread]: Running with dbt=1.10.15
[0m13:49:47.954854 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt build --select +dim_customers', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m13:50:30.236551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384EE09250>]}
[0m13:50:30.360798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384A3E40D0>]}
[0m13:50:30.363104 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m13:50:31.902655 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m13:50:32.696365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:32.697362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:32.890707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023865227310>]}
[0m13:50:33.321084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:50:33.326760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:50:37.234577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384EE091D0>]}
[0m13:50:37.236574 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m13:50:37.258513 [info ] [MainThread]: 
[0m13:50:37.260510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:37.262503 [info ] [MainThread]: 
[0m13:50:37.266494 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:50:37.301403 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m13:50:37.303564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:37.304747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m13:50:37.306385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m13:50:37.307744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:37.309378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m13:50:37.310721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:37.312416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:49.654010 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: TransportError(ReadTimeout(ReadTimeoutError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Read timed out. (read timeout=120)")))
[0m13:52:49.701027 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: TransportError(ReadTimeout(ReadTimeoutError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Read timed out. (read timeout=120)")))
[0m13:52:49.747998 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: TransportError(ReadTimeout(ReadTimeoutError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Read timed out. (read timeout=120)")))
[0m13:52:50.043679 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: TransportError(ReadTimeout(ReadTimeoutError("HTTPSConnectionPool(host='oauth2.googleapis.com', port=443): Read timed out. (read timeout=120)")))
[0m13:52:52.280514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m13:52:52.283456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m13:52:52.284459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:52.286452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m13:52:52.291441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:52.293435 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m13:52:52.378248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:52.390174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:54.160700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_intermediate, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m13:52:54.166613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:54.264302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_staging, now list_big-query-dbt-481111_dbt_dev_yourname_seeds)
[0m13:52:54.271285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:56.851400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385D426510>]}
[0m13:52:56.913142 [info ] [MainThread]: ============================================================
[0m13:52:56.916261 [info ] [MainThread]: DBT RUN STARTED
[0m13:52:56.919129 [info ] [MainThread]: Target: dev
[0m13:52:56.926060 [info ] [MainThread]: Project: dbt_advanced_olist
[0m13:52:56.929052 [info ] [MainThread]: Time: 2025-12-24 13:52:56
[0m13:52:56.933040 [info ] [MainThread]: ============================================================
[0m13:52:56.936033 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m13:52:56.981910 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m13:52:56.991890 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.13s]
[0m13:52:56.996718 [info ] [MainThread]: 
[0m13:52:56.999912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:57.100931 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m13:52:57.105873 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m13:52:57.108865 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m13:52:57.112057 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m13:52:57.113894 [info ] [Thread-1 (]: 1 of 98 START test dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [RUN]
[0m13:52:57.117846 [info ] [Thread-2 (]: 2 of 98 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [RUN]
[0m13:52:57.122832 [info ] [Thread-3 (]: 3 of 98 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [RUN]
[0m13:52:57.132801 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0'
[0m13:52:57.127937 [info ] [Thread-4 (]: 4 of 98 START test dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [RUN]
[0m13:52:57.139784 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb'
[0m13:52:57.143773 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d'
[0m13:52:57.148760 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m13:52:57.159732 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936'
[0m13:52:57.165713 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m13:52:57.168703 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m13:52:57.222562 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m13:52:57.250531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m13:52:57.291376 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m13:52:57.318348 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m13:52:57.355207 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:52:57.443047 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m13:52:57.445063 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m13:52:57.458249 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m13:52:57.513862 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:52:57.529861 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:57.543778 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:52:59.109376 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
[0m13:52:59.111432 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
[0m13:52:59.114383 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
[0m13:52:59.268953 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`raw_olist`.`customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:52:59.277927 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and freight_value >= 0 and freight_value <= 1000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:52:59.281916 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price >= 0 and price <= 10000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:52:59.887512 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:227917b2-6f04-44bb-8144-4684302a892e&page=queryresults
[0m13:52:59.901258 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m13:52:59.909263 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m13:52:59.911234 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2c9720ae-ccf6-42ec-9c2e-073699ff3308&page=queryresults
[0m13:53:00.028918 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:351269b0-f736-41b9-b79a-790f1a66b638&page=queryresults
[0m13:53:00.260298 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
[0m13:53:00.262294 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
      
    
    

    
    OPTIONS()
    as (
      
    
  with relation_columns as (

        
        select
            cast('ORDER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CUSTOMER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_STATUS' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_PURCHASE_TIMESTAMP' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_APPROVED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CARRIER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CUSTOMER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_ESTIMATED_DELIVERY_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PURCHASE_TIMESTAMP'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:00.941478 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3e4e4e7d-3af5-4312-afed-c67ddb56e766&page=queryresults
[0m13:53:05.927218 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m13:53:05.943178 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m13:53:05.941180 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m13:53:06.124354 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:06.130337 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:06.147292 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:07.089009 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9ce49240-d1f0-46f1-b492-39cacd588a3f&page=queryresults
[0m13:53:07.090999 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1785fb15-0768-4116-a120-9abddd8ee4e5&page=queryresults
[0m13:53:07.092996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f92524ca-ec4b-48f1-bef0-01acc1c3bcf4&page=queryresults
[0m13:53:08.163626 [info ] [Thread-4 (]: 4 of 98 PASS dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [[32mPASS[0m in 11.00s]
[0m13:53:08.173600 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m13:53:08.168613 [info ] [Thread-1 (]: 1 of 98 PASS dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [[32mPASS[0m in 11.04s]
[0m13:53:08.176168 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m13:53:08.178587 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m13:53:08.171606 [info ] [Thread-2 (]: 2 of 98 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [[32mPASS[0m in 11.03s]
[0m13:53:08.182576 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m13:53:08.181357 [info ] [Thread-4 (]: 5 of 98 START test source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m13:53:08.187564 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m13:53:08.191553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936, now test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c)
[0m13:53:08.196572 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m13:53:08.198639 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m13:53:08.207509 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m13:53:08.189560 [info ] [Thread-1 (]: 6 of 98 START test source_not_null_raw_olist_customers_customer_city ........... [RUN]
[0m13:53:08.265356 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m13:53:08.202524 [info ] [Thread-2 (]: 7 of 98 START test source_not_null_raw_olist_customers_customer_id ............. [RUN]
[0m13:53:08.267352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a)
[0m13:53:08.273333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c)
[0m13:53:08.275326 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m13:53:08.277350 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m13:53:08.308242 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m13:53:08.331178 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m13:53:08.333173 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m13:53:08.337570 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:08.359103 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:08.359103 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m13:53:08.363377 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m13:53:08.376059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:08.447866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:09.012355 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c0b4065-ad43-482d-a8f5-9449fbdec474&page=queryresults
[0m13:53:09.672591 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
[0m13:53:09.674585 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
[0m13:53:09.676580 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`raw_olist`.`orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:09.679572 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:10.262392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2eb152d1-1a25-4c79-be13-2aa9a02b2d61&page=queryresults
[0m13:53:10.264386 [info ] [Thread-3 (]: 3 of 98 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [[32mPASS[0m in 13.12s]
[0m13:53:10.266380 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a3d9f6e5-af00-4c7b-9393-196cf05d6676&page=queryresults
[0m13:53:10.273363 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m13:53:10.277351 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m13:53:10.280344 [info ] [Thread-3 (]: 8 of 98 START test source_not_null_raw_olist_customers_customer_state .......... [RUN]
[0m13:53:10.283337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de)
[0m13:53:10.285330 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m13:53:10.298294 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m13:53:10.301289 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m13:53:10.315251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:10.840142 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
[0m13:53:10.843105 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:11.444492 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:99a0d7f0-274c-4467-8873-7c8060bfb521&page=queryresults
[0m13:53:11.611050 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
[0m13:53:11.613044 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:12.340242 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e2d1a8e-31ac-4348-abde-544873d4ada5&page=queryresults
[0m13:53:12.425872 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m13:53:12.428864 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:12.447810 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m13:53:12.451824 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:13.127991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:948f080e-a920-44dd-971e-c172b3a0495d&page=queryresults
[0m13:53:13.130984 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6111df2e-88d5-4d7a-8baa-a690b4730a76&page=queryresults
[0m13:53:14.263956 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m13:53:14.268942 [info ] [Thread-1 (]: 6 of 98 PASS source_not_null_raw_olist_customers_customer_city ................. [[32mPASS[0m in 6.00s]
[0m13:53:14.273927 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:14.275922 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m13:53:14.279910 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m13:53:14.281906 [info ] [Thread-1 (]: 9 of 98 START test source_not_null_raw_olist_customers_customer_unique_id ...... [RUN]
[0m13:53:14.289886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30)
[0m13:53:14.291879 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m13:53:14.308834 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m13:53:14.287890 [info ] [Thread-4 (]: 5 of 98 PASS source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 6.10s]
[0m13:53:14.312823 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m13:53:14.315818 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m13:53:14.322990 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m13:53:14.344741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:14.320371 [info ] [Thread-4 (]: 10 of 98 START test source_not_null_raw_olist_order_items_freight_value ........ [RUN]
[0m13:53:14.348728 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5)
[0m13:53:14.352717 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m13:53:14.365682 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m13:53:14.428514 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m13:53:14.439483 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:14.870687 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m13:53:14.873679 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:15.179897 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:208c336a-0895-4797-896a-2e41d25f964d&page=queryresults
[0m13:53:15.649061 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:917dfaa8-4208-4840-b295-3a8f3676f863&page=queryresults
[0m13:53:16.161691 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
[0m13:53:16.165682 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:16.255441 [info ] [Thread-2 (]: 7 of 98 PASS source_not_null_raw_olist_customers_customer_id ................... [[32mPASS[0m in 7.98s]
[0m13:53:16.257438 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m13:53:16.259430 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m13:53:16.260429 [info ] [Thread-2 (]: 11 of 98 START test source_not_null_raw_olist_order_items_order_id ............. [RUN]
[0m13:53:16.262421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37)
[0m13:53:16.264416 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m13:53:16.278379 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m13:53:16.281809 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m13:53:16.297326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:16.298324 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
[0m13:53:16.306305 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where freight_value is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:16.894732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db6da122-32b8-425f-9b45-8241d53ed816&page=queryresults
[0m13:53:16.933626 [info ] [Thread-3 (]: 8 of 98 PASS source_not_null_raw_olist_customers_customer_state ................ [[32mPASS[0m in 6.65s]
[0m13:53:16.937619 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d77fa22f-15cb-460f-a4cf-84cd64856d35&page=queryresults
[0m13:53:16.938615 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m13:53:16.941606 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m13:53:16.943602 [info ] [Thread-3 (]: 12 of 98 START test source_not_null_raw_olist_order_items_order_item_id ........ [RUN]
[0m13:53:16.945766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c)
[0m13:53:16.947592 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m13:53:16.962549 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m13:53:16.965543 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m13:53:16.980501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:17.685618 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
[0m13:53:17.688610 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:18.452773 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7f7dbf70-6ad4-44c6-9962-4ae3682399bd&page=queryresults
[0m13:53:18.818799 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
[0m13:53:18.821789 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_item_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:19.577762 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d92d1b62-bc4e-438f-a265-42a8cc26110f&page=queryresults
[0m13:53:20.363094 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m13:53:20.369079 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:21.158968 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:10872d67-b69d-4ba6-9528-4316bda7a074&page=queryresults
[0m13:53:21.837171 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m13:53:21.842158 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:22.036638 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m13:53:22.039634 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m13:53:22.043082 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:22.045616 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:22.335875 [info ] [Thread-2 (]: 11 of 98 PASS source_not_null_raw_olist_order_items_order_id ................... [[32mPASS[0m in 6.07s]
[0m13:53:22.338831 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m13:53:22.339827 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m13:53:22.341823 [info ] [Thread-2 (]: 13 of 98 START test source_not_null_raw_olist_order_items_price ................ [RUN]
[0m13:53:22.342917 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9)
[0m13:53:22.345153 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m13:53:22.360771 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m13:53:22.378724 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m13:53:22.391689 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:22.593153 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a168e822-57b8-441b-b22e-1c7fd49f60a1&page=queryresults
[0m13:53:22.625064 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6cd8c4f8-2b83-40e4-896c-e139bb4e717c&page=queryresults
[0m13:53:22.660967 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:df57270d-e9c6-4be2-bd1b-d47cc2f3dd6e&page=queryresults
[0m13:53:23.507144 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
[0m13:53:23.509076 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where price is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:23.734474 [info ] [Thread-3 (]: 12 of 98 PASS source_not_null_raw_olist_order_items_order_item_id .............. [[32mPASS[0m in 6.79s]
[0m13:53:23.736472 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m13:53:23.738462 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m13:53:23.744446 [info ] [Thread-1 (]: 9 of 98 PASS source_not_null_raw_olist_customers_customer_unique_id ............ [[32mPASS[0m in 9.45s]
[0m13:53:23.751430 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m13:53:23.753424 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m13:53:23.745445 [info ] [Thread-3 (]: 14 of 98 START test source_not_null_raw_olist_order_items_product_id ........... [RUN]
[0m13:53:23.759407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29)
[0m13:53:23.747444 [info ] [Thread-4 (]: 10 of 98 PASS source_not_null_raw_olist_order_items_freight_value .............. [[32mPASS[0m in 9.40s]
[0m13:53:23.761403 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m13:53:23.755678 [info ] [Thread-1 (]: 15 of 98 START test source_not_null_raw_olist_orders_customer_id ............... [RUN]
[0m13:53:23.764393 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m13:53:23.787333 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m13:53:23.789327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02)
[0m13:53:23.790662 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m13:53:23.793398 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m13:53:23.795311 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m13:53:23.796309 [info ] [Thread-4 (]: 16 of 98 START test source_not_null_raw_olist_orders_order_id .................. [RUN]
[0m13:53:23.823244 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m13:53:23.837750 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:23.839193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b)
[0m13:53:23.895043 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m13:53:23.899040 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m13:53:23.910005 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m13:53:23.919979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:23.924963 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m13:53:23.984806 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:24.113461 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e6e5d7d4-a233-43cc-8a31-213027b7b245&page=queryresults
[0m13:53:25.254430 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
[0m13:53:25.260414 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:25.404803 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
[0m13:53:25.409789 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:25.808536 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:298ccb90-3346-4401-be93-a6ef2387917a&page=queryresults
[0m13:53:26.016188 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d066b184-46c7-4690-afff-3d126d7cdc8d&page=queryresults
[0m13:53:26.041049 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m13:53:26.051180 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:26.242848 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
[0m13:53:26.246838 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:26.829281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6e1466ab-8889-479f-8dbb-5f3be1038eeb&page=queryresults
[0m13:53:26.849229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bb40760f-8496-4823-bb0f-ae9c2f570830&page=queryresults
[0m13:53:27.561325 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m13:53:27.565315 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:27.919367 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m13:53:27.917373 [info ] [Thread-2 (]: 13 of 98 PASS source_not_null_raw_olist_order_items_price ...................... [[32mPASS[0m in 5.57s]
[0m13:53:27.922391 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m13:53:27.924456 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m13:53:27.926348 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:27.927375 [info ] [Thread-2 (]: 17 of 98 START test source_not_null_raw_olist_orders_order_purchase_timestamp .. [RUN]
[0m13:53:27.930337 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5)
[0m13:53:27.933331 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m13:53:27.947292 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m13:53:27.957266 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m13:53:27.973223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:28.321292 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1cb1364c-6634-472f-b664-dadd25e0793a&page=queryresults
[0m13:53:28.675347 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7fce8405-00a4-4c40-8492-8e02b08326b4&page=queryresults
[0m13:53:29.055329 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m13:53:29.065302 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:29.451272 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
[0m13:53:29.457256 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_purchase_timestamp is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:29.458252 [info ] [Thread-3 (]: 14 of 98 PASS source_not_null_raw_olist_order_items_product_id ................. [[32mPASS[0m in 5.70s]
[0m13:53:29.465233 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m13:53:29.468226 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m13:53:29.470221 [info ] [Thread-3 (]: 18 of 98 START test source_not_null_raw_olist_orders_order_status .............. [RUN]
[0m13:53:29.473212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a)
[0m13:53:29.475444 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m13:53:29.489168 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m13:53:29.491163 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m13:53:29.507129 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:29.819289 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0c557b8b-a081-4711-975d-4ad4adbf1165&page=queryresults
[0m13:53:29.818608 [info ] [Thread-4 (]: 16 of 98 PASS source_not_null_raw_olist_orders_order_id ........................ [[32mPASS[0m in 5.98s]
[0m13:53:29.825774 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m13:53:29.828262 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m13:53:29.831255 [info ] [Thread-4 (]: 19 of 98 START test source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [RUN]
[0m13:53:29.838237 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5)
[0m13:53:29.840230 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m13:53:29.871148 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m13:53:29.875137 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m13:53:29.887109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:30.008780 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db952352-9545-4182-9985-dc1a1b8f7c85&page=queryresults
[0m13:53:30.955441 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
[0m13:53:30.960423 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
[0m13:53:30.969414 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:30.977391 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:30.972409 [info ] [Thread-1 (]: 15 of 98 PASS source_not_null_raw_olist_orders_customer_id ..................... [[32mPASS[0m in 7.18s]
[0m13:53:30.998291 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m13:53:31.003273 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m13:53:31.008266 [info ] [Thread-1 (]: 20 of 98 START test source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [RUN]
[0m13:53:31.013246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8)
[0m13:53:31.019541 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m13:53:31.065108 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m13:53:31.072162 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m13:53:31.089109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:31.499489 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d6d3f812-6306-422a-9db3-812b27ae0608&page=queryresults
[0m13:53:31.566594 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a7f75eb1-c5e5-47be-8106-e5a6b6373716&page=queryresults
[0m13:53:32.152768 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m13:53:32.160745 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:32.476715 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
[0m13:53:32.488640 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:32.891112 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c383a973-148a-4a7f-a227-701449bfcef8&page=queryresults
[0m13:53:33.099248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8e7480bb-5f1e-493c-bbe9-aae76cbbfb1d&page=queryresults
[0m13:53:33.623631 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m13:53:33.636589 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:33.994712 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m13:53:34.000700 [info ] [Thread-2 (]: 17 of 98 PASS source_not_null_raw_olist_orders_order_purchase_timestamp ........ [[32mPASS[0m in 6.07s]
[0m13:53:34.004647 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m13:53:34.007634 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:34.010625 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m13:53:34.018604 [info ] [Thread-2 (]: 21 of 98 START test source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [RUN]
[0m13:53:34.021596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5, now test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543)
[0m13:53:34.024590 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m13:53:34.059539 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m13:53:34.068470 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m13:53:34.083429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:34.375846 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0b34f554-c4d8-471b-9b58-d56bbfd7b0e1&page=queryresults
[0m13:53:34.636903 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c8734d71-0e6b-4db8-9129-788743b10a8b&page=queryresults
[0m13:53:35.145279 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m13:53:35.159416 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:35.516819 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
[0m13:53:35.523840 [info ] [Thread-4 (]: 19 of 98 PASS source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [[32mPASS[0m in 5.69s]
[0m13:53:35.529963 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:35.537771 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m13:53:35.551188 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m13:53:35.556716 [info ] [Thread-4 (]: 22 of 98 START test source_unique_raw_olist_customers_customer_id .............. [RUN]
[0m13:53:35.560745 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5, now test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816)
[0m13:53:35.566686 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m13:53:35.622578 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m13:53:35.635505 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m13:53:35.660434 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:35.752187 [info ] [Thread-3 (]: 18 of 98 PASS source_not_null_raw_olist_orders_order_status .................... [[32mPASS[0m in 6.28s]
[0m13:53:35.757219 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m13:53:35.759169 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m13:53:35.761212 [info ] [Thread-3 (]: 23 of 98 START test source_unique_raw_olist_orders_order_id .................... [RUN]
[0m13:53:35.764157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a, now test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0)
[0m13:53:35.767154 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m13:53:35.790133 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m13:53:35.794814 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m13:53:35.820791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:35.919479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5a4cd19d-f2bb-4acd-bd9f-80deeb50c711&page=queryresults
[0m13:53:36.093791 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:23de6959-91b3-49cf-ac7a-efbe03a56fa5&page=queryresults
[0m13:53:37.064978 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
[0m13:53:37.077984 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:37.072998 [info ] [Thread-1 (]: 20 of 98 PASS source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [[32mPASS[0m in 6.06s]
[0m13:53:37.091909 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m13:53:37.099886 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_order_items
[0m13:53:37.106870 [info ] [Thread-1 (]: 24 of 98 START sql view model dbt_dev_yourname_staging.stg_order_items ......... [RUN]
[0m13:53:37.111898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8, now model.dbt_advanced_olist.stg_order_items)
[0m13:53:37.121834 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_order_items
[0m13:53:37.231533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_order_items"
[0m13:53:37.236933 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_order_items
[0m13:53:37.289838 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
[0m13:53:37.325699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_order_items"
[0m13:53:37.329689 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:37.338660 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_order_items: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_order_items
  
  Purpose: Clean order line item data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Rename columns
  - Calculate item total (price + freight)
  - Generate surrogate key for unique identification
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`order_items`
),

renamed as (
    select
        -- Surrogate Key (composite primary key)
        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,
        
        -- Foreign Keys
        order_id,
        product_id,
        seller_id,
        
        -- Item Position
        order_item_id as item_sequence,
        
        -- Pricing
        cast(price as numeric) as item_price,
        cast(freight_value as numeric) as item_freight,
        
        -- Derived: Total for this item
        cast(price as numeric) + cast(freight_value as numeric) as item_total,
        
        -- Shipping date
        cast(shipping_limit_date as timestamp) as shipping_limit_at

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_order_items | schema: dbt_dev_yourname_staging */;
[0m13:53:37.342697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:37.604581 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:637b106e-cffd-4107-87ff-626dcedf4e1c&page=queryresults
[0m13:53:38.021004 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9bd61d5c-945c-4252-8fe7-ce131441eb21&page=queryresults
[0m13:53:38.202589 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m13:53:38.212554 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:38.785859 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:917be142-cccf-406f-97b9-92090df2a9cb&page=queryresults
[0m13:53:38.790844 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:992e9d1a-96d0-447f-9191-888cbf75823f&page=queryresults
[0m13:53:39.614773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238662EA850>]}
[0m13:53:39.617765 [info ] [Thread-1 (]: 24 of 98 OK created sql view model dbt_dev_yourname_staging.stg_order_items .... [[32mCREATE VIEW (0 processed)[0m in 2.50s]
[0m13:53:39.620760 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_order_items
[0m13:53:39.623750 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m13:53:39.625746 [info ] [Thread-1 (]: 25 of 98 START test is_not_negative_stg_order_items_item_freight ............... [RUN]
[0m13:53:39.630731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_order_items, now test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a)
[0m13:53:39.633767 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m13:53:39.670650 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m13:53:39.676174 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m13:53:39.697121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:39.781898 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m13:53:39.790869 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:40.082446 [info ] [Thread-2 (]: 21 of 98 PASS source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [[32mPASS[0m in 6.06s]
[0m13:53:40.088432 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m13:53:40.092417 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m13:53:40.097404 [info ] [Thread-2 (]: 26 of 98 START test is_positive_stg_order_items_item_price ..................... [RUN]
[0m13:53:40.102388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543, now test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242)
[0m13:53:40.106427 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m13:53:40.153254 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m13:53:40.159988 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m13:53:40.184654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:40.454486 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:67c5b78e-c02b-4573-b7c7-4959e068948d&page=queryresults
[0m13:53:40.648963 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m13:53:40.697831 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:40.982907 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
[0m13:53:40.986059 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_freight as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:41.303273 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b7a28f08-bb40-4ace-b800-23d5074a4e52&page=queryresults
[0m13:53:41.613934 [info ] [Thread-4 (]: 22 of 98 PASS source_unique_raw_olist_customers_customer_id .................... [[32mPASS[0m in 6.05s]
[0m13:53:41.620915 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m13:53:41.623907 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m13:53:41.626808 [info ] [Thread-4 (]: 27 of 98 START test is_positive_stg_order_items_item_total ..................... [RUN]
[0m13:53:41.632884 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816, now test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25)
[0m13:53:41.638272 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
[0m13:53:41.644234 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m13:53:41.653879 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_price as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price <= 0
   or item_price is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:41.698707 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m13:53:42.092406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9ff638ed-b245-4191-a7e2-98be3274c36b&page=queryresults
[0m13:53:42.134303 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m13:53:42.166209 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:42.426266 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:18adadbc-64bc-4f8f-80ee-c3d4c73075f5&page=queryresults
[0m13:53:42.437299 [info ] [Thread-3 (]: 23 of 98 PASS source_unique_raw_olist_orders_order_id .......................... [[32mPASS[0m in 6.67s]
[0m13:53:42.453504 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m13:53:42.457609 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m13:53:42.462112 [info ] [Thread-3 (]: 28 of 98 START test not_null_stg_order_items_item_freight ...................... [RUN]
[0m13:53:42.476221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0, now test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5)
[0m13:53:42.482205 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m13:53:42.517081 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m13:53:42.520117 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m13:53:42.549034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:44.129219 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
[0m13:53:44.134214 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:44.253138 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m13:53:44.564544 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:44.632698 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
[0m13:53:44.639688 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total <= 0
   or item_total is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:44.648033 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m13:53:44.660543 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:44.769806 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f597d626-f8cb-42fb-b444-a63d7681e165&page=queryresults
[0m13:53:45.398753 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:23ea6eb5-39f0-4b52-b3ee-5efd43de745a&page=queryresults
[0m13:53:45.403732 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:65a744d6-3ffe-441d-853c-61dfe5ec64c3&page=queryresults
[0m13:53:45.404704 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5a17dffa-9c57-491d-9304-edfda1baccac&page=queryresults
[0m13:53:46.555232 [info ] [Thread-1 (]: 25 of 98 PASS is_not_negative_stg_order_items_item_freight ..................... [[32mPASS[0m in 6.92s]
[0m13:53:46.563212 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m13:53:46.567352 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m13:53:46.557227 [info ] [Thread-2 (]: 26 of 98 PASS is_positive_stg_order_items_item_price ........................... [[32mPASS[0m in 6.46s]
[0m13:53:46.574582 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m13:53:46.571190 [info ] [Thread-1 (]: 29 of 98 START test not_null_stg_order_items_item_price ........................ [RUN]
[0m13:53:46.579569 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m13:53:46.582615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a, now test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556)
[0m13:53:46.588606 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m13:53:46.585614 [info ] [Thread-2 (]: 30 of 98 START test not_null_stg_order_items_item_total ........................ [RUN]
[0m13:53:46.609049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242, now test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2)
[0m13:53:46.618940 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m13:53:46.669027 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m13:53:46.670025 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m13:53:46.685202 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m13:53:46.687198 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m13:53:46.703180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:46.724971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:47.324002 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m13:53:47.327994 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m13:53:47.382092 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:47.385083 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:48.079849 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d59ddd80-c747-42a7-a09d-860e1f01719a&page=queryresults
[0m13:53:48.140722 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
[0m13:53:48.147747 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:48.161823 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db061674-0e7b-475a-b9d0-35ddbc7899a1&page=queryresults
[0m13:53:48.197878 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
[0m13:53:48.200870 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:48.817776 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b871a7a8-c4a8-4c99-bf56-7f439f321ff1&page=queryresults
[0m13:53:48.892224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:398c1db0-d928-439d-8f65-97936cc09fa7&page=queryresults
[0m13:53:49.213501 [info ] [Thread-4 (]: 27 of 98 PASS is_positive_stg_order_items_item_total ........................... [[32mPASS[0m in 7.58s]
[0m13:53:49.217222 [info ] [Thread-3 (]: 28 of 98 PASS not_null_stg_order_items_item_freight ............................ [[32mPASS[0m in 6.74s]
[0m13:53:49.230193 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m13:53:49.243928 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m13:53:49.251955 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m13:53:49.258944 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m13:53:49.266982 [info ] [Thread-4 (]: 31 of 98 START test not_null_stg_order_items_order_id .......................... [RUN]
[0m13:53:49.292002 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25, now test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96)
[0m13:53:49.272058 [info ] [Thread-3 (]: 32 of 98 START test not_null_stg_order_items_order_item_key .................... [RUN]
[0m13:53:49.298990 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m13:53:49.302077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5, now test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa)
[0m13:53:49.325114 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m13:53:49.331098 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m13:53:49.352619 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m13:53:49.355613 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m13:53:49.371524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:49.374029 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m13:53:49.471885 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:50.734964 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m13:53:50.866783 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:50.872416 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
[0m13:53:50.881370 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_item_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:50.897328 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
[0m13:53:50.902912 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:51.095990 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m13:53:51.481185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c2080bd-bef1-42c3-b2c8-5217e4778dfe&page=queryresults
[0m13:53:51.484060 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:823d35e0-33a1-4d64-bddd-d2c0cfa55a1d&page=queryresults
[0m13:53:51.486058 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:31ffaa87-7a87-4aef-bb0c-d796fa7ec1f3&page=queryresults
[0m13:53:51.534206 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:52.096047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:20c31593-a712-4baf-96e0-fcd4a0a56959&page=queryresults
[0m13:53:52.620771 [info ] [Thread-2 (]: 30 of 98 PASS not_null_stg_order_items_item_total .............................. [[32mPASS[0m in 6.01s]
[0m13:53:52.630323 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m13:53:52.632153 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:53:52.635093 [info ] [Thread-2 (]: 33 of 98 START test not_null_stg_order_items_product_id ........................ [RUN]
[0m13:53:52.638081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2, now test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6)
[0m13:53:52.641072 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:53:52.682227 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:53:52.685785 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:53:52.706490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:53.383207 [info ] [Thread-1 (]: 29 of 98 PASS not_null_stg_order_items_item_price .............................. [[32mPASS[0m in 6.80s]
[0m13:53:53.403155 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m13:53:53.414492 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:53:53.420186 [info ] [Thread-1 (]: 34 of 98 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m13:53:53.424173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556, now test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m13:53:53.431153 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:53:53.489223 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:53:53.496217 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m13:53:53.501871 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:53.504849 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:53:53.528956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:53.770932 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m13:53:53.775966 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:54.132929 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5b41650e-b53d-4bf5-b57e-26fbd3a32a1e&page=queryresults
[0m13:53:54.205860 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
[0m13:53:54.211852 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:54.390139 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b3304e08-9fd1-4cee-8bdc-acb3ce08fb9e&page=queryresults
[0m13:53:54.733863 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9fdcb376-de4b-43a9-b5a1-a1b29cffb7c8&page=queryresults
[0m13:53:55.325464 [info ] [Thread-3 (]: 32 of 98 PASS not_null_stg_order_items_order_item_key .......................... [[32mPASS[0m in 6.02s]
[0m13:53:55.336397 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m13:53:55.339390 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m13:53:55.343678 [info ] [Thread-3 (]: 35 of 98 START test unique_stg_order_items_order_item_key ...................... [RUN]
[0m13:53:55.350357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa, now test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057)
[0m13:53:55.354350 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m13:53:55.401219 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m13:53:55.423163 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m13:53:55.419172 [info ] [Thread-4 (]: 31 of 98 PASS not_null_stg_order_items_order_id ................................ [[32mPASS[0m in 6.13s]
[0m13:53:55.468632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:53:55.470625 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m13:53:55.557399 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_customers
[0m13:53:55.563332 [info ] [Thread-4 (]: 36 of 98 START sql view model dbt_dev_yourname_staging.stg_customers ........... [RUN]
[0m13:53:55.566408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96, now model.dbt_advanced_olist.stg_customers)
[0m13:53:55.568317 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_customers
[0m13:53:55.588265 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_customers"
[0m13:53:55.597620 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_customers
[0m13:53:55.607214 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_customers"
[0m13:53:55.614195 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_customers: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_customers
  
  Purpose: Clean and standardize customer data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Standardize location data
  - Clean state codes
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`customers`
),

renamed as (
    select
        -- Primary Key
        customer_id,
        
        -- Alternative Key (same customer across orders)
        customer_unique_id,
        
        -- Location
        lower(trim(customer_city)) as customer_city,
        upper(trim(customer_state)) as customer_state,
        cast(customer_zip_code_prefix as string) as customer_zip_code,
        
        -- Derived: Region classification
        case upper(trim(customer_state))
            when 'SP' then 'Southeast'
            when 'RJ' then 'Southeast'
            when 'MG' then 'Southeast'
            when 'ES' then 'Southeast'
            when 'PR' then 'South'
            when 'SC' then 'South'
            when 'RS' then 'South'
            when 'BA' then 'Northeast'
            when 'PE' then 'Northeast'
            when 'CE' then 'Northeast'
            when 'MA' then 'Northeast'
            when 'PB' then 'Northeast'
            when 'RN' then 'Northeast'
            when 'PI' then 'Northeast'
            when 'AL' then 'Northeast'
            when 'SE' then 'Northeast'
            when 'GO' then 'Central-West'
            when 'DF' then 'Central-West'
            when 'MT' then 'Central-West'
            when 'MS' then 'Central-West'
            else 'North'
        end as customer_region

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_customers | schema: dbt_dev_yourname_staging */;
[0m13:53:55.617192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:55.830425 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
[0m13:53:55.836455 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:56.450333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ed2fd56-a1f9-4456-9370-0928d882d5c6&page=queryresults
[0m13:53:56.603393 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m13:53:56.608339 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:57.268051 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:147c2feb-9f69-4ea7-b80d-fc7e51502f42&page=queryresults
[0m13:53:57.734102 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5bc0b2d6-5324-4eb4-ad9f-378a2afaf20c&page=queryresults
[0m13:53:58.317005 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
[0m13:53:58.330924 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_item_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  where order_item_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:53:58.323946 [info ] [Thread-2 (]: 33 of 98 PASS not_null_stg_order_items_product_id .............................. [[32mPASS[0m in 5.68s]
[0m13:53:58.342890 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m13:53:58.349088 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_orders
[0m13:53:58.353867 [info ] [Thread-2 (]: 37 of 98 START sql view model dbt_dev_yourname_staging.stg_orders .............. [RUN]
[0m13:53:58.359845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6, now model.dbt_advanced_olist.stg_orders)
[0m13:53:58.369818 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_orders
[0m13:53:58.421727 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_orders"
[0m13:53:58.426667 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238663A0550>]}
[0m13:53:58.435813 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_orders
[0m13:53:58.432650 [info ] [Thread-4 (]: 36 of 98 OK created sql view model dbt_dev_yourname_staging.stg_customers ...... [[32mCREATE VIEW (0 processed)[0m in 2.86s]
[0m13:53:58.448708 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_orders"
[0m13:53:58.453649 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_customers
[0m13:53:58.459996 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_orders: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_orders
  
  Purpose: Clean and standardize raw order data
  Source: Olist Brazilian E-commerce (10K orders sample)
  
  Transformations:
  - Rename columns to consistent naming convention
  - Cast timestamps to proper types
  - Calculate delivery metrics
  - Add late delivery flag
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`orders`
),

renamed as (
    select
        -- Primary Key
        order_id,
        
        -- Foreign Keys
        customer_id,
        
        -- Order Status
        order_status,
        
        -- Timestamps (cast to proper types)
        cast(order_purchase_timestamp as timestamp) as ordered_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as shipped_at,
        cast(order_delivered_customer_date as timestamp) as delivered_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,
        
        -- Derived: Order date (for partitioning)
        date(cast(order_purchase_timestamp as timestamp)) as order_date,
        
        -- Derived: Delivery time in days
        case 
            when order_delivered_customer_date is not null 
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_purchase_timestamp as timestamp)),
                day
            )
        end as delivery_days,
        
        -- Derived: Is delivery late?
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then true
            else false
        end as is_late_delivery,
        
        -- Derived: Days late (if late)
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_estimated_delivery_date as timestamp)),
                day
            )
            else 0
        end as days_late

    from source
)

select * from renamed

-- Limit in dev for faster iteration
limit 1000
/* dbt 1.10.15 | model: stg_orders | schema: dbt_dev_yourname_staging */;
[0m13:53:58.464984 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m13:53:58.466979 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:58.469969 [info ] [Thread-4 (]: 38 of 98 START test accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m13:53:58.563769 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_customers, now test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f)
[0m13:53:58.568705 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m13:53:58.593643 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m13:53:58.597634 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m13:53:58.617620 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:58.797676 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m13:53:58.805647 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:53:58.920979 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f87233e7-33ee-483c-be67-96d31a6bed1a&page=queryresults
[0m13:53:59.455451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2718a929-c2c8-4f24-a3ca-6bba9400bc33&page=queryresults
[0m13:53:59.832263 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
[0m13:53:59.839245 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:00.027741 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:07069a83-3800-43ed-859a-d6e4dbbbb014&page=queryresults
[0m13:54:00.446623 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3a68813a-eacb-40bf-a4eb-08ad0f92e4c4&page=queryresults
[0m13:54:00.598216 [warn ] [Thread-1 (]: 34 of 98 WARN 642 relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[33mWARN 642[0m in 7.17s]
[0m13:54:00.602204 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m13:54:00.604418 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m13:54:00.605197 [info ] [Thread-1 (]: 39 of 98 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [RUN]
[0m13:54:00.608190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789)
[0m13:54:00.610227 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m13:54:00.629134 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m13:54:00.647086 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238665954D0>]}
[0m13:54:00.652076 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m13:54:00.666034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:00.650238 [info ] [Thread-2 (]: 37 of 98 OK created sql view model dbt_dev_yourname_staging.stg_orders ......... [[32mCREATE VIEW (0 processed)[0m in 2.29s]
[0m13:54:00.727869 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_orders
[0m13:54:00.731858 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:54:00.736846 [info ] [Thread-2 (]: 40 of 98 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m13:54:00.738868 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_orders, now test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:54:00.739837 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:54:00.753802 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:54:00.761780 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:54:00.771752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:01.353196 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m13:54:01.384115 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:01.972540 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
[0m13:54:01.979523 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:01.981516 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9ffecb2f-cb16-4a40-96d0-894b392e0584&page=queryresults
[0m13:54:02.692616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:06822538-5f45-4942-bb51-3e75a3b12920&page=queryresults
[0m13:54:02.698599 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m13:54:02.704584 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:03.027722 [info ] [Thread-3 (]: 35 of 98 PASS unique_stg_order_items_order_item_key ............................ [[32mPASS[0m in 7.68s]
[0m13:54:03.033706 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m13:54:03.035698 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m13:54:03.038691 [info ] [Thread-3 (]: 41 of 98 START test not_null_stg_customers_customer_region ..................... [RUN]
[0m13:54:03.041683 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057, now test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e)
[0m13:54:03.043677 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m13:54:03.066616 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
[0m13:54:03.074839 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:03.085633 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m13:54:03.088559 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m13:54:03.113490 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:03.635097 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bc397ee5-dd08-4773-9733-20ddcb8da89c&page=queryresults
[0m13:54:03.637089 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd049b4d-c99d-432a-80dc-30ddad0e4c2a&page=queryresults
[0m13:54:04.775047 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
[0m13:54:04.781030 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:04.778176 [info ] [Thread-4 (]: 38 of 98 PASS accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 6.21s]
[0m13:54:04.785020 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m13:54:04.786998 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m13:54:04.788049 [info ] [Thread-4 (]: 42 of 98 START test not_null_stg_customers_customer_state ...................... [RUN]
[0m13:54:04.791005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f, now test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397)
[0m13:54:04.793000 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m13:54:04.804970 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m13:54:04.809954 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m13:54:04.822923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:04.884755 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m13:54:04.889741 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:05.536015 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1d927134-ce67-47f4-921f-131aa7589471&page=queryresults
[0m13:54:05.537013 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:02d191a4-70f7-4f92-be4c-207664490250&page=queryresults
[0m13:54:05.932980 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:54:05.936941 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:06.377033 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
[0m13:54:06.382081 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:06.682216 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5fc86d7c-6ec2-4084-ba6d-8591d4df8c7e&page=queryresults
[0m13:54:06.717322 [info ] [Thread-1 (]: 39 of 98 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [[32mPASS[0m in 6.11s]
[0m13:54:06.720116 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m13:54:06.721380 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:54:06.722109 [info ] [Thread-1 (]: 43 of 98 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m13:54:06.726097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789, now test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba)
[0m13:54:06.728092 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:54:06.739064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:54:06.747042 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:54:06.763996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:07.052551 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bdee7d89-3fb7-4e3e-aa1e-2b69253c6226&page=queryresults
[0m13:54:07.443234 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m13:54:07.446172 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:07.815184 [info ] [Thread-2 (]: 40 of 98 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 7.08s]
[0m13:54:07.818176 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:54:07.819174 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m13:54:07.820418 [info ] [Thread-2 (]: 44 of 98 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:54:07.822166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada)
[0m13:54:07.824173 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m13:54:07.843111 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m13:54:07.848098 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m13:54:07.863058 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:08.035598 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8c9696f6-bc4a-44e1-9cd5-5bf19edb42a6&page=queryresults
[0m13:54:08.194173 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
[0m13:54:08.197166 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:09.045262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:05029867-6eac-4cd9-aa48-b1208fb621f0&page=queryresults
[0m13:54:09.096418 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
[0m13:54:09.101410 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:09.115375 [info ] [Thread-3 (]: 41 of 98 PASS not_null_stg_customers_customer_region ........................... [[32mPASS[0m in 6.07s]
[0m13:54:09.120314 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m13:54:09.124303 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m13:54:09.129290 [info ] [Thread-3 (]: 45 of 98 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m13:54:09.134278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e, now test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460)
[0m13:54:09.138268 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m13:54:09.180162 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m13:54:09.187284 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m13:54:09.221240 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:09.421766 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m13:54:09.428709 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:09.715460 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0ffa9997-0afb-4606-b107-0d42d1d59025&page=queryresults
[0m13:54:10.168294 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:587cc5a3-4650-4413-84af-8d82f4754cb2&page=queryresults
[0m13:54:10.659197 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
[0m13:54:10.663185 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:10.936454 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:54:10.939447 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:11.234860 [info ] [Thread-4 (]: 42 of 98 PASS not_null_stg_customers_customer_state ............................ [[32mPASS[0m in 6.44s]
[0m13:54:11.237649 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m13:54:11.238645 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m13:54:11.240643 [info ] [Thread-4 (]: 46 of 98 START test assert_delivery_dates_logical .............................. [RUN]
[0m13:54:11.242968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397, now test.dbt_advanced_olist.assert_delivery_dates_logical)
[0m13:54:11.244709 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m13:54:11.254606 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m13:54:11.263580 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea4b820f-0459-487f-9354-c41c297c30f5&page=queryresults
[0m13:54:11.266572 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m13:54:11.283526 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:11.648551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6411375c-a8eb-424d-99d0-91593092c402&page=queryresults
[0m13:54:11.694523 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m13:54:11.697422 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:12.237974 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eaba9f6c-9555-49f5-be2e-980dc619c8e2&page=queryresults
[0m13:54:12.514270 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
[0m13:54:12.517230 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_delivery_dates_logical
  
  Purpose: Delivery dates should follow logical order
  
  Business Rules:
  - approved_at >= ordered_at
  - shipped_at >= approved_at (if exists)
  - delivered_at >= shipped_at (if exists)
  
  Test PASSES if query returns 0 rows
*/

with orders as (
    select
        order_id,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

date_violations as (
    select
        order_id,
        case
            when approved_at < ordered_at then 'Approved before ordered'
            when shipped_at < approved_at then 'Shipped before approved'
            when delivered_at < shipped_at then 'Delivered before shipped'
            when delivered_at < ordered_at then 'Delivered before ordered'
        end as violation_type,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from orders
    where 
        (approved_at is not null and approved_at < ordered_at)
        or (shipped_at is not null and approved_at is not null and shipped_at < approved_at)
        or (delivered_at is not null and shipped_at is not null and delivered_at < shipped_at)
        or (delivered_at is not null and delivered_at < ordered_at)
)

select * from date_violations
  
  
    )
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:12.781585 [info ] [Thread-1 (]: 43 of 98 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 6.06s]
[0m13:54:12.783515 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:54:12.784514 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.assert_orders_have_items
[0m13:54:12.786510 [info ] [Thread-1 (]: 47 of 98 START test assert_orders_have_items ................................... [RUN]
[0m13:54:12.788504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_advanced_olist.assert_orders_have_items)
[0m13:54:12.790498 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.assert_orders_have_items
[0m13:54:12.804462 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m13:54:12.808498 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.assert_orders_have_items
[0m13:54:12.820419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:13.152529 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cfa0f1da-9578-4ea3-b7b1-a817b81f4874&page=queryresults
[0m13:54:13.251410 [info ] [Thread-2 (]: 44 of 98 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 5.43s]
[0m13:54:13.253261 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m13:54:13.255255 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m13:54:13.258248 [info ] [Thread-2 (]: 48 of 98 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [RUN]
[0m13:54:13.260241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15)
[0m13:54:13.261240 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m13:54:13.282184 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m13:54:13.312103 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m13:54:13.326066 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:14.363293 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
[0m13:54:14.367283 [debug] [Thread-1 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

/*
  SINGULAR TEST: assert_orders_have_items
  Purpose: Every order should have at least one line item
  Business Rule: An order without items indicates data integrity issue
  Test PASSES if this query returns 0 rows
  Test FAILS if any orders exist without items
  
  Note: Sample data may have orphaned records - set to warn
*/
with orders as (
    select order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),
order_items as (
    select distinct order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),
orders_without_items as (
    select
        o.order_id
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    where oi.order_id is null
)
select
    order_id,
    'Order has no items' as failure_reason
from orders_without_items
  
  
    )
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:15.031727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f0a8fdcf-f818-4978-8bb6-01233a5728e2&page=queryresults
[0m13:54:15.244443 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
[0m13:54:15.249430 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_days >= 0 and delivery_days <= 180
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where
        delivery_days is not null
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:15.885119 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:22144dfa-7f05-4ce1-8e4a-57775d7e6802&page=queryresults
[0m13:54:16.212556 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m13:54:16.229510 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:16.935940 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ae4f69ba-85df-47d5-a84b-dfce3d37d851&page=queryresults
[0m13:54:17.319142 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m13:54:17.336114 [debug] [Thread-1 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:17.950296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c4a7d621-dd90-4e2d-90e5-4d6c55fa2b29&page=queryresults
[0m13:54:18.083559 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m13:54:18.089542 [info ] [Thread-4 (]: 46 of 98 PASS assert_delivery_dates_logical .................................... [[32mPASS[0m in 6.84s]
[0m13:54:18.098520 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m13:54:18.102513 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:18.108494 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:54:18.122456 [info ] [Thread-4 (]: 49 of 98 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m13:54:18.131431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_delivery_dates_logical, now test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:54:18.134429 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:54:18.182341 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:54:18.196258 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:54:18.220192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:18.711230 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2a3076ae-680b-40bb-a95e-94a859f39726&page=queryresults
[0m13:54:19.038312 [warn ] [Thread-1 (]: 47 of 98 WARN 890 assert_orders_have_items ..................................... [[33mWARN 890[0m in 6.25s]
[0m13:54:19.044533 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.assert_orders_have_items
[0m13:54:19.046629 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m13:54:19.048289 [info ] [Thread-1 (]: 50 of 98 START test not_null_stg_orders_is_late_delivery ....................... [RUN]
[0m13:54:19.051353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_orders_have_items, now test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0)
[0m13:54:19.054315 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m13:54:19.070271 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m13:54:19.078345 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m13:54:19.093166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:19.780872 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
[0m13:54:19.786855 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:20.032652 [warn ] [Thread-2 (]: 48 of 98 WARN 1 dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [[33mWARN 1[0m in 6.77s]
[0m13:54:20.040594 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m13:54:20.044586 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m13:54:20.048569 [info ] [Thread-2 (]: 51 of 98 START test not_null_stg_orders_order_date ............................. [RUN]
[0m13:54:20.052596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15, now test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb)
[0m13:54:20.059541 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m13:54:20.113438 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m13:54:20.127360 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m13:54:20.145353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:20.357142 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f6c359c-0acc-4b89-b7a3-f7048c993ae4&page=queryresults
[0m13:54:20.793657 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m13:54:20.801635 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:21.495500 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:757ff098-d712-4bcc-9e11-7b16c139d530&page=queryresults
[0m13:54:21.500477 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
[0m13:54:21.504535 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
[0m13:54:21.517400 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:21.525380 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where is_late_delivery is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:22.267646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:99003380-f17a-4dec-bd34-48f4b724ff09&page=queryresults
[0m13:54:22.272634 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d2b68472-020b-49cd-af24-6e83dda56519&page=queryresults
[0m13:54:22.276673 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:54:22.319135 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:22.650255 [info ] [Thread-3 (]: 45 of 98 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 13.51s]
[0m13:54:22.663178 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m13:54:22.668199 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m13:54:22.674148 [info ] [Thread-3 (]: 52 of 98 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:54:22.683125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:54:22.688111 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m13:54:22.732039 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:54:22.744970 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m13:54:22.768957 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:23.015034 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:263c7c89-6585-46be-b923-eb8b97689fc4&page=queryresults
[0m13:54:24.157987 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
[0m13:54:24.168962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m13:54:24.174942 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m13:54:24.181972 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:24.176987 [info ] [Thread-4 (]: 49 of 98 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 6.05s]
[0m13:54:24.192677 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:24.200877 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:54:24.207856 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:24.224812 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m13:54:24.235778 [info ] [Thread-4 (]: 53 of 98 START test not_null_stg_orders_order_status ........................... [RUN]
[0m13:54:24.244102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79)
[0m13:54:24.246754 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m13:54:24.280659 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m13:54:24.285644 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m13:54:24.334535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:24.812632 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8c8543d-fc12-4b2f-9631-049b5fc85efa&page=queryresults
[0m13:54:24.815618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3d01a4a1-835e-4739-a257-8783b40dbdff&page=queryresults
[0m13:54:24.913824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c1393b3b-1833-4207-91c4-1391f2e8b7a3&page=queryresults
[0m13:54:25.892861 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
[0m13:54:25.899842 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:26.064820 [info ] [Thread-1 (]: 50 of 98 PASS not_null_stg_orders_is_late_delivery ............................. [[32mPASS[0m in 7.01s]
[0m13:54:26.075788 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m13:54:26.068807 [info ] [Thread-2 (]: 51 of 98 PASS not_null_stg_orders_order_date ................................... [[32mPASS[0m in 6.01s]
[0m13:54:26.079774 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m13:54:26.087753 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m13:54:26.096730 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:54:26.093736 [info ] [Thread-1 (]: 54 of 98 START test not_null_stg_orders_ordered_at ............................. [RUN]
[0m13:54:26.103709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0, now test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca)
[0m13:54:26.110693 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m13:54:26.100717 [info ] [Thread-2 (]: 55 of 98 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:54:26.178509 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m13:54:26.182496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m13:54:26.191474 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:54:26.228376 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:54:26.231367 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m13:54:26.247323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:26.249320 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:54:26.349055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:26.878142 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:54:26.885308 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:27.024531 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:016880c2-6274-4540-88e1-781a3d5e9625&page=queryresults
[0m13:54:27.458533 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:179ffcea-10be-4735-8ea7-ba107012ec9a&page=queryresults
[0m13:54:27.702908 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
[0m13:54:27.713877 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:27.745770 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
[0m13:54:27.750758 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:28.398838 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e2a37240-c566-4237-9708-356737cafc8c&page=queryresults
[0m13:54:28.408773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:60b439b6-1340-4337-8997-40ed0077eaa6&page=queryresults
[0m13:54:28.758942 [info ] [Thread-3 (]: 52 of 98 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 6.07s]
[0m13:54:28.771909 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m13:54:28.775897 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:54:28.777941 [info ] [Thread-3 (]: 56 of 98 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:54:28.782090 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:54:28.786866 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:54:28.842719 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:54:28.850710 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:54:28.881988 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:30.239675 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m13:54:30.248651 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:30.440138 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
[0m13:54:30.446121 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:30.614191 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m13:54:30.621434 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:31.078165 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d34e4409-8786-40f0-a448-afb56dbf17f7&page=queryresults
[0m13:54:31.158771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0175da04-49f5-48d1-ab08-e1d9dd1cbc36&page=queryresults
[0m13:54:31.415299 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7ffc633a-9a19-44ca-9d62-3c1c81911bd0&page=queryresults
[0m13:54:32.189532 [info ] [Thread-1 (]: 54 of 98 PASS not_null_stg_orders_ordered_at ................................... [[32mPASS[0m in 6.09s]
[0m13:54:32.195519 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m13:54:32.198508 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m13:54:32.202494 [info ] [Thread-1 (]: 57 of 98 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:54:32.209066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca, now test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a)
[0m13:54:32.213061 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m13:54:32.261158 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m13:54:32.267329 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m13:54:32.303844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:32.600119 [info ] [Thread-4 (]: 53 of 98 PASS not_null_stg_orders_order_status ................................. [[32mPASS[0m in 8.36s]
[0m13:54:32.615072 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m13:54:33.286395 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m13:54:33.293379 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:54:33.300419 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:33.305874 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:33.929149 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
[0m13:54:33.931146 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0f2eaac5-a824-4dbc-b896-673b0850e6fe&page=queryresults
[0m13:54:33.937433 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:34.039101 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8c10ec89-3547-40ea-8e67-1934e72fb221&page=queryresults
[0m13:54:34.655105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f7880509-c9a7-49bd-b490-84b950b89d9a&page=queryresults
[0m13:54:35.188942 [warn ] [Thread-3 (]: 56 of 98 WARN 902 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 902[0m in 6.41s]
[0m13:54:35.191934 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:54:35.207262 [warn ] [Thread-2 (]: 55 of 98 WARN 862 relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mWARN 862[0m in 9.02s]
[0m13:54:35.211255 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m13:54:36.703494 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m13:54:36.708080 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:37.285843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ab8f1030-0551-4c83-aa53-7609b112b674&page=queryresults
[0m13:54:38.230195 [info ] [Thread-1 (]: 57 of 98 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 6.02s]
[0m13:54:38.233103 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m13:54:38.256167 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m13:54:38.258162 [info ] [Thread-4 (]: 58 of 98 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [RUN]
[0m13:54:38.260157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79, now model.dbt_advanced_olist.int_orders_enriched)
[0m13:54:38.261183 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m13:54:38.304983 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m13:54:38.309971 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m13:54:38.322936 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m13:54:38.327956 [debug] [Thread-4 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m13:54:38.329950 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:40.170889 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a7a24e51-1d7d-4b74-84fa-b26022b1754f&page=queryresults
[0m13:54:40.880247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386647A5D0>]}
[0m13:54:40.886227 [info ] [Thread-4 (]: 58 of 98 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.62s]
[0m13:54:40.890319 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m13:54:40.894286 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m13:54:40.897251 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m13:54:40.899299 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m13:54:40.903238 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m13:54:40.906231 [info ] [Thread-2 (]: 59 of 98 START test assert_order_total_matches_items ........................... [RUN]
[0m13:54:40.910222 [info ] [Thread-1 (]: 60 of 98 START test dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [RUN]
[0m13:54:40.925177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_advanced_olist.assert_order_total_matches_items)
[0m13:54:40.937305 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.assert_order_total_matches_items
[0m13:54:40.929165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75)
[0m13:54:40.920191 [info ] [Thread-4 (]: 62 of 98 START test not_null_int_orders_enriched_item_count .................... [RUN]
[0m13:54:40.913209 [info ] [Thread-3 (]: 61 of 98 START test is_not_negative_int_orders_enriched_order_total ............ [RUN]
[0m13:54:40.967653 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m13:54:40.974638 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m13:54:40.977626 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_orders_enriched, now test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101)
[0m13:54:40.979874 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf)
[0m13:54:41.010317 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m13:54:41.012890 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m13:54:41.014868 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.assert_order_total_matches_items
[0m13:54:41.016407 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m13:54:41.033406 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m13:54:41.047430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:41.048396 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m13:54:41.069343 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m13:54:41.163174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:41.169123 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m13:54:41.176302 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m13:54:41.260986 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:41.277532 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:42.774842 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
[0m13:54:42.777357 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
[0m13:54:42.779352 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
[0m13:54:42.781346 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
[0m13:54:42.786389 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and item_count >= 0 and item_count <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:42.789381 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_order_total_matches_items
  
  Purpose: Order total should equal sum of item totals (within tolerance)
  
  Business Rule: Order total = sum(item_price + item_freight) for all items
  
  Tolerance: 1 BRL to account for rounding
  
  Test PASSES if query returns 0 rows
*/

with order_totals_from_items as (
    select
        order_id,
        sum(item_total) as calculated_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    group by 1
),

order_totals_from_orders as (
    select
        order_id,
        order_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

mismatches as (
    select
        o.order_id,
        o.order_total as reported_total,
        i.calculated_total,
        abs(o.order_total - i.calculated_total) as difference
    from order_totals_from_orders o
    inner join order_totals_from_items i on o.order_id = i.order_id
    where abs(o.order_total - i.calculated_total) > 1  -- 1 BRL tolerance
)

select
    order_id,
    reported_total,
    calculated_total,
    round(difference, 2) as difference_brl,
    'Order total does not match sum of items' as failure_reason
from mismatches
  
  
    )
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:42.793478 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    order_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:42.797247 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:43.536386 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3f7c62a0-7760-478b-8277-47253a1b3aed&page=queryresults
[0m13:54:43.540374 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7a76b12e-8ff7-4980-b510-cca5b16dd0a6&page=queryresults
[0m13:54:43.541372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4e56ae92-1669-45cb-97e7-e072f32ad569&page=queryresults
[0m13:54:43.554603 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b1bf66fc-1d18-4114-8491-f3445b50a762&page=queryresults
[0m13:54:45.817393 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m13:54:45.824373 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m13:54:45.830420 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:45.833412 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:46.193408 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m13:54:46.200424 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:46.606869 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m13:54:46.607043 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:49529390-4e74-4f65-882e-11f0491a76a2&page=queryresults
[0m13:54:46.614757 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:46.631864 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8970259a-2504-45d8-9ba5-7d918f0440e5&page=queryresults
[0m13:54:46.825625 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4e1116eb-240e-44e5-b3e5-4c2dd1730aa7&page=queryresults
[0m13:54:47.196907 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:78eec1ba-4d82-4609-a35b-ba2a0875dea0&page=queryresults
[0m13:54:47.719560 [info ] [Thread-2 (]: 59 of 98 PASS assert_order_total_matches_items ................................. [[32mPASS[0m in 6.80s]
[0m13:54:47.722522 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m13:54:47.723638 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m13:54:47.724516 [info ] [Thread-2 (]: 63 of 98 START test not_null_int_orders_enriched_order_id ...................... [RUN]
[0m13:54:47.726541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_order_total_matches_items, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e)
[0m13:54:47.728537 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m13:54:47.745016 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m13:54:47.748008 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m13:54:47.763869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:54:47.868932 [info ] [Thread-4 (]: 62 of 98 PASS not_null_int_orders_enriched_item_count .......................... [[32mPASS[0m in 6.89s]
[0m13:54:47.871919 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m13:54:47.873917 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m13:54:47.874942 [info ] [Thread-4 (]: 64 of 98 START test not_null_int_orders_enriched_order_total ................... [RUN]
[0m13:54:47.877939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c)
[0m13:54:47.880542 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m13:54:47.918939 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m13:54:47.940959 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m13:54:47.957805 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:54:48.196355 [info ] [Thread-1 (]: 60 of 98 PASS dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [[32mPASS[0m in 7.27s]
[0m13:54:48.201342 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m13:54:48.203014 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m13:54:48.203992 [info ] [Thread-1 (]: 65 of 98 START test unique_int_orders_enriched_order_id ........................ [RUN]
[0m13:54:48.206552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75, now test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232)
[0m13:54:48.208322 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m13:54:48.226929 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m13:54:48.238986 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m13:54:48.231381 [info ] [Thread-3 (]: 61 of 98 PASS is_not_negative_int_orders_enriched_order_total .................. [[32mPASS[0m in 7.25s]
[0m13:54:48.256076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:48.258068 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m13:54:49.384970 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
[0m13:54:49.386944 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
[0m13:54:49.390932 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:49.392928 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:49.697925 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
[0m13:54:49.702916 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:54:50.078408 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:618d7624-e2ba-411b-a9d8-46b94b9e1060&page=queryresults
[0m13:54:50.162983 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a2761221-7e99-4080-87d1-9831e5ca068b&page=queryresults
[0m13:54:50.572870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b5fdd933-0ef8-4081-862f-6565531de365&page=queryresults
[0m13:54:52.489520 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m13:54:52.523429 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:52.867511 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m13:54:52.889452 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:53.059091 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m13:54:53.063082 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:54:53.250581 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bcdb6ec5-b019-45b1-aa32-5423cc7474f6&page=queryresults
[0m13:54:53.554232 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9929d0a6-bfe5-49d9-a7fa-0f99d0adb38c&page=queryresults
[0m13:54:53.641171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3a22905e-410f-416c-8958-cffd553e8898&page=queryresults
[0m13:54:54.554981 [info ] [Thread-4 (]: 64 of 98 PASS not_null_int_orders_enriched_order_total ......................... [[32mPASS[0m in 6.68s]
[0m13:54:54.559968 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m13:54:54.592883 [info ] [Thread-2 (]: 63 of 98 PASS not_null_int_orders_enriched_order_id ............................ [[32mPASS[0m in 6.87s]
[0m13:54:54.594876 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m13:54:55.324702 [info ] [Thread-1 (]: 65 of 98 PASS unique_int_orders_enriched_order_id .............................. [[32mPASS[0m in 7.12s]
[0m13:54:55.327698 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m13:54:55.329691 [debug] [Thread-3 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m13:54:55.332681 [info ] [Thread-3 (]: 66 of 98 START unit_test dim_customers::test_customer_segment_high_value ....... [RUN]
[0m13:54:55.334676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value)
[0m13:54:55.336671 [debug] [Thread-3 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m13:54:55.337667 [debug] [Thread-3 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m13:54:55.553091 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:54:57.650555 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m13:54:58.083091 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m13:54:58.252720 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m13:54:58.382372 [debug] [Thread-3 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_high_value__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */;
[0m13:54:58.979565 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b5140dd4-2b28-4c02-9bab-1cbb8bdc826b&page=queryresults
[0m13:55:03.123483 [debug] [Thread-3 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m13:55:03.157392 [debug] [Thread-3 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''High Value''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */
[0m13:55:03.824333 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ce447a65-6d86-4d58-b63b-da4304ebc591&page=queryresults
[0m13:55:14.990539 [info ] [Thread-3 (]: 66 of 98 PASS dim_customers::test_customer_segment_high_value .................. [[32mPASS[0m in 19.65s]
[0m13:55:14.999425 [debug] [Thread-3 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m13:55:15.003416 [debug] [Thread-3 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m13:55:15.006406 [info ] [Thread-3 (]: 67 of 98 START unit_test dim_customers::test_customer_segment_no_orders ........ [RUN]
[0m13:55:15.012393 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders)
[0m13:55:15.016381 [debug] [Thread-3 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m13:55:15.018374 [debug] [Thread-3 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m13:55:15.073626 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:16.642410 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m13:55:17.014579 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m13:55:17.149953 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m13:55:17.204188 [debug] [Thread-3 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_no_orders__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */;
[0m13:55:18.492110 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:600c714e-c836-49dd-a388-aa0f7a37d8e6&page=queryresults
[0m13:55:20.824844 [debug] [Thread-3 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m13:55:20.866886 [debug] [Thread-3 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''No Orders''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */
[0m13:55:21.533292 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:698d3026-165d-4aab-879b-64b139febbce&page=queryresults
[0m13:55:23.097803 [info ] [Thread-3 (]: 67 of 98 PASS dim_customers::test_customer_segment_no_orders ................... [[32mPASS[0m in 8.08s]
[0m13:55:23.101916 [debug] [Thread-3 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m13:55:23.103927 [debug] [Thread-3 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m13:55:23.105907 [info ] [Thread-3 (]: 68 of 98 START unit_test dim_customers::test_customer_segment_vip .............. [RUN]
[0m13:55:23.110895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip)
[0m13:55:23.114886 [debug] [Thread-3 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m13:55:23.117875 [debug] [Thread-3 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m13:55:23.217970 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:25.467671 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m13:55:25.823230 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m13:55:26.011760 [debug] [Thread-3 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m13:55:26.040608 [debug] [Thread-3 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_vip__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */;
[0m13:55:26.658365 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:27348b66-18f0-4f3c-b61f-5251327aef5e&page=queryresults
[0m13:55:29.534136 [debug] [Thread-3 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m13:55:29.547144 [debug] [Thread-3 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''VIP''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */
[0m13:55:30.346938 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:98be7239-1076-43f4-b900-1dbfc7101fd0&page=queryresults
[0m13:55:31.815056 [info ] [Thread-3 (]: 68 of 98 PASS dim_customers::test_customer_segment_vip ......................... [[32mPASS[0m in 8.70s]
[0m13:55:31.819694 [debug] [Thread-3 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m13:55:31.822686 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m13:55:31.830668 [info ] [Thread-3 (]: 69 of 98 START sql table model dbt_dev_yourname_marts.dim_customers ............ [RUN]
[0m13:55:31.834651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip, now model.dbt_advanced_olist.dim_customers)
[0m13:55:31.837873 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m13:55:31.889215 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m13:55:32.029632 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m13:55:32.139052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:33.751354 [debug] [Thread-3 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m13:55:34.852252 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a757936a-bd58-44de-9605-ac7a2e548400&page=queryresults
[0m13:55:35.277342 [warn ] [Thread-3 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m13:55:35.280467 [debug] [Thread-3 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m13:55:35.978987 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c7a2a5ae-c5e6-474c-9166-50e392d2dac1&page=queryresults
[0m13:55:36.477805 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m13:55:36.481796 [debug] [Thread-3 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m13:55:37.206016 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:39d9933d-50ee-4442-82f0-9815310c19f1&page=queryresults
[0m13:55:40.600795 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd67eef38-ae5e-4db4-b086-f5163a9b65a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238661BEBD0>]}
[0m13:55:40.606779 [info ] [Thread-3 (]: 69 of 98 OK created sql table model dbt_dev_yourname_marts.dim_customers ....... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 8.77s]
[0m13:55:40.614799 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m13:55:40.622844 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m13:55:40.626726 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m13:55:40.630713 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m13:55:40.634710 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m13:55:40.639688 [info ] [Thread-2 (]: 70 of 98 START test accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m13:55:40.674599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213)
[0m13:55:40.650661 [info ] [Thread-1 (]: 71 of 98 START test accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [RUN]
[0m13:55:40.679583 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m13:55:40.664625 [info ] [Thread-3 (]: 73 of 98 START test assert_vip_customer_criteria ............................... [RUN]
[0m13:55:40.684570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0)
[0m13:55:40.660639 [info ] [Thread-4 (]: 72 of 98 START test accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [RUN]
[0m13:55:40.729449 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m13:55:40.731444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_customers, now test.dbt_advanced_olist.assert_vip_customer_criteria)
[0m13:55:40.734440 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m13:55:40.736433 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c, now test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09)
[0m13:55:40.742419 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m13:55:40.759371 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m13:55:40.773331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m13:55:40.786298 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m13:55:40.818213 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m13:55:40.938224 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m13:55:40.943143 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m13:55:40.965960 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:40.985960 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:40.987914 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m13:55:40.995892 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m13:55:41.172581 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:55:41.185592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:42.434382 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
[0m13:55:42.438992 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
[0m13:55:42.443363 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:42.448347 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_vip_customer_criteria
  
  Purpose: VIP customers must meet the defined criteria
  
  Business Rule: VIP = lifetime_revenue >= 500 AND lifetime_orders >= 3
  
  Test PASSES if query returns 0 rows
*/

with vip_customers as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where customer_segment = 'VIP'
),

invalid_vips as (
    select
        customer_id,
        lifetime_revenue,
        lifetime_orders,
        'VIP but does not meet criteria' as violation
    from vip_customers
    where lifetime_revenue < 500
       or lifetime_orders < 3
),

should_be_vips as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders,
        'Should be VIP but is not' as violation
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where lifetime_revenue >= 500
      and lifetime_orders >= 3
      and customer_segment != 'VIP'
)

select * from invalid_vips
union all
select customer_id, lifetime_revenue, lifetime_orders, violation from should_be_vips
  
  
    )
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:42.633534 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
[0m13:55:42.638519 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
[0m13:55:42.648543 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        purchase_frequency as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by purchase_frequency

)

select *
from all_values
where value_field not in (
    'Frequent','Repeat','One-Time','Never Purchased'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:42.656472 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'VIP','High Value','Medium Value','Low Value','No Orders'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:42.951020 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:add903ee-9a12-476d-981d-9111a057034d&page=queryresults
[0m13:55:43.018968 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:823aa665-ea8b-4750-ba0b-f9595b5686a7&page=queryresults
[0m13:55:43.192657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d52497a5-594d-42dd-b49b-380642e97855&page=queryresults
[0m13:55:44.590532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:edb25f77-b743-41b0-a82d-f0a4aeec1fd1&page=queryresults
[0m13:55:45.857032 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m13:55:45.864009 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:45.877973 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m13:55:45.888943 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m13:55:45.893937 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:45.910887 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:45.939809 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m13:55:46.023088 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:46.416865 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d8b45a4c-7fbe-446e-aac1-9a404a9ab924&page=queryresults
[0m13:55:46.427725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eca6ac7a-f92e-47f2-b152-bb1dd57ad677&page=queryresults
[0m13:55:46.479827 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6a9993e7-486f-43d7-8959-31be9d9da1eb&page=queryresults
[0m13:55:46.643065 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:980c3a20-344c-4acd-9632-2d94b3a7dbb3&page=queryresults
[0m13:55:47.559887 [info ] [Thread-1 (]: 71 of 98 PASS accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [[32mPASS[0m in 6.87s]
[0m13:55:47.569857 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m13:55:47.562876 [info ] [Thread-3 (]: 73 of 98 PASS assert_vip_customer_criteria ..................................... [[32mPASS[0m in 6.83s]
[0m13:55:47.574844 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m13:55:47.580827 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m13:55:47.564874 [info ] [Thread-4 (]: 72 of 98 PASS accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [[32mPASS[0m in 6.83s]
[0m13:55:47.588806 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m13:55:47.594792 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m13:55:47.584822 [info ] [Thread-1 (]: 74 of 98 START test dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [RUN]
[0m13:55:47.604762 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m13:55:47.608752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d)
[0m13:55:47.617831 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m13:55:47.599778 [info ] [Thread-3 (]: 75 of 98 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [RUN]
[0m13:55:47.613743 [info ] [Thread-4 (]: 76 of 98 START test is_not_negative_dim_customers_avg_order_value .............. [RUN]
[0m13:55:47.667595 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m13:55:47.668594 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_vip_customer_criteria, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9)
[0m13:55:47.673589 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09, now test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178)
[0m13:55:47.677586 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m13:55:47.680605 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m13:55:47.699553 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m13:55:47.719455 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m13:55:47.725871 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m13:55:47.743435 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m13:55:47.745386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:47.760345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:47.760345 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m13:55:47.929964 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:55:48.626245 [info ] [Thread-2 (]: 70 of 98 PASS accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 7.95s]
[0m13:55:48.631030 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m13:55:48.632233 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m13:55:48.635224 [info ] [Thread-2 (]: 77 of 98 START test is_not_negative_dim_customers_customer_lifespan_days ....... [RUN]
[0m13:55:48.640209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213, now test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e)
[0m13:55:48.643201 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m13:55:48.667137 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m13:55:48.682140 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m13:55:48.698055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:49.274906 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
[0m13:55:49.279939 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
[0m13:55:49.285924 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:49.296849 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    avg_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:49.775226 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e32e4419-ed50-4748-b5b0-e1b105dc520d&page=queryresults
[0m13:55:49.823559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:23b55a13-33d4-4958-8ba4-f436ba95ad54&page=queryresults
[0m13:55:50.034934 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
[0m13:55:50.042915 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
[0m13:55:50.049940 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and late_delivery_rate >= 0 and late_delivery_rate <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:50.057872 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    customer_lifespan_days as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_lifespan_days < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:50.526580 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:14e65382-79cd-41dc-8750-b864f4f85cd9&page=queryresults
[0m13:55:50.568092 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7aeff272-b598-4637-b37c-d1e1b7629e5e&page=queryresults
[0m13:55:51.939211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m13:55:52.035799 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:52.093837 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m13:55:52.098785 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:52.699783 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m13:55:52.703725 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m13:55:52.706718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c9c0239f-defe-4de5-8f49-da7bb0d7ba0e&page=queryresults
[0m13:55:52.708715 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:587f6c46-b87d-4c33-b68d-6734323d80cc&page=queryresults
[0m13:55:52.745615 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:52.756545 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:53.304519 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:479e9de5-4dc3-4516-bbf4-061fdea59a5d&page=queryresults
[0m13:55:53.339674 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a979ea9b-9592-4b90-838a-38d1e663fa2c&page=queryresults
[0m13:55:53.852242 [info ] [Thread-4 (]: 76 of 98 PASS is_not_negative_dim_customers_avg_order_value .................... [[32mPASS[0m in 6.18s]
[0m13:55:53.857174 [info ] [Thread-1 (]: 74 of 98 PASS dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [[32mPASS[0m in 6.25s]
[0m13:55:53.877323 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m13:55:53.884108 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m13:55:53.888092 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m13:55:53.893079 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m13:55:53.898067 [info ] [Thread-4 (]: 78 of 98 START test is_not_negative_dim_customers_late_deliveries .............. [RUN]
[0m13:55:53.915022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178, now test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a)
[0m13:55:53.904047 [info ] [Thread-1 (]: 79 of 98 START test is_not_negative_dim_customers_lifetime_items ............... [RUN]
[0m13:55:53.922997 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m13:55:53.927985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159)
[0m13:55:53.950927 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m13:55:53.983837 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m13:55:53.993809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m13:55:53.998795 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m13:55:54.014814 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:55:54.102656 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m13:55:54.121606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:54.605442 [info ] [Thread-2 (]: 77 of 98 PASS is_not_negative_dim_customers_customer_lifespan_days ............. [[32mPASS[0m in 5.96s]
[0m13:55:54.617362 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m13:55:54.610378 [info ] [Thread-3 (]: 75 of 98 PASS dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [[32mPASS[0m in 6.94s]
[0m13:55:54.624341 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m13:55:54.630325 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m13:55:54.640301 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m13:55:54.634315 [info ] [Thread-2 (]: 80 of 98 START test is_not_negative_dim_customers_lifetime_orders .............. [RUN]
[0m13:55:54.650273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8)
[0m13:55:54.660248 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m13:55:54.645286 [info ] [Thread-3 (]: 81 of 98 START test is_not_negative_dim_customers_lifetime_revenue ............. [RUN]
[0m13:55:54.709115 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m13:55:54.711154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e)
[0m13:55:54.714154 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m13:55:54.733111 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m13:55:54.735107 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m13:55:54.756051 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:54.760043 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m13:55:54.857822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:55.793790 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
[0m13:55:55.800769 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_items as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:56.151937 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
[0m13:55:56.160879 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_orders as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:56.205617 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
[0m13:55:56.213589 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_revenue as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:56.324895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:76070197-3d2b-4d50-9ec9-eea4b492ec4d&page=queryresults
[0m13:55:56.493615 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
[0m13:55:56.498599 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    late_deliveries as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where late_deliveries < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:55:56.666522 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:92ed8a27-bc94-4bfd-ad84-ff7511f34c4d&page=queryresults
[0m13:55:56.708287 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:09fdf409-14a6-4ec4-b91b-c800456ae4da&page=queryresults
[0m13:55:56.991742 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a1ef4e7b-36e1-40f9-877e-ca24d3ed983a&page=queryresults
[0m13:55:58.933905 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m13:55:58.938892 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m13:55:58.944886 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:59.029394 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:59.192771 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m13:55:59.274063 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:59.537078 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m13:55:59.546059 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:55:59.566611 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:777fe730-6311-4234-9017-2cdf9e6ab688&page=queryresults
[0m13:55:59.734337 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8fb97689-8952-4eeb-8cac-a3a76aea20c3&page=queryresults
[0m13:55:59.916267 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f4fa1805-72fa-4ab6-9c0a-6c2c59de5913&page=queryresults
[0m13:56:00.132115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5c97b393-ef94-4c92-bd17-949d08aab8af&page=queryresults
[0m13:56:00.711020 [info ] [Thread-3 (]: 81 of 98 PASS is_not_negative_dim_customers_lifetime_revenue ................... [[32mPASS[0m in 6.00s]
[0m13:56:00.729926 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m13:56:00.724945 [info ] [Thread-2 (]: 80 of 98 PASS is_not_negative_dim_customers_lifetime_orders .................... [[32mPASS[0m in 6.07s]
[0m13:56:00.736009 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m13:56:00.742896 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m13:56:00.752866 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m13:56:00.747881 [info ] [Thread-3 (]: 82 of 98 START test is_not_negative_dim_customers_max_order_value .............. [RUN]
[0m13:56:00.764173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e, now test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c)
[0m13:56:00.759848 [info ] [Thread-2 (]: 83 of 98 START test not_null_dim_customers_avg_order_value ..................... [RUN]
[0m13:56:00.798743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8, now test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843)
[0m13:56:00.803730 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m13:56:00.767826 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m13:56:00.848608 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m13:56:00.865608 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m13:56:01.059618 [info ] [Thread-4 (]: 78 of 98 PASS is_not_negative_dim_customers_late_deliveries .................... [[32mPASS[0m in 7.14s]
[0m13:56:01.065595 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m13:56:01.070767 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m13:56:01.075571 [info ] [Thread-4 (]: 84 of 98 START test not_null_dim_customers_customer_city ....................... [RUN]
[0m13:56:01.081592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a, now test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d)
[0m13:56:01.086540 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m13:56:01.148417 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m13:56:01.139401 [info ] [Thread-1 (]: 79 of 98 PASS is_not_negative_dim_customers_lifetime_items ..................... [[32mPASS[0m in 7.21s]
[0m13:56:01.159346 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m13:56:01.163335 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:01.167324 [info ] [Thread-1 (]: 85 of 98 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:56:01.175305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159, now test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:56:01.179291 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:01.203227 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:02.226167 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m13:56:02.258080 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m13:56:02.261073 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m13:56:02.266061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:02.269050 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:02.287010 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:02.307946 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:02.407679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:03.862090 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
[0m13:56:03.866076 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
[0m13:56:03.873062 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
[0m13:56:03.886979 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:03.897999 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:03.906976 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:04.512599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:252f2939-8bc2-465d-aa8f-1cc88121d5b4&page=queryresults
[0m13:56:04.515591 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:28c0ef36-d2ca-4966-8e9e-b49e532aa697&page=queryresults
[0m13:56:04.519583 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dfd9cc82-7e61-41b8-aaba-2b0f75799c29&page=queryresults
[0m13:56:04.586947 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
[0m13:56:04.591941 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    max_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:05.093608 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0479ec52-ca65-47ad-9960-425a171588df&page=queryresults
[0m13:56:06.756402 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m13:56:06.764379 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:07.339958 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:23ebaec6-de7d-4922-a7c8-a0248271394d&page=queryresults
[0m13:56:07.525536 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m13:56:07.539693 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:07.891724 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m13:56:07.950959 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:08.149765 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d6a5246a-cb97-4af1-bfb3-27c950c2a3b6&page=queryresults
[0m13:56:08.345397 [info ] [Thread-4 (]: 84 of 98 PASS not_null_dim_customers_customer_city ............................. [[32mPASS[0m in 7.26s]
[0m13:56:08.351336 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m13:56:08.354325 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m13:56:08.357548 [info ] [Thread-4 (]: 86 of 98 START test not_null_dim_customers_customer_key ........................ [RUN]
[0m13:56:08.361376 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d, now test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411)
[0m13:56:08.365364 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m13:56:08.414235 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m13:56:08.444156 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m13:56:08.457611 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:08.539900 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa5eb67b-872c-4acf-b2ca-67adfa1f707a&page=queryresults
[0m13:56:09.458302 [info ] [Thread-2 (]: 83 of 98 PASS not_null_dim_customers_avg_order_value ........................... [[32mPASS[0m in 8.66s]
[0m13:56:09.463283 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m13:56:09.466275 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m13:56:09.471264 [info ] [Thread-2 (]: 87 of 98 START test not_null_dim_customers_customer_region ..................... [RUN]
[0m13:56:09.474255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843, now test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2)
[0m13:56:09.478247 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m13:56:09.515195 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m13:56:09.526117 [info ] [Thread-3 (]: 82 of 98 PASS is_not_negative_dim_customers_max_order_value .................... [[32mPASS[0m in 8.76s]
[0m13:56:09.533095 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m13:56:09.538087 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m13:56:09.543077 [info ] [Thread-3 (]: 88 of 98 START test not_null_dim_customers_customer_segment .................... [RUN]
[0m13:56:09.547059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c, now test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m13:56:09.551048 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m13:56:09.595980 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m13:56:09.597974 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m13:56:09.614921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:09.623290 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m13:56:09.713612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:09.809221 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
[0m13:56:09.813211 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:10.318020 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1fb6f875-1641-4c82-bf65-cda19973a300&page=queryresults
[0m13:56:10.935891 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
[0m13:56:10.942911 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_segment is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:11.481960 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:03a989d9-7076-43c8-affb-21ae42476bb4&page=queryresults
[0m13:56:12.102393 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
[0m13:56:12.108373 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:12.689646 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:249fe863-e5b6-4fc1-82dd-854240d0761e&page=queryresults
[0m13:56:13.661673 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m13:56:13.670604 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:14.250656 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:93aeac57-7dea-44b1-bd7a-37d08e54d770&page=queryresults
[0m13:56:14.410381 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m13:56:14.417359 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:14.978630 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e3556ad4-a1d4-4085-820a-a56efbb62055&page=queryresults
[0m13:56:15.584770 [info ] [Thread-3 (]: 88 of 98 PASS not_null_dim_customers_customer_segment .......................... [[32mPASS[0m in 6.04s]
[0m13:56:15.591740 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m13:56:15.595730 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m13:56:15.597722 [info ] [Thread-3 (]: 89 of 98 START test not_null_dim_customers_customer_state ...................... [RUN]
[0m13:56:15.603712 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa)
[0m13:56:15.607699 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m13:56:15.645646 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m13:56:15.676580 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m13:56:15.703506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:16.313617 [info ] [Thread-4 (]: 86 of 98 PASS not_null_dim_customers_customer_key .............................. [[32mPASS[0m in 7.95s]
[0m13:56:16.324591 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m13:56:16.328578 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m13:56:16.334563 [info ] [Thread-4 (]: 90 of 98 START test not_null_dim_customers_customer_unique_id .................. [RUN]
[0m13:56:16.341542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m13:56:16.346742 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m13:56:16.393403 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m13:56:16.400388 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m13:56:16.418337 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:17.450438 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
[0m13:56:17.456462 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:17.961023 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f2b51b16-ad42-4659-8c85-e3f3ff1301ae&page=queryresults
[0m13:56:17.977132 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
[0m13:56:17.982967 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:18.155829 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m13:56:18.163800 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:18.537602 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:75b279f3-24fb-4527-a2cf-b7c5b6f36426&page=queryresults
[0m13:56:18.780922 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:91f4b5c5-1123-46e1-8fff-40857c8b4a73&page=queryresults
[0m13:56:20.089896 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m13:56:20.102862 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:20.094928 [info ] [Thread-2 (]: 87 of 98 PASS not_null_dim_customers_customer_region ........................... [[32mPASS[0m in 10.62s]
[0m13:56:20.118822 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m13:56:20.126519 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m13:56:20.130793 [info ] [Thread-2 (]: 91 of 98 START test not_null_dim_customers_lifetime_items ...................... [RUN]
[0m13:56:20.141764 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a)
[0m13:56:20.145747 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m13:56:20.206629 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m13:56:20.220548 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m13:56:20.241542 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:20.651004 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eb338716-d21c-4624-b0ec-cbcc4e7085d9&page=queryresults
[0m13:56:20.816535 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m13:56:20.826981 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:21.341010 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:473e9a95-b0dd-410b-9133-7df22a4f3786&page=queryresults
[0m13:56:21.687411 [info ] [Thread-3 (]: 89 of 98 PASS not_null_dim_customers_customer_state ............................ [[32mPASS[0m in 6.08s]
[0m13:56:21.691399 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m13:56:21.695349 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:21.699347 [info ] [Thread-3 (]: 92 of 98 START test not_null_dim_customers_lifetime_orders ..................... [RUN]
[0m13:56:21.705470 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:56:21.709354 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:21.742219 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:21.746212 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:21.770190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:22.776719 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
[0m13:56:22.790682 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:22.785658 [info ] [Thread-4 (]: 90 of 98 PASS not_null_dim_customers_customer_unique_id ........................ [[32mPASS[0m in 6.44s]
[0m13:56:22.804604 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m13:56:22.809590 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m13:56:22.816766 [info ] [Thread-4 (]: 93 of 98 START test not_null_dim_customers_lifetime_revenue .................... [RUN]
[0m13:56:22.823553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105)
[0m13:56:22.828541 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m13:56:22.875415 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m13:56:22.889375 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m13:56:22.917301 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:23.287996 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:debcb65d-4849-4cc4-bbea-2c16c123ae4b&page=queryresults
[0m13:56:24.442312 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
[0m13:56:24.448297 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:24.458923 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
[0m13:56:24.468896 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:25.001349 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6d3a5966-a58e-4800-8bbc-92dd199ab7a6&page=queryresults
[0m13:56:25.004345 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:093c26b3-b1d0-4dc6-9372-f95f2d6e5431&page=queryresults
[0m13:56:25.382326 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m13:56:25.400932 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:25.998336 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c827911-a112-47ec-95de-fab1884c22a1&page=queryresults
[0m13:56:26.901582 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m13:56:26.918536 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:26.940919 [info ] [Thread-2 (]: 91 of 98 PASS not_null_dim_customers_lifetime_items ............................ [[32mPASS[0m in 6.80s]
[0m13:56:26.945961 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m13:56:26.949903 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m13:56:26.952889 [info ] [Thread-2 (]: 94 of 98 START test not_null_dim_customers_max_order_value ..................... [RUN]
[0m13:56:26.957877 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a, now test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8)
[0m13:56:26.960875 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m13:56:27.001992 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m13:56:27.011732 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m13:56:27.040705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:27.304869 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:27.311810 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:27.472669 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0dc5eb21-ee1c-4c13-a737-2cac542ab752&page=queryresults
[0m13:56:28.099445 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:338de5b8-6dc6-45ad-bf2b-645f10e92523&page=queryresults
[0m13:56:28.525328 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
[0m13:56:28.533312 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:28.550259 [info ] [Thread-4 (]: 93 of 98 PASS not_null_dim_customers_lifetime_revenue .......................... [[32mPASS[0m in 5.73s]
[0m13:56:28.556248 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m13:56:28.560230 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m13:56:28.563666 [info ] [Thread-4 (]: 95 of 98 START test not_null_dim_customers_purchase_frequency .................. [RUN]
[0m13:56:28.570216 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105, now test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093)
[0m13:56:28.574245 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m13:56:28.612097 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m13:56:28.624910 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m13:56:28.655878 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:29.177127 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b410a158-f27a-4d91-b15f-6c779ab736d0&page=queryresults
[0m13:56:29.186096 [info ] [Thread-3 (]: 92 of 98 PASS not_null_dim_customers_lifetime_orders ........................... [[32mPASS[0m in 7.48s]
[0m13:56:29.199064 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:29.203049 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:29.206043 [info ] [Thread-3 (]: 96 of 98 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:56:29.211030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:56:29.216017 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:29.274863 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:29.288820 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:29.310815 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:56:30.762880 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
[0m13:56:30.769964 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
[0m13:56:30.775852 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:30.785820 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where purchase_frequency is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:30.811228 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:30.821161 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:31.275905 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4d5927f5-3399-4c5f-965a-ecf3cef8ab31&page=queryresults
[0m13:56:31.340685 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c05513a-5a15-4b05-b850-b53c825b1463&page=queryresults
[0m13:56:31.454174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a5c920f8-e79a-401f-924a-19fb0aaa5ee6&page=queryresults
[0m13:56:32.599961 [info ] [Thread-1 (]: 85 of 98 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 31.42s]
[0m13:56:32.606987 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:32.610948 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:32.615919 [info ] [Thread-1 (]: 97 of 98 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:56:32.620904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:56:32.623898 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:32.670772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:32.739101 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:32.760099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:33.587790 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m13:56:33.596722 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:34.117147 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
[0m13:56:34.123135 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:34.166021 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2f2aab50-10e9-498a-9a58-e48078a99513&page=queryresults
[0m13:56:34.573310 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:34.581333 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:35.091802 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ae77fac9-7e8e-454e-a0d7-4ee63381b947&page=queryresults
[0m13:56:35.135088 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8460b31-c722-414f-a94d-8de704f0b5e5&page=queryresults
[0m13:56:35.257396 [info ] [Thread-4 (]: 95 of 98 PASS not_null_dim_customers_purchase_frequency ........................ [[32mPASS[0m in 6.69s]
[0m13:56:35.265750 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m13:56:35.270316 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m13:56:35.275310 [info ] [Thread-4 (]: 98 of 98 START test unique_dim_customers_customer_key .......................... [RUN]
[0m13:56:35.281290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093, now test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e)
[0m13:56:35.286275 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m13:56:35.338181 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m13:56:35.354093 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m13:56:35.376085 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:56:36.192974 [info ] [Thread-3 (]: 96 of 98 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 6.98s]
[0m13:56:36.201915 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:36.790895 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
[0m13:56:36.799833 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m13:56:37.158575 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:37.168554 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:37.231478 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3b65ee23-68e8-4e57-8631-c25d11bd6440&page=queryresults
[0m13:56:37.737131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:de3accd9-51a3-42c2-80ef-6a401892da76&page=queryresults
[0m13:56:39.207764 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m13:56:39.223717 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:56:39.505963 [info ] [Thread-1 (]: 97 of 98 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 6.88s]
[0m13:56:39.513940 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:39.836351 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:28f26f47-374d-4b38-aabf-c0bbbd06623d&page=queryresults
[0m13:56:40.958031 [info ] [Thread-4 (]: 98 of 98 PASS unique_dim_customers_customer_key ................................ [[32mPASS[0m in 5.68s]
[0m13:56:40.994932 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m13:59:34.890311 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m13:59:34.900287 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m13:59:35.620939 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9efc554b-3bd2-4e83-9fd2-ab9eccce9af4&page=queryresults
[0m13:59:36.824813 [info ] [Thread-2 (]: 94 of 98 PASS not_null_dim_customers_max_order_value ........................... [[32mPASS[0m in 189.87s]
[0m13:59:36.833789 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m13:59:36.840731 [info ] [MainThread]: 
[0m13:59:36.940490 [info ] [MainThread]: ============================================================
[0m13:59:36.942542 [info ] [MainThread]: DBT RUN COMPLETED
[0m13:59:36.947443 [info ] [MainThread]: Success: 5
[0m13:59:36.949969 [info ] [MainThread]: Errors: 0
[0m13:59:36.952428 [info ] [MainThread]: Skipped: 0
[0m13:59:36.954423 [info ] [MainThread]: Total: 98
[0m13:59:36.956443 [info ] [MainThread]: ============================================================
[0m13:59:36.957440 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m13:59:36.959530 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m13:59:36.964397 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.12s]
[0m13:59:36.966390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:36.971376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:36.973371 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m13:59:36.975370 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m13:59:36.976476 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m13:59:36.980351 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m13:59:36.982977 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m13:59:36.984867 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m13:59:36.985339 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m13:59:36.986887 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m13:59:36.987332 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m13:59:36.989605 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8' was properly closed.
[0m13:59:36.990326 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m13:59:36.991432 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e' was properly closed.
[0m13:59:37.020131 [info ] [MainThread]: 
[0m13:59:37.022132 [info ] [MainThread]: Finished running 2 project hooks, 1 table model, 90 data tests, 3 unit tests, 4 view models in 0 hours 8 minutes and 59.73 seconds (539.73s).
[0m13:59:37.099964 [debug] [MainThread]: Command end result
[0m13:59:37.344953 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m13:59:37.381646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m13:59:37.418368 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m13:59:37.419364 [info ] [MainThread]: 
[0m13:59:37.420365 [info ] [MainThread]: [33mCompleted with 5 warnings:[0m
[0m13:59:37.422356 [info ] [MainThread]: 
[0m13:59:37.424352 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models\staging\_staging.yml)[0m
[0m13:59:37.426349 [warn ] [MainThread]: Got 642 results, configured to warn if != 0
[0m13:59:37.431334 [info ] [MainThread]: 
[0m13:59:37.433329 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f.sql
[0m13:59:37.435433 [info ] [MainThread]: 
[0m13:59:37.437320 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m13:59:37.441307 [info ] [MainThread]: 
[0m13:59:37.448374 [warn ] [MainThread]: [33mWarning in test assert_orders_have_items (tests\singular\assert_orders_have_items.sql)[0m
[0m13:59:37.453275 [warn ] [MainThread]: Got 890 results, configured to warn if != 0
[0m13:59:37.455269 [info ] [MainThread]: 
[0m13:59:37.457264 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\tests\singular\assert_orders_have_items.sql
[0m13:59:37.459260 [info ] [MainThread]: 
[0m13:59:37.466273 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
  --------------------------------------------------------------------------------------------------
[0m13:59:37.469267 [info ] [MainThread]: 
[0m13:59:37.471227 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null (models\staging\_staging.yml)[0m
[0m13:59:37.473224 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m13:59:37.475216 [info ] [MainThread]: 
[0m13:59:37.479219 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43.sql
[0m13:59:37.484503 [info ] [MainThread]: 
[0m13:59:37.487306 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
  -----------------------------------------------------------------------------------------------------------------------------------------
[0m13:59:37.492171 [info ] [MainThread]: 
[0m13:59:37.497862 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\staging\_staging.yml)[0m
[0m13:59:37.499289 [warn ] [MainThread]: Got 902 results, configured to warn if != 0
[0m13:59:37.501150 [info ] [MainThread]: 
[0m13:59:37.503141 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m13:59:37.505136 [info ] [MainThread]: 
[0m13:59:37.507871 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
  -----------------------------------------------------------------------------------------------------------------------------------
[0m13:59:37.514167 [info ] [MainThread]: 
[0m13:59:37.517107 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models\staging\_staging.yml)[0m
[0m13:59:37.521094 [warn ] [MainThread]: Got 862 results, configured to warn if != 0
[0m13:59:37.524341 [info ] [MainThread]: 
[0m13:59:37.526079 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0.sql
[0m13:59:37.530069 [info ] [MainThread]: 
[0m13:59:37.532180 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m13:59:37.535058 [info ] [MainThread]: 
[0m13:59:37.537068 [info ] [MainThread]: Done. PASS=95 WARN=5 ERROR=0 SKIP=0 NO-OP=0 TOTAL=100
[0m13:59:37.542045 [debug] [MainThread]: Command `dbt build` succeeded at 13:59:37.542045 after 590.07 seconds
[0m13:59:37.546027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384EE52C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386503FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384D761350>]}
[0m13:59:37.548021 [debug] [MainThread]: Flushing usage events
[0m13:59:40.302636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:41.508138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AAEF5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AAEF7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AAEF4590>]}


============================== 14:00:41.755186 | 89ef0619-aee7-4483-bbfc-d75fbf9a6120 ==============================
[0m14:00:41.755186 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:00:41.760127 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt ls --select state:modified+ --state prod-artifacts/', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m14:02:05.558267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89ef0619-aee7-4483-bbfc-d75fbf9a6120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C093E890>]}
[0m14:02:05.771691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89ef0619-aee7-4483-bbfc-d75fbf9a6120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247A66E4A90>]}
[0m14:02:05.774682 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:02:08.152553 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:02:12.550072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:12.552231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:12.752560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ef0619-aee7-4483-bbfc-d75fbf9a6120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C0C0A910>]}
[0m14:02:13.340247 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:02:13.349290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:02:14.073509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ef0619-aee7-4483-bbfc-d75fbf9a6120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C1065090>]}
[0m14:02:14.075504 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m14:02:14.077498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ef0619-aee7-4483-bbfc-d75fbf9a6120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C1146A10>]}
[0m14:02:14.086504 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m14:02:14.088469 [warn ] [MainThread]: No nodes selected!
[0m14:02:14.093459 [debug] [MainThread]: Command `dbt ls` succeeded at 14:02:14.093459 after 93.66 seconds
[0m14:02:14.094456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AAF5D110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AAF5DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247AAF5D150>]}
[0m14:02:14.095896 [debug] [MainThread]: Flushing usage events
[0m14:02:15.490546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:33.759387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB98F6A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB96F1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB96F1450>]}


============================== 14:05:33.767207 | 94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9 ==============================
[0m14:05:33.767207 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:05:33.769172 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m14:05:41.989705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCF36E3D0>]}
[0m14:05:42.115399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB50E4590>]}
[0m14:05:42.116893 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:05:43.579453 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:05:44.296536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:44.297534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:44.488054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCF357010>]}
[0m14:05:44.886959 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:05:44.893941 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:05:45.154358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB4FF8950>]}
[0m14:05:45.156352 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m14:05:45.188299 [info ] [MainThread]: 
[0m14:05:45.189323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:45.194350 [info ] [MainThread]: 
[0m14:05:45.196245 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:45.230262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:05:45.231153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:45.233148 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:05:45.235141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:05:45.237136 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:05:45.289071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:45.294023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:45.294981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:47.898378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:47.989280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:52.583733 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m14:05:52.585868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:52.588679 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m14:05:52.591717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m14:05:52.598191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m14:05:52.672451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:52.675446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:52.677438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:54.787365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m14:05:54.793548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:55.360271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit, now list_big-query-dbt-481111_snapshots)
[0m14:05:55.400166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:58.962785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCE7A4810>]}
[0m14:05:59.018586 [info ] [MainThread]: ============================================================
[0m14:05:59.021714 [info ] [MainThread]: DBT RUN STARTED
[0m14:05:59.026701 [info ] [MainThread]: Target: dev
[0m14:05:59.029694 [info ] [MainThread]: Project: dbt_advanced_olist
[0m14:05:59.033681 [info ] [MainThread]: Time: 2025-12-24 14:05:59
[0m14:05:59.036673 [info ] [MainThread]: ============================================================
[0m14:05:59.042663 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m14:05:59.069636 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m14:05:59.076571 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.11s]
[0m14:05:59.081553 [info ] [MainThread]: 
[0m14:05:59.086736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:59.164727 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m14:05:59.166722 [debug] [Thread-2 (]: Began running node seed.dbt_advanced_olist.brazilian_states
[0m14:05:59.167720 [debug] [Thread-3 (]: Began running node seed.dbt_advanced_olist.order_status_codes
[0m14:05:59.169209 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:05:59.172707 [info ] [Thread-1 (]: 1 of 148 START sql table model dbt_dev_yourname_marts.dim_date ................. [RUN]
[0m14:05:59.176696 [info ] [Thread-2 (]: 2 of 148 START seed file dbt_dev_yourname_seeds.brazilian_states ............... [RUN]
[0m14:05:59.179533 [info ] [Thread-3 (]: 3 of 148 START seed file dbt_dev_yourname_seeds.order_status_codes ............. [RUN]
[0m14:05:59.186389 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m14:05:59.191379 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.brazilian_states'
[0m14:05:59.183404 [info ] [Thread-4 (]: 4 of 148 START test dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [RUN]
[0m14:05:59.196366 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.order_status_codes'
[0m14:05:59.198360 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m14:05:59.201352 [debug] [Thread-2 (]: Began compiling node seed.dbt_advanced_olist.brazilian_states
[0m14:05:59.203344 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0'
[0m14:05:59.209331 [debug] [Thread-3 (]: Began compiling node seed.dbt_advanced_olist.order_status_codes
[0m14:05:59.283242 [debug] [Thread-2 (]: Began executing node seed.dbt_advanced_olist.brazilian_states
[0m14:05:59.293104 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m14:05:59.295731 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:05:59.297773 [debug] [Thread-3 (]: Began executing node seed.dbt_advanced_olist.order_status_codes
[0m14:05:59.367540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:59.434748 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m14:05:59.517956 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:05:59.561838 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:59.870624 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:59.875652 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:06:02.031586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f2bd10db-d2bd-480d-bd1e-b3b78080cfb2&page=queryresults
[0m14:06:03.143497 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
[0m14:06:03.262219 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`raw_olist`.`customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:03.293098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m14:06:03.296133 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m14:06:03.965343 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m14:06:03.975272 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7dd30162-d396-4f50-b2dc-4e36c231f1ef&page=queryresults
[0m14:06:03.992603 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(date_key, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m14:06:04.664352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4fc6f0cf-6990-493d-abea-47273a83880e&page=queryresults
[0m14:06:06.265719 [debug] [Thread-2 (]: On seed.dbt_advanced_olist.brazilian_states: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states` set OPTIONS()
/* dbt 1.10.15 | model: brazilian_states | schema: dbt_dev_yourname_seeds */
[0m14:06:06.272702 [debug] [Thread-3 (]: On seed.dbt_advanced_olist.order_status_codes: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes` set OPTIONS()
/* dbt 1.10.15 | model: order_status_codes | schema: dbt_dev_yourname_seeds */
[0m14:06:06.746893 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c20fbaea-2f6e-4997-ab0c-7fbf6e873d71&page=queryresults
[0m14:06:06.749522 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:81f11101-53c3-45b2-910e-8bb26ee2ca24&page=queryresults
[0m14:06:07.417145 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.order_status_codes"
[0m14:06:07.425120 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.brazilian_states"
[0m14:06:07.541757 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD061B990>]}
[0m14:06:07.542785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD09D3E50>]}
[0m14:06:07.543820 [info ] [Thread-2 (]: 2 of 148 OK loaded seed file dbt_dev_yourname_seeds.brazilian_states ........... [[32mINSERT 27[0m in 8.35s]
[0m14:06:07.546865 [debug] [Thread-2 (]: Finished running node seed.dbt_advanced_olist.brazilian_states
[0m14:06:07.545746 [info ] [Thread-3 (]: 3 of 148 OK loaded seed file dbt_dev_yourname_seeds.order_status_codes ......... [[32mINSERT 8[0m in 8.35s]
[0m14:06:07.548739 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:06:07.550733 [debug] [Thread-3 (]: Finished running node seed.dbt_advanced_olist.order_status_codes
[0m14:06:07.554364 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:06:07.551459 [info ] [Thread-2 (]: 5 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [RUN]
[0m14:06:07.558328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.brazilian_states, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb)
[0m14:06:07.557328 [info ] [Thread-3 (]: 6 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [RUN]
[0m14:06:07.560488 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:06:07.561694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.order_status_codes, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d)
[0m14:06:07.599893 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m14:06:07.601671 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:06:07.617629 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m14:06:07.621619 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:06:07.633589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:07.635581 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:06:07.696448 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:08.479883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD03EC050>]}
[0m14:06:08.483874 [info ] [Thread-1 (]: 1 of 148 OK created sql table model dbt_dev_yourname_marts.dim_date ............ [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 9.29s]
[0m14:06:08.491897 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m14:06:08.493912 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:06:08.496837 [info ] [Thread-1 (]: 7 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [RUN]
[0m14:06:08.499858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_date, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529)
[0m14:06:08.504818 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:06:08.542715 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m14:06:08.546705 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:06:08.561663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:08.843447 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
[0m14:06:08.846694 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
[0m14:06:08.850425 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and freight_value >= 0 and freight_value <= 1000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:08.857362 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price >= 0 and price <= 10000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:09.427770 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:06fe2f7b-c964-4c12-aa30-2b90e507310f&page=queryresults
[0m14:06:09.429999 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ee803b3-79bd-4e9b-adf7-06d7a88a71d7&page=queryresults
[0m14:06:09.976320 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
[0m14:06:09.983302 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and product_weight_g >= 0 and product_weight_g <= 100000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`products`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:10.862707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e985e2c5-0a96-4d01-9817-634a6a2dd1b3&page=queryresults
[0m14:06:12.940868 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m14:06:12.943865 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m14:06:12.975918 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:12.980898 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:13.848850 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8306893-ba3b-4a30-98d8-edcef86d4994&page=queryresults
[0m14:06:13.853836 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:49a998d0-7ffd-4abf-90f7-3e607eca363f&page=queryresults
[0m14:06:14.246005 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m14:06:14.259966 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:15.381831 [info ] [Thread-3 (]: 6 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [[32mPASS[0m in 7.82s]
[0m14:06:15.394893 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:06:15.386816 [info ] [Thread-2 (]: 5 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [[32mPASS[0m in 7.83s]
[0m14:06:15.399780 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:06:15.405764 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:06:15.413744 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:06:15.409757 [info ] [Thread-3 (]: 8 of 148 START test dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [RUN]
[0m14:06:15.423718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936)
[0m14:06:15.431696 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:06:15.419022 [info ] [Thread-2 (]: 9 of 148 START test source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:06:15.478571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb, now test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c)
[0m14:06:15.510481 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:15.512505 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:06:15.592292 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m14:06:15.616436 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:06:15.633384 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:15.712819 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:42535b3e-9fff-49e9-95c2-cd511d1d121b&page=queryresults
[0m14:06:16.818245 [info ] [Thread-1 (]: 7 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [[32mPASS[0m in 8.32s]
[0m14:06:16.826228 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:06:16.829223 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:06:16.833210 [info ] [Thread-1 (]: 10 of 148 START test source_not_null_raw_olist_customers_customer_city ......... [RUN]
[0m14:06:16.838193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a)
[0m14:06:16.842183 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:06:16.883115 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m14:06:16.891050 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:06:16.909998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:16.978442 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
[0m14:06:16.982475 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`raw_olist`.`orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:17.593798 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3bca4505-89eb-46dc-bef1-e029e24d7259&page=queryresults
[0m14:06:18.171902 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
[0m14:06:18.177884 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:18.468392 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m14:06:18.475150 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:06:18.762078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c4e5bea5-797c-4e5c-abe8-01074e2a3770&page=queryresults
[0m14:06:18.805513 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
[0m14:06:18.812492 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
      
    
    

    
    OPTIONS()
    as (
      
    
  with relation_columns as (

        
        select
            cast('ORDER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CUSTOMER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_STATUS' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_PURCHASE_TIMESTAMP' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_APPROVED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CARRIER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CUSTOMER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_ESTIMATED_DELIVERY_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PURCHASE_TIMESTAMP'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:19.354612 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0f0e6531-7a2e-4def-ad1c-0dc2320fef50&page=queryresults
[0m14:06:21.025188 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m14:06:21.162095 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:21.407312 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m14:06:21.415294 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:22.324148 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m14:06:22.330127 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f7515703-93f3-427a-8100-1f328202869f&page=queryresults
[0m14:06:22.337108 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:22.340146 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:979f47b2-23bc-4230-83ef-85dbd58e62f5&page=queryresults
[0m14:06:22.961187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:94c3d361-127b-4834-8d7a-4ac70db0e38d&page=queryresults
[0m14:06:23.540360 [info ] [Thread-3 (]: 8 of 148 PASS dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [[32mPASS[0m in 8.12s]
[0m14:06:23.544395 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:06:23.547647 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:06:23.551331 [info ] [Thread-3 (]: 11 of 148 START test source_not_null_raw_olist_customers_customer_id ........... [RUN]
[0m14:06:23.554633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c)
[0m14:06:23.557315 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:06:23.589228 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m14:06:23.593223 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:06:23.610219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:23.698979 [info ] [Thread-2 (]: 9 of 148 PASS source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 8.22s]
[0m14:06:23.705920 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:06:23.707912 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:06:23.709909 [info ] [Thread-2 (]: 12 of 148 START test source_not_null_raw_olist_customers_customer_state ........ [RUN]
[0m14:06:23.712251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de)
[0m14:06:23.713916 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:06:23.736835 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m14:06:23.740824 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:06:23.752792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:24.130805 [info ] [Thread-1 (]: 10 of 148 PASS source_not_null_raw_olist_customers_customer_city ............... [[32mPASS[0m in 7.29s]
[0m14:06:24.142842 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:06:24.145835 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:06:24.150010 [info ] [Thread-1 (]: 13 of 148 START test source_not_null_raw_olist_customers_customer_unique_id .... [RUN]
[0m14:06:24.155736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30)
[0m14:06:24.159901 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:06:24.205606 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m14:06:24.230322 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:06:24.255906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.169801 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
[0m14:06:25.173791 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:25.397638 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
[0m14:06:25.402627 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:25.522382 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
[0m14:06:25.525402 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:25.719313 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ec233169-af74-497f-9716-2ea928c5cf16&page=queryresults
[0m14:06:26.023764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b368ec46-0b58-4efc-9313-8285ecdbf434&page=queryresults
[0m14:06:26.072200 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e2eaaf89-3719-484e-99c8-edd342e6e4d5&page=queryresults
[0m14:06:27.821424 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m14:06:27.837381 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:28.272222 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m14:06:28.277169 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m14:06:28.301732 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:28.306719 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:28.413187 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c7428db4-b926-45b5-b8b7-c0b8272e07a9&page=queryresults
[0m14:06:28.946461 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:30891e2e-60ba-45a1-8a27-d14ec8c63d7b&page=queryresults
[0m14:06:28.952447 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9844f335-e8a7-483d-bcc1-0618fcf4df74&page=queryresults
[0m14:06:29.330425 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m14:06:29.342392 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:29.355355 [info ] [Thread-2 (]: 12 of 148 PASS source_not_null_raw_olist_customers_customer_state .............. [[32mPASS[0m in 5.64s]
[0m14:06:29.358350 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:06:29.360343 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:06:29.362338 [info ] [Thread-2 (]: 14 of 148 START test source_not_null_raw_olist_order_items_freight_value ....... [RUN]
[0m14:06:29.364986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5)
[0m14:06:29.367390 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:06:29.390262 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m14:06:29.414200 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:06:29.426166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:30.106151 [info ] [Thread-3 (]: 11 of 148 PASS source_not_null_raw_olist_customers_customer_id ................. [[32mPASS[0m in 6.55s]
[0m14:06:30.114615 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3ebb22a5-457f-48e9-83c8-bf86d36f88f1&page=queryresults
[0m14:06:30.110144 [info ] [Thread-1 (]: 13 of 148 PASS source_not_null_raw_olist_customers_customer_unique_id .......... [[32mPASS[0m in 5.95s]
[0m14:06:30.129884 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:06:30.153114 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:06:30.158496 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:06:30.164480 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:06:30.170465 [info ] [Thread-3 (]: 15 of 148 START test source_not_null_raw_olist_order_items_order_id ............ [RUN]
[0m14:06:30.212351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37)
[0m14:06:30.216340 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:06:30.241500 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m14:06:30.175452 [info ] [Thread-1 (]: 16 of 148 START test source_not_null_raw_olist_order_items_order_item_id ....... [RUN]
[0m14:06:30.247256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c)
[0m14:06:30.244264 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:06:30.251246 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:06:30.290427 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:30.312083 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m14:06:30.316087 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:06:30.341206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:30.847643 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
[0m14:06:30.870584 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where freight_value is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:31.340066 [info ] [Thread-4 (]: 4 of 148 PASS dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [[32mPASS[0m in 32.14s]
[0m14:06:31.345053 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:06:31.347345 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:06:31.351039 [info ] [Thread-4 (]: 17 of 148 START test source_not_null_raw_olist_order_items_price ............... [RUN]
[0m14:06:31.356026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9)
[0m14:06:31.359016 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:06:31.385946 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m14:06:31.388936 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f5c6e598-b474-462b-b072-f0494255e3a2&page=queryresults
[0m14:06:31.391929 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:06:31.404893 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:31.779187 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
[0m14:06:31.787119 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:32.469598 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3e047fe5-ab17-4a8c-8da5-16b99be59830&page=queryresults
[0m14:06:32.885005 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
[0m14:06:32.890994 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
[0m14:06:32.895980 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where price is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:32.909938 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_item_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:33.623153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c04bee8-0622-4d96-ac84-711cac15df66&page=queryresults
[0m14:06:33.626143 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1de9acd5-27bd-4264-b6bd-81a39a48717e&page=queryresults
[0m14:06:34.010996 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m14:06:34.035929 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:34.518653 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m14:06:34.523643 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:34.655113 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6409a06e-dd2c-4e26-841c-2cef4b5d7a28&page=queryresults
[0m14:06:35.464861 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m14:06:35.472839 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:35.788096 [info ] [Thread-2 (]: 14 of 148 PASS source_not_null_raw_olist_order_items_freight_value ............. [[32mPASS[0m in 6.42s]
[0m14:06:35.794075 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:06:35.804049 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:06:35.809035 [info ] [Thread-2 (]: 18 of 148 START test source_not_null_raw_olist_order_items_product_id .......... [RUN]
[0m14:06:35.813073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29)
[0m14:06:35.818012 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:06:35.854912 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m14:06:35.859902 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:06:35.885829 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:36.257368 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m14:06:36.260309 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1f61b5d2-a078-400a-898b-38ade84ee962&page=queryresults
[0m14:06:36.269743 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:36.620336 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e2284757-f5b0-49b4-ba68-b9a9572a6161&page=queryresults
[0m14:06:37.311788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bbc53dcb-6dd7-436f-ac54-64cb3697889a&page=queryresults
[0m14:06:37.378379 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
[0m14:06:37.373268 [info ] [Thread-4 (]: 17 of 148 PASS source_not_null_raw_olist_order_items_price ..................... [[32mPASS[0m in 6.02s]
[0m14:06:37.386237 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:37.390757 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:06:37.401733 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:06:37.406719 [info ] [Thread-4 (]: 19 of 148 START test source_not_null_raw_olist_orders_customer_id .............. [RUN]
[0m14:06:37.411703 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02)
[0m14:06:37.416687 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:06:37.446607 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m14:06:37.457579 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:06:37.486551 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:37.691749 [info ] [Thread-3 (]: 15 of 148 PASS source_not_null_raw_olist_order_items_order_id .................. [[32mPASS[0m in 7.48s]
[0m14:06:37.702725 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:06:37.706664 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:06:37.710651 [info ] [Thread-3 (]: 20 of 148 START test source_not_null_raw_olist_orders_order_id ................. [RUN]
[0m14:06:37.716637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b)
[0m14:06:37.721623 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:06:37.759520 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m14:06:37.769497 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:06:37.792437 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:37.897091 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d3fd4141-a87c-4f2a-81bc-0a69b096075c&page=queryresults
[0m14:06:38.457224 [info ] [Thread-1 (]: 16 of 148 PASS source_not_null_raw_olist_order_items_order_item_id ............. [[32mPASS[0m in 8.21s]
[0m14:06:38.473175 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:06:38.478163 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:06:38.484098 [info ] [Thread-1 (]: 21 of 148 START test source_not_null_raw_olist_orders_order_purchase_timestamp . [RUN]
[0m14:06:38.500245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5)
[0m14:06:38.505930 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:06:38.558945 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m14:06:38.586870 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:06:38.601828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:38.825975 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
[0m14:06:38.835915 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:39.205156 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
[0m14:06:39.212136 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:40.028942 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
[0m14:06:40.034882 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fafcf02d-94b0-4abb-ac3c-a6b9a80effb0&page=queryresults
[0m14:06:40.040153 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1be8dae8-3151-49eb-aded-bcb9839fcb5a&page=queryresults
[0m14:06:40.044896 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m14:06:40.051835 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_purchase_timestamp is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:40.071477 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:40.599235 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:efd7bd49-075f-4349-849b-4d9c9bdd8c79&page=queryresults
[0m14:06:40.724339 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d9292442-9bdc-46c2-8fae-f1c31ce5dbe2&page=queryresults
[0m14:06:41.901712 [info ] [Thread-2 (]: 18 of 148 PASS source_not_null_raw_olist_order_items_product_id ................ [[32mPASS[0m in 6.09s]
[0m14:06:41.911722 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:06:41.916668 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:06:41.921657 [info ] [Thread-2 (]: 22 of 148 START test source_not_null_raw_olist_orders_order_status ............. [RUN]
[0m14:06:41.925883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a)
[0m14:06:41.930761 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:06:41.973557 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m14:06:41.980671 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:06:42.023425 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:42.423415 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m14:06:42.427447 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m14:06:42.443361 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:42.448349 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:43.127957 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m14:06:43.131947 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9486a093-5baf-4fea-82f8-754937a3fd48&page=queryresults
[0m14:06:43.135936 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7813628f-be2a-4753-9f19-f875e31497ca&page=queryresults
[0m14:06:43.173690 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:43.917026 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
[0m14:06:43.935979 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:43.941963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bbd63cea-8228-4fb4-8a7b-f28f26be46d1&page=queryresults
[0m14:06:45.005931 [info ] [Thread-3 (]: 20 of 148 PASS source_not_null_raw_olist_orders_order_id ....................... [[32mPASS[0m in 7.29s]
[0m14:06:45.013908 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:06:45.019128 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:06:45.023804 [info ] [Thread-3 (]: 23 of 148 START test source_not_null_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m14:06:45.027895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1)
[0m14:06:45.034853 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:06:45.053803 [info ] [Thread-4 (]: 19 of 148 PASS source_not_null_raw_olist_orders_customer_id .................... [[32mPASS[0m in 7.64s]
[0m14:06:45.072977 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:06:45.109703 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:06:45.124658 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m14:06:45.129599 [info ] [Thread-4 (]: 24 of 148 START test source_not_null_raw_olist_product_category_name_translation_string_field_1  [RUN]
[0m14:06:45.136581 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:06:45.139572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841)
[0m14:06:45.156528 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:45.158519 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:06:45.231326 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m14:06:45.237313 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:06:45.251313 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:45.428057 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1ff29567-61ec-4562-aaa9-b73e2ca297c9&page=queryresults
[0m14:06:46.167637 [info ] [Thread-1 (]: 21 of 148 PASS source_not_null_raw_olist_orders_order_purchase_timestamp ....... [[32mPASS[0m in 7.67s]
[0m14:06:46.172156 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:06:46.173642 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:06:46.174618 [info ] [Thread-1 (]: 25 of 148 START test source_not_null_raw_olist_products_product_id ............. [RUN]
[0m14:06:46.176613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5, now test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf)
[0m14:06:46.178607 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:06:46.191571 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m14:06:46.200325 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:06:46.222490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:46.885969 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m14:06:46.902880 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:47.154691 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
[0m14:06:47.164794 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_1 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:47.205379 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
[0m14:06:47.210364 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_0 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:47.535364 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
[0m14:06:47.539357 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:47.543297 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e4b5b8f3-5df7-4cf8-8fd8-039e2c936454&page=queryresults
[0m14:06:47.725595 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e637d50d-e988-4fb2-ad7e-01473dc9eefc&page=queryresults
[0m14:06:47.730015 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b192d997-cc23-4b30-b8fd-f631d1b75585&page=queryresults
[0m14:06:48.039042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:002cd2bf-48a2-44b1-88c4-010e0db89ff5&page=queryresults
[0m14:06:48.676442 [info ] [Thread-2 (]: 22 of 148 PASS source_not_null_raw_olist_orders_order_status ................... [[32mPASS[0m in 6.75s]
[0m14:06:48.684466 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:06:48.687444 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:06:48.693399 [info ] [Thread-2 (]: 26 of 148 START test source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [RUN]
[0m14:06:48.706365 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5)
[0m14:06:48.713777 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:06:48.817066 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m14:06:48.820058 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:06:48.827038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:49.949649 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m14:06:49.954299 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:50.200554 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m14:06:50.208531 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:50.267783 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
[0m14:06:50.272769 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:50.529451 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8f7081e5-bbb7-405d-a651-2c7174ae3551&page=queryresults
[0m14:06:51.818528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:51ab8369-c663-4615-8742-01fbf15c3e3f&page=queryresults
[0m14:06:51.827984 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a43f3801-e425-4e9c-8e3e-3d0f385f416e&page=queryresults
[0m14:06:52.629265 [info ] [Thread-4 (]: 24 of 148 PASS source_not_null_raw_olist_product_category_name_translation_string_field_1  [[32mPASS[0m in 7.49s]
[0m14:06:52.641049 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:06:52.642049 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:06:52.645039 [info ] [Thread-4 (]: 27 of 148 START test source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [RUN]
[0m14:06:52.651024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8)
[0m14:06:52.653017 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:06:52.673972 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m14:06:52.701926 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:06:52.728848 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:52.939989 [info ] [Thread-1 (]: 25 of 148 PASS source_not_null_raw_olist_products_product_id ................... [[32mPASS[0m in 6.76s]
[0m14:06:52.950961 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:06:52.956943 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:06:52.963253 [info ] [Thread-1 (]: 28 of 148 START test source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [RUN]
[0m14:06:52.972900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf, now test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543)
[0m14:06:52.979888 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:06:53.042713 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m14:06:53.048705 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:06:53.059667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:53.303746 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m14:06:53.310777 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:54.020983 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:86964bd0-295f-4d8a-8074-ab147384df32&page=queryresults
[0m14:06:54.875563 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
[0m14:06:54.887495 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:55.415890 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:956e040a-a224-47b4-94fe-e0e61b44fcbc&page=queryresults
[0m14:06:55.518184 [info ] [Thread-2 (]: 26 of 148 PASS source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [[32mPASS[0m in 6.81s]
[0m14:06:55.522165 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:06:55.525156 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:06:55.530793 [info ] [Thread-2 (]: 29 of 148 START test source_unique_raw_olist_customers_customer_id ............. [RUN]
[0m14:06:55.538273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5, now test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816)
[0m14:06:55.540122 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:06:55.575024 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m14:06:55.578014 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:06:55.600954 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:56.122504 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m14:06:56.128489 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:56.789868 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:14a10465-6928-4a1f-935a-ef2a720bd51a&page=queryresults
[0m14:06:56.848049 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
[0m14:06:56.855071 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:57.419139 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cef0dbd5-c62c-451a-a1d8-6bc6bbe23410&page=queryresults
[0m14:06:57.424125 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m14:06:57.440104 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:57.864378 [info ] [Thread-3 (]: 23 of 148 PASS source_not_null_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 12.84s]
[0m14:06:57.867368 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:06:57.869487 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:06:57.871357 [info ] [Thread-3 (]: 30 of 148 START test source_unique_raw_olist_orders_order_id ................... [RUN]
[0m14:06:57.873354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1, now test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0)
[0m14:06:57.874722 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:06:57.888312 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m14:06:57.890307 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:06:57.903272 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:58.184120 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d5ee7633-94e4-4043-a145-1bebc4c7d8a2&page=queryresults
[0m14:06:59.426042 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
[0m14:06:59.437059 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m14:06:59.443001 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:06:59.466935 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:06:59.455965 [info ] [Thread-4 (]: 27 of 148 PASS source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [[32mPASS[0m in 6.80s]
[0m14:06:59.496003 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:06:59.503840 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:06:59.521787 [info ] [Thread-4 (]: 31 of 148 START test source_unique_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m14:06:59.530779 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8, now test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df)
[0m14:06:59.534755 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:06:59.556693 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m14:06:59.566674 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:06:59.585616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:59.699311 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
[0m14:06:59.703301 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:00.886005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7faeabb8-2936-4564-a4b3-1cf77856edf7&page=queryresults
[0m14:07:00.893211 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:09198d33-c5a0-48ba-85eb-63ed75736722&page=queryresults
[0m14:07:00.904006 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:34e2076e-7d20-4249-bcd6-8919cd17966c&page=queryresults
[0m14:07:01.770661 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
[0m14:07:01.774628 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select string_field_0 as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
  where string_field_0 is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:01.906957 [info ] [Thread-2 (]: 29 of 148 PASS source_unique_raw_olist_customers_customer_id ................... [[32mPASS[0m in 6.37s]
[0m14:07:01.912942 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:07:01.914936 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:07:01.917929 [info ] [Thread-2 (]: 32 of 148 START test source_unique_raw_olist_products_product_id ............... [RUN]
[0m14:07:01.921919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816, now test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1)
[0m14:07:01.924974 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:07:01.970792 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m14:07:01.978767 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:07:02.003744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:02.125888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m14:07:02.131875 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m14:07:02.140850 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:02.149826 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:02.269513 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d7ba64a3-ed46-4642-b6c3-29d2e68acc71&page=queryresults
[0m14:07:02.698206 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4df2a18a-736a-4011-93cd-b76ca8049604&page=queryresults
[0m14:07:02.712726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4fd3379a-01d5-4cce-868e-4af51f8160f9&page=queryresults
[0m14:07:03.158252 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
[0m14:07:03.167174 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:03.620967 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b2e28f19-a9ee-44e4-b3b9-44a4199a120d&page=queryresults
[0m14:07:03.757526 [info ] [Thread-3 (]: 30 of 148 PASS source_unique_raw_olist_orders_order_id ......................... [[32mPASS[0m in 5.88s]
[0m14:07:03.771495 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:07:03.763521 [info ] [Thread-1 (]: 28 of 148 PASS source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [[32mPASS[0m in 10.79s]
[0m14:07:03.773488 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:07:03.782473 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:07:03.790440 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:07:03.787446 [info ] [Thread-3 (]: 33 of 148 START test accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [RUN]
[0m14:07:03.805400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0, now test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22)
[0m14:07:03.810386 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:07:03.801572 [info ] [Thread-1 (]: 34 of 148 START test not_null_brazilian_states_state_code ...................... [RUN]
[0m14:07:03.877208 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m14:07:03.884365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543, now test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec)
[0m14:07:03.887323 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:07:03.920091 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m14:07:03.934055 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:07:03.953003 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:07:03.955002 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:03.973951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:04.763554 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m14:07:04.772528 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:05.242823 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
[0m14:07:05.247855 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
where state_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:05.281151 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
[0m14:07:05.285140 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
    group by region

)

select *
from all_values
where value_field not in (
    'North','Northeast','Central-West','Southeast','South'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:05.601024 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e9f1cb9b-05ed-469e-a72e-cbb53025a588&page=queryresults
[0m14:07:05.762591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5db9b030-0c52-49db-8fe6-a4ea152f5122&page=queryresults
[0m14:07:05.953084 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fce82585-5a2e-4d10-b53f-545eb5f72f58&page=queryresults
[0m14:07:05.956105 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m14:07:05.969316 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:06.545487 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3a42e400-cc46-49d4-a3c3-4dacceb8c6d9&page=queryresults
[0m14:07:06.574415 [info ] [Thread-4 (]: 31 of 148 PASS source_unique_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 7.04s]
[0m14:07:06.582391 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:07:06.583386 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:07:06.586425 [info ] [Thread-4 (]: 35 of 148 START test unique_brazilian_states_state_code ........................ [RUN]
[0m14:07:06.590369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df, now test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855)
[0m14:07:06.594359 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:07:06.623281 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m14:07:06.635249 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:07:06.653198 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:07.644453 [info ] [Thread-2 (]: 32 of 148 PASS source_unique_raw_olist_products_product_id ..................... [[32mPASS[0m in 5.72s]
[0m14:07:07.649442 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:07:07.652433 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:07:07.654545 [info ] [Thread-2 (]: 36 of 148 START test not_null_order_status_codes_status_code ................... [RUN]
[0m14:07:07.658416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1, now test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968)
[0m14:07:07.662409 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:07:07.697349 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m14:07:07.711277 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m14:07:07.721250 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:07:07.750177 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:07.753163 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:07.919257 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
[0m14:07:07.924242 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select state_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
  where state_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:08.042233 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m14:07:08.099843 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:08.365619 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2006d40e-6008-4cd0-b9d8-fa2268a09f37&page=queryresults
[0m14:07:08.408923 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:18426b6d-5a89-4788-af76-a5ce049a267a&page=queryresults
[0m14:07:08.612801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6dc76a47-4cee-4604-8c7e-7091f8e0e9ed&page=queryresults
[0m14:07:08.899890 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
[0m14:07:08.905923 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
where status_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:09.340495 [info ] [Thread-3 (]: 33 of 148 PASS accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [[32mPASS[0m in 5.54s]
[0m14:07:09.350517 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:07:09.353494 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:07:09.356454 [info ] [Thread-3 (]: 37 of 148 START test unique_order_status_codes_status_code ..................... [RUN]
[0m14:07:09.361441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22, now test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b)
[0m14:07:09.365427 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:07:09.395350 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:189f0e92-396f-49e2-b192-3ad959327448&page=queryresults
[0m14:07:09.405320 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m14:07:09.422275 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:07:09.477131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:09.743209 [info ] [Thread-1 (]: 34 of 148 PASS not_null_brazilian_states_state_code ............................ [[32mPASS[0m in 5.86s]
[0m14:07:09.748197 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:07:09.753184 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_order_items
[0m14:07:09.763205 [info ] [Thread-1 (]: 38 of 148 START sql view model dbt_dev_yourname_staging.stg_order_items ........ [RUN]
[0m14:07:09.766609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec, now model.dbt_advanced_olist.stg_order_items)
[0m14:07:09.769144 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_order_items
[0m14:07:09.850384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_order_items"
[0m14:07:09.854931 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_order_items
[0m14:07:09.936690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_order_items"
[0m14:07:09.943671 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_order_items: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_order_items
  
  Purpose: Clean order line item data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Rename columns
  - Calculate item total (price + freight)
  - Generate surrogate key for unique identification
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`order_items`
),

renamed as (
    select
        -- Surrogate Key (composite primary key)
        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,
        
        -- Foreign Keys
        order_id,
        product_id,
        seller_id,
        
        -- Item Position
        order_item_id as item_sequence,
        
        -- Pricing
        cast(price as numeric) as item_price,
        cast(freight_value as numeric) as item_freight,
        
        -- Derived: Total for this item
        cast(price as numeric) + cast(freight_value as numeric) as item_total,
        
        -- Shipping date
        cast(shipping_limit_date as timestamp) as shipping_limit_at

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_order_items | schema: dbt_dev_yourname_staging */;
[0m14:07:09.946665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:10.361625 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m14:07:10.365617 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:10.704707 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
[0m14:07:10.712793 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select status_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
  where status_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:10.939098 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:441a69e6-970a-45e6-b803-b648c326b41a&page=queryresults
[0m14:07:11.228299 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d20ed7f4-90cf-41c6-8ba1-7cf8c11eab21&page=queryresults
[0m14:07:11.233290 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f5dd9ac0-eade-46e2-851e-025a4a515428&page=queryresults
[0m14:07:11.562551 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m14:07:11.568531 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:11.822605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD0BDEB50>]}
[0m14:07:11.828796 [info ] [Thread-1 (]: 38 of 148 OK created sql view model dbt_dev_yourname_staging.stg_order_items ... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m14:07:11.833485 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_order_items
[0m14:07:11.836477 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_customers
[0m14:07:11.842460 [info ] [Thread-1 (]: 39 of 148 START sql view model dbt_dev_yourname_staging.stg_customers .......... [RUN]
[0m14:07:11.852435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_order_items, now model.dbt_advanced_olist.stg_customers)
[0m14:07:11.854429 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_customers
[0m14:07:11.885349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_customers"
[0m14:07:11.889751 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_customers
[0m14:07:11.920252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_customers"
[0m14:07:11.916264 [info ] [Thread-4 (]: 35 of 148 PASS unique_brazilian_states_state_code .............................. [[32mPASS[0m in 5.33s]
[0m14:07:11.926030 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:07:11.928402 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_orders
[0m14:07:11.931226 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_customers: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_customers
  
  Purpose: Clean and standardize customer data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Standardize location data
  - Clean state codes
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`customers`
),

renamed as (
    select
        -- Primary Key
        customer_id,
        
        -- Alternative Key (same customer across orders)
        customer_unique_id,
        
        -- Location
        lower(trim(customer_city)) as customer_city,
        upper(trim(customer_state)) as customer_state,
        cast(customer_zip_code_prefix as string) as customer_zip_code,
        
        -- Derived: Region classification
        case upper(trim(customer_state))
            when 'SP' then 'Southeast'
            when 'RJ' then 'Southeast'
            when 'MG' then 'Southeast'
            when 'ES' then 'Southeast'
            when 'PR' then 'South'
            when 'SC' then 'South'
            when 'RS' then 'South'
            when 'BA' then 'Northeast'
            when 'PE' then 'Northeast'
            when 'CE' then 'Northeast'
            when 'MA' then 'Northeast'
            when 'PB' then 'Northeast'
            when 'RN' then 'Northeast'
            when 'PI' then 'Northeast'
            when 'AL' then 'Northeast'
            when 'SE' then 'Northeast'
            when 'GO' then 'Central-West'
            when 'DF' then 'Central-West'
            when 'MT' then 'Central-West'
            when 'MS' then 'Central-West'
            else 'North'
        end as customer_region

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_customers | schema: dbt_dev_yourname_staging */;
[0m14:07:11.937207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:11.935213 [info ] [Thread-4 (]: 40 of 148 START sql view model dbt_dev_yourname_staging.stg_orders ............. [RUN]
[0m14:07:12.015997 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855, now model.dbt_advanced_olist.stg_orders)
[0m14:07:12.018988 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_orders
[0m14:07:12.034946 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_orders"
[0m14:07:12.037939 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_orders
[0m14:07:12.049001 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_orders"
[0m14:07:12.070853 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_orders: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_orders
  
  Purpose: Clean and standardize raw order data
  Source: Olist Brazilian E-commerce (10K orders sample)
  
  Transformations:
  - Rename columns to consistent naming convention
  - Cast timestamps to proper types
  - Calculate delivery metrics
  - Add late delivery flag
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`orders`
),

renamed as (
    select
        -- Primary Key
        order_id,
        
        -- Foreign Keys
        customer_id,
        
        -- Order Status
        order_status,
        
        -- Timestamps (cast to proper types)
        cast(order_purchase_timestamp as timestamp) as ordered_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as shipped_at,
        cast(order_delivered_customer_date as timestamp) as delivered_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,
        
        -- Derived: Order date (for partitioning)
        date(cast(order_purchase_timestamp as timestamp)) as order_date,
        
        -- Derived: Delivery time in days
        case 
            when order_delivered_customer_date is not null 
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_purchase_timestamp as timestamp)),
                day
            )
        end as delivery_days,
        
        -- Derived: Is delivery late?
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then true
            else false
        end as is_late_delivery,
        
        -- Derived: Days late (if late)
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_estimated_delivery_date as timestamp)),
                day
            )
            else 0
        end as days_late

    from source
)

select * from renamed

-- Limit in dev for faster iteration
limit 1000
/* dbt 1.10.15 | model: stg_orders | schema: dbt_dev_yourname_staging */;
[0m14:07:12.075852 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:12.547866 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4db1ad74-e3c0-41eb-8fca-ae0744f6fe60&page=queryresults
[0m14:07:13.173415 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m14:07:13.187378 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:13.264308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cbca3fea-2bae-4212-a08a-521db4465d01&page=queryresults
[0m14:07:13.293247 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9545853d-6101-4b30-ad2a-425720ff27c7&page=queryresults
[0m14:07:13.485456 [info ] [Thread-2 (]: 36 of 148 PASS not_null_order_status_codes_status_code ......................... [[32mPASS[0m in 5.83s]
[0m14:07:13.489372 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:07:13.491324 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_product_categories
[0m14:07:13.494317 [info ] [Thread-2 (]: 41 of 148 START sql view model dbt_dev_yourname_staging.stg_product_categories . [RUN]
[0m14:07:13.497367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968, now model.dbt_advanced_olist.stg_product_categories)
[0m14:07:13.500305 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_product_categories
[0m14:07:13.571156 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_product_categories"
[0m14:07:13.577143 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_product_categories
[0m14:07:13.597131 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_product_categories"
[0m14:07:13.633648 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_product_categories: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  OPTIONS()
  as 
/*
  STAGING MODEL: stg_product_categories
  Purpose: Product category translation (Portuguese → English)
  Source: Olist Brazilian E-commerce
*/
with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
),
renamed as (
    select
        -- Portuguese name (join key)
        string_field_0 as category_name_pt,
        -- English translation
        string_field_1 as category_name_en,
        -- Derived: Category group
        case
            when string_field_1 in ('computers', 'computers_accessories', 'electronics', 'tablets_printing_image', 'telephony', 'fixed_telephony')
                then 'Electronics'
            when string_field_1 in ('furniture_decor', 'furniture_living_room', 'furniture_bedroom', 'furniture_mattress_and_upholstery', 'office_furniture', 'home_comfort', 'home_comfort_2', 'home_confort')
                then 'Furniture'
            when string_field_1 in ('health_beauty', 'perfumery', 'diapers_and_hygiene')
                then 'Health & Beauty'
            when string_field_1 in ('sports_leisure', 'toys', 'baby', 'fashion_bags_accessories', 'fashion_shoes', 'fashion_sport', 'fashion_underwear_beach', 'fashio_female_clothing', 'fashion_male_clothing', 'fashion_childrens_clothes')
                then 'Fashion & Lifestyle'
            when string_field_1 in ('housewares', 'kitchen_dining_laundry_garden_furniture', 'garden_tools', 'flowers', 'la_cuisine')
                then 'Home & Garden'
            else 'Other'
        end as category_group
    from source
)
select * from renamed
/* dbt 1.10.15 | model: stg_product_categories | schema: dbt_dev_yourname_staging */;
[0m14:07:13.636640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:13.772278 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ebfc3a4e-a491-4f51-9c45-c88e359a3714&page=queryresults
[0m14:07:13.861039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD1589490>]}
[0m14:07:13.864031 [info ] [Thread-1 (]: 39 of 148 OK created sql view model dbt_dev_yourname_staging.stg_customers ..... [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m14:07:13.868020 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_customers
[0m14:07:13.870015 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_products
[0m14:07:13.875003 [info ] [Thread-1 (]: 42 of 148 START sql view model dbt_dev_yourname_staging.stg_products ........... [RUN]
[0m14:07:13.886970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_customers, now model.dbt_advanced_olist.stg_products)
[0m14:07:13.890384 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_products
[0m14:07:13.912909 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_products"
[0m14:07:13.920882 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD1550950>]}
[0m14:07:13.928480 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_products
[0m14:07:13.942820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_products"
[0m14:07:13.923871 [info ] [Thread-4 (]: 40 of 148 OK created sql view model dbt_dev_yourname_staging.stg_orders ........ [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m14:07:13.946811 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_orders
[0m14:07:13.950799 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:07:13.952794 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_products: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_products
  
  Purpose: Clean product catalog data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Calculate product volume
  - Classify product size
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`products`
),

renamed as (
    select
        -- Primary Key
        product_id,
        
        -- Category (Portuguese - join with translation table)
        product_category_name as category_name_pt,
        
        -- Dimensions
        cast(product_weight_g as numeric) as weight_grams,
        cast(product_length_cm as numeric) as length_cm,
        cast(product_height_cm as numeric) as height_cm,
        cast(product_width_cm as numeric) as width_cm,
        
        -- Derived: Volume in cubic cm
        cast(product_length_cm as numeric) 
            * cast(product_height_cm as numeric) 
            * cast(product_width_cm as numeric) as volume_cm3,
        
        -- Derived: Size classification
        case
            when cast(product_weight_g as numeric) < 500 then 'Small'
            when cast(product_weight_g as numeric) < 2000 then 'Medium'
            when cast(product_weight_g as numeric) < 10000 then 'Large'
            else 'Extra Large'
        end as size_category,
        
        -- Product description stats
        product_name_lenght as name_length,
        product_description_lenght as description_length,
        product_photos_qty as photo_count

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_products | schema: dbt_dev_yourname_staging */;
[0m14:07:13.962771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:13.957115 [info ] [Thread-4 (]: 43 of 148 START test is_not_negative_stg_order_items_item_freight .............. [RUN]
[0m14:07:14.078459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_orders, now test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a)
[0m14:07:14.086438 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:07:14.123338 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m14:07:14.146276 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:07:14.162236 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:14.761954 [info ] [Thread-3 (]: 37 of 148 PASS unique_order_status_codes_status_code ........................... [[32mPASS[0m in 5.40s]
[0m14:07:14.765812 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:07:14.767807 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:07:14.770820 [info ] [Thread-3 (]: 44 of 148 START test is_positive_stg_order_items_item_price .................... [RUN]
[0m14:07:14.774852 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b, now test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242)
[0m14:07:14.777780 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:07:14.815678 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m14:07:14.818671 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:07:14.837620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:15.061025 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:951585ea-fd29-4591-81ed-3e2a85342731&page=queryresults
[0m14:07:15.376253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6a28d957-950c-45da-b953-bfc93c398f88&page=queryresults
[0m14:07:15.403235 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
[0m14:07:15.408168 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_freight as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:15.838427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD1654250>]}
[0m14:07:15.843337 [info ] [Thread-2 (]: 41 of 148 OK created sql view model dbt_dev_yourname_staging.stg_product_categories  [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m14:07:15.847374 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_product_categories
[0m14:07:15.850316 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:07:15.852313 [info ] [Thread-2 (]: 45 of 148 START test is_positive_stg_order_items_item_total .................... [RUN]
[0m14:07:15.855303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_product_categories, now test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25)
[0m14:07:15.859294 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:07:15.886221 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m14:07:15.911155 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
[0m14:07:15.915146 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:07:15.918295 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_price as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price <= 0
   or item_price is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:15.940076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:15.947059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD1655610>]}
[0m14:07:16.049782 [info ] [Thread-1 (]: 42 of 148 OK created sql view model dbt_dev_yourname_staging.stg_products ...... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m14:07:16.057762 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_products
[0m14:07:16.060755 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cad5d8ab-c6a1-4374-a759-34858b8b1ae5&page=queryresults
[0m14:07:16.062748 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:07:16.070727 [info ] [Thread-1 (]: 46 of 148 START test not_null_stg_order_items_item_freight ..................... [RUN]
[0m14:07:16.072951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_products, now test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5)
[0m14:07:16.075716 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:07:16.101690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m14:07:16.106724 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:07:16.132563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:16.550445 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8378f999-d155-4294-a9a6-223a388684b9&page=queryresults
[0m14:07:17.078948 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
[0m14:07:17.084933 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total <= 0
   or item_total is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:17.743014 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2bfde796-b001-4b3a-8b0d-c64c1da00b53&page=queryresults
[0m14:07:18.045342 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m14:07:18.069951 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:18.442959 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
[0m14:07:18.448937 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:18.648260 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m14:07:18.650253 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:72a306a2-81c6-4969-baa7-52dee913b9ff&page=queryresults
[0m14:07:18.659230 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:19.060271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8b5d9243-0ed5-4867-b242-3aa6adbcda33&page=queryresults
[0m14:07:19.244025 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:32c9057a-4436-46e1-9220-33fa29a35dc2&page=queryresults
[0m14:07:19.836704 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m14:07:19.841693 [info ] [Thread-4 (]: 43 of 148 PASS is_not_negative_stg_order_items_item_freight .................... [[32mPASS[0m in 5.76s]
[0m14:07:19.848673 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:07:19.851664 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:07:19.854657 [info ] [Thread-4 (]: 47 of 148 START test not_null_stg_order_items_item_price ....................... [RUN]
[0m14:07:19.859646 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a, now test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556)
[0m14:07:19.861638 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:07:19.884576 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m14:07:19.888566 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:19.898920 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:07:19.917488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:20.511018 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:79b9d4a2-2d82-405c-9bd2-ced46d1ab284&page=queryresults
[0m14:07:20.606926 [info ] [Thread-3 (]: 44 of 148 PASS is_positive_stg_order_items_item_price .......................... [[32mPASS[0m in 5.83s]
[0m14:07:20.611795 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:07:20.614741 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:07:20.617777 [info ] [Thread-3 (]: 48 of 148 START test not_null_stg_order_items_item_total ....................... [RUN]
[0m14:07:20.621724 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242, now test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2)
[0m14:07:20.624717 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:07:20.649649 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m14:07:20.653652 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:07:20.677575 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:21.139145 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m14:07:21.163015 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:21.168001 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
[0m14:07:21.174987 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:21.454300 [info ] [Thread-2 (]: 45 of 148 PASS is_positive_stg_order_items_item_total .......................... [[32mPASS[0m in 5.60s]
[0m14:07:21.460282 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:07:21.461279 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:07:21.464270 [info ] [Thread-2 (]: 49 of 148 START test not_null_stg_order_items_order_id ......................... [RUN]
[0m14:07:21.468261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25, now test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96)
[0m14:07:21.471252 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:07:21.494196 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m14:07:21.497181 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:07:21.513137 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:21.712608 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:13aa1644-2c73-4a2e-8fee-792aba11b8c3&page=queryresults
[0m14:07:21.723577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1022cb53-9a4a-422f-8ebc-d9211ba97afd&page=queryresults
[0m14:07:21.927188 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
[0m14:07:21.932223 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:22.596470 [info ] [Thread-1 (]: 46 of 148 PASS not_null_stg_order_items_item_freight ........................... [[32mPASS[0m in 6.52s]
[0m14:07:22.602455 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:07:22.605461 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:07:22.608441 [info ] [Thread-1 (]: 50 of 148 START test not_null_stg_order_items_order_item_key ................... [RUN]
[0m14:07:22.610433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5, now test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa)
[0m14:07:22.613425 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:07:23.057239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m14:07:23.060245 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:07:23.083171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:23.184022 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
[0m14:07:23.189885 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4eb2ea90-085e-437b-a3b5-82172ff2d516&page=queryresults
[0m14:07:23.194873 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:23.767341 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a2dd59a6-939a-4f5e-95be-3364e4af6e78&page=queryresults
[0m14:07:23.972863 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m14:07:23.976780 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:24.298919 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
[0m14:07:24.302908 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_item_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:24.587147 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:95ea851b-a62f-424e-bece-4411e7055b67&page=queryresults
[0m14:07:24.780412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c68d41d0-9c82-4714-8fde-ddc38ed317a4&page=queryresults
[0m14:07:24.860894 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m14:07:24.865878 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:25.476265 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f2c961b3-6038-4a78-a689-9111dcb37fa2&page=queryresults
[0m14:07:25.543112 [info ] [Thread-4 (]: 47 of 148 PASS not_null_stg_order_items_item_price ............................. [[32mPASS[0m in 5.68s]
[0m14:07:25.549064 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:07:25.552131 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:07:25.558040 [info ] [Thread-4 (]: 51 of 148 START test not_null_stg_order_items_product_id ....................... [RUN]
[0m14:07:25.562043 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556, now test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6)
[0m14:07:25.565020 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:07:25.587534 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m14:07:25.595941 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:07:25.631875 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:25.734569 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m14:07:25.742550 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:26.370569 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c43bb2f-2331-4c28-bf64-00b4617615f8&page=queryresults
[0m14:07:26.694806 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m14:07:26.699358 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:26.762175 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
[0m14:07:26.766161 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:26.948225 [info ] [Thread-3 (]: 48 of 148 PASS not_null_stg_order_items_item_total ............................. [[32mPASS[0m in 6.33s]
[0m14:07:26.956368 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:07:26.961189 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:07:26.980226 [info ] [Thread-3 (]: 52 of 148 START test unique_stg_order_items_order_item_key ..................... [RUN]
[0m14:07:26.988092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2, now test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057)
[0m14:07:26.997592 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:07:27.043126 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m14:07:27.050650 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:07:27.083655 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:27.233886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:27edc490-2fba-455a-ad02-2c0a569578f3&page=queryresults
[0m14:07:27.276358 [info ] [Thread-2 (]: 49 of 148 PASS not_null_stg_order_items_order_id ............................... [[32mPASS[0m in 5.81s]
[0m14:07:27.283475 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:07:27.288056 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:07:27.293020 [info ] [Thread-2 (]: 53 of 148 START test accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m14:07:27.299054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96, now test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f)
[0m14:07:27.303046 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:07:27.350315 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m14:07:27.353355 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8e5c6169-9ada-411a-af9f-35859ad32402&page=queryresults
[0m14:07:27.375092 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:07:27.390549 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:28.597320 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
[0m14:07:28.614212 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_item_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  where order_item_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:28.608235 [info ] [Thread-1 (]: 50 of 148 PASS not_null_stg_order_items_order_item_key ......................... [[32mPASS[0m in 6.00s]
[0m14:07:28.629342 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:07:28.634366 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:07:28.640586 [info ] [Thread-1 (]: 54 of 148 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [RUN]
[0m14:07:28.650436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789)
[0m14:07:28.654582 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:07:28.696301 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m14:07:28.704478 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:07:28.723539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:28.930814 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
[0m14:07:28.933806 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:29.270009 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7741ec5a-47b0-47e3-a757-88814e664689&page=queryresults
[0m14:07:29.418569 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m14:07:29.426694 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:29.646337 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fb31af30-a161-4c26-a333-536ea52d1fb2&page=queryresults
[0m14:07:29.848243 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
[0m14:07:29.856209 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:29.972234 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2a4d5658-e35e-461f-b498-4994163d746f&page=queryresults
[0m14:07:30.527902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dbf074c9-65aa-4e97-8a54-d814a637d7db&page=queryresults
[0m14:07:30.938093 [info ] [Thread-4 (]: 51 of 148 PASS not_null_stg_order_items_product_id ............................. [[32mPASS[0m in 5.38s]
[0m14:07:30.950120 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:07:30.953110 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:07:30.959094 [info ] [Thread-4 (]: 55 of 148 START test not_null_stg_customers_customer_id ........................ [RUN]
[0m14:07:30.963083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:07:30.967071 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:07:31.000102 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:07:31.009393 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:07:31.028271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:31.296011 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m14:07:31.304239 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:31.924122 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3d2552ba-bca5-4725-83ea-3ac164756f1a&page=queryresults
[0m14:07:32.178355 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
[0m14:07:32.181257 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:32.460440 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m14:07:32.466746 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:32.561187 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m14:07:32.576150 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:32.779336 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dfb40f1b-f4ee-404b-b2b5-e07568a61aa8&page=queryresults
[0m14:07:32.986729 [info ] [Thread-3 (]: 52 of 148 PASS unique_stg_order_items_order_item_key ........................... [[32mPASS[0m in 6.00s]
[0m14:07:32.996235 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:07:32.999226 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:07:33.002219 [info ] [Thread-3 (]: 56 of 148 START test not_null_stg_customers_customer_region .................... [RUN]
[0m14:07:33.010198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057, now test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e)
[0m14:07:33.015189 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:07:33.067289 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m14:07:33.081855 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:07:33.095874 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:33.178340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:239de006-aa8d-4e18-a402-9367b0dcb146&page=queryresults
[0m14:07:33.181599 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:06c84c92-899b-4244-b128-a266e69df976&page=queryresults
[0m14:07:34.148590 [info ] [Thread-2 (]: 53 of 148 PASS accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 6.85s]
[0m14:07:34.157466 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:07:34.160462 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:07:34.164451 [info ] [Thread-2 (]: 57 of 148 START test not_null_stg_customers_customer_state ..................... [RUN]
[0m14:07:34.168443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f, now test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397)
[0m14:07:34.176420 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:07:34.228390 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m14:07:34.246047 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:07:34.239079 [info ] [Thread-1 (]: 54 of 148 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [[32mPASS[0m in 5.59s]
[0m14:07:34.284124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:34.286647 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:07:34.374103 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:07:34.378171 [info ] [Thread-1 (]: 58 of 148 START test not_null_stg_customers_customer_unique_id ................. [RUN]
[0m14:07:34.381169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789, now test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba)
[0m14:07:34.382202 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:07:34.401187 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:07:34.414174 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:07:34.435285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:34.595451 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
[0m14:07:34.601463 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:34.697676 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:07:34.705613 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:35.133197 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e64577d2-8836-43c6-81a5-9193351c6b72&page=queryresults
[0m14:07:35.272333 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:88f690c9-1727-4d64-b0d3-53815ebc0c62&page=queryresults
[0m14:07:35.382507 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
[0m14:07:35.387752 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:35.518757 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
[0m14:07:35.527683 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:36.096895 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:10e25c58-66f8-48e5-a7b6-07128cd9cf20&page=queryresults
[0m14:07:36.146185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1b60e0dc-246e-4b01-bbe1-7799e60dd00d&page=queryresults
[0m14:07:36.376444 [info ] [Thread-4 (]: 55 of 148 PASS not_null_stg_customers_customer_id .............................. [[32mPASS[0m in 5.41s]
[0m14:07:36.381052 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:07:36.382051 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:07:36.385041 [info ] [Thread-4 (]: 59 of 148 START test unique_stg_customers_customer_id .......................... [RUN]
[0m14:07:36.391980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada)
[0m14:07:36.395968 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:07:36.415280 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m14:07:36.424255 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:07:36.441972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:38.022159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:07:38.029356 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:38.272129 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
[0m14:07:38.277116 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:38.926526 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3deef18e-93b4-4d9b-8cb7-d98067288816&page=queryresults
[0m14:07:38.943196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9393911e-a292-4c08-a05d-71bc0fc0165e&page=queryresults
[0m14:07:39.677137 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m14:07:39.697088 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:40.377972 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1e864861-747a-485b-a5d8-15acb78d0e32&page=queryresults
[0m14:07:40.397917 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m14:07:40.405888 [info ] [Thread-1 (]: 58 of 148 PASS not_null_stg_customers_customer_unique_id ....................... [[32mPASS[0m in 6.02s]
[0m14:07:40.411934 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:40.415867 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:07:40.424839 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:07:40.428827 [info ] [Thread-1 (]: 60 of 148 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:07:40.434825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460)
[0m14:07:40.441655 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:07:40.494512 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m14:07:40.498501 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:07:40.522435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:41.180977 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1ef8c287-3495-4c36-846f-48326afacc7d&page=queryresults
[0m14:07:41.193942 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m14:07:41.212989 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:41.500989 [info ] [Thread-2 (]: 57 of 148 PASS not_null_stg_customers_customer_state ........................... [[32mPASS[0m in 7.33s]
[0m14:07:41.510540 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:07:41.513913 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:07:41.516946 [info ] [Thread-2 (]: 61 of 148 START test assert_delivery_dates_logical ............................. [RUN]
[0m14:07:41.522886 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397, now test.dbt_advanced_olist.assert_delivery_dates_logical)
[0m14:07:41.527872 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:07:41.611178 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m14:07:41.624141 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:07:41.639135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:41.843109 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:887ee5ac-7cc1-41f7-b6c1-7db193d1423c&page=queryresults
[0m14:07:42.260422 [info ] [Thread-3 (]: 56 of 148 PASS not_null_stg_customers_customer_region .......................... [[32mPASS[0m in 9.25s]
[0m14:07:42.265407 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:07:42.269883 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_orders_have_items
[0m14:07:42.274390 [info ] [Thread-3 (]: 62 of 148 START test assert_orders_have_items .................................. [RUN]
[0m14:07:42.278578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e, now test.dbt_advanced_olist.assert_orders_have_items)
[0m14:07:42.282365 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_orders_have_items
[0m14:07:42.320263 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m14:07:42.329243 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_orders_have_items
[0m14:07:42.357165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:42.684122 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
[0m14:07:42.693057 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:42.797433 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
[0m14:07:42.812346 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_delivery_dates_logical
  
  Purpose: Delivery dates should follow logical order
  
  Business Rules:
  - approved_at >= ordered_at
  - shipped_at >= approved_at (if exists)
  - delivered_at >= shipped_at (if exists)
  
  Test PASSES if query returns 0 rows
*/

with orders as (
    select
        order_id,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

date_violations as (
    select
        order_id,
        case
            when approved_at < ordered_at then 'Approved before ordered'
            when shipped_at < approved_at then 'Shipped before approved'
            when delivered_at < shipped_at then 'Delivered before shipped'
            when delivered_at < ordered_at then 'Delivered before ordered'
        end as violation_type,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from orders
    where 
        (approved_at is not null and approved_at < ordered_at)
        or (shipped_at is not null and approved_at is not null and shipped_at < approved_at)
        or (delivered_at is not null and shipped_at is not null and delivered_at < shipped_at)
        or (delivered_at is not null and delivered_at < ordered_at)
)

select * from date_violations
  
  
    )
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:42.807400 [info ] [Thread-4 (]: 59 of 148 PASS unique_stg_customers_customer_id ................................ [[32mPASS[0m in 6.41s]
[0m14:07:42.826312 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:07:42.831303 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:07:42.838447 [info ] [Thread-4 (]: 63 of 148 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [RUN]
[0m14:07:42.844147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15)
[0m14:07:42.847152 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:07:42.892018 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m14:07:42.898005 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:07:42.936902 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:43.329611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d2a5f970-d623-42ec-a1be-5031d6d72cce&page=queryresults
[0m14:07:44.024018 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:832849fb-9975-4b1d-a565-3d56e9cc09b2&page=queryresults
[0m14:07:44.368513 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
[0m14:07:44.376489 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

/*
  SINGULAR TEST: assert_orders_have_items
  Purpose: Every order should have at least one line item
  Business Rule: An order without items indicates data integrity issue
  Test PASSES if this query returns 0 rows
  Test FAILS if any orders exist without items
  
  Note: Sample data may have orphaned records - set to warn
*/
with orders as (
    select order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),
order_items as (
    select distinct order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),
orders_without_items as (
    select
        o.order_id
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    where oi.order_id is null
)
select
    order_id,
    'Order has no items' as failure_reason
from orders_without_items
  
  
    )
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:45.164562 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:58f2e78a-67e1-453c-a173-6770ce21cd29&page=queryresults
[0m14:07:45.265282 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
[0m14:07:45.284783 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_days >= 0 and delivery_days <= 180
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where
        delivery_days is not null
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:45.625076 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m14:07:45.629119 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m14:07:45.653557 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:45.663504 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:46.193545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bd708213-0f1a-4e55-8587-7039960f07b3&page=queryresults
[0m14:07:46.246707 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ddfc0d19-fa66-410b-a6ef-41fc9ac78a71&page=queryresults
[0m14:07:46.787342 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c195f693-3409-4fc6-afa3-d3def98303ff&page=queryresults
[0m14:07:46.948584 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m14:07:46.955515 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:47.103819 [info ] [Thread-1 (]: 60 of 148 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 6.67s]
[0m14:07:47.110815 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:07:47.114426 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:07:47.119417 [info ] [Thread-1 (]: 64 of 148 START test not_null_stg_orders_customer_id ........................... [RUN]
[0m14:07:47.125417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:07:47.131401 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:07:47.195828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:07:47.208580 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:07:47.226061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:47.229481 [info ] [Thread-2 (]: 61 of 148 PASS assert_delivery_dates_logical ................................... [[32mPASS[0m in 5.71s]
[0m14:07:47.315397 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:07:47.322351 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:07:47.323734 [info ] [Thread-2 (]: 65 of 148 START test not_null_stg_orders_is_late_delivery ...................... [RUN]
[0m14:07:47.328525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_delivery_dates_logical, now test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0)
[0m14:07:47.330672 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:07:47.354885 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m14:07:47.358497 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:07:47.377444 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:47.483178 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:48ae8d9f-584c-49fc-9c90-f29bd935883d&page=queryresults
[0m14:07:48.327388 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
[0m14:07:48.332376 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:48.432163 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
[0m14:07:48.437717 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where is_late_delivery is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:48.476627 [warn ] [Thread-3 (]: 62 of 148 WARN 890 assert_orders_have_items .................................... [[33mWARN 890[0m in 6.20s]
[0m14:07:48.486528 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_orders_have_items
[0m14:07:48.488520 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:07:48.491546 [info ] [Thread-3 (]: 66 of 148 START test not_null_stg_orders_order_date ............................ [RUN]
[0m14:07:48.507741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_orders_have_items, now test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb)
[0m14:07:48.509737 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:07:48.528734 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m14:07:48.531601 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:07:48.555518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:48.746852 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m14:07:48.751837 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:49.010500 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:168c9868-b11c-4792-b2d7-7b1ef38e5ad0&page=queryresults
[0m14:07:49.187586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eb92fd79-afb8-4611-8dde-7b533427556c&page=queryresults
[0m14:07:49.277841 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ee1c2215-2426-4281-afe0-9534f9190325&page=queryresults
[0m14:07:49.747766 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
[0m14:07:49.754536 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:50.330396 [warn ] [Thread-4 (]: 63 of 148 WARN 1 dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [[33mWARN 1[0m in 7.49s]
[0m14:07:50.336336 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:07:50.340323 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:07:50.345407 [info ] [Thread-4 (]: 67 of 148 START test not_null_stg_orders_order_id .............................. [RUN]
[0m14:07:50.351437 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15, now test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:07:50.356457 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:07:50.395701 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:07:50.397694 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:357c3116-1862-4f91-b08b-197f7d40f166&page=queryresults
[0m14:07:50.426339 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:07:50.441335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:52.015230 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m14:07:52.019221 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:52.043475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:07:52.076510 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:52.506758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f9f209a5-a70f-4670-8ff9-de99f4d059f3&page=queryresults
[0m14:07:52.585310 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
[0m14:07:52.594317 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:53.010850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7e3688d7-2d0e-4399-abdf-834e73508d75&page=queryresults
[0m14:07:53.133378 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cfb7a149-1e21-4703-b89c-4f0705aea1ea&page=queryresults
[0m14:07:53.280349 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m14:07:53.286472 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:53.444888 [info ] [Thread-2 (]: 65 of 148 PASS not_null_stg_orders_is_late_delivery ............................ [[32mPASS[0m in 6.12s]
[0m14:07:53.451872 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:07:53.456857 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:07:53.461845 [info ] [Thread-2 (]: 68 of 148 START test not_null_stg_orders_order_status .......................... [RUN]
[0m14:07:53.467378 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0, now test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79)
[0m14:07:53.473361 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:07:53.523941 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m14:07:53.564369 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:07:53.586577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:53.858488 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7539aef6-3e2e-4220-a9a6-5e41425e21a4&page=queryresults
[0m14:07:54.198304 [info ] [Thread-1 (]: 64 of 148 PASS not_null_stg_orders_customer_id ................................. [[32mPASS[0m in 7.07s]
[0m14:07:54.209179 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:07:54.212193 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:07:54.217298 [info ] [Thread-1 (]: 69 of 148 START test not_null_stg_orders_ordered_at ............................ [RUN]
[0m14:07:54.223167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca)
[0m14:07:54.226682 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:07:54.281390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:07:54.289379 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:07:54.310408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:54.810687 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
[0m14:07:54.829428 [info ] [Thread-3 (]: 66 of 148 PASS not_null_stg_orders_order_date .................................. [[32mPASS[0m in 6.32s]
[0m14:07:54.840693 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:54.858746 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:07:54.873453 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:07:54.877396 [info ] [Thread-3 (]: 70 of 148 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:07:54.882380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m14:07:54.887432 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:07:54.930624 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m14:07:54.939604 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:07:54.965237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:55.145925 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:07:55.151867 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:55.370422 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7e5efd0a-f813-4769-9594-6460e9852063&page=queryresults
[0m14:07:55.422366 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
[0m14:07:55.427352 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:56.027345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6e0c2a3e-d749-438b-9089-a18b22c83eeb&page=queryresults
[0m14:07:56.068942 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9101f53a-6cf8-4a27-8b19-ed441d7230a4&page=queryresults
[0m14:07:56.228022 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
[0m14:07:56.237872 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:56.945773 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3eab092f-79f5-4a63-845c-bc6905c91cc5&page=queryresults
[0m14:07:57.106535 [info ] [Thread-4 (]: 67 of 148 PASS not_null_stg_orders_order_id .................................... [[32mPASS[0m in 6.76s]
[0m14:07:57.112661 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:07:57.114512 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:07:57.116507 [info ] [Thread-4 (]: 71 of 148 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:07:57.120500 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:07:57.122492 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:07:57.144618 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:07:57.151510 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:07:57.168466 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:57.543701 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m14:07:57.550682 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:58.176274 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c718531-050d-4435-a05d-591ef001120a&page=queryresults
[0m14:07:58.674567 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
[0m14:07:58.691526 [debug] [Thread-4 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:07:59.014504 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m14:07:59.020095 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:07:59.338058 [info ] [Thread-2 (]: 68 of 148 PASS not_null_stg_orders_order_status ................................ [[32mPASS[0m in 5.87s]
[0m14:07:59.345044 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:07:59.352020 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:07:59.358003 [info ] [Thread-2 (]: 72 of 148 START test unique_stg_orders_order_id ................................ [RUN]
[0m14:07:59.363340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79, now test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a)
[0m14:07:59.388921 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:07:59.441780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m14:07:59.446436 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:07:59.460431 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:59.547213 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4fa655c1-538f-4c50-b29e-f41b8dec6389&page=queryresults
[0m14:07:59.710800 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3975c0d0-248e-44bd-879c-f4764ee419ac&page=queryresults
[0m14:08:00.736662 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:08:00.741650 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
[0m14:08:00.758604 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:00.752621 [warn ] [Thread-3 (]: 70 of 148 WARN 862 relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mWARN 862[0m in 5.87s]
[0m14:08:00.762595 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:00.774563 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:08:00.787529 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:08:00.792591 [info ] [Thread-3 (]: 73 of 148 START test not_null_stg_product_categories_category_group ............ [RUN]
[0m14:08:00.799494 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a)
[0m14:08:00.804481 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:08:00.830411 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m14:08:00.839388 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:08:00.856345 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:02.386980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0e4bf4fa-0818-482b-96bf-ef3ab56c36d7&page=queryresults
[0m14:08:02.411188 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a31f1186-05e5-4b39-ae1a-d3d2baff03d2&page=queryresults
[0m14:08:02.790954 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:08:02.797919 [debug] [Thread-4 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:03.128814 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
[0m14:08:03.135795 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:03.343290 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m14:08:03.350269 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:03.371212 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6cac4e23-f64c-4c8c-abfe-6e01b63d0128&page=queryresults
[0m14:08:03.374208 [info ] [Thread-1 (]: 69 of 148 PASS not_null_stg_orders_ordered_at .................................. [[32mPASS[0m in 9.15s]
[0m14:08:03.381187 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:08:03.386283 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:08:03.389210 [info ] [Thread-1 (]: 74 of 148 START test not_null_stg_product_categories_category_name_en .......... [RUN]
[0m14:08:03.392293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17)
[0m14:08:03.395150 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:08:03.433047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m14:08:03.438033 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:08:03.456003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:03.738118 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:766bbff8-75c0-4262-9e52-7992f83591af&page=queryresults
[0m14:08:03.929079 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0a7cf953-61d6-4011-8836-16ebecfe7219&page=queryresults
[0m14:08:05.050992 [warn ] [Thread-4 (]: 71 of 148 WARN 902 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 902[0m in 7.93s]
[0m14:08:05.055698 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:08:05.058690 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:08:05.061682 [info ] [Thread-4 (]: 75 of 148 START test not_null_stg_product_categories_category_name_pt .......... [RUN]
[0m14:08:05.064202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c)
[0m14:08:05.067667 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:08:05.088658 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m14:08:05.109559 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:08:05.135485 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:05.241202 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
[0m14:08:05.246189 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_en is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:05.423132 [info ] [Thread-2 (]: 72 of 148 PASS unique_stg_orders_order_id ...................................... [[32mPASS[0m in 6.06s]
[0m14:08:05.432222 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:08:05.438084 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:08:05.442111 [info ] [Thread-2 (]: 76 of 148 START test unique_stg_product_categories_category_name_pt ............ [RUN]
[0m14:08:05.446194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a, now test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374)
[0m14:08:05.455043 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:08:05.553792 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m14:08:05.559757 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:08:05.594925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:05.862948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e4ae5b0d-471d-4b6a-9699-b299a6ccf73b&page=queryresults
[0m14:08:05.957193 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m14:08:05.962182 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:06.391068 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
[0m14:08:06.395056 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_pt is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:06.541033 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:76ea4f6b-ac34-4a39-a103-c32d07f4b518&page=queryresults
[0m14:08:06.979205 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
[0m14:08:06.985191 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select category_name_pt as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  where category_name_pt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:06.989177 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:91af945d-4689-445b-87fc-41b5393cf357&page=queryresults
[0m14:08:07.537682 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ce4ec348-a45a-49c2-9ea4-1b61f9e2fa75&page=queryresults
[0m14:08:07.625780 [info ] [Thread-3 (]: 73 of 148 PASS not_null_stg_product_categories_category_group .................. [[32mPASS[0m in 6.83s]
[0m14:08:07.642730 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:08:07.649714 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:08:07.655697 [info ] [Thread-3 (]: 77 of 148 START test accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [RUN]
[0m14:08:07.668020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a, now test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b)
[0m14:08:07.681699 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:08:07.725925 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m14:08:07.729050 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:08:07.757421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:07.900913 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m14:08:07.922725 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:08.496959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5aee9bed-4972-4a12-89c2-e9b2e334dd8a&page=queryresults
[0m14:08:08.862645 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
[0m14:08:08.870624 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        size_category as value_field,
        count(*) as n_records

    from (select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products` where size_category is not null) dbt_subquery
    group by size_category

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Extra Large'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:09.399624 [info ] [Thread-1 (]: 74 of 148 PASS not_null_stg_product_categories_category_name_en ................ [[32mPASS[0m in 6.01s]
[0m14:08:09.404562 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:08:09.406556 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:08:09.408566 [info ] [Thread-1 (]: 78 of 148 START test is_not_negative_stg_products_weight_grams ................. [RUN]
[0m14:08:09.410547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17, now test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890)
[0m14:08:09.414538 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:08:09.437567 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m14:08:09.442462 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:08:09.474386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:09.598117 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d7f151e3-a8b8-4918-a2ad-08699ac26d45&page=queryresults
[0m14:08:09.670267 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m14:08:09.678824 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:10.421246 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0210bd29-d76b-4807-a6cc-7e513a8919cb&page=queryresults
[0m14:08:10.772973 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
[0m14:08:10.778999 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m14:08:10.790960 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    weight_grams as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where weight_grams < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:10.806883 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:11.375427 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ad4ff921-fda9-40e4-9aec-87428d5885bf&page=queryresults
[0m14:08:11.402802 [info ] [Thread-2 (]: 76 of 148 PASS unique_stg_product_categories_category_name_pt .................. [[32mPASS[0m in 5.96s]
[0m14:08:11.408820 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:08:11.412774 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:08:11.418759 [info ] [Thread-2 (]: 79 of 148 START test not_null_stg_products_product_id .......................... [RUN]
[0m14:08:11.425741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:55aa50cf-b75d-4cb6-895b-0b9792a62498&page=queryresults
[0m14:08:11.427734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374, now test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3)
[0m14:08:11.444691 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:08:11.523477 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m14:08:11.528464 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:08:11.539433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:11.602266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m14:08:11.609618 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:12.178309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f1a0426c-3c86-43bb-b545-e0e3c1cb29be&page=queryresults
[0m14:08:12.417777 [info ] [Thread-4 (]: 75 of 148 PASS not_null_stg_product_categories_category_name_pt ................ [[32mPASS[0m in 7.36s]
[0m14:08:12.421766 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:08:12.425885 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:08:12.428632 [info ] [Thread-4 (]: 80 of 148 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m14:08:12.442711 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c, now test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m14:08:12.445850 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:08:12.515965 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m14:08:12.520504 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:08:12.595304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:12.731937 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
[0m14:08:12.736925 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:13.133747 [info ] [Thread-3 (]: 77 of 148 PASS accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [[32mPASS[0m in 5.47s]
[0m14:08:13.143732 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:08:13.145671 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:08:13.149980 [info ] [Thread-3 (]: 81 of 148 START test unique_stg_products_product_id ............................ [RUN]
[0m14:08:13.156639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b, now test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467)
[0m14:08:13.159630 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:08:13.191545 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m14:08:13.205510 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:08:13.223461 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:13.345963 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:652af6d0-cddb-46a6-837f-6b926d9a8114&page=queryresults
[0m14:08:13.702805 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m14:08:13.708787 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:13.890868 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
[0m14:08:13.895161 [debug] [Thread-4 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:14.249947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fb9fe516-36e9-45bc-b43d-14c712335554&page=queryresults
[0m14:08:14.355815 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
[0m14:08:14.359804 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:14.542150 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7ed9cdf9-4377-4145-9128-599d302d0dba&page=queryresults
[0m14:08:14.938783 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bdc30bc8-0bd2-44e1-a060-c419ac12c251&page=queryresults
[0m14:08:15.220033 [info ] [Thread-1 (]: 78 of 148 PASS is_not_negative_stg_products_weight_grams ....................... [[32mPASS[0m in 5.81s]
[0m14:08:15.232000 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:08:15.233994 [debug] [Thread-1 (]: Began running node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:08:15.235991 [info ] [Thread-1 (]: 82 of 148 START snapshot snapshots.customers_snapshot .......................... [RUN]
[0m14:08:15.238983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890, now snapshot.dbt_advanced_olist.customers_snapshot)
[0m14:08:15.240976 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:08:15.259925 [debug] [Thread-1 (]: Began executing node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:08:15.460697 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m14:08:15.610986 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        select customer_city, customer_state, customer_zip_code from (
                



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:08:15.616985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:15.686784 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:16.267183 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:13ef466e-d72f-4a6a-b2a6-2d9a5d9c5812&page=queryresults
[0m14:08:16.610132 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m14:08:16.679532 [debug] [Thread-4 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:17.165207 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m14:08:17.179163 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:17.241648 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:87d65ede-ff5c-46d7-ab75-292b71de05d6&page=queryresults
[0m14:08:17.284589 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:88f30a1b-3774-4411-87f2-7587300f4c2c&page=queryresults
[0m14:08:17.468411 [info ] [Thread-2 (]: 79 of 148 PASS not_null_stg_products_product_id ................................ [[32mPASS[0m in 6.04s]
[0m14:08:17.471359 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:08:17.473354 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m14:08:17.475348 [info ] [Thread-2 (]: 83 of 148 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [RUN]
[0m14:08:17.478342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3, now model.dbt_advanced_olist.int_orders_enriched)
[0m14:08:17.482517 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m14:08:17.520231 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m14:08:17.540848 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m14:08:17.560832 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m14:08:17.571763 [debug] [Thread-2 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m14:08:17.573762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:17.850029 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:91bbc49b-0ad1-496e-90af-d8383d68d767&page=queryresults
[0m14:08:18.163263 [warn ] [Thread-4 (]: 80 of 148 WARN 642 relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[33mWARN 642[0m in 5.72s]
[0m14:08:18.169287 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:08:19.089107 [info ] [Thread-3 (]: 81 of 148 PASS unique_stg_products_product_id .................................. [[32mPASS[0m in 5.93s]
[0m14:08:19.137945 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:08:19.236675 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: 
        
  
    

    create or replace table `big-query-dbt-481111`.`snapshots`.`customers_snapshot__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `big-query-dbt-481111`.`snapshots`.`customers_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */;
[0m14:08:19.238670 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.int_products_enriched
[0m14:08:19.241662 [info ] [Thread-4 (]: 84 of 148 START sql view model dbt_dev_yourname_intermediate.int_products_enriched  [RUN]
[0m14:08:19.243658 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now model.dbt_advanced_olist.int_products_enriched)
[0m14:08:19.246650 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.int_products_enriched
[0m14:08:19.257622 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_products_enriched"
[0m14:08:19.265600 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.int_products_enriched
[0m14:08:19.275818 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_products_enriched"
[0m14:08:19.284027 [debug] [Thread-4 (]: On model.dbt_advanced_olist.int_products_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_products_enriched
  
  Purpose: Enrich products with category translations and sales metrics
*/

with products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
),

categories as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Calculate product-level sales metrics
product_sales as (
    select
        product_id,
        count(distinct order_id) as times_ordered,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_selling_price,
        min(item_price) as min_selling_price,
        max(item_price) as max_selling_price
    from order_items
    group by 1
),

-- Join products with categories and sales
enriched as (
    select
        -- Product info
        p.product_id,
        p.category_name_pt,
        coalesce(c.category_name_en, 'Unknown') as category_name,
        coalesce(c.category_group, 'Other') as category_group,
        
        -- Dimensions
        p.weight_grams,
        p.length_cm,
        p.height_cm,
        p.width_cm,
        p.volume_cm3,
        p.size_category,
        
        -- Product listing quality
        p.name_length,
        p.description_length,
        p.photo_count,
        
        -- Derived: Listing quality score (0-100)
        (
            case when p.name_length > 0 then 20 else 0 end +
            case when p.description_length > 100 then 30 else p.description_length * 0.3 end +
            case when p.photo_count >= 3 then 50 else p.photo_count * 15 end
        ) as listing_quality_score,
        
        -- Sales metrics
        coalesce(ps.times_ordered, 0) as times_ordered,
        coalesce(ps.total_revenue, 0) as total_revenue,
        coalesce(ps.avg_selling_price, 0) as avg_selling_price,
        
        -- Derived: Product popularity tier
        case
            when coalesce(ps.times_ordered, 0) = 0 then 'Never Sold'
            when ps.times_ordered < 5 then 'Low'
            when ps.times_ordered < 20 then 'Medium'
            when ps.times_ordered < 50 then 'High'
            else 'Top Seller'
        end as popularity_tier

    from products p
    left join categories c on p.category_name_pt = c.category_name_pt
    left join product_sales ps on p.product_id = ps.product_id
)

select * from enriched
/* dbt 1.10.15 | model: int_products_enriched | schema: dbt_dev_yourname_intermediate */;
[0m14:08:19.285545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:19.521811 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bfa1202a-66b4-493c-ba72-b087c7bc9b24&page=queryresults
[0m14:08:19.899654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0f169c7e-9bc5-48f8-bf11-49ef5d76d9c4&page=queryresults
[0m14:08:20.092024 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD039B9D0>]}
[0m14:08:20.095017 [info ] [Thread-2 (]: 83 of 148 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.61s]
[0m14:08:20.105169 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m14:08:20.107991 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:08:20.109978 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:08:20.113967 [info ] [Thread-3 (]: 85 of 148 START test assert_order_total_matches_items .......................... [RUN]
[0m14:08:20.117956 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467, now test.dbt_advanced_olist.assert_order_total_matches_items)
[0m14:08:20.119951 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:08:20.115962 [info ] [Thread-2 (]: 86 of 148 START test dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [RUN]
[0m14:08:20.139897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_orders_enriched, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75)
[0m14:08:20.235641 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:08:20.260574 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m14:08:20.271545 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m14:08:20.325402 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:08:20.347828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:20.353325 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:08:20.532908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:20.747287 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7e95ac4a-ee25-474c-aa54-10301013610b&page=queryresults
[0m14:08:21.351694 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD1538090>]}
[0m14:08:21.355731 [info ] [Thread-4 (]: 84 of 148 OK created sql view model dbt_dev_yourname_intermediate.int_products_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m14:08:21.361019 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.int_products_enriched
[0m14:08:21.366656 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:08:21.370710 [info ] [Thread-4 (]: 87 of 148 START test is_not_negative_int_orders_enriched_order_total ........... [RUN]
[0m14:08:21.374734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_products_enriched, now test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf)
[0m14:08:21.376731 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:08:21.418684 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m14:08:21.440074 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:08:21.471994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:21.807593 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
[0m14:08:21.819216 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_order_total_matches_items
  
  Purpose: Order total should equal sum of item totals (within tolerance)
  
  Business Rule: Order total = sum(item_price + item_freight) for all items
  
  Tolerance: 1 BRL to account for rounding
  
  Test PASSES if query returns 0 rows
*/

with order_totals_from_items as (
    select
        order_id,
        sum(item_total) as calculated_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    group by 1
),

order_totals_from_orders as (
    select
        order_id,
        order_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

mismatches as (
    select
        o.order_id,
        o.order_total as reported_total,
        i.calculated_total,
        abs(o.order_total - i.calculated_total) as difference
    from order_totals_from_orders o
    inner join order_totals_from_items i on o.order_id = i.order_id
    where abs(o.order_total - i.calculated_total) > 1  -- 1 BRL tolerance
)

select
    order_id,
    reported_total,
    calculated_total,
    round(difference, 2) as difference_brl,
    'Order total does not match sum of items' as failure_reason
from mismatches
  
  
    )
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:21.937153 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
[0m14:08:21.945096 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and item_count >= 0 and item_count <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:22.458480 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b88a4d25-058f-42d6-9dea-be1c1394c64e&page=queryresults
[0m14:08:22.517233 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:994040b7-7b97-4b1d-9d79-4c078504731b&page=queryresults
[0m14:08:22.774002 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
[0m14:08:22.809907 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    order_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:23.147708 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `big-query-dbt-481111`.`snapshots`.`customers_snapshot`".
[0m14:08:23.565052 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3416d45d-88a5-459e-9622-daab2c5d944a&page=queryresults
[0m14:08:24.271375 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        
    
    with snapshot_query as (

        



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `big-query-dbt-481111`.`snapshots`.`customers_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:08:24.749375 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m14:08:24.781575 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:24.865436 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m14:08:24.870378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:385d6aa1-5155-42ca-b55a-7dc29d745cfb&page=queryresults
[0m14:08:24.888385 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:25.228275 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:08:25.315793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:04bba7a7-35b8-41a8-ab12-6ed1670b4dc2&page=queryresults
[0m14:08:25.437235 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fc033ff9-95eb-4f36-a022-84915f5aff9e&page=queryresults
[0m14:08:25.833923 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m14:08:25.837910 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c9d3a4a8-5bb6-491c-9b28-4fac4ac6c1b5&page=queryresults
[0m14:08:25.854064 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:26.197494 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_advanced_olist.customers_snapshot"
[0m14:08:26.218312 [info ] [Thread-2 (]: 86 of 148 PASS dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [[32mPASS[0m in 6.08s]
[0m14:08:26.224726 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:08:26.226681 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:08:26.229676 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: 
      merge into `big-query-dbt-481111`.`snapshots`.`customers_snapshot` as DBT_INTERNAL_DEST
    using `big-query-dbt-481111`.`snapshots`.`customers_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_city`, `customer_state`, `customer_zip_code`, `customer_region`, `_snapshot_at`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_city`, `customer_state`, `customer_zip_code`, `customer_region`, `_snapshot_at`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:08:26.232274 [info ] [Thread-2 (]: 88 of 148 START test not_null_int_orders_enriched_item_count ................... [RUN]
[0m14:08:26.239256 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75, now test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101)
[0m14:08:26.241508 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:08:26.259204 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m14:08:26.269183 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:08:26.284508 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:26.423238 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:adf2a0e9-3c35-4eef-ae69-1d990073ec92&page=queryresults
[0m14:08:26.512997 [info ] [Thread-3 (]: 85 of 148 PASS assert_order_total_matches_items ................................ [[32mPASS[0m in 6.39s]
[0m14:08:26.516986 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:08:26.518981 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:08:26.520975 [info ] [Thread-3 (]: 89 of 148 START test not_null_int_orders_enriched_order_id ..................... [RUN]
[0m14:08:26.523006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_order_total_matches_items, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e)
[0m14:08:26.524965 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:08:26.546908 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m14:08:26.553889 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:08:26.578819 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:da4decc8-3dbf-4b32-b816-e811f765c53d&page=queryresults
[0m14:08:26.590787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:26.581912 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:da4decc8-3dbf-4b32-b816-e811f765c53d&page=queryresults
[0m14:08:26.847271 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m14:08:26.855248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD15D1D90>]}
[0m14:08:26.866221 [error] [Thread-1 (]: 82 of 148 ERROR snapshotting snapshots.customers_snapshot ...................... [[31mERROR[0m in 11.62s]
[0m14:08:26.872259 [debug] [Thread-1 (]: Finished running node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:08:26.875193 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:08:26.884174 [debug] [Thread-7 (]: Marking all children of 'snapshot.dbt_advanced_olist.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql.
[0m14:08:26.889157 [info ] [Thread-1 (]: 90 of 148 START test not_null_int_orders_enriched_order_total .................. [RUN]
[0m14:08:26.899765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_advanced_olist.customers_snapshot, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c)
[0m14:08:26.904742 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:08:26.956018 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m14:08:26.958969 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:08:26.974925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:27.535834 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
[0m14:08:27.557780 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:27.550795 [info ] [Thread-4 (]: 87 of 148 PASS is_not_negative_int_orders_enriched_order_total ................. [[32mPASS[0m in 6.18s]
[0m14:08:27.574773 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:08:27.581712 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:08:27.586785 [info ] [Thread-4 (]: 91 of 148 START test unique_int_orders_enriched_order_id ....................... [RUN]
[0m14:08:27.596706 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf, now test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232)
[0m14:08:27.601660 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:08:27.631612 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m14:08:27.635565 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:08:27.654513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:27.725043 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
[0m14:08:27.729198 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:28.183787 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
[0m14:08:28.199740 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:28.822160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:597b71ae-39af-4a83-a6df-f9faadc4bea9&page=queryresults
[0m14:08:28.844053 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e45875ed-1b8a-4dcc-9d4f-22af91e968df&page=queryresults
[0m14:08:28.884944 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:87ca17b4-8958-4a45-b7bc-3d3407876d8f&page=queryresults
[0m14:08:28.933707 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
[0m14:08:28.939725 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:29.714029 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:327fd637-a958-4ac1-a7a5-52a42e06be7f&page=queryresults
[0m14:08:31.158245 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m14:08:31.162190 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m14:08:31.168876 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:31.171884 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m14:08:31.176270 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:31.186915 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:31.769229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d7cb9b52-e986-47a1-843e-8402d8de9e2a&page=queryresults
[0m14:08:31.772957 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1ec1584a-b467-4715-8c90-348dce44566f&page=queryresults
[0m14:08:31.776325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ca1ab5eb-d5fb-4af2-8525-81fa05a86a21&page=queryresults
[0m14:08:32.840077 [info ] [Thread-2 (]: 88 of 148 PASS not_null_int_orders_enriched_item_count ......................... [[32mPASS[0m in 6.60s]
[0m14:08:32.853875 [info ] [Thread-3 (]: 89 of 148 PASS not_null_int_orders_enriched_order_id ........................... [[32mPASS[0m in 6.33s]
[0m14:08:32.866629 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:08:32.871620 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:08:32.875781 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:08:32.880768 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:08:32.885831 [info ] [Thread-2 (]: 92 of 148 START test dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [RUN]
[0m14:08:32.905909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd)
[0m14:08:32.889822 [info ] [Thread-3 (]: 93 of 148 START test not_null_int_products_enriched_category_name .............. [RUN]
[0m14:08:32.911205 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:08:32.917883 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e, now test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760)
[0m14:08:32.952260 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m14:08:32.953279 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:08:32.967726 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m14:08:32.969722 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:08:32.983908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:32.984821 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:08:33.040065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:33.088803 [info ] [Thread-1 (]: 90 of 148 PASS not_null_int_orders_enriched_order_total ........................ [[32mPASS[0m in 6.19s]
[0m14:08:33.092767 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:08:33.094846 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:08:33.096754 [info ] [Thread-1 (]: 94 of 148 START test not_null_int_products_enriched_product_id ................. [RUN]
[0m14:08:33.097751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c, now test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565)
[0m14:08:33.099745 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:08:33.114069 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m14:08:33.116700 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:08:33.124761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:33.271218 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m14:08:33.280306 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:34.426568 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:48b5f6f0-0198-465d-85c4-8318d923252c&page=queryresults
[0m14:08:35.519967 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
[0m14:08:35.527034 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
[0m14:08:35.545222 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where category_name is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:35.557889 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and listing_quality_score >= 0 and listing_quality_score <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:36.038282 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
[0m14:08:36.048995 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:36.051357 [info ] [Thread-4 (]: 91 of 148 PASS unique_int_orders_enriched_order_id ............................. [[32mPASS[0m in 8.46s]
[0m14:08:36.063004 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:08:36.066011 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:08:36.068996 [info ] [Thread-4 (]: 95 of 148 START test unique_int_products_enriched_product_id ................... [RUN]
[0m14:08:36.073255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232, now test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117)
[0m14:08:36.078553 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:08:36.106402 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m14:08:36.117713 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:08:36.150670 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:36.447818 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eebd40c5-74bb-4a18-970c-05cf8a2444e0&page=queryresults
[0m14:08:36.459926 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dc627a68-2788-4576-bccc-47e681b52afd&page=queryresults
[0m14:08:36.967921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2d6616ac-b476-4126-be55-3963530f86ba&page=queryresults
[0m14:08:37.802376 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
[0m14:08:37.810449 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:38.733903 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4a8fa5b2-d87c-4d54-aa73-81d54daeff35&page=queryresults
[0m14:08:39.450058 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m14:08:39.470549 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:40.195413 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m14:08:40.201240 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:40.210974 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d1c5cc8d-be98-49db-85c7-a2208fc93c30&page=queryresults
[0m14:08:40.805126 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:27792c96-372e-4aac-9b8b-80de52438640&page=queryresults
[0m14:08:40.955858 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m14:08:40.972898 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:41.336837 [info ] [Thread-1 (]: 94 of 148 PASS not_null_int_products_enriched_product_id ....................... [[32mPASS[0m in 8.24s]
[0m14:08:41.344578 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:08:41.349051 [debug] [Thread-1 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:08:41.353684 [info ] [Thread-1 (]: 96 of 148 START unit_test dim_customers::test_customer_segment_high_value ...... [RUN]
[0m14:08:41.359606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value)
[0m14:08:41.366943 [debug] [Thread-1 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:08:41.383211 [debug] [Thread-1 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:08:41.612853 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e7038b0a-c91c-4bad-9b27-8b0cb7943cd8&page=queryresults
[0m14:08:41.694640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:41.764839 [info ] [Thread-2 (]: 92 of 148 PASS dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [[32mPASS[0m in 8.86s]
[0m14:08:41.768801 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:08:43.025798 [info ] [Thread-4 (]: 95 of 148 PASS unique_int_products_enriched_product_id ......................... [[32mPASS[0m in 6.95s]
[0m14:08:43.094650 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:08:43.161052 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:08:43.662867 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:08:43.866637 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:08:43.953210 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_high_value__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */;
[0m14:08:44.768726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fbf64448-06f6-43d7-adbb-a939a7284103&page=queryresults
[0m14:08:46.703948 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m14:08:46.712926 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:08:47.368276 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0268f387-ae42-46e2-ad3e-4620efbc4316&page=queryresults
[0m14:08:48.355555 [info ] [Thread-3 (]: 93 of 148 PASS not_null_int_products_enriched_category_name .................... [[32mPASS[0m in 15.44s]
[0m14:08:48.369758 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:08:48.382817 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.fct_orders
[0m14:08:48.392458 [info ] [Thread-2 (]: 97 of 148 START sql table model dbt_dev_yourname_marts.fct_orders .............. [RUN]
[0m14:08:48.402437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd, now model.dbt_advanced_olist.fct_orders)
[0m14:08:48.414183 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.fct_orders
[0m14:08:48.437121 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.fct_orders"
[0m14:08:48.446097 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.fct_orders
[0m14:08:48.466043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:49.869345 [debug] [Thread-2 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m14:08:50.831974 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:13b888d8-ff96-4432-b24f-b583b58ddbe9&page=queryresults
[0m14:08:50.870867 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:08:50.907486 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''High Value''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */
[0m14:08:51.258799 [warn ] [Thread-2 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['subtotal', 'freight_total', 'order_total', 'avg_item_price']`
[0m14:08:51.261820 [debug] [Thread-2 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        select
    
      
    cast(null as string)
 as order_id, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as order_status, 
      
    cast(null as date)
 as order_date, 
      
    cast(null as timestamp)
 as ordered_at, 
      
    cast(null as timestamp)
 as approved_at, 
      
    cast(null as timestamp)
 as shipped_at, 
      
    cast(null as timestamp)
 as delivered_at, 
      
    cast(null as timestamp)
 as estimated_delivery_at, 
      
    cast(null as int64)
 as order_year, 
      
    cast(null as int64)
 as order_month, 
      
    cast(null as int64)
 as order_quarter, 
      
    cast(null as int64)
 as order_week, 
      
    cast(null as int64)
 as order_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as string)
 as primary_category, 
      
    cast(null as string)
 as primary_category_group, 
      
    cast(null as int64)
 as item_count, 
      
    cast(null as int64)
 as unique_products, 
      
    cast(null as numeric)
 as subtotal, 
      
    cast(null as numeric)
 as freight_total, 
      
    cast(null as numeric)
 as order_total, 
      
    cast(null as numeric)
 as avg_item_price, 
      
    cast(null as int64)
 as delivery_days, 
      
    cast(null as boolean)
 as is_late_delivery, 
      
    cast(null as int64)
 as days_late, 
      
    cast(null as string)
 as order_size_bucket, 
      
    cast(null as string)
 as delivery_sla_status, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m14:08:51.409333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c9128a6-fc34-41c8-9b0c-9c27ee00b9f6&page=queryresults
[0m14:08:51.817764 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:33bfd397-69b7-4447-9314-d445c4143ec5&page=queryresults
[0m14:08:52.234093 [warn ] [Thread-2 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m14:08:52.260800 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.fct_orders"
[0m14:08:52.264483 [debug] [Thread-2 (]: On model.dbt_advanced_olist.fct_orders: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
        
  (
    order_id string not null primary key not enforced,
    customer_id string,
    order_status string,
    order_date date,
    ordered_at timestamp,
    approved_at timestamp,
    shipped_at timestamp,
    delivered_at timestamp,
    estimated_delivery_at timestamp,
    order_year int64,
    order_month int64,
    order_quarter int64,
    order_week int64,
    order_day_of_week int64,
    is_weekend boolean,
    customer_city string,
    customer_state string,
    customer_region string,
    primary_category string,
    primary_category_group string,
    item_count int64,
    unique_products int64,
    subtotal numeric,
    freight_total numeric,
    order_total numeric,
    avg_item_price numeric,
    delivery_days int64,
    is_late_delivery boolean,
    days_late int64,
    order_size_bucket string,
    delivery_sla_status string,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(order_date, month)
    cluster by order_status, customer_state

    
    OPTIONS()
    as (
      
    select order_id, customer_id, order_status, order_date, ordered_at, approved_at, shipped_at, delivered_at, estimated_delivery_at, order_year, order_month, order_quarter, order_week, order_day_of_week, is_weekend, customer_city, customer_state, customer_region, primary_category, primary_category_group, item_count, unique_products, subtotal, freight_total, order_total, avg_item_price, delivery_days, is_late_delivery, days_late, order_size_bucket, delivery_sla_status, _loaded_at
    from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */;
[0m14:08:52.793746 [info ] [Thread-1 (]: 96 of 148 PASS dim_customers::test_customer_segment_high_value ................. [[32mPASS[0m in 11.43s]
[0m14:08:52.798708 [debug] [Thread-1 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:08:52.801748 [debug] [Thread-1 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:08:52.805689 [info ] [Thread-1 (]: 98 of 148 START unit_test dim_customers::test_customer_segment_no_orders ....... [RUN]
[0m14:08:52.811674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders)
[0m14:08:52.815509 [debug] [Thread-1 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:08:52.817506 [debug] [Thread-1 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:08:52.881287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:53.453721 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a29ed038-4bc3-427f-afcc-7884f14c46e1&page=queryresults
[0m14:08:55.152294 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:08:55.849371 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:08:55.952449 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:08:55.984766 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_no_orders__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */;
[0m14:08:56.552625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:18126913-164a-4ef5-936f-7509d86eda0e&page=queryresults
[0m14:08:56.959512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD17DE990>]}
[0m14:08:56.963536 [info ] [Thread-2 (]: 97 of 148 OK created sql table model dbt_dev_yourname_marts.fct_orders ......... [[32mCREATE TABLE (0.0 rows, 2.8 MiB processed)[0m in 8.56s]
[0m14:08:56.968522 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.fct_orders
[0m14:08:56.977463 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:08:56.980496 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:08:56.982449 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:08:56.986452 [info ] [Thread-3 (]: 99 of 148 START test accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [RUN]
[0m14:08:57.003393 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760, now test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670)
[0m14:08:56.992422 [info ] [Thread-4 (]: 100 of 148 START test accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [RUN]
[0m14:08:57.016359 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:08:56.998408 [info ] [Thread-2 (]: 101 of 148 START test accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:08:57.026686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117, now test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c)
[0m14:08:57.094479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.fct_orders, now test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969)
[0m14:08:57.093367 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m14:08:57.099351 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:08:57.101342 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:08:57.121288 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m14:08:57.136335 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m14:08:57.139286 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:08:57.143275 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:08:57.157237 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:08:57.159232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:57.166593 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:57.177127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:58.406691 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
[0m14:08:58.415678 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        delivery_sla_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by delivery_sla_status

)

select *
from all_values
where value_field not in (
    'Met','Missed','Canceled','In Progress'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:58.536344 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
[0m14:08:58.553317 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:58.582269 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
[0m14:08:58.587207 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_size_bucket as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_size_bucket

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Premium'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:08:58.930293 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7b532422-6bfc-43e3-af10-fa619faee39b&page=queryresults
[0m14:08:58.965197 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:08:58.984147 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''No Orders''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */
[0m14:08:59.007086 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c326d13-aad7-482a-b11d-88d246d18955&page=queryresults
[0m14:08:59.162669 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5211befb-6cb9-4c74-b1c7-de0c716df89c&page=queryresults
[0m14:08:59.541655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7af412b7-ab73-4182-9fbd-82807501748f&page=queryresults
[0m14:09:01.065361 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m14:09:01.083412 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:01.106255 [info ] [Thread-1 (]: 98 of 148 PASS dim_customers::test_customer_segment_no_orders .................. [[32mPASS[0m in 8.29s]
[0m14:09:01.112238 [debug] [Thread-1 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:09:01.114231 [debug] [Thread-1 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:09:01.115229 [info ] [Thread-1 (]: 118 of 148 START unit_test dim_customers::test_customer_segment_vip ............ [RUN]
[0m14:09:01.118481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip)
[0m14:09:01.121330 [debug] [Thread-1 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:09:01.124237 [debug] [Thread-1 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:09:01.209050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:01.450188 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m14:09:01.462113 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:01.678638 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ae8fa13a-6b29-4bf8-b307-dc2bde113eb2&page=queryresults
[0m14:09:01.974856 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m14:09:01.989814 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:01.999089 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f5b95b31-7347-4a07-b8d9-aebb060baa1e&page=queryresults
[0m14:09:02.598519 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0207461e-0b1f-451f-8ddf-d3777ae60061&page=queryresults
[0m14:09:02.603509 [info ] [Thread-3 (]: 99 of 148 PASS accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [[32mPASS[0m in 5.60s]
[0m14:09:02.616470 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:09:02.621457 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:09:02.626443 [info ] [Thread-3 (]: 102 of 148 START test is_not_negative_fct_orders_freight_total ................. [RUN]
[0m14:09:02.633424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670, now test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20)
[0m14:09:02.663346 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:09:02.700449 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m14:09:02.707227 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:09:02.723226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:03.012849 [info ] [Thread-2 (]: 101 of 148 PASS accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 5.92s]
[0m14:09:03.017837 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:09:03.021975 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:09:03.024869 [info ] [Thread-2 (]: 103 of 148 START test is_not_negative_fct_orders_subtotal ...................... [RUN]
[0m14:09:03.028809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969, now test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4)
[0m14:09:03.032797 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:09:03.063082 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m14:09:03.072926 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:09:03.110591 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:03.478994 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:09:03.897199 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:09:03.907170 [info ] [Thread-4 (]: 100 of 148 PASS accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [[32mPASS[0m in 6.88s]
[0m14:09:03.998926 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:09:04.041812 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:09:04.057768 [info ] [Thread-4 (]: 104 of 148 START test not_null_fct_orders_customer_id .......................... [RUN]
[0m14:09:04.105639 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c, now test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b)
[0m14:09:04.123592 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:09:04.160492 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:09:04.182941 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:09:04.235399 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_vip__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */;
[0m14:09:04.245378 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:09:04.266317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:04.916887 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
[0m14:09:04.923629 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
[0m14:09:04.926622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f3f22938-6af7-4b7b-815e-f5103dd04fcc&page=queryresults
[0m14:09:04.930660 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    freight_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:04.937596 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    subtotal as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:05.468184 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f7717974-58fa-43f2-a352-0e50fa1f7218&page=queryresults
[0m14:09:05.490792 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:51f81e49-cb40-41ed-a653-a6f7e0da1644&page=queryresults
[0m14:09:06.006996 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
[0m14:09:06.013027 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:06.597949 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:729fbf33-e406-4e20-a519-97bd3755b4b4&page=queryresults
[0m14:09:07.167653 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:09:07.210823 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''VIP''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */
[0m14:09:07.710269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f6ae426b-65d7-4787-8179-f8e4bb35bb6e&page=queryresults
[0m14:09:07.909348 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m14:09:07.913344 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m14:09:07.924322 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:07.929294 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:08.445322 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5f526a3e-4151-4146-945c-f5037cf726f9&page=queryresults
[0m14:09:08.511177 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3a8bc2a6-424e-49d9-9738-2ee63a7c9521&page=queryresults
[0m14:09:08.671454 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:09:08.682377 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:09.249281 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:62acfc6e-005a-45ae-8ff0-418150d5fa9b&page=queryresults
[0m14:09:09.446584 [info ] [Thread-3 (]: 102 of 148 PASS is_not_negative_fct_orders_freight_total ....................... [[32mPASS[0m in 6.81s]
[0m14:09:09.456514 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:09:09.462995 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:09:09.469482 [info ] [Thread-3 (]: 105 of 148 START test not_null_fct_orders_delivery_sla_status .................. [RUN]
[0m14:09:09.482445 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20, now test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0)
[0m14:09:09.493503 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:09:09.508380 [info ] [Thread-2 (]: 103 of 148 PASS is_not_negative_fct_orders_subtotal ............................ [[32mPASS[0m in 6.48s]
[0m14:09:09.538296 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:09:09.542284 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:09:09.565221 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m14:09:09.567216 [info ] [Thread-2 (]: 106 of 148 START test not_null_fct_orders_freight_total ........................ [RUN]
[0m14:09:09.579184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4, now test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3)
[0m14:09:09.585173 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:09:09.610102 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:09:09.582178 [info ] [Thread-1 (]: 118 of 148 PASS dim_customers::test_customer_segment_vip ....................... [[32mPASS[0m in 8.46s]
[0m14:09:09.612098 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m14:09:09.629051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:09.631046 [debug] [Thread-1 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:09:09.727786 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m14:09:09.730781 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:09:09.746738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:09.735769 [info ] [Thread-1 (]: 119 of 148 START sql table model dbt_dev_yourname_marts.dim_customers .......... [RUN]
[0m14:09:09.841528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip, now model.dbt_advanced_olist.dim_customers)
[0m14:09:09.846473 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m14:09:09.866420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m14:09:09.872400 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m14:09:09.880380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:10.279069 [info ] [Thread-4 (]: 104 of 148 PASS not_null_fct_orders_customer_id ................................ [[32mPASS[0m in 6.17s]
[0m14:09:10.287012 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:09:10.291989 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:09:10.294990 [info ] [Thread-4 (]: 107 of 148 START test not_null_fct_orders_item_count ........................... [RUN]
[0m14:09:10.302545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91)
[0m14:09:10.308948 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:09:10.400741 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m14:09:10.409675 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:09:10.429621 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:11.098546 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
[0m14:09:11.107527 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where delivery_sla_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:11.133668 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
[0m14:09:11.144740 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:11.328935 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m14:09:11.603648 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:331773b1-8eb1-4bcc-b90d-fd818d3aa7e9&page=queryresults
[0m14:09:11.609630 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5aa6690a-6419-47ca-ae0a-e0e71fe630a0&page=queryresults
[0m14:09:11.788860 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
[0m14:09:11.793852 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:12.125728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c1c707e-309a-4a3d-9c51-9ac1f54f4006&page=queryresults
[0m14:09:12.300640 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:efbf1d6d-8682-46dd-82ae-16dc40afb389&page=queryresults
[0m14:09:12.625889 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m14:09:12.630924 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m14:09:13.271381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b626cacd-be60-4fdc-b1cb-e61efb5f3983&page=queryresults
[0m14:09:13.854653 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m14:09:13.849669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m14:09:13.868617 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:13.875598 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m14:09:14.271818 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m14:09:14.280537 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:14.556048 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:27e132b4-5ed6-4833-ba73-594825039d66&page=queryresults
[0m14:09:14.745631 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m14:09:14.754424 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:59001998-dc6f-4b53-80f6-b672585fd1e7&page=queryresults
[0m14:09:14.765395 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:14.938492 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a25de783-11e0-44b4-8c35-9f965879a72d&page=queryresults
[0m14:09:15.526096 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4569df57-ca31-4910-b309-82464886fa47&page=queryresults
[0m14:09:15.921662 [info ] [Thread-2 (]: 106 of 148 PASS not_null_fct_orders_freight_total .............................. [[32mPASS[0m in 6.34s]
[0m14:09:15.936624 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:09:15.942608 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:09:15.947594 [info ] [Thread-2 (]: 108 of 148 START test not_null_fct_orders_order_date ........................... [RUN]
[0m14:09:15.957570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3, now test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362)
[0m14:09:15.962593 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:09:15.999509 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m14:09:16.010423 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:09:16.024387 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:16.620909 [info ] [Thread-3 (]: 105 of 148 PASS not_null_fct_orders_delivery_sla_status ........................ [[32mPASS[0m in 7.14s]
[0m14:09:16.626892 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:09:16.628887 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:09:16.630883 [info ] [Thread-3 (]: 109 of 148 START test not_null_fct_orders_order_id ............................. [RUN]
[0m14:09:16.635869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0, now test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0)
[0m14:09:16.638861 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:09:16.660804 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m14:09:16.678754 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:09:16.698702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:17.005880 [info ] [Thread-4 (]: 107 of 148 PASS not_null_fct_orders_item_count ................................. [[32mPASS[0m in 6.70s]
[0m14:09:17.010866 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:09:17.013859 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:09:17.015853 [info ] [Thread-4 (]: 110 of 148 START test not_null_fct_orders_order_status ......................... [RUN]
[0m14:09:17.021002 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91, now test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b)
[0m14:09:17.022834 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:09:17.041784 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m14:09:17.046778 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:09:17.063840 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:17.756577 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
[0m14:09:17.771536 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:17.778741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94b2393d-54ad-4ba5-b2d6-9aa7dbd998d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FD1A69AD0>]}
[0m14:09:17.787497 [info ] [Thread-1 (]: 119 of 148 OK created sql table model dbt_dev_yourname_marts.dim_customers ..... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 7.94s]
[0m14:09:17.793482 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m14:09:17.796469 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:09:17.804447 [info ] [Thread-1 (]: 111 of 148 START test not_null_fct_orders_order_total .......................... [RUN]
[0m14:09:17.809435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_customers, now test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6)
[0m14:09:17.812760 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:09:17.846340 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m14:09:17.854317 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:09:17.875303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:17.996348 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
[0m14:09:18.004279 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:18.519307 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
[0m14:09:18.521301 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e887ccc0-641d-4ef5-b283-67715c2d8a68&page=queryresults
[0m14:09:18.526287 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a3fb4afe-2086-4a7f-88ec-75f2967414ac&page=queryresults
[0m14:09:18.529280 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:18.986058 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:92b3065c-b39a-4896-bcb3-0e2d68f136c8&page=queryresults
[0m14:09:19.363051 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
[0m14:09:19.368038 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:19.890579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0dbeba65-80f2-4fd3-8bf6-16faf0d0b58f&page=queryresults
[0m14:09:20.812579 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m14:09:20.819568 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:21.204703 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m14:09:21.210726 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:21.454354 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9d40f9b3-b447-4b57-9ceb-0ac995d53d82&page=queryresults
[0m14:09:21.760269 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a34dfb87-eb82-4fab-9b81-c4f2142ec109&page=queryresults
[0m14:09:21.946117 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m14:09:21.959081 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:22.356452 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m14:09:22.365380 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:22.762181 [info ] [Thread-2 (]: 108 of 148 PASS not_null_fct_orders_order_date ................................. [[32mPASS[0m in 6.81s]
[0m14:09:22.773603 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:09:22.766168 [info ] [Thread-4 (]: 110 of 148 PASS not_null_fct_orders_order_status ............................... [[32mPASS[0m in 5.74s]
[0m14:09:22.777139 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:09:22.781171 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:09:22.789113 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:09:22.786115 [info ] [Thread-2 (]: 112 of 148 START test not_null_fct_orders_ordered_at ........................... [RUN]
[0m14:09:22.796090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362, now test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9)
[0m14:09:22.802073 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:09:22.793097 [info ] [Thread-4 (]: 113 of 148 START test not_null_fct_orders_primary_category ..................... [RUN]
[0m14:09:22.833988 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m14:09:22.842147 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b, now test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67)
[0m14:09:22.844184 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:30f5fc09-9fe2-4de2-be43-dc1379ac22c8&page=queryresults
[0m14:09:22.846952 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:09:22.871887 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:09:22.874877 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m14:09:22.880862 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:22.946857 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:09:22.960647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:23.077449 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f395dafb-4c98-4388-bd6a-f49d01d34079&page=queryresults
[0m14:09:23.871564 [info ] [Thread-3 (]: 109 of 148 PASS not_null_fct_orders_order_id ................................... [[32mPASS[0m in 7.24s]
[0m14:09:23.881533 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:09:23.886521 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:09:23.891510 [info ] [Thread-3 (]: 114 of 148 START test not_null_fct_orders_primary_category_group ............... [RUN]
[0m14:09:23.896496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed)
[0m14:09:23.908462 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:09:23.954338 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m14:09:23.961344 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:09:23.995271 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:25.460202 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
[0m14:09:25.471127 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:25.928564 [info ] [Thread-1 (]: 111 of 148 PASS not_null_fct_orders_order_total ................................ [[32mPASS[0m in 8.12s]
[0m14:09:25.937531 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:09:25.944510 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
[0m14:09:25.950494 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:09:25.962508 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:25.969442 [info ] [Thread-1 (]: 115 of 148 START test not_null_fct_orders_subtotal ............................. [RUN]
[0m14:09:25.979424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6, now test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0)
[0m14:09:25.988391 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:09:26.028284 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m14:09:26.030328 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:81d2583e-bcc7-4e86-bd0e-ff877e7d8592&page=queryresults
[0m14:09:26.045241 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:09:26.064241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:26.524208 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:573801ee-ee77-486d-a33d-21aa9e0e7e90&page=queryresults
[0m14:09:26.554829 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
[0m14:09:26.562708 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:27.505137 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
[0m14:09:27.513149 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:27.530104 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:349d7f8b-27f8-4bed-97c2-5290cac611b6&page=queryresults
[0m14:09:28.019308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c468962-8966-43c1-a6bd-c6de22391077&page=queryresults
[0m14:09:28.071503 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m14:09:28.077450 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:28.593934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a22daedc-3ecc-4971-aaf4-b6642449f8c1&page=queryresults
[0m14:09:28.775563 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m14:09:28.782499 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:29.341429 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d073fcf5-7293-432f-9e03-703d528b183a&page=queryresults
[0m14:09:29.545268 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m14:09:29.550257 [info ] [Thread-4 (]: 113 of 148 PASS not_null_fct_orders_primary_category ........................... [[32mPASS[0m in 6.71s]
[0m14:09:29.562222 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:09:29.567210 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:29.571201 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:09:29.587176 [info ] [Thread-4 (]: 116 of 148 START test not_null_fct_orders_unique_products ...................... [RUN]
[0m14:09:29.592142 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67, now test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7)
[0m14:09:29.595188 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:09:29.627102 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m14:09:29.636176 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:09:29.663320 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:30.310061 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c56f6a9a-abbf-4fa8-9014-576db97f404d&page=queryresults
[0m14:09:30.315047 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m14:09:30.336987 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:30.488039 [info ] [Thread-2 (]: 112 of 148 PASS not_null_fct_orders_ordered_at ................................. [[32mPASS[0m in 7.69s]
[0m14:09:30.492075 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:09:30.495020 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:09:30.497015 [info ] [Thread-2 (]: 117 of 148 START test unique_fct_orders_order_id ............................... [RUN]
[0m14:09:30.503000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9, now test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5)
[0m14:09:30.504996 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:09:30.539900 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m14:09:30.542891 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:09:30.822148 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:30.902929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:64684726-e55e-4fb7-a0c3-95083307f3ae&page=queryresults
[0m14:09:31.136912 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
[0m14:09:31.140900 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where unique_products is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:31.443988 [info ] [Thread-3 (]: 114 of 148 PASS not_null_fct_orders_primary_category_group ..................... [[32mPASS[0m in 7.55s]
[0m14:09:31.452997 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:09:31.456953 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:09:31.459945 [info ] [Thread-3 (]: 120 of 148 START test accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m14:09:31.466924 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213)
[0m14:09:31.469917 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:09:31.488865 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m14:09:31.495847 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:09:31.511803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:31.651455 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9250dd78-90f0-4810-b917-586fa192548d&page=queryresults
[0m14:09:31.820691 [info ] [Thread-1 (]: 115 of 148 PASS not_null_fct_orders_subtotal ................................... [[32mPASS[0m in 5.84s]
[0m14:09:31.825681 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:09:31.828776 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:09:31.832661 [info ] [Thread-1 (]: 121 of 148 START test accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [RUN]
[0m14:09:31.838644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0)
[0m14:09:31.841635 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:09:31.912866 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m14:09:31.920430 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:09:31.932395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:32.194063 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
[0m14:09:32.202387 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:32.846858 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5692fd10-2783-494e-b7e4-08a243bed9e3&page=queryresults
[0m14:09:33.008228 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
[0m14:09:33.016173 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:33.720799 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
[0m14:09:33.737470 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7f2eee61-8e70-45f8-882b-cb224c2ae489&page=queryresults
[0m14:09:33.746443 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'VIP','High Value','Medium Value','Low Value','No Orders'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:34.341413 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m14:09:34.356341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aeaae1cc-5ec4-4ebc-b833-59c9d64fec8a&page=queryresults
[0m14:09:34.372587 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:35.055444 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m14:09:35.063642 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d4e7f5bb-15e9-446f-9447-18a18ee40a88&page=queryresults
[0m14:09:35.078023 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:35.619876 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m14:09:35.622873 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5bb1b99c-eca3-4c77-a028-97b2c4547c4a&page=queryresults
[0m14:09:35.634566 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:36.405691 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea4cd7a3-86a5-4aa0-8312-3a223a4bfe3f&page=queryresults
[0m14:09:36.807781 [info ] [Thread-4 (]: 116 of 148 PASS not_null_fct_orders_unique_products ............................ [[32mPASS[0m in 7.22s]
[0m14:09:36.828675 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:09:36.836891 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:09:36.841649 [info ] [Thread-4 (]: 122 of 148 START test accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [RUN]
[0m14:09:36.845963 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7, now test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09)
[0m14:09:36.851730 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:09:36.907631 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m14:09:36.920547 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:09:36.939545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:37.161277 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m14:09:37.149308 [info ] [Thread-2 (]: 117 of 148 PASS unique_fct_orders_order_id ..................................... [[32mPASS[0m in 6.64s]
[0m14:09:37.169253 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:09:37.173245 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:09:37.176245 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:37.179228 [info ] [Thread-2 (]: 123 of 148 START test assert_vip_customer_criteria ............................. [RUN]
[0m14:09:37.194237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_advanced_olist.assert_vip_customer_criteria)
[0m14:09:37.197179 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:09:37.221118 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m14:09:37.223156 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:09:37.238069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:37.735548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ac3224d4-f978-452b-b8c1-7c766ade9a04&page=queryresults
[0m14:09:37.898033 [info ] [Thread-3 (]: 120 of 148 PASS accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 6.43s]
[0m14:09:37.903069 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:09:37.906014 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:09:37.909002 [info ] [Thread-3 (]: 124 of 148 START test dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [RUN]
[0m14:09:37.913989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d)
[0m14:09:37.918974 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:09:37.968884 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m14:09:37.975823 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:09:37.987823 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:38.364798 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
[0m14:09:38.370519 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        purchase_frequency as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by purchase_frequency

)

select *
from all_values
where value_field not in (
    'Frequent','Repeat','One-Time','Never Purchased'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:38.417455 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
[0m14:09:38.423492 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_vip_customer_criteria
  
  Purpose: VIP customers must meet the defined criteria
  
  Business Rule: VIP = lifetime_revenue >= 500 AND lifetime_orders >= 3
  
  Test PASSES if query returns 0 rows
*/

with vip_customers as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where customer_segment = 'VIP'
),

invalid_vips as (
    select
        customer_id,
        lifetime_revenue,
        lifetime_orders,
        'VIP but does not meet criteria' as violation
    from vip_customers
    where lifetime_revenue < 500
       or lifetime_orders < 3
),

should_be_vips as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders,
        'Should be VIP but is not' as violation
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where lifetime_revenue >= 500
      and lifetime_orders >= 3
      and customer_segment != 'VIP'
)

select * from invalid_vips
union all
select customer_id, lifetime_revenue, lifetime_orders, violation from should_be_vips
  
  
    )
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:38.661125 [info ] [Thread-1 (]: 121 of 148 PASS accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [[32mPASS[0m in 6.82s]
[0m14:09:38.676080 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:09:38.682065 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:09:38.687051 [info ] [Thread-1 (]: 125 of 148 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [RUN]
[0m14:09:38.693143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9)
[0m14:09:38.703011 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:09:38.763234 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m14:09:38.773162 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:09:38.799837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:38.848617 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1ef279af-cb3d-434a-9e45-3e67353b687a&page=queryresults
[0m14:09:38.925706 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e00c8811-e7fb-4d06-a6b4-3978b42e33dc&page=queryresults
[0m14:09:39.454865 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
[0m14:09:39.470827 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:40.173882 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b4834163-9e88-4cd6-a298-ed3455c3edb8&page=queryresults
[0m14:09:40.371709 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
[0m14:09:40.382675 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and late_delivery_rate >= 0 and late_delivery_rate <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:40.985659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:87ab0664-2673-4dd8-949f-565a9dee0d45&page=queryresults
[0m14:09:41.023278 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m14:09:41.027222 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:41.709696 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c8fc1b90-5932-48de-8c75-c99deb13a94f&page=queryresults
[0m14:09:42.076147 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m14:09:42.095094 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:42.461281 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m14:09:42.502128 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:42.724173 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e7def76-e167-4ce1-a3f3-f13cf8b2f6f5&page=queryresults
[0m14:09:42.841667 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m14:09:42.858577 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:42.849601 [info ] [Thread-4 (]: 122 of 148 PASS accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [[32mPASS[0m in 6.00s]
[0m14:09:42.881516 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:09:42.888497 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:09:42.894101 [info ] [Thread-4 (]: 126 of 148 START test is_not_negative_dim_customers_avg_order_value ............ [RUN]
[0m14:09:42.902458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09, now test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178)
[0m14:09:42.910438 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:09:42.956314 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m14:09:42.959373 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:09:42.971271 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:43.422088 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:892c1291-a0f6-4adb-9d9f-1b1b41c32af7&page=queryresults
[0m14:09:43.429071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:37288b9a-259c-4cb4-9810-727fd83fe0ec&page=queryresults
[0m14:09:44.107226 [info ] [Thread-3 (]: 124 of 148 PASS dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [[32mPASS[0m in 6.19s]
[0m14:09:44.133822 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:09:44.138144 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:09:44.144127 [info ] [Thread-3 (]: 127 of 148 START test is_not_negative_dim_customers_customer_lifespan_days ..... [RUN]
[0m14:09:44.155112 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d, now test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e)
[0m14:09:44.159088 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:09:44.191073 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m14:09:44.193383 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:09:44.207303 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:44.733815 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
[0m14:09:44.741793 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    avg_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:45.292145 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:38fe0d23-ab12-4452-9e82-e6bb29be7a91&page=queryresults
[0m14:09:45.296132 [info ] [Thread-1 (]: 125 of 148 PASS dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [[32mPASS[0m in 6.60s]
[0m14:09:45.300118 [info ] [Thread-2 (]: 123 of 148 PASS assert_vip_customer_criteria ................................... [[32mPASS[0m in 8.10s]
[0m14:09:45.309095 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:09:45.319125 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:09:45.322293 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:09:45.325054 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:09:45.327420 [info ] [Thread-1 (]: 128 of 148 START test is_not_negative_dim_customers_late_deliveries ............ [RUN]
[0m14:09:45.334030 [info ] [Thread-2 (]: 129 of 148 START test is_not_negative_dim_customers_lifetime_items ............. [RUN]
[0m14:09:45.338018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9, now test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a)
[0m14:09:45.341054 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_vip_customer_criteria, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159)
[0m14:09:45.345997 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:09:45.349988 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:09:45.386026 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m14:09:45.429775 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:09:45.417804 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m14:09:45.450716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:45.567404 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:09:45.601313 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:47.436775 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
[0m14:09:47.450713 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m14:09:47.454702 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    customer_lifespan_days as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_lifespan_days < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:47.445282 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
[0m14:09:47.472525 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:47.478512 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    late_deliveries as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where late_deliveries < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:47.951913 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9d03ae28-2f6f-4376-a88a-5806a309e493&page=queryresults
[0m14:09:47.970547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:20950378-8323-401f-9dec-e12090d9d2fa&page=queryresults
[0m14:09:48.123518 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aaafd647-0596-4dfe-adea-b3e1da912d97&page=queryresults
[0m14:09:48.984083 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
[0m14:09:48.991107 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_items as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:49.269607 [info ] [Thread-4 (]: 126 of 148 PASS is_not_negative_dim_customers_avg_order_value .................. [[32mPASS[0m in 6.37s]
[0m14:09:49.275594 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:09:49.278585 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:09:49.281578 [info ] [Thread-4 (]: 130 of 148 START test is_not_negative_dim_customers_lifetime_orders ............ [RUN]
[0m14:09:49.285383 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8)
[0m14:09:49.288605 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:09:49.314490 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m14:09:49.319474 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:09:49.338454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:49.461184 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0ed95acd-387d-4d9f-b171-d59ffa79fc6e&page=queryresults
[0m14:09:50.032438 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m14:09:50.041030 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:50.064965 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m14:09:50.074206 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:50.607811 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
[0m14:09:50.610803 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_orders as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:50.651604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:53879a03-cfda-4a44-b572-284b6783d88f&page=queryresults
[0m14:09:51.225366 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6d7c452a-a07d-40fb-81e5-42618a3e49b9&page=queryresults
[0m14:09:51.229357 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8b8561df-be9d-4708-b630-dcda29799fbf&page=queryresults
[0m14:09:51.555042 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m14:09:51.570003 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:52.135715 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e0ba8555-915b-4237-8507-727611241ee6&page=queryresults
[0m14:09:52.205459 [info ] [Thread-3 (]: 127 of 148 PASS is_not_negative_dim_customers_customer_lifespan_days ........... [[32mPASS[0m in 8.05s]
[0m14:09:52.213705 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:09:52.216591 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:09:52.221392 [info ] [Thread-3 (]: 131 of 148 START test is_not_negative_dim_customers_lifetime_revenue ........... [RUN]
[0m14:09:52.225367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e)
[0m14:09:52.233347 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:09:52.285208 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m14:09:52.291191 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:09:52.320111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:52.413906 [info ] [Thread-1 (]: 128 of 148 PASS is_not_negative_dim_customers_late_deliveries .................. [[32mPASS[0m in 7.07s]
[0m14:09:52.418981 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:09:52.420901 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:09:52.422880 [info ] [Thread-1 (]: 132 of 148 START test is_not_negative_dim_customers_max_order_value ............ [RUN]
[0m14:09:52.425025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a, now test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c)
[0m14:09:52.427826 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:09:52.446773 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m14:09:52.457748 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:09:52.473702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:53.067280 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m14:09:53.075258 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:53.117070 [info ] [Thread-2 (]: 129 of 148 PASS is_not_negative_dim_customers_lifetime_items ................... [[32mPASS[0m in 7.78s]
[0m14:09:53.121058 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:09:53.123122 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:09:53.125051 [info ] [Thread-2 (]: 133 of 148 START test not_null_dim_customers_avg_order_value ................... [RUN]
[0m14:09:53.129039 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159, now test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843)
[0m14:09:53.133070 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:09:53.155970 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m14:09:53.161952 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:09:53.190875 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:53.686934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2ed0871e-0044-448c-8fbb-91b5de264bae&page=queryresults
[0m14:09:53.825552 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
[0m14:09:53.832536 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    max_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:54.312598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9723e7ed-e279-4828-9143-6dfe31b2280a&page=queryresults
[0m14:09:54.638856 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
[0m14:09:54.644940 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
[0m14:09:54.653861 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_revenue as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:54.662792 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:54.732958 [info ] [Thread-4 (]: 130 of 148 PASS is_not_negative_dim_customers_lifetime_orders .................. [[32mPASS[0m in 5.45s]
[0m14:09:54.737948 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:09:54.740938 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:09:54.745924 [info ] [Thread-4 (]: 134 of 148 START test not_null_dim_customers_customer_city ..................... [RUN]
[0m14:09:54.749917 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8, now test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d)
[0m14:09:54.753285 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:09:54.812746 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m14:09:54.817734 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:09:54.845658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:55.114967 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2c0d58a7-cf5b-4821-86ac-f704e34e1643&page=queryresults
[0m14:09:55.192382 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd7c0610-1972-43a2-acae-d675791ea427&page=queryresults
[0m14:09:56.483221 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m14:09:56.486212 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:57.035179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5b1cfef2-64af-4799-aa90-524595a8892a&page=queryresults
[0m14:09:57.315256 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m14:09:57.323231 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:57.341294 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
[0m14:09:57.351163 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:57.713615 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m14:09:57.720590 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:09:58.014663 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:21d848b5-5261-4ddc-bd28-a88a4c0f1a47&page=queryresults
[0m14:09:58.017655 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9dc677df-f91b-4491-a826-5305f7d4b70c&page=queryresults
[0m14:09:58.394244 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3faa01a8-320c-453f-a41d-2bca5b9fe7f7&page=queryresults
[0m14:09:58.398274 [info ] [Thread-1 (]: 132 of 148 PASS is_not_negative_dim_customers_max_order_value .................. [[32mPASS[0m in 5.97s]
[0m14:09:58.417180 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:09:58.421169 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:09:58.425158 [info ] [Thread-1 (]: 135 of 148 START test not_null_dim_customers_customer_id ....................... [RUN]
[0m14:09:58.433137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c, now test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m14:09:58.434133 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:09:58.453084 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:09:58.456595 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:09:58.469042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:59.164950 [info ] [Thread-2 (]: 133 of 148 PASS not_null_dim_customers_avg_order_value ......................... [[32mPASS[0m in 6.03s]
[0m14:09:59.177916 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:09:59.187886 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:09:59.190880 [info ] [Thread-2 (]: 136 of 148 START test not_null_dim_customers_customer_key ...................... [RUN]
[0m14:09:59.346464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843, now test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411)
[0m14:09:59.350453 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:09:59.376382 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m14:09:59.451183 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:09:59.490078 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:59.604794 [info ] [Thread-3 (]: 131 of 148 PASS is_not_negative_dim_customers_lifetime_revenue ................. [[32mPASS[0m in 7.38s]
[0m14:09:59.610801 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:09:59.612934 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:09:59.613749 [info ] [Thread-3 (]: 137 of 148 START test not_null_dim_customers_customer_region ................... [RUN]
[0m14:09:59.616745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e, now test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2)
[0m14:09:59.618083 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:09:59.638681 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m14:09:59.644671 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:09:59.668602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:59.738499 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
[0m14:09:59.744404 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:09:59.948097 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m14:09:59.953148 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:00.284093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:29366cc7-e42f-4cfc-923c-51e15825259c&page=queryresults
[0m14:10:00.491238 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:36cbbbc0-b929-4281-8de5-f3d97a56718a&page=queryresults
[0m14:10:00.663896 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
[0m14:10:00.666768 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:00.868739 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
[0m14:10:00.873860 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:01.114801 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1c0f6495-e118-4a45-aefb-b51453649a16&page=queryresults
[0m14:10:01.428617 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:80deb698-f004-4469-9ab7-57f817f4c2f7&page=queryresults
[0m14:10:01.440584 [info ] [Thread-4 (]: 134 of 148 PASS not_null_dim_customers_customer_city ........................... [[32mPASS[0m in 6.69s]
[0m14:10:01.450601 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:10:01.454625 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:10:01.459533 [info ] [Thread-4 (]: 138 of 148 START test not_null_dim_customers_customer_segment .................. [RUN]
[0m14:10:01.472544 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d, now test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m14:10:01.476551 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:10:01.516380 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m14:10:01.547496 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:10:01.607264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:10:02.187890 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:10:02.324001 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:03.023837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c7857034-69a2-4135-b34f-95cfcff9c61f&page=queryresults
[0m14:10:03.448642 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m14:10:03.461653 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:03.848070 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m14:10:03.869065 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:04.086829 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:df21bc62-71b2-4662-9a52-25157f6b5b80&page=queryresults
[0m14:10:04.089866 [info ] [Thread-1 (]: 135 of 148 PASS not_null_dim_customers_customer_id ............................. [[32mPASS[0m in 5.66s]
[0m14:10:04.098796 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:10:04.101793 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:10:04.104781 [info ] [Thread-1 (]: 139 of 148 START test not_null_dim_customers_customer_state .................... [RUN]
[0m14:10:04.108005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa)
[0m14:10:04.112759 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:10:04.150658 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m14:10:04.154647 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:10:04.171647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:04.697118 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3f46c655-4ecf-4e3c-bc4a-2b4d429184d6&page=queryresults
[0m14:10:04.872228 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
[0m14:10:04.884151 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_segment is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:05.368782 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5eb2fc1d-d0ee-44ce-b1b5-025d28026190&page=queryresults
[0m14:10:05.414492 [info ] [Thread-2 (]: 136 of 148 PASS not_null_dim_customers_customer_key ............................ [[32mPASS[0m in 6.07s]
[0m14:10:05.421468 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:10:05.423494 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:10:05.426456 [info ] [Thread-2 (]: 140 of 148 START test not_null_dim_customers_customer_unique_id ................ [RUN]
[0m14:10:05.429447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m14:10:05.431444 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:10:05.453383 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m14:10:05.456594 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:10:05.478317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:10:06.462499 [info ] [Thread-3 (]: 137 of 148 PASS not_null_dim_customers_customer_region ......................... [[32mPASS[0m in 6.85s]
[0m14:10:06.469357 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:10:06.472348 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:10:06.474948 [info ] [Thread-3 (]: 141 of 148 START test not_null_dim_customers_lifetime_items .................... [RUN]
[0m14:10:06.483319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a)
[0m14:10:06.485314 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:10:06.507253 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m14:10:06.516270 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:10:06.539169 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:10:06.921433 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
[0m14:10:06.927419 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:07.334551 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
[0m14:10:07.339536 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m14:10:07.348558 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:07.358668 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:07.489160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7197ef89-f437-42fc-8988-e9b0c4504e5e&page=queryresults
[0m14:10:07.801990 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:71344d16-729c-4715-9a5f-0cfd483717b1&page=queryresults
[0m14:10:07.816914 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
[0m14:10:07.827074 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:08.285302 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:76432b5f-75bb-4b45-a235-345fb28befcf&page=queryresults
[0m14:10:08.346218 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cf86dd7a-df58-42b6-b20e-dfe8e672fc12&page=queryresults
[0m14:10:09.501412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m14:10:09.492788 [info ] [Thread-4 (]: 138 of 148 PASS not_null_dim_customers_customer_segment ........................ [[32mPASS[0m in 8.02s]
[0m14:10:09.531337 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:10:09.536321 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:09.543302 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:10:09.558262 [info ] [Thread-4 (]: 142 of 148 START test not_null_dim_customers_lifetime_orders ................... [RUN]
[0m14:10:09.565242 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m14:10:09.568231 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:10:09.610122 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m14:10:09.616108 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:10:09.646024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:10:09.854317 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m14:10:09.862291 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:10.147016 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m14:10:10.151955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a8cbb9d4-c4c0-4d3f-b54a-069355efa1d4&page=queryresults
[0m14:10:10.166916 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:10.624801 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f5ec7820-5750-4866-97af-9d1f94b4d12a&page=queryresults
[0m14:10:10.742484 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d4043683-7d95-4e4e-a989-3808c9ab1bcb&page=queryresults
[0m14:10:11.086092 [info ] [Thread-1 (]: 139 of 148 PASS not_null_dim_customers_customer_state .......................... [[32mPASS[0m in 6.98s]
[0m14:10:11.094957 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:10:11.098996 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:10:11.102966 [info ] [Thread-1 (]: 143 of 148 START test not_null_dim_customers_lifetime_revenue .................. [RUN]
[0m14:10:11.107920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105)
[0m14:10:11.112909 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:10:11.168759 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m14:10:11.178733 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:10:11.207653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:11.631828 [info ] [Thread-2 (]: 140 of 148 PASS not_null_dim_customers_customer_unique_id ...................... [[32mPASS[0m in 6.20s]
[0m14:10:11.644786 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:10:11.635811 [info ] [Thread-3 (]: 141 of 148 PASS not_null_dim_customers_lifetime_items .......................... [[32mPASS[0m in 5.15s]
[0m14:10:11.650772 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:10:11.658751 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:10:11.667732 [info ] [Thread-2 (]: 144 of 148 START test not_null_dim_customers_max_order_value ................... [RUN]
[0m14:10:11.673711 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:10:11.679697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8)
[0m14:10:11.698646 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:10:11.753495 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m14:10:11.760477 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:10:11.688668 [info ] [Thread-3 (]: 145 of 148 START test not_null_dim_customers_purchase_frequency ................ [RUN]
[0m14:10:11.779470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:10:11.782421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a, now test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093)
[0m14:10:11.862204 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:10:11.880200 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m14:10:11.884144 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:10:11.899150 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:10:12.230178 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
[0m14:10:12.235163 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:12.824904 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0de23781-a811-43a9-98f4-c45f599b38be&page=queryresults
[0m14:10:12.900103 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
[0m14:10:12.910121 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:13.145561 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
[0m14:10:13.152542 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:13.283951 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
[0m14:10:13.292282 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where purchase_frequency is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:13.431090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bf408603-6d28-4c76-864a-dec70f3a16a8&page=queryresults
[0m14:10:13.743916 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aace1bf5-4fab-4ed1-9c86-5771a36bd4ff&page=queryresults
[0m14:10:13.943809 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9832f682-1079-4115-90aa-b051b1f5f8b5&page=queryresults
[0m14:10:15.567530 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m14:10:15.577499 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m14:10:15.581490 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:15.608487 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:15.850549 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m14:10:15.857763 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:16.213596 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8c680de4-0436-49bd-a006-d4d978a0bec9&page=queryresults
[0m14:10:16.326295 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:38f5ec02-a948-4f26-93b9-a78da1728b40&page=queryresults
[0m14:10:16.460847 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:23fbfb9e-16f9-4400-bd03-61e914a9c5b8&page=queryresults
[0m14:10:17.142468 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m14:10:17.145511 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:17.331961 [info ] [Thread-1 (]: 143 of 148 PASS not_null_dim_customers_lifetime_revenue ........................ [[32mPASS[0m in 6.23s]
[0m14:10:17.335949 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:10:17.338942 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:10:17.345923 [info ] [Thread-1 (]: 146 of 148 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m14:10:17.351088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105, now test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m14:10:17.349369 [info ] [Thread-2 (]: 144 of 148 PASS not_null_dim_customers_max_order_value ......................... [[32mPASS[0m in 5.67s]
[0m14:10:17.353903 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:10:17.358172 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:10:17.382351 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:10:17.384090 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:10:17.391803 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:10:17.401774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:17.386917 [info ] [Thread-2 (]: 147 of 148 START test unique_dim_customers_customer_id ......................... [RUN]
[0m14:10:17.466598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8, now test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:10:17.471586 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:10:17.475973 [info ] [Thread-3 (]: 145 of 148 PASS not_null_dim_customers_purchase_frequency ...................... [[32mPASS[0m in 5.69s]
[0m14:10:17.496528 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:10:17.498514 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:10:17.501987 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:10:17.504498 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:10:17.509487 [info ] [Thread-3 (]: 148 of 148 START test unique_dim_customers_customer_key ........................ [RUN]
[0m14:10:17.525253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:10:17.527437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093, now test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e)
[0m14:10:17.599482 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:10:17.615202 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m14:10:17.618196 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:10:17.629165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:10:17.697647 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:31bd4e30-3222-4dc0-b8c2-5a32c89a307e&page=queryresults
[0m14:10:18.668890 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
[0m14:10:18.680856 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:18.831211 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
[0m14:10:18.827222 [info ] [Thread-4 (]: 142 of 148 PASS not_null_dim_customers_lifetime_orders ......................... [[32mPASS[0m in 9.26s]
[0m14:10:18.836197 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:18.842089 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:10:18.888358 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
[0m14:10:18.896314 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:10:19.243948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:48910b08-5850-414d-9d89-4703ad077a83&page=queryresults
[0m14:10:19.330562 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dfbdb421-0170-42cb-9a5a-6bbd73088ca9&page=queryresults
[0m14:10:19.485091 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ef9a6ad4-b61a-4c8c-878a-d2d013ccfaeb&page=queryresults
[0m14:10:21.498247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:10:21.502238 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:21.642655 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:10:21.646881 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:22.135360 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f1de287f-b268-4981-b7ad-2d279941b487&page=queryresults
[0m14:10:22.459454 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ebae6beb-28e3-49bb-a343-35501f53bb97&page=queryresults
[0m14:10:23.181715 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m14:10:23.190553 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:10:23.185568 [info ] [Thread-1 (]: 146 of 148 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 5.83s]
[0m14:10:23.199529 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:10:23.824052 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5526279e-72d7-4117-a998-009536b22831&page=queryresults
[0m14:10:23.913000 [info ] [Thread-2 (]: 147 of 148 PASS unique_dim_customers_customer_id ............................... [[32mPASS[0m in 6.45s]
[0m14:10:23.919976 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:10:25.018709 [info ] [Thread-3 (]: 148 of 148 PASS unique_dim_customers_customer_key .............................. [[32mPASS[0m in 7.49s]
[0m14:10:25.031722 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:10:25.063825 [info ] [MainThread]: 
[0m14:10:25.125423 [info ] [MainThread]: ============================================================
[0m14:10:25.127448 [info ] [MainThread]: DBT RUN COMPLETED
[0m14:10:25.129413 [info ] [MainThread]: Success: 12
[0m14:10:25.130409 [info ] [MainThread]: Errors: 1
[0m14:10:25.133575 [info ] [MainThread]: Skipped: 0
[0m14:10:25.135466 [info ] [MainThread]: Total: 148
[0m14:10:25.142379 [info ] [MainThread]: ============================================================
[0m14:10:25.144763 [info ] [MainThread]: FAILED MODELS:
[0m14:10:25.147364 [info ] [MainThread]:   - customers_snapshot: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m14:10:25.149656 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m14:10:25.152352 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m14:10:25.158337 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.09s]
[0m14:10:25.161385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:25.165367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:25.166314 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:10:25.168980 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:10:25.169307 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:10:25.174293 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:10:25.176489 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m14:10:25.177285 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m14:10:25.178946 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m14:10:25.180372 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m14:10:25.181276 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m14:10:25.182272 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m14:10:25.183822 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e' was properly closed.
[0m14:10:25.184266 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3' was properly closed.
[0m14:10:25.442114 [info ] [MainThread]: 
[0m14:10:25.446684 [info ] [MainThread]: Finished running 2 project hooks, 2 seeds, 1 snapshot, 3 table models, 132 data tests, 3 unit tests, 7 view models in 0 hours 4 minutes and 39.99 seconds (279.99s).
[0m14:10:25.590753 [debug] [MainThread]: Command end result
[0m14:10:25.792217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:10:25.797382 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:10:25.831113 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m14:10:25.832111 [info ] [MainThread]: 
[0m14:10:25.834103 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 5 warnings:[0m
[0m14:10:25.836097 [info ] [MainThread]: 
[0m14:10:25.839133 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m14:10:25.842082 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m14:10:25.844078 [info ] [MainThread]: 
[0m14:10:25.847470 [warn ] [MainThread]: [33mWarning in test assert_orders_have_items (tests\singular\assert_orders_have_items.sql)[0m
[0m14:10:25.850062 [warn ] [MainThread]: Got 890 results, configured to warn if != 0
[0m14:10:25.851271 [info ] [MainThread]: 
[0m14:10:25.856045 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\tests\singular\assert_orders_have_items.sql
[0m14:10:25.860035 [info ] [MainThread]: 
[0m14:10:25.862028 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
  --------------------------------------------------------------------------------------------------
[0m14:10:25.866019 [info ] [MainThread]: 
[0m14:10:25.868015 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null (models\staging\_staging.yml)[0m
[0m14:10:25.872004 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m14:10:25.874995 [info ] [MainThread]: 
[0m14:10:25.876990 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43.sql
[0m14:10:25.881975 [info ] [MainThread]: 
[0m14:10:25.883058 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
  -----------------------------------------------------------------------------------------------------------------------------------------
[0m14:10:25.885966 [info ] [MainThread]: 
[0m14:10:25.891948 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models\staging\_staging.yml)[0m
[0m14:10:25.895938 [warn ] [MainThread]: Got 862 results, configured to warn if != 0
[0m14:10:25.897108 [info ] [MainThread]: 
[0m14:10:25.898930 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0.sql
[0m14:10:25.900926 [info ] [MainThread]: 
[0m14:10:25.905413 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m14:10:25.908902 [info ] [MainThread]: 
[0m14:10:25.910898 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\staging\_staging.yml)[0m
[0m14:10:25.915887 [warn ] [MainThread]: Got 902 results, configured to warn if != 0
[0m14:10:25.923864 [info ] [MainThread]: 
[0m14:10:25.926396 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m14:10:25.927882 [info ] [MainThread]: 
[0m14:10:25.929847 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
  -----------------------------------------------------------------------------------------------------------------------------------
[0m14:10:25.935834 [info ] [MainThread]: 
[0m14:10:25.944807 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models\staging\_staging.yml)[0m
[0m14:10:25.947026 [warn ] [MainThread]: Got 642 results, configured to warn if != 0
[0m14:10:25.948796 [info ] [MainThread]: 
[0m14:10:25.950791 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f.sql
[0m14:10:25.952786 [info ] [MainThread]: 
[0m14:10:25.957773 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m14:10:25.961762 [info ] [MainThread]: 
[0m14:10:25.963757 [info ] [MainThread]: Done. PASS=144 WARN=5 ERROR=1 SKIP=0 NO-OP=0 TOTAL=150
[0m14:10:25.973828 [debug] [MainThread]: Command `dbt build` failed at 14:10:25.973828 after 292.36 seconds
[0m14:10:25.975726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB9957B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB3944410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FB3944250>]}
[0m14:10:25.976722 [debug] [MainThread]: Flushing usage events
[0m14:10:28.393874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:12.789521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523C8F5B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523C8F5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523C8F6FD0>]}


============================== 14:17:12.870268 | 5f0503ed-1436-41a1-a435-55e8074a9e7c ==============================
[0m14:17:12.870268 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:17:12.874259 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt build', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m14:17:40.434222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523BEFB750>]}
[0m14:17:40.557859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025237FE4450>]}
[0m14:17:40.558857 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:17:42.031948 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:17:45.273967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:17:45.276009 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:17:45.532303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025252F09D10>]}
[0m14:17:45.949159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:17:45.955419 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:17:46.583761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252534984D0>]}
[0m14:17:46.585755 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m14:17:46.613680 [info ] [MainThread]: 
[0m14:17:46.615330 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:46.616673 [info ] [MainThread]: 
[0m14:17:46.617671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:17:46.649584 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:17:46.650734 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:17:46.651579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:46.655582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:17:46.657562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:46.658898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:17:46.711456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:46.758454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:52.931167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:52.958290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:56.261920 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m14:17:56.264862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m14:17:56.266193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:56.269074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m14:17:56.271069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:56.273135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m14:17:56.348502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:56.400805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:02.544186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_intermediate, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m14:18:02.550926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:02.554914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_snapshots, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m14:18:02.573033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:10.537876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025252EDA350>]}
[0m14:18:10.623689 [info ] [MainThread]: ============================================================
[0m14:18:10.625639 [info ] [MainThread]: DBT RUN STARTED
[0m14:18:10.628627 [info ] [MainThread]: Target: dev
[0m14:18:10.631666 [info ] [MainThread]: Project: dbt_advanced_olist
[0m14:18:10.639599 [info ] [MainThread]: Time: 2025-12-24 14:18:10
[0m14:18:10.643595 [info ] [MainThread]: ============================================================
[0m14:18:10.647578 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m14:18:10.675502 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m14:18:10.678494 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.11s]
[0m14:18:10.688708 [info ] [MainThread]: 
[0m14:18:10.692462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:10.743227 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m14:18:10.743956 [debug] [Thread-2 (]: Began running node seed.dbt_advanced_olist.brazilian_states
[0m14:18:10.745491 [debug] [Thread-3 (]: Began running node seed.dbt_advanced_olist.order_status_codes
[0m14:18:10.746427 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:18:10.747395 [info ] [Thread-1 (]: 1 of 148 START sql table model dbt_dev_yourname_marts.dim_date ................. [RUN]
[0m14:18:10.752601 [info ] [Thread-2 (]: 2 of 148 START seed file dbt_dev_yourname_seeds.brazilian_states ............... [RUN]
[0m14:18:10.755374 [info ] [Thread-3 (]: 3 of 148 START seed file dbt_dev_yourname_seeds.order_status_codes ............. [RUN]
[0m14:18:10.757022 [info ] [Thread-4 (]: 4 of 148 START test dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [RUN]
[0m14:18:10.760048 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m14:18:10.762009 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.brazilian_states'
[0m14:18:10.763850 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.order_status_codes'
[0m14:18:10.767455 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0'
[0m14:18:10.769551 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m14:18:10.771495 [debug] [Thread-2 (]: Began compiling node seed.dbt_advanced_olist.brazilian_states
[0m14:18:10.773436 [debug] [Thread-3 (]: Began compiling node seed.dbt_advanced_olist.order_status_codes
[0m14:18:10.776085 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:18:10.836329 [debug] [Thread-2 (]: Began executing node seed.dbt_advanced_olist.brazilian_states
[0m14:18:10.841288 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m14:18:10.843271 [debug] [Thread-3 (]: Began executing node seed.dbt_advanced_olist.order_status_codes
[0m14:18:10.892262 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m14:18:10.930007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:10.941546 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:18:11.013354 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:18:11.768229 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:18:11.771188 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:18:18.522949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:215d363a-6a28-4481-b42d-b362ec550f46&page=queryresults
[0m14:18:21.032831 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
[0m14:18:21.159088 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`raw_olist`.`customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:21.823868 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fdf58a87-7df1-4482-bc09-e18b13295d67&page=queryresults
[0m14:18:22.257280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m14:18:22.306817 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m14:18:23.035617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m14:18:23.045257 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(date_key, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m14:18:23.635142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1f6f83ae-bce2-48ad-a2ab-d6d5d0582381&page=queryresults
[0m14:18:24.520125 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m14:18:24.525540 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:25.244039 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ee938ef-8894-41b3-91db-eac50fc0e39c&page=queryresults
[0m14:18:26.155034 [debug] [Thread-2 (]: On seed.dbt_advanced_olist.brazilian_states: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states` set OPTIONS()
/* dbt 1.10.15 | model: brazilian_states | schema: dbt_dev_yourname_seeds */
[0m14:18:26.403122 [debug] [Thread-3 (]: On seed.dbt_advanced_olist.order_status_codes: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes` set OPTIONS()
/* dbt 1.10.15 | model: order_status_codes | schema: dbt_dev_yourname_seeds */
[0m14:18:26.706359 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a619a993-e133-42f2-85e3-c4d9ac87b262&page=queryresults
[0m14:18:27.036693 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5aaee8c1-8ef0-49de-bfa2-1261bd7d8974&page=queryresults
[0m14:18:27.039732 [info ] [Thread-4 (]: 4 of 148 PASS dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [[32mPASS[0m in 16.27s]
[0m14:18:27.049663 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:18:27.052648 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:18:27.056142 [info ] [Thread-4 (]: 5 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [RUN]
[0m14:18:27.060127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb)
[0m14:18:27.067165 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:18:27.159830 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m14:18:27.171830 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:18:27.194774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:27.764239 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.brazilian_states"
[0m14:18:27.856715 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253D00D90>]}
[0m14:18:27.858713 [info ] [Thread-2 (]: 2 of 148 OK loaded seed file dbt_dev_yourname_seeds.brazilian_states ........... [[32mINSERT 27[0m in 17.09s]
[0m14:18:27.864477 [debug] [Thread-2 (]: Finished running node seed.dbt_advanced_olist.brazilian_states
[0m14:18:27.866558 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:18:27.868419 [info ] [Thread-2 (]: 6 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [RUN]
[0m14:18:27.871870 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.brazilian_states, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d)
[0m14:18:27.876412 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:18:27.918670 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m14:18:27.924228 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.order_status_codes"
[0m14:18:27.927227 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:18:27.950320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:27.951544 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253D400D0>]}
[0m14:18:27.998419 [info ] [Thread-3 (]: 3 of 148 OK loaded seed file dbt_dev_yourname_seeds.order_status_codes ......... [[32mINSERT 8[0m in 17.19s]
[0m14:18:28.001030 [debug] [Thread-3 (]: Finished running node seed.dbt_advanced_olist.order_status_codes
[0m14:18:28.003023 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:18:28.004039 [info ] [Thread-3 (]: 7 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [RUN]
[0m14:18:28.006038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.order_status_codes, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529)
[0m14:18:28.008124 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:18:28.024988 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m14:18:28.026345 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:18:28.040944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:28.245669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252531DFDD0>]}
[0m14:18:28.249660 [info ] [Thread-1 (]: 1 of 148 OK created sql table model dbt_dev_yourname_marts.dim_date ............ [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 17.48s]
[0m14:18:28.254517 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m14:18:28.257222 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:18:28.260212 [info ] [Thread-1 (]: 8 of 148 START test dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [RUN]
[0m14:18:28.268191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_date, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936)
[0m14:18:28.273195 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:18:28.327261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:28.843280 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
[0m14:18:28.850532 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and freight_value >= 0 and freight_value <= 1000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:29.471484 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
[0m14:18:29.478465 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price >= 0 and price <= 10000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:29.557301 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:787d02c7-d34f-4674-aa81-ad6228efc351&page=queryresults
[0m14:18:29.921735 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m14:18:29.925722 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:18:30.051062 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
[0m14:18:30.061036 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and product_weight_g >= 0 and product_weight_g <= 100000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`products`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:30.204709 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:413a4e39-7540-48a1-9b64-53c2f2bda050&page=queryresults
[0m14:18:30.401107 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
[0m14:18:30.406148 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
      
    
    

    
    OPTIONS()
    as (
      
    
  with relation_columns as (

        
        select
            cast('ORDER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CUSTOMER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_STATUS' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_PURCHASE_TIMESTAMP' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_APPROVED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CARRIER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CUSTOMER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_ESTIMATED_DELIVERY_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PURCHASE_TIMESTAMP'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:30.799264 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dd8b4ce4-3518-4b27-b61d-b8a9e6c6d82a&page=queryresults
[0m14:18:31.033697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:84b85e4c-5ad3-4b11-831e-bfb684faedc1&page=queryresults
[0m14:18:32.243312 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m14:18:32.258291 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:33.010812 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2757e2a8-dc51-444f-a03a-ee7ee5ee5044&page=queryresults
[0m14:18:33.480972 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m14:18:33.485999 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m14:18:33.504907 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:33.510315 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:34.089366 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m14:18:34.102289 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:34.389258 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8d081a6f-e8b0-425c-a968-abd4d507f60f&page=queryresults
[0m14:18:34.392250 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fc49e2c9-1f28-489c-9d78-3e093ab48473&page=queryresults
[0m14:18:34.522043 [info ] [Thread-4 (]: 5 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [[32mPASS[0m in 7.46s]
[0m14:18:34.526985 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:18:34.531971 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:18:34.537248 [info ] [Thread-4 (]: 9 of 148 START test source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:18:34.542577 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb, now test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c)
[0m14:18:34.548927 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:18:34.651699 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m14:18:34.656637 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:18:34.680156 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:34.830476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9bea6b28-1a55-4621-81ab-98ec797f8e37&page=queryresults
[0m14:18:35.956482 [info ] [Thread-2 (]: 6 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [[32mPASS[0m in 8.08s]
[0m14:18:35.971117 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:18:35.966132 [info ] [Thread-3 (]: 7 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [[32mPASS[0m in 7.96s]
[0m14:18:35.977095 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:18:35.993054 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:18:36.016991 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:18:36.008018 [info ] [Thread-2 (]: 10 of 148 START test source_not_null_raw_olist_customers_customer_city ......... [RUN]
[0m14:18:36.036937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a)
[0m14:18:36.022346 [info ] [Thread-3 (]: 11 of 148 START test source_not_null_raw_olist_customers_customer_id ........... [RUN]
[0m14:18:36.040928 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:18:36.046911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c)
[0m14:18:36.082441 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:18:36.089328 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m14:18:36.104905 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m14:18:36.107867 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:18:36.124965 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:18:36.129808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:36.147884 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:36.443406 [info ] [Thread-1 (]: 8 of 148 PASS dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [[32mPASS[0m in 8.17s]
[0m14:18:36.452339 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:18:36.457334 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:18:36.462417 [info ] [Thread-1 (]: 12 of 148 START test source_not_null_raw_olist_customers_customer_state ........ [RUN]
[0m14:18:36.470852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de)
[0m14:18:36.474840 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:18:36.518747 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m14:18:36.546157 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:18:36.571092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:37.069135 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
[0m14:18:37.075119 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`raw_olist`.`orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:37.869725 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
[0m14:18:37.872754 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f940c1c1-e3a6-4d8b-956c-a831c1ea81b0&page=queryresults
[0m14:18:37.880689 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:38.384904 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
[0m14:18:38.389011 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
[0m14:18:38.399910 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:38.407842 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:38.550758 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e9874bdf-e9ad-4c39-a4d1-b47461cb7d73&page=queryresults
[0m14:18:39.081596 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2b74596c-4113-4a76-99d2-3eca62359378&page=queryresults
[0m14:18:39.114923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:37270cdb-e2ff-4121-9c8f-675b8de7a1cf&page=queryresults
[0m14:18:40.284513 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m14:18:40.290451 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:40.905007 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m14:18:40.913983 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:41.202290 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m14:18:41.205298 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:84e18eb0-aad4-4dec-ba06-3085108abdb6&page=queryresults
[0m14:18:41.216255 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:41.585228 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m14:18:41.591210 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:42.697118 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3aff6e1f-5246-42e6-98ee-958ea62d2325&page=queryresults
[0m14:18:42.703143 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:578b371b-2634-4c38-8670-568d2d137905&page=queryresults
[0m14:18:43.040373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:504fb1c4-a7b9-4969-94da-26841c43137c&page=queryresults
[0m14:18:43.518648 [info ] [Thread-4 (]: 9 of 148 PASS source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 8.98s]
[0m14:18:43.530610 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:18:43.547565 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:18:43.556539 [info ] [Thread-4 (]: 13 of 148 START test source_not_null_raw_olist_customers_customer_unique_id .... [RUN]
[0m14:18:43.566722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30)
[0m14:18:43.570507 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:18:43.607405 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m14:18:43.623944 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:18:43.650339 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:45.205361 [info ] [Thread-3 (]: 11 of 148 PASS source_not_null_raw_olist_customers_customer_id ................. [[32mPASS[0m in 9.16s]
[0m14:18:45.234282 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:18:45.223321 [info ] [Thread-1 (]: 12 of 148 PASS source_not_null_raw_olist_customers_customer_state .............. [[32mPASS[0m in 8.75s]
[0m14:18:45.242264 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:18:45.228300 [info ] [Thread-2 (]: 10 of 148 PASS source_not_null_raw_olist_customers_customer_city ............... [[32mPASS[0m in 9.19s]
[0m14:18:45.253235 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:18:45.266198 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:18:45.258229 [info ] [Thread-3 (]: 14 of 148 START test source_not_null_raw_olist_order_items_freight_value ....... [RUN]
[0m14:18:45.272186 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:18:45.279165 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:18:45.285222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5)
[0m14:18:45.303102 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:18:45.291132 [info ] [Thread-1 (]: 15 of 148 START test source_not_null_raw_olist_order_items_order_id ............ [RUN]
[0m14:18:45.328032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37)
[0m14:18:45.337010 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m14:18:45.295136 [info ] [Thread-2 (]: 16 of 148 START test source_not_null_raw_olist_order_items_order_item_id ....... [RUN]
[0m14:18:45.339001 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:18:45.341012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c)
[0m14:18:45.357994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m14:18:45.364352 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:18:45.365931 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:18:45.380923 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m14:18:45.382884 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:18:45.391011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:45.403858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:45.404825 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:18:45.511927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:46.982552 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
[0m14:18:46.986577 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
[0m14:18:46.992712 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:47.000541 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where freight_value is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:47.148073 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
[0m14:18:47.154061 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:47.463760 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
[0m14:18:47.475249 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_item_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:47.698746 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5b9df950-af96-4caf-acc6-bb667611dc64&page=queryresults
[0m14:18:47.735159 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6797b308-8b5b-423a-824b-3a2236cf7a81&page=queryresults
[0m14:18:48.014488 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eef94473-1480-4e33-b1e5-dfc2c6d2a311&page=queryresults
[0m14:18:48.110817 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7c953b96-7a69-4530-ac0e-9c76587b5fec&page=queryresults
[0m14:18:50.517929 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m14:18:50.525861 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:50.534843 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m14:18:50.550037 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m14:18:50.559362 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:50.565394 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:50.919749 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m14:18:50.928634 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:51.301342 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0523d840-77a9-4d04-b222-3aed1ceff40f&page=queryresults
[0m14:18:51.454912 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:452d5675-e8ad-4903-8948-24f3567c0337&page=queryresults
[0m14:18:51.492374 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d7cc4ebc-a0c2-4443-b9cf-ca9daafee2af&page=queryresults
[0m14:18:51.633634 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bcd90a55-9bab-491a-be5f-55a38b844a4e&page=queryresults
[0m14:18:53.152791 [info ] [Thread-3 (]: 14 of 148 PASS source_not_null_raw_olist_order_items_freight_value ............. [[32mPASS[0m in 7.87s]
[0m14:18:53.169743 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:18:53.173227 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:18:53.178723 [info ] [Thread-3 (]: 17 of 148 START test source_not_null_raw_olist_order_items_price ............... [RUN]
[0m14:18:53.184703 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9)
[0m14:18:53.189691 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:18:53.235610 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m14:18:53.259505 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:18:53.283486 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:53.761547 [info ] [Thread-2 (]: 16 of 148 PASS source_not_null_raw_olist_order_items_order_item_id ............. [[32mPASS[0m in 8.42s]
[0m14:18:53.776498 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:18:53.771512 [info ] [Thread-1 (]: 15 of 148 PASS source_not_null_raw_olist_order_items_order_id .................. [[32mPASS[0m in 8.44s]
[0m14:18:53.783480 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:18:53.789464 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:18:53.799436 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:18:53.794743 [info ] [Thread-2 (]: 18 of 148 START test source_not_null_raw_olist_order_items_product_id .......... [RUN]
[0m14:18:53.814400 [info ] [Thread-1 (]: 19 of 148 START test source_not_null_raw_olist_orders_customer_id .............. [RUN]
[0m14:18:53.824372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29)
[0m14:18:53.832351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02)
[0m14:18:53.820382 [info ] [Thread-4 (]: 13 of 148 PASS source_not_null_raw_olist_customers_customer_unique_id .......... [[32mPASS[0m in 10.25s]
[0m14:18:53.838374 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:18:53.849306 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:18:53.867302 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:18:53.886233 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m14:18:53.899168 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m14:18:53.900167 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:18:53.905162 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:18:53.903187 [info ] [Thread-4 (]: 20 of 148 START test source_not_null_raw_olist_orders_order_id ................. [RUN]
[0m14:18:53.916151 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:53.916151 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:18:53.917368 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b)
[0m14:18:53.976184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:53.978178 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:18:54.046997 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m14:18:54.050268 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:18:54.063952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:55.071359 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
[0m14:18:55.081334 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where price is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:55.680052 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ac15361-ccfe-4d5f-9fe8-459ade522ca3&page=queryresults
[0m14:18:56.100275 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
[0m14:18:56.105261 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
[0m14:18:56.112245 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:56.123215 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:56.178174 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
[0m14:18:56.184185 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:18:56.814233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bbe7707a-17e8-4c54-ae88-cb9f1e1aceb4&page=queryresults
[0m14:18:56.817378 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6746bd55-a261-459c-851d-131e05deba1e&page=queryresults
[0m14:18:57.097185 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6582491f-4baf-4cc9-87f7-d3645ca4ead0&page=queryresults
[0m14:18:58.618790 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m14:18:58.625734 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:59.119761 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m14:18:59.135688 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m14:18:59.142658 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:59.153626 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:59.383904 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7e96b857-6ca6-4806-b66c-aa52e2baf38e&page=queryresults
[0m14:18:59.549734 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m14:18:59.555675 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:18:59.963239 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c732bc99-c64e-497e-bbb1-d653fd85ac90&page=queryresults
[0m14:18:59.971255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5f6fe5d3-7ae0-4df8-b8d0-dcd6c88c0ba7&page=queryresults
[0m14:19:00.296438 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b3dbbb73-c187-4d72-a559-cc3ada7fa66a&page=queryresults
[0m14:19:00.933824 [info ] [Thread-3 (]: 17 of 148 PASS source_not_null_raw_olist_order_items_price ..................... [[32mPASS[0m in 7.75s]
[0m14:19:00.943795 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:19:00.960012 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:19:00.965702 [info ] [Thread-3 (]: 21 of 148 START test source_not_null_raw_olist_orders_order_purchase_timestamp . [RUN]
[0m14:19:00.974673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5)
[0m14:19:00.980653 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:19:01.020066 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m14:19:01.031520 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:19:01.064436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:01.366651 [info ] [Thread-4 (]: 20 of 148 PASS source_not_null_raw_olist_orders_order_id ....................... [[32mPASS[0m in 7.45s]
[0m14:19:01.374238 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:19:01.379098 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:19:01.383083 [info ] [Thread-4 (]: 22 of 148 START test source_not_null_raw_olist_orders_order_status ............. [RUN]
[0m14:19:01.388069 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a)
[0m14:19:01.399043 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:19:01.450901 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m14:19:01.462870 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:19:01.499774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:01.783806 [info ] [Thread-1 (]: 19 of 148 PASS source_not_null_raw_olist_orders_customer_id .................... [[32mPASS[0m in 7.95s]
[0m14:19:01.796809 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:19:01.799757 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:19:01.804744 [info ] [Thread-1 (]: 23 of 148 START test source_not_null_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m14:19:01.813721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1)
[0m14:19:01.819704 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:19:01.866620 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m14:19:01.877955 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:19:01.902525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:02.428729 [info ] [Thread-2 (]: 18 of 148 PASS source_not_null_raw_olist_order_items_product_id ................ [[32mPASS[0m in 8.60s]
[0m14:19:02.433710 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:19:02.436696 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:19:02.444686 [info ] [Thread-2 (]: 24 of 148 START test source_not_null_raw_olist_product_category_name_translation_string_field_1  [RUN]
[0m14:19:02.449623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841)
[0m14:19:02.453235 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:19:02.502480 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m14:19:02.512453 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:19:02.534395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:04.392208 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
[0m14:19:04.397197 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
[0m14:19:04.401885 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_purchase_timestamp is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:04.410883 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:04.586206 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
[0m14:19:04.593187 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_0 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:04.600218 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
[0m14:19:04.609144 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_1 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:05.214031 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e0cf7ae7-51c8-4fa9-b1fc-3270886e817a&page=queryresults
[0m14:19:05.218969 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:daa80ae8-67af-46fe-b47e-06f537d55501&page=queryresults
[0m14:19:05.459686 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:90f5fa55-5288-4750-a20e-08b50fe4c1a7&page=queryresults
[0m14:19:05.849938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a30f28d3-498c-4f6f-b4ff-46f0c219a664&page=queryresults
[0m14:19:07.813073 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m14:19:07.880912 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:08.260971 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m14:19:08.265380 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m14:19:08.271317 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:08.291674 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:08.356896 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m14:19:08.363873 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:08.578082 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:79577008-2ae1-4061-83cc-4f6a773af1b5&page=queryresults
[0m14:19:09.090481 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:23db993d-34a6-4ccd-b7bc-86b61279f99e&page=queryresults
[0m14:19:09.094465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:58507c99-a5f6-455f-af06-2157d5bbb4fe&page=queryresults
[0m14:19:09.256710 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d714e3ad-3339-4d70-b938-325f37196c77&page=queryresults
[0m14:19:10.057512 [info ] [Thread-3 (]: 21 of 148 PASS source_not_null_raw_olist_orders_order_purchase_timestamp ....... [[32mPASS[0m in 9.08s]
[0m14:19:10.065534 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:19:10.069027 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:19:10.074467 [info ] [Thread-3 (]: 25 of 148 START test source_not_null_raw_olist_products_product_id ............. [RUN]
[0m14:19:10.079929 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5, now test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf)
[0m14:19:10.083444 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:19:10.135307 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m14:19:10.144286 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:19:10.166224 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:10.791721 [info ] [Thread-4 (]: 22 of 148 PASS source_not_null_raw_olist_orders_order_status ................... [[32mPASS[0m in 9.40s]
[0m14:19:10.806635 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:19:10.799700 [info ] [Thread-1 (]: 23 of 148 PASS source_not_null_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 8.99s]
[0m14:19:10.812617 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:19:10.817603 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:19:10.825645 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:19:10.820708 [info ] [Thread-4 (]: 26 of 148 START test source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [RUN]
[0m14:19:10.837550 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5)
[0m14:19:10.844530 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:19:10.831154 [info ] [Thread-1 (]: 27 of 148 START test source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [RUN]
[0m14:19:10.913345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8)
[0m14:19:10.915366 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:19:10.912347 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m14:19:10.936313 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m14:19:10.941278 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:19:10.949283 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:10.950494 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:19:11.013078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:11.238787 [info ] [Thread-2 (]: 24 of 148 PASS source_not_null_raw_olist_product_category_name_translation_string_field_1  [[32mPASS[0m in 8.79s]
[0m14:19:11.241696 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:19:11.243799 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:19:11.245708 [info ] [Thread-2 (]: 28 of 148 START test source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [RUN]
[0m14:19:11.249673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841, now test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543)
[0m14:19:11.251668 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:19:11.272765 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m14:19:11.277599 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:19:11.295553 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:13.512381 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
[0m14:19:13.516415 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
[0m14:19:13.507395 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
[0m14:19:13.523207 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:13.530188 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:13.535870 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:14.326917 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fe47fe9b-120b-4975-9fce-574c8976f00b&page=queryresults
[0m14:19:14.331907 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ded51a0-e4f0-49f5-ba33-a0a0f0b14fa3&page=queryresults
[0m14:19:14.337846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e3069b06-fc1c-4025-a3a8-c3b520fcb2f4&page=queryresults
[0m14:19:16.476846 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m14:19:16.484778 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:16.625451 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m14:19:16.630547 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:17.090833 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m14:19:17.097815 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:17.210588 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2b9ffdbf-595d-405e-b83c-0e6ce8a06348&page=queryresults
[0m14:19:17.845495 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1dbd4261-8a24-4640-9eb0-9d48e549bafb&page=queryresults
[0m14:19:17.970352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c299b5ed-2104-4520-8d5a-d96fcfce2c4f&page=queryresults
[0m14:19:18.983999 [info ] [Thread-3 (]: 25 of 148 PASS source_not_null_raw_olist_products_product_id ................... [[32mPASS[0m in 8.90s]
[0m14:19:18.993971 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:19:18.996963 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:19:19.000910 [info ] [Thread-3 (]: 29 of 148 START test source_unique_raw_olist_customers_customer_id ............. [RUN]
[0m14:19:19.008892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf, now test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816)
[0m14:19:19.012879 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:19:19.098648 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m14:19:19.107623 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:19:19.127569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:19.255227 [info ] [Thread-2 (]: 28 of 148 PASS source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [[32mPASS[0m in 8.01s]
[0m14:19:19.260215 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:19:19.262209 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:19:19.263205 [info ] [Thread-2 (]: 30 of 148 START test source_unique_raw_olist_orders_order_id ................... [RUN]
[0m14:19:19.265263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543, now test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0)
[0m14:19:19.268194 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:19:19.273181 [info ] [Thread-1 (]: 27 of 148 PASS source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [[32mPASS[0m in 8.36s]
[0m14:19:19.280160 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m14:19:19.283155 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:19:19.285147 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:19:19.291526 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:19:19.300108 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:19.289136 [info ] [Thread-1 (]: 31 of 148 START test source_unique_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m14:19:19.352967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8, now test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df)
[0m14:19:19.355958 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:19:19.372914 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m14:19:19.384885 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:19:19.400839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:19.524135 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
[0m14:19:19.529120 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:21.538406 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
[0m14:19:21.543877 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:25eb2216-332a-4557-92f4-aadeb5f30fdb&page=queryresults
[0m14:19:21.548863 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:22.304338 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:be5fd5e5-f7bf-4c8b-a20b-9344864fe660&page=queryresults
[0m14:19:22.310356 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
[0m14:19:22.322287 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:22.926596 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
[0m14:19:22.932621 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select string_field_0 as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
  where string_field_0 is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:22.958611 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m14:19:22.965642 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:23.007052 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ed949457-47c6-46d4-80a1-910a1245e7c9&page=queryresults
[0m14:19:23.680305 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9e817bd3-4c9f-416c-a351-09c13597fd26&page=queryresults
[0m14:19:23.760010 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e0c53722-a2bd-4fe7-9e53-f873147a9517&page=queryresults
[0m14:19:26.411238 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m14:19:26.446306 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:27.955451 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m14:19:27.960481 [info ] [Thread-4 (]: 26 of 148 PASS source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [[32mPASS[0m in 17.12s]
[0m14:19:27.971405 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:19:27.976393 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:19:27.979386 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:27.985580 [info ] [Thread-4 (]: 32 of 148 START test source_unique_raw_olist_products_product_id ............... [RUN]
[0m14:19:28.002327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5, now test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1)
[0m14:19:28.009307 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:19:28.049196 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m14:19:28.061168 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:19:28.080116 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:29.342612 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:49c4d43b-918f-4879-a810-5fc689a5c074&page=queryresults
[0m14:19:30.816008 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m14:19:30.845387 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:30.920444 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:00f03b2f-16c2-4d07-9d16-e834baa986f3&page=queryresults
[0m14:19:31.628912 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a8d2f363-7de7-4f1b-8da3-cdef83c2a4a3&page=queryresults
[0m14:19:31.736720 [info ] [Thread-3 (]: 29 of 148 PASS source_unique_raw_olist_customers_customer_id ................... [[32mPASS[0m in 12.73s]
[0m14:19:31.742701 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:19:31.745693 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:19:31.748689 [info ] [Thread-3 (]: 33 of 148 START test accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [RUN]
[0m14:19:31.759657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816, now test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22)
[0m14:19:31.761650 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:19:31.828516 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m14:19:31.860926 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:19:31.893300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:31.954134 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
[0m14:19:31.957125 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:32.308253 [info ] [Thread-2 (]: 30 of 148 PASS source_unique_raw_olist_orders_order_id ......................... [[32mPASS[0m in 13.04s]
[0m14:19:32.314194 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:19:32.318184 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:19:32.323177 [info ] [Thread-2 (]: 34 of 148 START test not_null_brazilian_states_state_code ...................... [RUN]
[0m14:19:32.327869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0, now test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec)
[0m14:19:32.331861 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:19:32.377735 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m14:19:32.407216 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:19:32.441129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:32.681296 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ab1d666c-1e7d-4aeb-a3c3-9803386b5869&page=queryresults
[0m14:19:33.147794 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
[0m14:19:33.167745 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
    group by region

)

select *
from all_values
where value_field not in (
    'North','Northeast','Central-West','Southeast','South'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:33.177717 [info ] [Thread-1 (]: 31 of 148 PASS source_unique_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 13.82s]
[0m14:19:33.187689 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:19:33.190685 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:19:33.195720 [info ] [Thread-1 (]: 35 of 148 START test unique_brazilian_states_state_code ........................ [RUN]
[0m14:19:33.200734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df, now test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855)
[0m14:19:33.205642 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:19:33.240551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m14:19:33.247530 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:19:33.276505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:33.930450 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:87052a0f-007b-49b5-aa83-541c46a6739b&page=queryresults
[0m14:19:34.938220 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
[0m14:19:34.943196 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m14:19:34.950186 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
where state_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:34.961147 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:35.318088 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
[0m14:19:35.327108 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select state_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
  where state_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:35.559984 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:389e468a-4ca4-4ae0-8e72-44e39d7943c9&page=queryresults
[0m14:19:36.132054 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:86e7d35c-314e-4152-812e-27a112a90a3b&page=queryresults
[0m14:19:36.137001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:43e3c3d9-d624-473e-a30f-cc4b9b617ae8&page=queryresults
[0m14:19:36.242056 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m14:19:36.248992 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:36.942862 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e8aa3b37-d7a2-4ef9-86c8-bf2718032ea1&page=queryresults
[0m14:19:37.752728 [info ] [Thread-4 (]: 32 of 148 PASS source_unique_raw_olist_products_product_id ..................... [[32mPASS[0m in 9.75s]
[0m14:19:37.759977 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:19:37.764020 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:19:37.770950 [info ] [Thread-4 (]: 36 of 148 START test not_null_order_status_codes_status_code ................... [RUN]
[0m14:19:37.776228 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1, now test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968)
[0m14:19:37.779925 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:19:37.828793 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m14:19:37.840514 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:19:37.873715 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:38.125758 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m14:19:38.390919 [info ] [Thread-3 (]: 33 of 148 PASS accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [[32mPASS[0m in 6.63s]
[0m14:19:38.396984 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:19:38.400888 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:19:38.404885 [info ] [Thread-3 (]: 37 of 148 START test unique_order_status_codes_status_code ..................... [RUN]
[0m14:19:38.409039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22, now test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b)
[0m14:19:38.413851 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:19:38.456739 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m14:19:38.475748 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:19:38.508665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:38.601411 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m14:19:38.881070 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:39.175351 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:39.579272 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6bdba59f-6509-445f-816e-bd88dc9dfd44&page=queryresults
[0m14:19:39.662657 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
[0m14:19:39.670211 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
where status_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:39.923687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9a70022a-90cd-452d-9ea4-f1ca20c33ebd&page=queryresults
[0m14:19:40.653695 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea85bb3c-f6a9-4507-8594-5957cd30d117&page=queryresults
[0m14:19:41.189415 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
[0m14:19:41.210357 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select status_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
  where status_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:41.218334 [info ] [Thread-2 (]: 34 of 148 PASS not_null_brazilian_states_state_code ............................ [[32mPASS[0m in 8.89s]
[0m14:19:41.241313 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:19:41.247259 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_order_items
[0m14:19:41.255233 [info ] [Thread-2 (]: 38 of 148 START sql view model dbt_dev_yourname_staging.stg_order_items ........ [RUN]
[0m14:19:41.260221 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec, now model.dbt_advanced_olist.stg_order_items)
[0m14:19:41.262793 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_order_items
[0m14:19:41.346038 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_order_items"
[0m14:19:41.351973 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_order_items
[0m14:19:41.421788 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_order_items"
[0m14:19:41.426773 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_order_items: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_order_items
  
  Purpose: Clean order line item data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Rename columns
  - Calculate item total (price + freight)
  - Generate surrogate key for unique identification
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`order_items`
),

renamed as (
    select
        -- Surrogate Key (composite primary key)
        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,
        
        -- Foreign Keys
        order_id,
        product_id,
        seller_id,
        
        -- Item Position
        order_item_id as item_sequence,
        
        -- Pricing
        cast(price as numeric) as item_price,
        cast(freight_value as numeric) as item_freight,
        
        -- Derived: Total for this item
        cast(price as numeric) + cast(freight_value as numeric) as item_total,
        
        -- Shipping date
        cast(shipping_limit_date as timestamp) as shipping_limit_at

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_order_items | schema: dbt_dev_yourname_staging */;
[0m14:19:41.428766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:41.761231 [info ] [Thread-1 (]: 35 of 148 PASS unique_brazilian_states_state_code .............................. [[32mPASS[0m in 8.56s]
[0m14:19:41.765219 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:19:41.767213 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_customers
[0m14:19:41.769209 [info ] [Thread-1 (]: 39 of 148 START sql view model dbt_dev_yourname_staging.stg_customers .......... [RUN]
[0m14:19:41.771203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855, now model.dbt_advanced_olist.stg_customers)
[0m14:19:41.772201 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_customers
[0m14:19:41.790152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_customers"
[0m14:19:41.793144 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_customers
[0m14:19:41.808134 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_customers"
[0m14:19:41.809687 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_customers: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_customers
  
  Purpose: Clean and standardize customer data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Standardize location data
  - Clean state codes
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`customers`
),

renamed as (
    select
        -- Primary Key
        customer_id,
        
        -- Alternative Key (same customer across orders)
        customer_unique_id,
        
        -- Location
        lower(trim(customer_city)) as customer_city,
        upper(trim(customer_state)) as customer_state,
        cast(customer_zip_code_prefix as string) as customer_zip_code,
        
        -- Derived: Region classification
        case upper(trim(customer_state))
            when 'SP' then 'Southeast'
            when 'RJ' then 'Southeast'
            when 'MG' then 'Southeast'
            when 'ES' then 'Southeast'
            when 'PR' then 'South'
            when 'SC' then 'South'
            when 'RS' then 'South'
            when 'BA' then 'Northeast'
            when 'PE' then 'Northeast'
            when 'CE' then 'Northeast'
            when 'MA' then 'Northeast'
            when 'PB' then 'Northeast'
            when 'RN' then 'Northeast'
            when 'PI' then 'Northeast'
            when 'AL' then 'Northeast'
            when 'SE' then 'Northeast'
            when 'GO' then 'Central-West'
            when 'DF' then 'Central-West'
            when 'MT' then 'Central-West'
            when 'MS' then 'Central-West'
            else 'North'
        end as customer_region

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_customers | schema: dbt_dev_yourname_staging */;
[0m14:19:41.811313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:41.910776 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c05f57ed-837b-451a-b070-4a348514f67a&page=queryresults
[0m14:19:42.594297 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m14:19:42.603239 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:43.307745 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:79948c91-a83e-4dfa-8e17-a77f1cec5517&page=queryresults
[0m14:19:43.311733 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9d9a1697-1c3b-46f7-856d-8a0a4c2c2125&page=queryresults
[0m14:19:43.412269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c71c43d-7788-48bf-958f-44257f58dace&page=queryresults
[0m14:19:44.556374 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m14:19:44.559366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253E9A2D0>]}
[0m14:19:44.561100 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253CEAC10>]}
[0m14:19:44.576733 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:44.573390 [info ] [Thread-1 (]: 39 of 148 OK created sql view model dbt_dev_yourname_staging.stg_customers ..... [[32mCREATE VIEW (0 processed)[0m in 2.79s]
[0m14:19:44.581719 [info ] [Thread-2 (]: 38 of 148 OK created sql view model dbt_dev_yourname_staging.stg_order_items ... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m14:19:44.595707 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_customers
[0m14:19:44.604661 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_order_items
[0m14:19:44.608646 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_orders
[0m14:19:44.612521 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_product_categories
[0m14:19:44.618510 [info ] [Thread-1 (]: 40 of 148 START sql view model dbt_dev_yourname_staging.stg_orders ............. [RUN]
[0m14:19:44.626549 [info ] [Thread-2 (]: 41 of 148 START sql view model dbt_dev_yourname_staging.stg_product_categories . [RUN]
[0m14:19:44.630473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_customers, now model.dbt_advanced_olist.stg_orders)
[0m14:19:44.637458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_order_items, now model.dbt_advanced_olist.stg_product_categories)
[0m14:19:44.642455 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_orders
[0m14:19:44.645432 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_product_categories
[0m14:19:44.685331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_orders"
[0m14:19:44.725884 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_product_categories"
[0m14:19:44.731816 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_orders
[0m14:19:44.753757 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_product_categories
[0m14:19:44.757748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_orders"
[0m14:19:44.780693 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_product_categories"
[0m14:19:44.788949 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_orders: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_orders
  
  Purpose: Clean and standardize raw order data
  Source: Olist Brazilian E-commerce (10K orders sample)
  
  Transformations:
  - Rename columns to consistent naming convention
  - Cast timestamps to proper types
  - Calculate delivery metrics
  - Add late delivery flag
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`orders`
),

renamed as (
    select
        -- Primary Key
        order_id,
        
        -- Foreign Keys
        customer_id,
        
        -- Order Status
        order_status,
        
        -- Timestamps (cast to proper types)
        cast(order_purchase_timestamp as timestamp) as ordered_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as shipped_at,
        cast(order_delivered_customer_date as timestamp) as delivered_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,
        
        -- Derived: Order date (for partitioning)
        date(cast(order_purchase_timestamp as timestamp)) as order_date,
        
        -- Derived: Delivery time in days
        case 
            when order_delivered_customer_date is not null 
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_purchase_timestamp as timestamp)),
                day
            )
        end as delivery_days,
        
        -- Derived: Is delivery late?
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then true
            else false
        end as is_late_delivery,
        
        -- Derived: Days late (if late)
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_estimated_delivery_date as timestamp)),
                day
            )
            else 0
        end as days_late

    from source
)

select * from renamed

-- Limit in dev for faster iteration
limit 1000
/* dbt 1.10.15 | model: stg_orders | schema: dbt_dev_yourname_staging */;
[0m14:19:44.791717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:44.871451 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_product_categories: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  OPTIONS()
  as 
/*
  STAGING MODEL: stg_product_categories
  Purpose: Product category translation (Portuguese → English)
  Source: Olist Brazilian E-commerce
*/
with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
),
renamed as (
    select
        -- Portuguese name (join key)
        string_field_0 as category_name_pt,
        -- English translation
        string_field_1 as category_name_en,
        -- Derived: Category group
        case
            when string_field_1 in ('computers', 'computers_accessories', 'electronics', 'tablets_printing_image', 'telephony', 'fixed_telephony')
                then 'Electronics'
            when string_field_1 in ('furniture_decor', 'furniture_living_room', 'furniture_bedroom', 'furniture_mattress_and_upholstery', 'office_furniture', 'home_comfort', 'home_comfort_2', 'home_confort')
                then 'Furniture'
            when string_field_1 in ('health_beauty', 'perfumery', 'diapers_and_hygiene')
                then 'Health & Beauty'
            when string_field_1 in ('sports_leisure', 'toys', 'baby', 'fashion_bags_accessories', 'fashion_shoes', 'fashion_sport', 'fashion_underwear_beach', 'fashio_female_clothing', 'fashion_male_clothing', 'fashion_childrens_clothes')
                then 'Fashion & Lifestyle'
            when string_field_1 in ('housewares', 'kitchen_dining_laundry_garden_furniture', 'garden_tools', 'flowers', 'la_cuisine')
                then 'Home & Garden'
            else 'Other'
        end as category_group
    from source
)
select * from renamed
/* dbt 1.10.15 | model: stg_product_categories | schema: dbt_dev_yourname_staging */;
[0m14:19:44.873459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:45.001811 [info ] [Thread-4 (]: 36 of 148 PASS not_null_order_status_codes_status_code ......................... [[32mPASS[0m in 7.23s]
[0m14:19:45.003631 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:19:45.005625 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_products
[0m14:19:45.006623 [info ] [Thread-4 (]: 42 of 148 START sql view model dbt_dev_yourname_staging.stg_products ........... [RUN]
[0m14:19:45.008619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968, now model.dbt_advanced_olist.stg_products)
[0m14:19:45.010617 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_products
[0m14:19:45.024577 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_products"
[0m14:19:45.027817 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_products
[0m14:19:45.041539 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_products"
[0m14:19:45.044524 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_products: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_products
  
  Purpose: Clean product catalog data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Calculate product volume
  - Classify product size
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`products`
),

renamed as (
    select
        -- Primary Key
        product_id,
        
        -- Category (Portuguese - join with translation table)
        product_category_name as category_name_pt,
        
        -- Dimensions
        cast(product_weight_g as numeric) as weight_grams,
        cast(product_length_cm as numeric) as length_cm,
        cast(product_height_cm as numeric) as height_cm,
        cast(product_width_cm as numeric) as width_cm,
        
        -- Derived: Volume in cubic cm
        cast(product_length_cm as numeric) 
            * cast(product_height_cm as numeric) 
            * cast(product_width_cm as numeric) as volume_cm3,
        
        -- Derived: Size classification
        case
            when cast(product_weight_g as numeric) < 500 then 'Small'
            when cast(product_weight_g as numeric) < 2000 then 'Medium'
            when cast(product_weight_g as numeric) < 10000 then 'Large'
            else 'Extra Large'
        end as size_category,
        
        -- Product description stats
        product_name_lenght as name_length,
        product_description_lenght as description_length,
        product_photos_qty as photo_count

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_products | schema: dbt_dev_yourname_staging */;
[0m14:19:45.046537 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:45.603365 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ac9ca8a5-265b-481a-8fe9-7bf91b8ca6e0&page=queryresults
[0m14:19:47.165421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7dc121cf-8776-41ae-b92e-2b8c8c4becdf&page=queryresults
[0m14:19:47.175401 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1795c2bb-8b25-4191-ad42-d95a1b26ef9d&page=queryresults
[0m14:19:47.171405 [info ] [Thread-3 (]: 37 of 148 PASS unique_order_status_codes_status_code ........................... [[32mPASS[0m in 8.76s]
[0m14:19:47.191389 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:19:47.198486 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:19:47.204314 [info ] [Thread-3 (]: 43 of 148 START test accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m14:19:47.211301 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b, now test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f)
[0m14:19:47.218277 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:19:47.256179 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m14:19:47.268144 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:19:47.293082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:47.654028 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2c0ae690-fe6e-413f-9eba-d2947dcc3411&page=queryresults
[0m14:19:48.033848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025254567210>]}
[0m14:19:48.045780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002525452F150>]}
[0m14:19:48.053765 [info ] [Thread-1 (]: 40 of 148 OK created sql view model dbt_dev_yourname_staging.stg_orders ........ [[32mCREATE VIEW (0 processed)[0m in 3.40s]
[0m14:19:48.072711 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_orders
[0m14:19:48.059743 [info ] [Thread-2 (]: 41 of 148 OK created sql view model dbt_dev_yourname_staging.stg_product_categories  [[32mCREATE VIEW (0 processed)[0m in 3.41s]
[0m14:19:48.078696 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:19:48.089663 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_product_categories
[0m14:19:48.099638 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:19:48.093657 [info ] [Thread-1 (]: 44 of 148 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [RUN]
[0m14:19:48.120583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_orders, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789)
[0m14:19:48.125568 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:19:48.107617 [info ] [Thread-2 (]: 45 of 148 START test not_null_stg_customers_customer_id ........................ [RUN]
[0m14:19:48.156528 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m14:19:48.158636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_product_categories, now test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:19:48.161471 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:19:48.175433 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:19:48.193387 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:19:48.205351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:48.267188 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:19:48.276162 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:48.465959 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252544D2DD0>]}
[0m14:19:48.469988 [info ] [Thread-4 (]: 42 of 148 OK created sql view model dbt_dev_yourname_staging.stg_products ...... [[32mCREATE VIEW (0 processed)[0m in 3.46s]
[0m14:19:48.475973 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_products
[0m14:19:48.478968 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:19:48.483464 [info ] [Thread-4 (]: 46 of 148 START test not_null_stg_customers_customer_region .................... [RUN]
[0m14:19:48.489356 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_products, now test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e)
[0m14:19:48.492887 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:19:48.537976 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m14:19:48.543849 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:19:48.568729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:49.243497 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
[0m14:19:49.252474 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:50.169807 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
[0m14:19:50.174837 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
[0m14:19:50.177780 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4fdde354-6d1f-42aa-86ec-0c33e0e79f1d&page=queryresults
[0m14:19:50.186778 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:50.192843 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:50.363031 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
[0m14:19:50.371001 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:50.985023 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b9687df0-4117-4cd9-a5dd-e580fcb3e3c9&page=queryresults
[0m14:19:51.268271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ceb454cb-38f3-4c94-af1a-4081fe965d5f&page=queryresults
[0m14:19:51.270273 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cb7e82ba-28c4-4049-96aa-37b5e9ce923b&page=queryresults
[0m14:19:52.389288 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m14:19:52.404243 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:53.525493 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ac04cfef-c67a-4363-b52c-6793e58f42e1&page=queryresults
[0m14:19:53.531470 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:19:53.538452 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:54.090316 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m14:19:54.095307 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m14:19:54.104283 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:54.107271 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:19:54.318515 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8ed3f1e6-53a0-41c0-b1ac-c32c734fc57a&page=queryresults
[0m14:19:54.875885 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa9e5070-052e-4eb1-ab0f-7b2d7174486d&page=queryresults
[0m14:19:54.888817 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:83495862-253a-4fbf-b966-6337db9c2d35&page=queryresults
[0m14:19:55.108309 [info ] [Thread-3 (]: 43 of 148 PASS accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 7.90s]
[0m14:19:55.115686 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:19:55.120875 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:19:55.125224 [info ] [Thread-3 (]: 47 of 148 START test not_null_stg_customers_customer_state ..................... [RUN]
[0m14:19:55.133204 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f, now test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397)
[0m14:19:55.141186 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:19:55.192046 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m14:19:55.204015 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:19:55.225954 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:19:56.247949 [info ] [Thread-2 (]: 45 of 148 PASS not_null_stg_customers_customer_id .............................. [[32mPASS[0m in 8.09s]
[0m14:19:56.268517 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:19:56.271945 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:19:56.274895 [info ] [Thread-2 (]: 48 of 148 START test not_null_stg_customers_customer_unique_id ................. [RUN]
[0m14:19:56.278674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba)
[0m14:19:56.283592 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:19:56.307412 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:19:56.315391 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:19:56.334379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:19:56.726747 [info ] [Thread-1 (]: 44 of 148 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [[32mPASS[0m in 8.61s]
[0m14:19:56.740667 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:19:56.731692 [info ] [Thread-4 (]: 46 of 148 PASS not_null_stg_customers_customer_region .......................... [[32mPASS[0m in 8.24s]
[0m14:19:56.746651 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:19:56.754628 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:19:56.767168 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:19:56.760613 [info ] [Thread-1 (]: 49 of 148 START test unique_stg_customers_customer_id .......................... [RUN]
[0m14:19:56.780647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789, now test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada)
[0m14:19:56.771583 [info ] [Thread-4 (]: 50 of 148 START test is_not_negative_stg_order_items_item_freight .............. [RUN]
[0m14:19:56.795519 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:19:56.801504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e, now test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a)
[0m14:19:56.834413 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:19:56.852364 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m14:19:56.860343 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m14:19:56.866329 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:19:56.868611 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:19:56.883311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:19:56.889265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:57.303395 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
[0m14:19:57.310402 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:58.255346 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
[0m14:19:58.260333 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
[0m14:19:58.264369 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c4d00f6e-2775-4cad-9bf8-b5b50c92a9a3&page=queryresults
[0m14:19:58.269303 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:58.275537 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_freight as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:58.588751 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
[0m14:19:58.597681 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:19:59.195596 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c26aa4f-8116-471b-ab20-c90000b7e236&page=queryresults
[0m14:19:59.200592 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f7f70f20-928a-4624-8cbc-fd16365fa755&page=queryresults
[0m14:19:59.428662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dd1938e6-242a-4d72-853c-c60c54d99380&page=queryresults
[0m14:20:00.503837 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m14:20:00.511167 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:01.327403 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8263f245-5482-4363-814c-5463afcdccb6&page=queryresults
[0m14:20:01.334352 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:20:01.346430 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:01.948283 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m14:20:01.952279 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m14:20:01.964740 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:01.970725 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:02.120593 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:95f9ffc5-c59f-426a-9bd9-7099944355a2&page=queryresults
[0m14:20:02.813219 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f2fbf26d-33f6-4711-bfd2-8c0699254e11&page=queryresults
[0m14:20:02.895774 [info ] [Thread-3 (]: 47 of 148 PASS not_null_stg_customers_customer_state ........................... [[32mPASS[0m in 7.76s]
[0m14:20:02.904757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa58b204-c782-46fa-bdde-310d1c99f57d&page=queryresults
[0m14:20:02.908782 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:20:02.917756 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:20:02.923697 [info ] [Thread-3 (]: 51 of 148 START test is_positive_stg_order_items_item_price .................... [RUN]
[0m14:20:02.928686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397, now test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242)
[0m14:20:02.935669 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:20:02.985548 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m14:20:02.991517 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:20:03.026470 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:03.556805 [info ] [Thread-2 (]: 48 of 148 PASS not_null_stg_customers_customer_unique_id ....................... [[32mPASS[0m in 7.28s]
[0m14:20:03.564748 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:20:03.568766 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:20:03.571771 [info ] [Thread-2 (]: 52 of 148 START test is_positive_stg_order_items_item_total .................... [RUN]
[0m14:20:03.576715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25)
[0m14:20:03.582700 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:20:03.625590 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m14:20:03.636644 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:20:03.669472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:04.218591 [info ] [Thread-1 (]: 49 of 148 PASS unique_stg_customers_customer_id ................................ [[32mPASS[0m in 7.44s]
[0m14:20:04.235583 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:20:04.229578 [info ] [Thread-4 (]: 50 of 148 PASS is_not_negative_stg_order_items_item_freight .................... [[32mPASS[0m in 7.43s]
[0m14:20:04.239514 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:20:04.249470 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:20:04.255455 [info ] [Thread-1 (]: 53 of 148 START test not_null_stg_order_items_item_freight ..................... [RUN]
[0m14:20:04.260642 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:20:04.266425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada, now test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5)
[0m14:20:04.272407 [info ] [Thread-4 (]: 54 of 148 START test not_null_stg_order_items_item_price ....................... [RUN]
[0m14:20:04.276440 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:20:04.287367 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a, now test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556)
[0m14:20:04.591585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m14:20:04.594547 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:20:04.603555 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m14:20:04.605515 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:20:04.614519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:04.616486 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:20:04.663485 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:04.988398 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
[0m14:20:04.995338 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_price as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price <= 0
   or item_price is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:05.032688 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
[0m14:20:05.039670 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total <= 0
   or item_total is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:05.834559 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:223780ae-d722-4361-93bf-31ce668412bd&page=queryresults
[0m14:20:05.838511 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7fc5427e-38e7-411b-bc2a-d484a0aab88d&page=queryresults
[0m14:20:06.219392 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
[0m14:20:06.223347 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
[0m14:20:06.232172 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:06.237115 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:07.061150 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5524a40d-83b7-4a9c-acfd-91dfd811fec0&page=queryresults
[0m14:20:07.065135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b62a12fe-2fba-4a6d-8305-fa557379148f&page=queryresults
[0m14:20:08.291209 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m14:20:08.307127 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:08.908390 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m14:20:08.931288 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:08.972675 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:efa860a4-9024-4f93-aac1-9a96bc1b8e8b&page=queryresults
[0m14:20:09.522206 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m14:20:09.541118 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:09.926364 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:754f9292-076a-4b9d-9502-4bfa1186019c&page=queryresults
[0m14:20:10.013757 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m14:20:10.023933 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:10.337147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5fa16d6c-6027-4c6c-a6f4-57b7a4379bc7&page=queryresults
[0m14:20:10.457011 [info ] [Thread-2 (]: 52 of 148 PASS is_positive_stg_order_items_item_total .......................... [[32mPASS[0m in 6.88s]
[0m14:20:10.467940 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:20:10.470931 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:20:10.474407 [info ] [Thread-2 (]: 55 of 148 START test not_null_stg_order_items_item_total ....................... [RUN]
[0m14:20:10.482896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25, now test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2)
[0m14:20:10.486884 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:20:10.524782 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m14:20:10.537746 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:20:10.570660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:10.715831 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6790a236-6629-4d86-bb04-a067fb4f0999&page=queryresults
[0m14:20:11.548612 [info ] [Thread-3 (]: 51 of 148 PASS is_positive_stg_order_items_item_price .......................... [[32mPASS[0m in 8.62s]
[0m14:20:11.562360 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:20:11.576365 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:20:11.587983 [info ] [Thread-3 (]: 56 of 148 START test not_null_stg_order_items_order_id ......................... [RUN]
[0m14:20:11.593302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242, now test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96)
[0m14:20:11.600659 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:20:11.637158 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m14:20:11.641140 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:20:11.661087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:11.980732 [info ] [Thread-1 (]: 53 of 148 PASS not_null_stg_order_items_item_freight ........................... [[32mPASS[0m in 7.71s]
[0m14:20:11.988755 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:20:11.992700 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:20:11.996689 [info ] [Thread-1 (]: 57 of 148 START test not_null_stg_order_items_order_item_key ................... [RUN]
[0m14:20:12.001688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5, now test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa)
[0m14:20:12.005672 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:20:12.055575 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m14:20:12.050620 [info ] [Thread-4 (]: 54 of 148 PASS not_null_stg_order_items_item_price ............................. [[32mPASS[0m in 7.76s]
[0m14:20:12.065508 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:20:12.069493 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:20:12.073484 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:20:12.080465 [info ] [Thread-4 (]: 58 of 148 START test not_null_stg_order_items_product_id ....................... [RUN]
[0m14:20:12.111421 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556, now test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6)
[0m14:20:12.108433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:12.115371 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:20:12.200144 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m14:20:12.208157 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:20:12.224109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:12.691352 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
[0m14:20:12.701328 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:13.221952 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
[0m14:20:13.229895 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:13.353499 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:52e457d8-5029-457a-abe7-1727712d5798&page=queryresults
[0m14:20:13.652283 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
[0m14:20:13.660224 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_item_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:13.838953 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
[0m14:20:13.846931 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:14.056240 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:86782f4c-2b1f-4eae-aed6-b1e4edb138da&page=queryresults
[0m14:20:14.424862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5fecea0f-0dd1-43ee-9f94-7cafad01e06d&page=queryresults
[0m14:20:14.768356 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:edb03b8c-4a45-4097-bc5e-70d07c8580a9&page=queryresults
[0m14:20:15.868825 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m14:20:15.880802 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:16.687007 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:621f379e-2059-4a58-be5a-ac53cd3eb547&page=queryresults
[0m14:20:16.726638 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m14:20:16.734615 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:17.151444 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m14:20:17.167359 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:17.465993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fce824af-927f-4fd0-abfd-f935b0373556&page=queryresults
[0m14:20:18.330212 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e40f2a97-e829-4ae5-affc-18afe239e900&page=queryresults
[0m14:20:18.334156 [info ] [Thread-2 (]: 55 of 148 PASS not_null_stg_order_items_item_total ............................. [[32mPASS[0m in 7.85s]
[0m14:20:18.362083 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:20:18.367069 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:20:18.371101 [info ] [Thread-2 (]: 59 of 148 START test unique_stg_order_items_order_item_key ..................... [RUN]
[0m14:20:18.376046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2, now test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057)
[0m14:20:18.382035 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:20:18.419927 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m14:20:18.428918 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:20:18.451840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:18.948983 [info ] [Thread-1 (]: 57 of 148 PASS not_null_stg_order_items_order_item_key ......................... [[32mPASS[0m in 6.95s]
[0m14:20:18.961267 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:20:18.965888 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:20:18.969875 [info ] [Thread-1 (]: 60 of 148 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:20:18.987828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa, now test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460)
[0m14:20:18.998801 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:20:19.037737 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m14:20:19.047672 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:20:19.071603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:19.430411 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m14:20:19.435398 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:19.844218 [info ] [Thread-4 (]: 58 of 148 PASS not_null_stg_order_items_product_id ............................. [[32mPASS[0m in 7.73s]
[0m14:20:19.849202 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:20:19.852202 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:20:19.854239 [info ] [Thread-4 (]: 61 of 148 START test assert_delivery_dates_logical ............................. [RUN]
[0m14:20:19.858182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_advanced_olist.assert_delivery_dates_logical)
[0m14:20:19.862473 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:20:19.906051 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m14:20:19.921019 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:20:19.938995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:20.076595 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c1f9b91-700f-434e-bd54-554ca5a748b8&page=queryresults
[0m14:20:20.129454 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
[0m14:20:20.134443 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_item_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  where order_item_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:20.500803 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
[0m14:20:20.512734 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:20.994570 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e3849d09-2a23-434e-934b-28f8df60d379&page=queryresults
[0m14:20:21.084281 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
[0m14:20:21.093261 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_delivery_dates_logical
  
  Purpose: Delivery dates should follow logical order
  
  Business Rules:
  - approved_at >= ordered_at
  - shipped_at >= approved_at (if exists)
  - delivered_at >= shipped_at (if exists)
  
  Test PASSES if query returns 0 rows
*/

with orders as (
    select
        order_id,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

date_violations as (
    select
        order_id,
        case
            when approved_at < ordered_at then 'Approved before ordered'
            when shipped_at < approved_at then 'Shipped before approved'
            when delivered_at < shipped_at then 'Delivered before shipped'
            when delivered_at < ordered_at then 'Delivered before ordered'
        end as violation_type,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from orders
    where 
        (approved_at is not null and approved_at < ordered_at)
        or (shipped_at is not null and approved_at is not null and shipped_at < approved_at)
        or (delivered_at is not null and shipped_at is not null and delivered_at < shipped_at)
        or (delivered_at is not null and delivered_at < ordered_at)
)

select * from date_violations
  
  
    )
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:21.399034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5da1b80c-6649-4941-90d5-a467bd7842f4&page=queryresults
[0m14:20:21.420018 [info ] [Thread-3 (]: 56 of 148 PASS not_null_stg_order_items_order_id ............................... [[32mPASS[0m in 9.83s]
[0m14:20:21.427957 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:20:21.430951 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_orders_have_items
[0m14:20:21.433946 [info ] [Thread-3 (]: 62 of 148 START test assert_orders_have_items .................................. [RUN]
[0m14:20:21.438930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96, now test.dbt_advanced_olist.assert_orders_have_items)
[0m14:20:21.442917 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_orders_have_items
[0m14:20:21.471837 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m14:20:21.483809 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_orders_have_items
[0m14:20:21.515772 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:22.012825 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:53ca958f-0272-47b6-8912-b9ff67e3b6e5&page=queryresults
[0m14:20:22.673004 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
[0m14:20:22.682976 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

/*
  SINGULAR TEST: assert_orders_have_items
  Purpose: Every order should have at least one line item
  Business Rule: An order without items indicates data integrity issue
  Test PASSES if this query returns 0 rows
  Test FAILS if any orders exist without items
  
  Note: Sample data may have orphaned records - set to warn
*/
with orders as (
    select order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),
order_items as (
    select distinct order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),
orders_without_items as (
    select
        o.order_id
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    where oi.order_id is null
)
select
    order_id,
    'Order has no items' as failure_reason
from orders_without_items
  
  
    )
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:23.247275 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m14:20:23.257203 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:23.413636 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:029906c0-616c-4bf9-b5dd-08cfa747908d&page=queryresults
[0m14:20:23.703728 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m14:20:23.707675 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:23.917831 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f5a1de2c-b7d1-4a86-bf77-805bb4fb38a9&page=queryresults
[0m14:20:24.467918 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m14:20:24.475902 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:24.671756 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b585d141-577d-468d-b4a6-99e8e899229d&page=queryresults
[0m14:20:25.388906 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:890c4bdc-1db0-4833-81c8-3e946484c106&page=queryresults
[0m14:20:25.549462 [info ] [Thread-2 (]: 59 of 148 PASS unique_stg_order_items_order_item_key ........................... [[32mPASS[0m in 7.17s]
[0m14:20:25.554239 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:20:25.559293 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:20:25.564446 [info ] [Thread-2 (]: 63 of 148 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [RUN]
[0m14:20:25.571153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15)
[0m14:20:25.577138 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:20:25.631989 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m14:20:25.634980 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:20:25.651938 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:25.932290 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m14:20:25.938657 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:25.962803 [info ] [Thread-1 (]: 60 of 148 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 6.98s]
[0m14:20:25.968790 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:20:25.971782 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:20:25.977723 [info ] [Thread-1 (]: 64 of 148 START test not_null_stg_orders_customer_id ........................... [RUN]
[0m14:20:25.982712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:20:25.987696 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:20:26.033573 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:20:26.046538 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:20:26.069519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:26.812449 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:34c4a5ee-2bb0-466a-9ced-b0dcd0660db4&page=queryresults
[0m14:20:27.267299 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
[0m14:20:27.281222 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_days >= 0 and delivery_days <= 180
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where
        delivery_days is not null
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:27.296177 [info ] [Thread-4 (]: 61 of 148 PASS assert_delivery_dates_logical ................................... [[32mPASS[0m in 7.44s]
[0m14:20:27.308145 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:20:27.314134 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:20:27.317123 [info ] [Thread-4 (]: 65 of 148 START test not_null_stg_orders_is_late_delivery ...................... [RUN]
[0m14:20:27.326252 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_delivery_dates_logical, now test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0)
[0m14:20:27.332080 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:20:27.381988 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m14:20:27.452732 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:20:27.477669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:27.569824 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
[0m14:20:27.572769 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:28.159236 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cf3fbc2b-67b1-461b-bf97-4008903e5641&page=queryresults
[0m14:20:28.189156 [warn ] [Thread-3 (]: 62 of 148 WARN 890 assert_orders_have_items .................................... [[33mWARN 890[0m in 6.75s]
[0m14:20:28.199135 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_orders_have_items
[0m14:20:28.203119 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:20:28.209104 [info ] [Thread-3 (]: 66 of 148 START test not_null_stg_orders_order_date ............................ [RUN]
[0m14:20:28.214091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_orders_have_items, now test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb)
[0m14:20:28.218078 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:20:28.251987 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m14:20:28.254992 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:20:28.266947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:28.770567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c880b61-92e0-4d1a-b8bf-2ab04433efe3&page=queryresults
[0m14:20:29.180377 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
[0m14:20:29.191244 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where is_late_delivery is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:30.203784 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
[0m14:20:30.212766 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c0f7f5e9-2b86-4f62-9832-ab89c0205a3c&page=queryresults
[0m14:20:30.225725 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:30.824803 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m14:20:30.847743 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:30.960254 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a508d605-c3f1-472f-b217-7c32a7bdb182&page=queryresults
[0m14:20:31.434811 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:20:31.454758 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:31.545503 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a2adf4a3-9a4c-42c6-a385-0170f04f4d2e&page=queryresults
[0m14:20:32.465923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fc21a421-6e12-4e07-affe-6efffa4e1761&page=queryresults
[0m14:20:32.470948 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m14:20:32.500827 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:33.091191 [warn ] [Thread-2 (]: 63 of 148 WARN 1 dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [[33mWARN 1[0m in 7.52s]
[0m14:20:33.101206 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:20:33.104155 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:20:33.110143 [info ] [Thread-2 (]: 67 of 148 START test not_null_stg_orders_order_id .............................. [RUN]
[0m14:20:33.115135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15, now test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:20:33.119117 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:20:33.130288 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:993db389-b0ac-4092-9566-7266f6f6e66b&page=queryresults
[0m14:20:33.179997 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:20:33.185939 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:20:33.209920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:33.528526 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m14:20:33.533507 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:34.011544 [info ] [Thread-1 (]: 64 of 148 PASS not_null_stg_orders_customer_id ................................. [[32mPASS[0m in 8.03s]
[0m14:20:34.017194 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:20:34.020186 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:20:34.026168 [info ] [Thread-1 (]: 68 of 148 START test not_null_stg_orders_order_status .......................... [RUN]
[0m14:20:34.030154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79)
[0m14:20:34.035516 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:20:34.070090 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m14:20:34.102960 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:20:34.129887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:34.241325 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:faa80cb1-4ee1-478b-8896-a205d8631f67&page=queryresults
[0m14:20:34.529572 [info ] [Thread-4 (]: 65 of 148 PASS not_null_stg_orders_is_late_delivery ............................ [[32mPASS[0m in 7.20s]
[0m14:20:34.532484 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:20:34.533483 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:20:34.534670 [info ] [Thread-4 (]: 69 of 148 START test not_null_stg_orders_ordered_at ............................ [RUN]
[0m14:20:34.536473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0, now test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca)
[0m14:20:34.539466 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:20:34.550435 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:20:34.552516 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:20:34.566395 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:34.741040 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
[0m14:20:34.743035 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:35.381772 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1017afdd-ac9a-44dd-98bc-ca79090df3f6&page=queryresults
[0m14:20:35.577228 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
[0m14:20:35.579216 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:35.695457 [info ] [Thread-3 (]: 66 of 148 PASS not_null_stg_orders_order_date .................................. [[32mPASS[0m in 7.48s]
[0m14:20:35.698457 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:20:35.700402 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:20:35.702396 [info ] [Thread-3 (]: 70 of 148 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:20:35.705395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m14:20:35.708060 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:20:35.721355 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m14:20:35.727331 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:20:35.736305 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:36.103128 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
[0m14:20:36.112101 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:36.274509 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5d7aa463-556d-446a-b170-2bff1df03002&page=queryresults
[0m14:20:36.814803 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0b6252c4-ad67-46fc-992d-e7397110c39e&page=queryresults
[0m14:20:37.375997 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
[0m14:20:37.392958 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:37.827543 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:20:37.833562 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:38.227600 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ce6bd84b-106e-4aaa-9de8-c76a08cded76&page=queryresults
[0m14:20:38.294181 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m14:20:38.301174 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:38.496245 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ab6e3227-e750-4a23-a6c3-caa35347e8f6&page=queryresults
[0m14:20:39.012762 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:20:39.025037 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:39.032663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd76c7ea-bee2-46b3-b081-b4b3bc6af16e&page=queryresults
[0m14:20:39.721347 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a9e5dd59-cc75-4741-afd1-dc1f2984d641&page=queryresults
[0m14:20:40.264426 [info ] [Thread-2 (]: 67 of 148 PASS not_null_stg_orders_order_id .................................... [[32mPASS[0m in 7.15s]
[0m14:20:40.281379 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:20:40.294345 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:20:40.297335 [info ] [Thread-2 (]: 71 of 148 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:20:40.302322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:20:40.309310 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:20:40.351198 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:20:40.362162 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:20:40.390088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:40.715764 [info ] [Thread-1 (]: 68 of 148 PASS not_null_stg_orders_order_status ................................ [[32mPASS[0m in 6.68s]
[0m14:20:40.724701 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:20:40.727692 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:20:40.732682 [info ] [Thread-1 (]: 72 of 148 START test unique_stg_orders_order_id ................................ [RUN]
[0m14:20:40.737666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79, now test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a)
[0m14:20:40.743652 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:20:40.781597 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m14:20:40.801926 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m14:20:40.813899 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:40.829855 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:20:40.850795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:41.148866 [info ] [Thread-4 (]: 69 of 148 PASS not_null_stg_orders_ordered_at .................................. [[32mPASS[0m in 6.61s]
[0m14:20:41.162875 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:20:41.165819 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:20:41.168813 [info ] [Thread-4 (]: 73 of 148 START test not_null_stg_product_categories_category_group ............ [RUN]
[0m14:20:41.175793 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca, now test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a)
[0m14:20:41.181210 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:20:41.219718 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m14:20:41.231723 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:20:41.250638 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:41.574913 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cb1323ba-f329-4384-b365-1de6bd88ce50&page=queryresults
[0m14:20:41.957976 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
[0m14:20:41.963962 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:42.281852 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
[0m14:20:42.289782 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:42.901225 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
[0m14:20:42.907210 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8b8fcc25-98d9-4047-88b9-5533d0b64a85&page=queryresults
[0m14:20:42.913193 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:42.931151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:03b3cf6d-f699-47af-889c-1aa6880e5e09&page=queryresults
[0m14:20:42.947102 [warn ] [Thread-3 (]: 70 of 148 WARN 862 relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mWARN 862[0m in 7.24s]
[0m14:20:42.957078 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:20:42.961214 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:20:42.966061 [info ] [Thread-3 (]: 74 of 148 START test not_null_stg_product_categories_category_name_en .......... [RUN]
[0m14:20:42.972129 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17)
[0m14:20:42.980016 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:20:43.028882 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m14:20:43.060698 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:20:43.084108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:43.626200 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b125df28-0ce4-4add-b72c-a1ec23ec82ed&page=queryresults
[0m14:20:44.557565 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
[0m14:20:44.564552 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_en is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:45.161236 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:20:45.166214 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m14:20:45.182175 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:45.190152 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:45.357483 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0d4b423f-a9ed-44ba-8a6c-b4df25ce04c8&page=queryresults
[0m14:20:45.826429 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c66e571a-065a-4b11-a356-c5493179cb15&page=queryresults
[0m14:20:45.860807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:89b289eb-73de-443f-bf23-a18d6cd1c353&page=queryresults
[0m14:20:46.382831 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m14:20:46.404772 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:47.097691 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7bd6d9ef-20ef-4ea5-a844-47aa869772d6&page=queryresults
[0m14:20:47.226394 [info ] [Thread-1 (]: 72 of 148 PASS unique_stg_orders_order_id ...................................... [[32mPASS[0m in 6.49s]
[0m14:20:47.233004 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:20:47.236954 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:20:47.242939 [info ] [Thread-1 (]: 75 of 148 START test not_null_stg_product_categories_category_name_pt .......... [RUN]
[0m14:20:47.247235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c)
[0m14:20:47.252913 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:20:47.295802 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m14:20:47.306772 [warn ] [Thread-2 (]: 71 of 148 WARN 902 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 902[0m in 7.00s]
[0m14:20:47.313751 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:20:47.320734 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:20:47.349658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.354863 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:20:47.361800 [info ] [Thread-2 (]: 76 of 148 START test unique_stg_product_categories_category_name_pt ............ [RUN]
[0m14:20:47.425657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374)
[0m14:20:47.428616 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:20:47.438621 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m14:20:47.441581 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:20:47.451556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:47.629829 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m14:20:47.639768 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:48.312941 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:94670fb1-0dee-4401-a02f-3345a34f9c74&page=queryresults
[0m14:20:48.638640 [info ] [Thread-4 (]: 73 of 148 PASS not_null_stg_product_categories_category_group .................. [[32mPASS[0m in 7.46s]
[0m14:20:48.645616 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:20:48.648608 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:20:48.651599 [info ] [Thread-4 (]: 77 of 148 START test accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [RUN]
[0m14:20:48.659291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a, now test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b)
[0m14:20:48.662780 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:20:48.734378 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m14:20:48.742844 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:20:48.762352 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:48.765299 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
[0m14:20:48.840096 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_pt is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:48.872548 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
[0m14:20:48.880524 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select category_name_pt as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  where category_name_pt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:49.515140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6012c1f0-02a2-418f-ab3b-eb30a9eb8326&page=queryresults
[0m14:20:49.608706 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7b934d6a-13ba-4be5-9c41-f17b28319f58&page=queryresults
[0m14:20:49.699702 [info ] [Thread-3 (]: 74 of 148 PASS not_null_stg_product_categories_category_name_en ................ [[32mPASS[0m in 6.73s]
[0m14:20:49.708678 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:20:49.712624 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:20:49.721652 [info ] [Thread-3 (]: 78 of 148 START test is_not_negative_stg_products_weight_grams ................. [RUN]
[0m14:20:49.732570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17, now test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890)
[0m14:20:49.740804 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:20:49.784435 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m14:20:49.794403 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:20:49.821331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:50.264149 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
[0m14:20:50.273133 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        size_category as value_field,
        count(*) as n_records

    from (select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products` where size_category is not null) dbt_subquery
    group by size_category

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Extra Large'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:51.013807 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f63090c6-1cdc-4f29-a1c3-de788e56a53d&page=queryresults
[0m14:20:51.338834 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
[0m14:20:51.343819 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    weight_grams as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where weight_grams < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:51.817414 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m14:20:51.846336 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:52.113089 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e1d99790-0b7d-40ae-8601-d1e6bf5cab4f&page=queryresults
[0m14:20:52.137028 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m14:20:52.156971 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:52.557525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0fcd96ab-b4d4-4893-8ce4-49d6e12c4126&page=queryresults
[0m14:20:52.936480 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3a142f99-e543-4d1d-b102-fc85fd189d2f&page=queryresults
[0m14:20:53.233776 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m14:20:53.239719 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:54.363535 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6adae664-6930-459a-acb8-23738be19a6e&page=queryresults
[0m14:20:54.369852 [info ] [Thread-1 (]: 75 of 148 PASS not_null_stg_product_categories_category_name_pt ................ [[32mPASS[0m in 7.12s]
[0m14:20:54.394299 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:20:54.399282 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:20:54.406068 [info ] [Thread-1 (]: 79 of 148 START test not_null_stg_products_product_id .......................... [RUN]
[0m14:20:54.412589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c, now test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3)
[0m14:20:54.414950 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:20:54.443637 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m14:20:54.446609 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:20:54.458145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:55.186517 [info ] [Thread-2 (]: 76 of 148 PASS unique_stg_product_categories_category_name_pt .................. [[32mPASS[0m in 7.76s]
[0m14:20:55.207436 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:20:55.211360 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:20:55.216509 [info ] [Thread-2 (]: 80 of 148 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m14:20:55.227488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374, now test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m14:20:55.231459 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:20:55.280516 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m14:20:55.291020 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:20:55.314079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:55.659429 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m14:20:55.671063 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:20:56.155388 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
[0m14:20:56.162348 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:56.158363 [info ] [Thread-4 (]: 77 of 148 PASS accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [[32mPASS[0m in 7.50s]
[0m14:20:56.173749 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:20:56.177511 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:20:56.181478 [info ] [Thread-4 (]: 81 of 148 START test unique_stg_products_product_id ............................ [RUN]
[0m14:20:56.193402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b, now test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467)
[0m14:20:56.197353 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:20:56.231828 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m14:20:56.240275 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:20:56.256258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:20:56.372715 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f6f1f909-b2dc-422b-8aca-7d916619096e&page=queryresults
[0m14:20:56.990616 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
[0m14:20:56.992613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:16795fba-37d9-45d1-95e6-d9ad6da22f67&page=queryresults
[0m14:20:56.999591 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:57.695242 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:673ad01f-2535-4db9-ae60-e054dba07740&page=queryresults
[0m14:20:57.697846 [info ] [Thread-3 (]: 78 of 148 PASS is_not_negative_stg_products_weight_grams ....................... [[32mPASS[0m in 7.97s]
[0m14:20:57.711615 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:20:57.715604 [debug] [Thread-3 (]: Began running node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:20:57.720591 [info ] [Thread-3 (]: 82 of 148 START snapshot snapshots.customers_snapshot .......................... [RUN]
[0m14:20:57.724581 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890, now snapshot.dbt_advanced_olist.customers_snapshot)
[0m14:20:57.728619 [debug] [Thread-3 (]: Began compiling node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:20:57.762432 [debug] [Thread-3 (]: Began executing node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:20:57.882492 [debug] [Thread-3 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        select customer_city, customer_state, customer_zip_code from (
                



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:20:57.885446 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:20:58.111469 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
[0m14:20:58.121391 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:20:58.846542 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7b73e1ef-a043-4ee2-a725-0f94572b6b96&page=queryresults
[0m14:20:59.294803 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m14:20:59.300885 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:00.118699 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3f4317a7-995e-4834-9638-a1c78cce24f5&page=queryresults
[0m14:21:00.122592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9658ab53-6055-45b8-b24a-9b17b49cc43d&page=queryresults
[0m14:21:00.144185 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m14:21:00.150708 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:00.853613 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea89e08c-13a7-4492-9411-625e02d3938f&page=queryresults
[0m14:21:01.353980 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m14:21:01.372455 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:01.961481 [info ] [Thread-1 (]: 79 of 148 PASS not_null_stg_products_product_id ................................ [[32mPASS[0m in 7.55s]
[0m14:21:01.976437 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:21:01.980497 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m14:21:01.988487 [info ] [Thread-1 (]: 83 of 148 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [RUN]
[0m14:21:01.994475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3, now model.dbt_advanced_olist.int_orders_enriched)
[0m14:21:01.996505 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m14:21:02.062293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m14:21:02.073820 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m14:21:02.095135 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m14:21:02.103321 [debug] [Thread-1 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m14:21:02.107310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:02.186344 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ff863328-2adb-4cc5-8c35-09772d8bac77&page=queryresults
[0m14:21:02.393751 [warn ] [Thread-2 (]: 80 of 148 WARN 642 relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[33mWARN 642[0m in 7.17s]
[0m14:21:02.402970 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:21:03.095396 [debug] [Thread-3 (]: On snapshot.dbt_advanced_olist.customers_snapshot: 
        
  
    

    create or replace table `big-query-dbt-481111`.`snapshots`.`customers_snapshot__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `big-query-dbt-481111`.`snapshots`.`customers_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */;
[0m14:21:03.918085 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3466cf20-28ca-493f-a8d5-8d0a70271cad&page=queryresults
[0m14:21:04.012797 [info ] [Thread-4 (]: 81 of 148 PASS unique_stg_products_product_id .................................. [[32mPASS[0m in 7.82s]
[0m14:21:04.026758 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:21:04.035736 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.int_products_enriched
[0m14:21:04.041884 [info ] [Thread-2 (]: 84 of 148 START sql view model dbt_dev_yourname_intermediate.int_products_enriched  [RUN]
[0m14:21:04.048425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now model.dbt_advanced_olist.int_products_enriched)
[0m14:21:04.060603 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.int_products_enriched
[0m14:21:04.111328 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_products_enriched"
[0m14:21:04.120308 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.int_products_enriched
[0m14:21:04.129158 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_products_enriched"
[0m14:21:04.134268 [debug] [Thread-2 (]: On model.dbt_advanced_olist.int_products_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_products_enriched
  
  Purpose: Enrich products with category translations and sales metrics
*/

with products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
),

categories as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Calculate product-level sales metrics
product_sales as (
    select
        product_id,
        count(distinct order_id) as times_ordered,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_selling_price,
        min(item_price) as min_selling_price,
        max(item_price) as max_selling_price
    from order_items
    group by 1
),

-- Join products with categories and sales
enriched as (
    select
        -- Product info
        p.product_id,
        p.category_name_pt,
        coalesce(c.category_name_en, 'Unknown') as category_name,
        coalesce(c.category_group, 'Other') as category_group,
        
        -- Dimensions
        p.weight_grams,
        p.length_cm,
        p.height_cm,
        p.width_cm,
        p.volume_cm3,
        p.size_category,
        
        -- Product listing quality
        p.name_length,
        p.description_length,
        p.photo_count,
        
        -- Derived: Listing quality score (0-100)
        (
            case when p.name_length > 0 then 20 else 0 end +
            case when p.description_length > 100 then 30 else p.description_length * 0.3 end +
            case when p.photo_count >= 3 then 50 else p.photo_count * 15 end
        ) as listing_quality_score,
        
        -- Sales metrics
        coalesce(ps.times_ordered, 0) as times_ordered,
        coalesce(ps.total_revenue, 0) as total_revenue,
        coalesce(ps.avg_selling_price, 0) as avg_selling_price,
        
        -- Derived: Product popularity tier
        case
            when coalesce(ps.times_ordered, 0) = 0 then 'Never Sold'
            when ps.times_ordered < 5 then 'Low'
            when ps.times_ordered < 20 then 'Medium'
            when ps.times_ordered < 50 then 'High'
            else 'Top Seller'
        end as popularity_tier

    from products p
    left join categories c on p.category_name_pt = c.category_name_pt
    left join product_sales ps on p.product_id = ps.product_id
)

select * from enriched
/* dbt 1.10.15 | model: int_products_enriched | schema: dbt_dev_yourname_intermediate */;
[0m14:21:04.136576 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:05.737737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ce4fb89-fbf1-4895-8cc3-5d84c7654251&page=queryresults
[0m14:21:05.945143 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:10eeb0ee-517b-400f-aa14-45f7d1359205&page=queryresults
[0m14:21:07.302870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252534EBF50>]}
[0m14:21:07.311406 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252546FA710>]}
[0m14:21:07.318383 [info ] [Thread-1 (]: 83 of 148 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 5.31s]
[0m14:21:07.332343 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m14:21:07.326365 [info ] [Thread-2 (]: 84 of 148 OK created sql view model dbt_dev_yourname_intermediate.int_products_enriched  [[32mCREATE VIEW (0 processed)[0m in 3.26s]
[0m14:21:07.344025 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.int_products_enriched
[0m14:21:07.347494 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:21:07.355450 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:21:07.359532 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:21:07.370327 [info ] [Thread-4 (]: 85 of 148 START test assert_order_total_matches_items .......................... [RUN]
[0m14:21:07.391430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467, now test.dbt_advanced_olist.assert_order_total_matches_items)
[0m14:21:07.378624 [info ] [Thread-1 (]: 86 of 148 START test dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [RUN]
[0m14:21:07.386596 [info ] [Thread-2 (]: 87 of 148 START test is_not_negative_int_orders_enriched_order_total ........... [RUN]
[0m14:21:07.396866 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:21:07.402598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_orders_enriched, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75)
[0m14:21:07.405362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_products_enriched, now test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf)
[0m14:21:07.439344 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:21:07.441338 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m14:21:07.442366 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:21:07.456916 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m14:21:07.472986 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m14:21:07.473982 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:21:07.475983 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:21:07.486968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:07.496950 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:21:07.495874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:07.509460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:08.357598 [debug] [Thread-3 (]: BigQuery adapter: Adding columns ([]) to table `big-query-dbt-481111`.`snapshots`.`customers_snapshot`".
[0m14:21:09.093571 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
[0m14:21:09.103557 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and item_count >= 0 and item_count <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:09.524001 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
[0m14:21:09.535970 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_order_total_matches_items
  
  Purpose: Order total should equal sum of item totals (within tolerance)
  
  Business Rule: Order total = sum(item_price + item_freight) for all items
  
  Tolerance: 1 BRL to account for rounding
  
  Test PASSES if query returns 0 rows
*/

with order_totals_from_items as (
    select
        order_id,
        sum(item_total) as calculated_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    group by 1
),

order_totals_from_orders as (
    select
        order_id,
        order_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

mismatches as (
    select
        o.order_id,
        o.order_total as reported_total,
        i.calculated_total,
        abs(o.order_total - i.calculated_total) as difference
    from order_totals_from_orders o
    inner join order_totals_from_items i on o.order_id = i.order_id
    where abs(o.order_total - i.calculated_total) > 1  -- 1 BRL tolerance
)

select
    order_id,
    reported_total,
    calculated_total,
    round(difference, 2) as difference_brl,
    'Order total does not match sum of items' as failure_reason
from mismatches
  
  
    )
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:09.862805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5ffa0448-0f49-4464-affb-39b385a4aea9&page=queryresults
[0m14:21:10.062439 [debug] [Thread-3 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        
    
    with snapshot_query as (

        



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `big-query-dbt-481111`.`snapshots`.`customers_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:21:10.280525 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
[0m14:21:10.288043 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    order_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:10.653830 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9dd7a74b-a0bb-48b0-91e1-e513f690c63d&page=queryresults
[0m14:21:11.062494 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f9920699-c0d5-47f2-a5ad-f62a7a559383&page=queryresults
[0m14:21:11.107803 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a08777ce-cd1e-4615-ab95-65da069fbb20&page=queryresults
[0m14:21:11.548365 [debug] [Thread-3 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:21:12.292616 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d136af55-65b3-4b03-ad7a-e3b11e6a2f6e&page=queryresults
[0m14:21:12.902379 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.dbt_advanced_olist.customers_snapshot"
[0m14:21:12.920811 [debug] [Thread-3 (]: On snapshot.dbt_advanced_olist.customers_snapshot: 
      merge into `big-query-dbt-481111`.`snapshots`.`customers_snapshot` as DBT_INTERNAL_DEST
    using `big-query-dbt-481111`.`snapshots`.`customers_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_city`, `customer_state`, `customer_zip_code`, `customer_region`, `_snapshot_at`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_city`, `customer_state`, `customer_zip_code`, `customer_region`, `_snapshot_at`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m14:21:13.357526 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m14:21:13.371494 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:13.836304 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fbfd3c19-3d69-42d7-aa5c-57bafa105f6f&page=queryresults
[0m14:21:13.842278 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fbfd3c19-3d69-42d7-aa5c-57bafa105f6f&page=queryresults
[0m14:21:14.089667 [debug] [Thread-3 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m14:21:14.092807 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025253DB6910>]}
[0m14:21:14.099529 [error] [Thread-3 (]: 82 of 148 ERROR snapshotting snapshots.customers_snapshot ...................... [[31mERROR[0m in 16.37s]
[0m14:21:14.106344 [debug] [Thread-3 (]: Finished running node snapshot.dbt_advanced_olist.customers_snapshot
[0m14:21:14.109336 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:21:14.111383 [debug] [Thread-7 (]: Marking all children of 'snapshot.dbt_advanced_olist.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql.
[0m14:21:14.116324 [info ] [Thread-3 (]: 88 of 148 START test not_null_int_orders_enriched_item_count ................... [RUN]
[0m14:21:14.124280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.dbt_advanced_olist.customers_snapshot, now test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101)
[0m14:21:14.127490 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:21:14.138435 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aeefde62-6620-4020-aa93-f4b8dd1489e6&page=queryresults
[0m14:21:14.176600 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m14:21:14.187572 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:21:14.210567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:14.956351 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m14:21:14.966429 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m14:21:14.978468 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:14.987445 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:15.678311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f3cf4a47-d514-4dd3-bdc7-ec9524bb72ac&page=queryresults
[0m14:21:16.033061 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e695c9b0-0d6e-49ae-9c81-833574b84761&page=queryresults
[0m14:21:16.494036 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
[0m14:21:16.499022 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:16.552314 [info ] [Thread-4 (]: 85 of 148 PASS assert_order_total_matches_items ................................ [[32mPASS[0m in 9.16s]
[0m14:21:16.556301 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:21:16.558295 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:21:16.560292 [info ] [Thread-4 (]: 89 of 148 START test not_null_int_orders_enriched_order_id ..................... [RUN]
[0m14:21:16.562286 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_order_total_matches_items, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e)
[0m14:21:16.566273 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:21:16.598189 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m14:21:16.609161 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:21:16.625117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:16.945466 [info ] [Thread-1 (]: 86 of 148 PASS dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [[32mPASS[0m in 9.54s]
[0m14:21:16.952015 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:21:16.956796 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:21:16.958950 [info ] [Thread-1 (]: 90 of 148 START test not_null_int_orders_enriched_order_total .................. [RUN]
[0m14:21:16.962607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c)
[0m14:21:16.963977 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:21:16.987867 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m14:21:16.993972 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:21:17.018787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:17.425982 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5b32c11a-d877-4f56-bc1a-c1606bed9c0d&page=queryresults
[0m14:21:17.498006 [info ] [Thread-2 (]: 87 of 148 PASS is_not_negative_int_orders_enriched_order_total ................. [[32mPASS[0m in 10.09s]
[0m14:21:17.500950 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:21:17.503251 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:21:17.505064 [info ] [Thread-2 (]: 91 of 148 START test unique_int_orders_enriched_order_id ....................... [RUN]
[0m14:21:17.508472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf, now test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232)
[0m14:21:17.511465 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:21:17.534452 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m14:21:17.538393 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:21:17.552108 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:18.226677 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
[0m14:21:18.235651 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:18.740534 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
[0m14:21:18.747515 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:19.046667 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:81533f00-17ef-4863-bb94-3e23371e79eb&page=queryresults
[0m14:21:19.456895 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
[0m14:21:19.468911 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:19.521604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c636e1f4-41e8-485f-8808-c6dee255af11&page=queryresults
[0m14:21:20.207191 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cf7359f8-89b4-4daa-99f2-abd555f4271d&page=queryresults
[0m14:21:20.585161 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m14:21:20.590150 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:21.830040 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:15443cfa-0329-4bb1-aa3e-b69aa5bd83f3&page=queryresults
[0m14:21:22.387362 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m14:21:22.409263 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:23.254436 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m14:21:23.266400 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m14:21:23.273381 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:89b983aa-1f94-4198-beb1-6e41463770a4&page=queryresults
[0m14:21:23.281361 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:23.290337 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:23.974671 [info ] [Thread-3 (]: 88 of 148 PASS not_null_int_orders_enriched_item_count ......................... [[32mPASS[0m in 9.85s]
[0m14:21:23.986640 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:21:23.991627 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:21:23.998606 [info ] [Thread-3 (]: 92 of 148 START test dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [RUN]
[0m14:21:24.009782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd)
[0m14:21:24.018552 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:21:24.041493 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m14:21:24.043644 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:21:24.059995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:24.303171 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea5aee67-5ef0-4d56-b22a-1d2fa5bba950&page=queryresults
[0m14:21:24.311149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0cc3d99e-3067-439a-b6cc-5ca44f22dfe1&page=queryresults
[0m14:21:25.122003 [info ] [Thread-4 (]: 89 of 148 PASS not_null_int_orders_enriched_order_id ........................... [[32mPASS[0m in 8.56s]
[0m14:21:25.139402 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:21:25.142400 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:21:25.146386 [info ] [Thread-4 (]: 93 of 148 START test not_null_int_products_enriched_category_name .............. [RUN]
[0m14:21:25.152937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e, now test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760)
[0m14:21:25.156362 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:21:25.192445 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m14:21:25.204066 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:21:25.221014 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:26.236890 [info ] [Thread-2 (]: 91 of 148 PASS unique_int_orders_enriched_order_id ............................. [[32mPASS[0m in 8.73s]
[0m14:21:26.254844 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:21:26.249855 [info ] [Thread-1 (]: 90 of 148 PASS not_null_int_orders_enriched_order_total ........................ [[32mPASS[0m in 9.29s]
[0m14:21:26.259830 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:21:26.268808 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:21:26.273800 [info ] [Thread-2 (]: 94 of 148 START test not_null_int_products_enriched_product_id ................. [RUN]
[0m14:21:26.277784 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:21:26.284764 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232, now test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565)
[0m14:21:26.289751 [info ] [Thread-1 (]: 95 of 148 START test unique_int_products_enriched_product_id ................... [RUN]
[0m14:21:26.293897 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:21:26.301719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c, now test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117)
[0m14:21:26.324686 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m14:21:26.326649 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:21:26.341609 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m14:21:26.343616 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:21:26.360590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:26.413417 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:21:26.415440 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
[0m14:21:26.422422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:26.424418 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and listing_quality_score >= 0 and listing_quality_score <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:27.159907 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
[0m14:21:27.167848 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where category_name is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:27.306569 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1184f141-a7d6-4b7a-a419-f365ad2a3d07&page=queryresults
[0m14:21:27.911047 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
[0m14:21:27.917032 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:04b185cf-92d6-46be-bf0e-0b2a9bba3578&page=queryresults
[0m14:21:27.923131 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:28.886730 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:07589c6e-a221-451b-b346-734e3b86fdfb&page=queryresults
[0m14:21:29.082784 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
[0m14:21:29.089812 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:30.100174 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:30a86ccd-d104-4e23-a191-c5bfdc2777d5&page=queryresults
[0m14:21:30.175272 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m14:21:30.184218 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:30.560455 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m14:21:30.568393 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:31.136214 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4369bee0-0128-486a-a08d-0f6d5848b576&page=queryresults
[0m14:21:31.250935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:01a443a6-4324-4939-be60-e2e9e1f1984b&page=queryresults
[0m14:21:31.646002 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m14:21:31.664510 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:32.395417 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2372361b-81ef-44e8-9ee4-9a785fa31925&page=queryresults
[0m14:21:32.908968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m14:21:32.916948 [info ] [Thread-4 (]: 93 of 148 PASS not_null_int_products_enriched_category_name .................... [[32mPASS[0m in 7.76s]
[0m14:21:32.927919 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:21:32.920938 [info ] [Thread-3 (]: 92 of 148 PASS dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [[32mPASS[0m in 8.91s]
[0m14:21:32.931924 [debug] [Thread-4 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:21:32.933902 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:32.936893 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:21:32.938888 [info ] [Thread-4 (]: 96 of 148 START unit_test dim_customers::test_customer_segment_high_value ...... [RUN]
[0m14:21:32.946883 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value)
[0m14:21:32.948863 [debug] [Thread-4 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:21:32.950047 [debug] [Thread-4 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:21:33.152265 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:33.764934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7fd0b084-1cd4-4311-82f8-4e67dd5dfd82&page=queryresults
[0m14:21:34.183814 [info ] [Thread-2 (]: 94 of 148 PASS not_null_int_products_enriched_product_id ....................... [[32mPASS[0m in 7.90s]
[0m14:21:34.350372 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:21:35.081415 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:21:35.683363 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:21:35.860850 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:21:36.105184 [debug] [Thread-4 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_high_value__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */;
[0m14:21:36.215246 [info ] [Thread-1 (]: 95 of 148 PASS unique_int_products_enriched_product_id ......................... [[32mPASS[0m in 9.91s]
[0m14:21:36.219235 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:21:36.222228 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.fct_orders
[0m14:21:36.225220 [info ] [Thread-3 (]: 97 of 148 START sql table model dbt_dev_yourname_marts.fct_orders .............. [RUN]
[0m14:21:36.229211 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd, now model.dbt_advanced_olist.fct_orders)
[0m14:21:36.232207 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.fct_orders
[0m14:21:36.270101 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.fct_orders"
[0m14:21:36.273090 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.fct_orders
[0m14:21:36.288314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:36.688601 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d3963e88-4cbc-492f-a39a-89096c959f66&page=queryresults
[0m14:21:37.868016 [debug] [Thread-3 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m14:21:39.116064 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4272fec0-5154-4acf-85f4-76bc48a65494&page=queryresults
[0m14:21:39.270677 [debug] [Thread-4 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:21:39.333546 [debug] [Thread-4 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''High Value''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */
[0m14:21:39.605749 [warn ] [Thread-3 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['subtotal', 'freight_total', 'order_total', 'avg_item_price']`
[0m14:21:39.609166 [debug] [Thread-3 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        select
    
      
    cast(null as string)
 as order_id, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as order_status, 
      
    cast(null as date)
 as order_date, 
      
    cast(null as timestamp)
 as ordered_at, 
      
    cast(null as timestamp)
 as approved_at, 
      
    cast(null as timestamp)
 as shipped_at, 
      
    cast(null as timestamp)
 as delivered_at, 
      
    cast(null as timestamp)
 as estimated_delivery_at, 
      
    cast(null as int64)
 as order_year, 
      
    cast(null as int64)
 as order_month, 
      
    cast(null as int64)
 as order_quarter, 
      
    cast(null as int64)
 as order_week, 
      
    cast(null as int64)
 as order_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as string)
 as primary_category, 
      
    cast(null as string)
 as primary_category_group, 
      
    cast(null as int64)
 as item_count, 
      
    cast(null as int64)
 as unique_products, 
      
    cast(null as numeric)
 as subtotal, 
      
    cast(null as numeric)
 as freight_total, 
      
    cast(null as numeric)
 as order_total, 
      
    cast(null as numeric)
 as avg_item_price, 
      
    cast(null as int64)
 as delivery_days, 
      
    cast(null as boolean)
 as is_late_delivery, 
      
    cast(null as int64)
 as days_late, 
      
    cast(null as string)
 as order_size_bucket, 
      
    cast(null as string)
 as delivery_sla_status, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m14:21:40.231960 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4524c55d-92e6-4f25-b61b-eea9ea616227&page=queryresults
[0m14:21:40.434196 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:10bcf97f-4a00-4eba-9a0c-1ccbf0c0f92d&page=queryresults
[0m14:21:40.915298 [warn ] [Thread-3 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m14:21:40.933953 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.fct_orders"
[0m14:21:41.709964 [debug] [Thread-3 (]: On model.dbt_advanced_olist.fct_orders: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
        
  (
    order_id string not null primary key not enforced,
    customer_id string,
    order_status string,
    order_date date,
    ordered_at timestamp,
    approved_at timestamp,
    shipped_at timestamp,
    delivered_at timestamp,
    estimated_delivery_at timestamp,
    order_year int64,
    order_month int64,
    order_quarter int64,
    order_week int64,
    order_day_of_week int64,
    is_weekend boolean,
    customer_city string,
    customer_state string,
    customer_region string,
    primary_category string,
    primary_category_group string,
    item_count int64,
    unique_products int64,
    subtotal numeric,
    freight_total numeric,
    order_total numeric,
    avg_item_price numeric,
    delivery_days int64,
    is_late_delivery boolean,
    days_late int64,
    order_size_bucket string,
    delivery_sla_status string,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(order_date, month)
    cluster by order_status, customer_state

    
    OPTIONS()
    as (
      
    select order_id, customer_id, order_status, order_date, ordered_at, approved_at, shipped_at, delivered_at, estimated_delivery_at, order_year, order_month, order_quarter, order_week, order_day_of_week, is_weekend, customer_city, customer_state, customer_region, primary_category, primary_category_group, item_count, unique_products, subtotal, freight_total, order_total, avg_item_price, delivery_days, is_late_delivery, days_late, order_size_bucket, delivery_sla_status, _loaded_at
    from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */;
[0m14:21:42.908374 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ebd37082-1e4b-4229-9659-476807f9c49e&page=queryresults
[0m14:21:43.644925 [info ] [Thread-4 (]: 96 of 148 PASS dim_customers::test_customer_segment_high_value ................. [[32mPASS[0m in 10.70s]
[0m14:21:43.648741 [debug] [Thread-4 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:21:43.653324 [debug] [Thread-4 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:21:43.662418 [info ] [Thread-4 (]: 98 of 148 START unit_test dim_customers::test_customer_segment_vip ............. [RUN]
[0m14:21:43.667010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip)
[0m14:21:43.670823 [debug] [Thread-4 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:21:43.686339 [debug] [Thread-4 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:21:43.788916 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:45.694040 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:21:46.334987 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:21:46.461139 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:21:46.466712 [debug] [Thread-4 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_vip__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */;
[0m14:21:46.731382 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252545A22D0>]}
[0m14:21:46.734973 [info ] [Thread-3 (]: 97 of 148 OK created sql table model dbt_dev_yourname_marts.fct_orders ......... [[32mCREATE TABLE (0.0 rows, 2.8 MiB processed)[0m in 10.50s]
[0m14:21:46.741301 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.fct_orders
[0m14:21:46.748528 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:21:46.748528 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:21:46.752296 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:21:46.755523 [info ] [Thread-1 (]: 99 of 148 START test accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [RUN]
[0m14:21:46.762681 [info ] [Thread-2 (]: 100 of 148 START test accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [RUN]
[0m14:21:46.768122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117, now test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670)
[0m14:21:46.765599 [info ] [Thread-3 (]: 101 of 148 START test accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:21:46.771648 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565, now test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c)
[0m14:21:46.773398 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:21:46.778146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.fct_orders, now test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969)
[0m14:21:46.779414 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:21:46.800649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m14:21:46.800649 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:21:46.817408 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m14:21:46.826755 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m14:21:46.836883 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:21:46.839099 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:21:46.849810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:46.859824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:46.859824 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:21:46.960292 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:47.144585 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f977f993-f454-4005-a5ea-105cce104f90&page=queryresults
[0m14:21:48.434271 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
[0m14:21:48.443021 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:49.050387 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
[0m14:21:49.065132 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_size_bucket as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_size_bucket

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Premium'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:49.202653 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dcb6b004-b01d-4483-8a4f-b2266b3d327b&page=queryresults
[0m14:21:49.564011 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
[0m14:21:49.581614 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        delivery_sla_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by delivery_sla_status

)

select *
from all_values
where value_field not in (
    'Met','Missed','Canceled','In Progress'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:49.726108 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7d080004-1a21-47bc-a982-f3db79f202f9&page=queryresults
[0m14:21:50.080895 [debug] [Thread-4 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:21:50.092954 [debug] [Thread-4 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''VIP''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */
[0m14:21:50.481899 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e16619d-fce6-4c75-9460-31ffd698fcef&page=queryresults
[0m14:21:50.899870 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8832d70f-0c2e-4a7b-ba56-47ec517673eb&page=queryresults
[0m14:21:51.752188 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m14:21:51.759877 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:52.044122 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m14:21:52.051204 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:52.459101 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m14:21:52.468392 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:21:52.486815 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0f654caa-7fed-4da2-a466-54be8ca7dcd1&page=queryresults
[0m14:21:52.837671 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0d51312f-460a-4e66-8f43-b248f4c47006&page=queryresults
[0m14:21:52.870695 [info ] [Thread-4 (]: 98 of 148 PASS dim_customers::test_customer_segment_vip ........................ [[32mPASS[0m in 9.20s]
[0m14:21:52.874999 [debug] [Thread-4 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:21:52.874999 [debug] [Thread-4 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:21:52.878435 [info ] [Thread-4 (]: 118 of 148 START unit_test dim_customers::test_customer_segment_no_orders ...... [RUN]
[0m14:21:52.880491 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders)
[0m14:21:52.882384 [debug] [Thread-4 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:21:52.884817 [debug] [Thread-4 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:21:52.929497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:21:53.146584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d44acc3a-d001-485e-ba29-c6d8b07524b2&page=queryresults
[0m14:21:53.968304 [info ] [Thread-3 (]: 101 of 148 PASS accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 7.19s]
[0m14:21:53.975459 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:21:53.981027 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:21:53.984452 [info ] [Thread-3 (]: 102 of 148 START test is_not_negative_fct_orders_freight_total ................. [RUN]
[0m14:21:53.988562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969, now test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20)
[0m14:21:53.996575 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:21:54.033797 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m14:21:54.048218 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:21:54.083762 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:21:54.211604 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:21:54.213825 [info ] [Thread-2 (]: 100 of 148 PASS accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [[32mPASS[0m in 7.44s]
[0m14:21:54.220713 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:21:54.222792 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:21:54.236813 [info ] [Thread-2 (]: 103 of 148 START test is_not_negative_fct_orders_subtotal ...................... [RUN]
[0m14:21:54.244118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c, now test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4)
[0m14:21:54.246368 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:21:54.258440 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m14:21:54.263247 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:21:54.283060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:21:54.727324 [info ] [Thread-1 (]: 99 of 148 PASS accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [[32mPASS[0m in 7.96s]
[0m14:21:54.730997 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:21:54.732478 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:21:54.733476 [info ] [Thread-1 (]: 104 of 148 START test not_null_fct_orders_customer_id .......................... [RUN]
[0m14:21:54.737252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670, now test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b)
[0m14:21:54.741251 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:21:54.764005 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:21:54.778199 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:21:54.784227 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:21:54.841812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:54.909118 [debug] [Thread-4 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:21:54.985325 [debug] [Thread-4 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_no_orders__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */;
[0m14:21:55.591304 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f886a74e-d726-4539-ae26-1803c2d4dd0e&page=queryresults
[0m14:21:56.409185 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
[0m14:21:56.416495 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    subtotal as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:56.932656 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
[0m14:21:56.932656 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    freight_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:57.049485 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cbcc7053-00d2-40ee-bc98-1672b8a5d4e7&page=queryresults
[0m14:21:57.111781 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
[0m14:21:57.118231 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:21:57.567647 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7092cd73-d46e-4529-b34d-02b4768bbd4b&page=queryresults
[0m14:21:57.741322 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2cd8d27c-0d19-4754-b8f3-a2612c05e30c&page=queryresults
[0m14:21:58.444179 [debug] [Thread-4 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:21:58.452753 [debug] [Thread-4 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''No Orders''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */
[0m14:21:59.212319 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f97857ff-b47d-4a3d-a05f-de9a17181ebb&page=queryresults
[0m14:21:59.707797 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m14:21:59.737376 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:00.219211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:22:00.243611 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:00.423424 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b2ad2a8a-708a-4a7f-b6b8-f8e76ac0eddd&page=queryresults
[0m14:22:00.807857 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m14:22:00.816554 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:01.096210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:091f9b67-3524-449a-8450-4d7d2defb776&page=queryresults
[0m14:22:01.511005 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:80f90804-44f6-45d0-8ad0-1537704dcbd1&page=queryresults
[0m14:22:01.527702 [info ] [Thread-4 (]: 118 of 148 PASS dim_customers::test_customer_segment_no_orders ................. [[32mPASS[0m in 8.65s]
[0m14:22:01.535830 [debug] [Thread-4 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:22:01.540053 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m14:22:01.544444 [info ] [Thread-4 (]: 119 of 148 START sql table model dbt_dev_yourname_marts.dim_customers .......... [RUN]
[0m14:22:01.549243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders, now model.dbt_advanced_olist.dim_customers)
[0m14:22:01.552329 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m14:22:01.578832 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m14:22:01.636179 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m14:22:01.643071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:02.046515 [info ] [Thread-2 (]: 103 of 148 PASS is_not_negative_fct_orders_subtotal ............................ [[32mPASS[0m in 7.80s]
[0m14:22:02.056540 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:22:02.057547 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:22:02.063765 [info ] [Thread-2 (]: 105 of 148 START test not_null_fct_orders_delivery_sla_status .................. [RUN]
[0m14:22:02.066992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4, now test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0)
[0m14:22:02.069640 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:22:02.076686 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m14:22:02.084661 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:22:02.094656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:02.691284 [info ] [Thread-1 (]: 104 of 148 PASS not_null_fct_orders_customer_id ................................ [[32mPASS[0m in 7.95s]
[0m14:22:02.695350 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:22:02.697575 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:22:02.698571 [info ] [Thread-1 (]: 106 of 148 START test not_null_fct_orders_freight_total ........................ [RUN]
[0m14:22:02.702396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3)
[0m14:22:02.706641 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:22:02.725986 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m14:22:02.725986 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:22:02.740204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:03.445477 [info ] [Thread-3 (]: 102 of 148 PASS is_not_negative_fct_orders_freight_total ....................... [[32mPASS[0m in 9.46s]
[0m14:22:03.453562 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:22:03.456481 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:22:03.464217 [info ] [Thread-3 (]: 107 of 148 START test not_null_fct_orders_item_count ........................... [RUN]
[0m14:22:03.468545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20, now test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91)
[0m14:22:03.476127 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:22:03.542365 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m14:22:03.545742 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:22:03.558420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:04.146623 [debug] [Thread-4 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m14:22:04.726975 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
[0m14:22:04.734340 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:05.301265 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
[0m14:22:05.308625 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where delivery_sla_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:05.656672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a8e184ca-ee91-4ed7-9e77-cd0973a1911f&page=queryresults
[0m14:22:05.841534 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6e6ec0f9-5a28-4061-bee5-0ac294b60c8f&page=queryresults
[0m14:22:07.239585 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ccbd0736-b474-4c1f-9437-c0b2eac9ccb6&page=queryresults
[0m14:22:07.589626 [warn ] [Thread-4 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m14:22:07.601546 [debug] [Thread-4 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m14:22:07.939746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m14:22:07.949268 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:08.040289 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m14:22:08.049311 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:08.316966 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
[0m14:22:08.324981 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6d34f50e-5b6a-429f-989b-e10037c1253a&page=queryresults
[0m14:22:08.332795 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:08.506719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4aaa0aa2-aa1c-45c1-ac65-83c7c41a2388&page=queryresults
[0m14:22:08.808321 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:332e086a-eeac-4414-8e17-42ee1641bdb8&page=queryresults
[0m14:22:08.826748 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m14:22:08.836274 [debug] [Thread-4 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m14:22:08.882064 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e3509918-5035-4f3d-ba47-6dbaa2228616&page=queryresults
[0m14:22:09.540752 [info ] [Thread-1 (]: 106 of 148 PASS not_null_fct_orders_freight_total .............................. [[32mPASS[0m in 6.84s]
[0m14:22:09.547491 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:22:09.550670 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:22:09.554374 [info ] [Thread-1 (]: 108 of 148 START test not_null_fct_orders_order_date ........................... [RUN]
[0m14:22:09.560055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3, now test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362)
[0m14:22:09.561052 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:22:09.609345 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m14:22:09.616012 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:22:09.638907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:09.945644 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1260fc90-a746-493c-9f00-dfb90b3c4140&page=queryresults
[0m14:22:09.948569 [info ] [Thread-2 (]: 105 of 148 PASS not_null_fct_orders_delivery_sla_status ........................ [[32mPASS[0m in 7.88s]
[0m14:22:09.957185 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:22:09.960920 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:22:09.964348 [info ] [Thread-2 (]: 109 of 148 START test not_null_fct_orders_order_id ............................. [RUN]
[0m14:22:09.967981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0, now test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0)
[0m14:22:09.973791 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:22:09.996350 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m14:22:09.996350 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:22:10.009988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:11.066945 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
[0m14:22:11.078436 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:11.439995 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
[0m14:22:11.447639 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:11.737762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f1f8333d-3c07-41bf-b50d-49cdfe552631&page=queryresults
[0m14:22:11.957900 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e5f01ef3-091d-4e64-89b4-7907b672d41d&page=queryresults
[0m14:22:12.881213 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0503ed-1436-41a1-a435-55e8074a9e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025254D6ADD0>]}
[0m14:22:12.881213 [info ] [Thread-4 (]: 119 of 148 OK created sql table model dbt_dev_yourname_marts.dim_customers ..... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 11.33s]
[0m14:22:12.894607 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m14:22:12.894607 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:22:12.904874 [info ] [Thread-4 (]: 110 of 148 START test not_null_fct_orders_order_status ......................... [RUN]
[0m14:22:12.908791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_customers, now test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b)
[0m14:22:12.914347 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:22:12.950016 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m14:22:12.962286 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:22:12.993838 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:13.096836 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m14:22:13.101823 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:13.877559 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0d23c6b0-baa8-44dc-a1ce-703e38b535f7&page=queryresults
[0m14:22:14.491280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m14:22:14.498646 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m14:22:14.509429 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:14.520469 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:15.147268 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
[0m14:22:15.151490 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:858bc3d9-2364-4dd5-b72f-ecf742d5eeac&page=queryresults
[0m14:22:15.164195 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:15.299955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:40b9ff60-e4e7-435b-a5a2-21dbfcef12aa&page=queryresults
[0m14:22:15.914337 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1cebdef1-86e6-43f8-a2b8-52b2897c089b&page=queryresults
[0m14:22:15.911038 [info ] [Thread-3 (]: 107 of 148 PASS not_null_fct_orders_item_count ................................. [[32mPASS[0m in 12.44s]
[0m14:22:15.943429 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:22:15.946422 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:22:15.946422 [info ] [Thread-3 (]: 111 of 148 START test not_null_fct_orders_order_total .......................... [RUN]
[0m14:22:15.958485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91, now test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6)
[0m14:22:15.960276 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:22:15.992392 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m14:22:16.000980 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:22:16.022273 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:16.692541 [info ] [Thread-2 (]: 109 of 148 PASS not_null_fct_orders_order_id ................................... [[32mPASS[0m in 6.72s]
[0m14:22:16.697756 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:22:16.701592 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:22:16.706648 [info ] [Thread-2 (]: 112 of 148 START test not_null_fct_orders_ordered_at ........................... [RUN]
[0m14:22:16.712278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9)
[0m14:22:16.716957 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:22:16.763289 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m14:22:16.775087 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:22:16.801957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:17.028573 [info ] [Thread-1 (]: 108 of 148 PASS not_null_fct_orders_order_date ................................. [[32mPASS[0m in 7.47s]
[0m14:22:17.033878 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:22:17.037642 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:22:17.042600 [info ] [Thread-1 (]: 113 of 148 START test not_null_fct_orders_primary_category ..................... [RUN]
[0m14:22:17.046365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362, now test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67)
[0m14:22:17.050813 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:22:17.094554 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m14:22:17.109126 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:22:17.121947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:17.789820 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m14:22:17.794433 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:18.164156 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
[0m14:22:18.171015 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:18.257587 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
[0m14:22:18.270711 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:18.336704 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:80779994-07f2-4d01-87a5-c94bdfa7200a&page=queryresults
[0m14:22:18.545719 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
[0m14:22:18.554834 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:18.664525 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ff59de4a-5743-4657-b4e7-0c37812b8c55&page=queryresults
[0m14:22:18.764518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:072d48f7-36a3-4895-b342-da9c8831f4af&page=queryresults
[0m14:22:19.067168 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c27dd14b-0c83-466e-b06f-95dcc6161677&page=queryresults
[0m14:22:19.366010 [info ] [Thread-4 (]: 110 of 148 PASS not_null_fct_orders_order_status ............................... [[32mPASS[0m in 6.46s]
[0m14:22:19.376961 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:22:19.381767 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:22:19.388359 [info ] [Thread-4 (]: 114 of 148 START test not_null_fct_orders_primary_category_group ............... [RUN]
[0m14:22:19.395519 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b, now test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed)
[0m14:22:19.399441 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:22:19.447214 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m14:22:19.458432 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:22:19.491995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:20.825172 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
[0m14:22:20.837116 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m14:22:20.847872 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m14:22:20.857965 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:20.870015 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:20.879103 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:21.202629 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m14:22:21.212009 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:21.410365 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8798f0e2-24c6-46fd-8231-2c5693e6fac9&page=queryresults
[0m14:22:21.475892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0bc213da-b066-4448-a008-f9d2dc5326ec&page=queryresults
[0m14:22:21.480348 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:94f2c80e-861f-4ec8-9c5c-29d958a3ba8a&page=queryresults
[0m14:22:21.774806 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1a83b577-0519-4d13-b284-4f6f4c6ec494&page=queryresults
[0m14:22:22.753943 [info ] [Thread-1 (]: 113 of 148 PASS not_null_fct_orders_primary_category ........................... [[32mPASS[0m in 5.71s]
[0m14:22:22.759000 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:22:22.765466 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:22:22.770767 [info ] [Thread-1 (]: 115 of 148 START test not_null_fct_orders_subtotal ............................. [RUN]
[0m14:22:22.775138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67, now test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0)
[0m14:22:22.780667 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:22:22.826860 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m14:22:22.841080 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:22:22.855996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:22.862575 [info ] [Thread-2 (]: 112 of 148 PASS not_null_fct_orders_ordered_at ................................. [[32mPASS[0m in 6.14s]
[0m14:22:22.924514 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:22:22.928322 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:22:22.931119 [info ] [Thread-2 (]: 116 of 148 START test not_null_fct_orders_unique_products ...................... [RUN]
[0m14:22:22.933253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9, now test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7)
[0m14:22:22.935446 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:22:22.938574 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m14:22:22.947199 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:22:22.958621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:23.361416 [info ] [Thread-3 (]: 111 of 148 PASS not_null_fct_orders_order_total ................................ [[32mPASS[0m in 7.40s]
[0m14:22:23.370713 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:22:23.375736 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:22:23.380010 [info ] [Thread-3 (]: 117 of 148 START test unique_fct_orders_order_id ............................... [RUN]
[0m14:22:23.385496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6, now test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5)
[0m14:22:23.391978 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:22:23.425598 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m14:22:23.431746 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:22:23.453418 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:23.968737 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m14:22:23.974576 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:24.823807 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:74058d47-c7f6-4da4-a7c2-38c8800b10c8&page=queryresults
[0m14:22:25.185190 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
[0m14:22:25.190417 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:25.605488 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
[0m14:22:25.610936 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:25.809937 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
[0m14:22:25.812149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9e2a16a7-057c-4de8-954e-6ee089621502&page=queryresults
[0m14:22:25.815191 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where unique_products is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:26.020589 [info ] [Thread-4 (]: 114 of 148 PASS not_null_fct_orders_primary_category_group ..................... [[32mPASS[0m in 6.62s]
[0m14:22:26.026747 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:22:26.027744 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:22:26.032259 [info ] [Thread-4 (]: 120 of 148 START test accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m14:22:26.040779 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213)
[0m14:22:26.044065 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:22:26.062039 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m14:22:26.064034 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:22:26.073042 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:26.143321 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:22cd49d9-44e5-4978-854d-60f6b11f5fd8&page=queryresults
[0m14:22:26.298500 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ef7afc7c-9577-4a10-ab3c-2a5818ac225b&page=queryresults
[0m14:22:27.758942 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
[0m14:22:27.773087 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:27.778811 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m14:22:27.799319 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:28.102471 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m14:22:28.115057 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:28.292146 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db791f1e-e9f6-4ced-a2ac-5a2a8e59d109&page=queryresults
[0m14:22:28.423667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5b2be281-a293-4035-93ff-d716a39e4964&page=queryresults
[0m14:22:28.458941 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m14:22:28.466657 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:28.805931 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8abb7b26-f8df-4b11-accf-2979a83a0bc0&page=queryresults
[0m14:22:29.047817 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e6530523-5fb6-413b-ac1d-e8b992fa5a0f&page=queryresults
[0m14:22:29.574292 [info ] [Thread-1 (]: 115 of 148 PASS not_null_fct_orders_subtotal ................................... [[32mPASS[0m in 6.80s]
[0m14:22:29.582423 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:22:29.585987 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:22:29.591250 [info ] [Thread-1 (]: 121 of 148 START test accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [RUN]
[0m14:22:29.595501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0)
[0m14:22:29.599707 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:22:29.661359 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m14:22:29.673431 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:22:29.677962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:29.948524 [info ] [Thread-3 (]: 117 of 148 PASS unique_fct_orders_order_id ..................................... [[32mPASS[0m in 6.56s]
[0m14:22:29.969547 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:22:29.977247 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:22:29.980046 [info ] [Thread-3 (]: 122 of 148 START test accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [RUN]
[0m14:22:29.985867 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09)
[0m14:22:29.988551 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:22:30.043684 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m14:22:30.057150 [info ] [Thread-2 (]: 116 of 148 PASS not_null_fct_orders_unique_products ............................ [[32mPASS[0m in 7.12s]
[0m14:22:30.062886 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:22:30.068721 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:22:30.072949 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:22:30.106270 [info ] [Thread-2 (]: 123 of 148 START test assert_vip_customer_criteria ............................. [RUN]
[0m14:22:30.113466 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:30.117353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7, now test.dbt_advanced_olist.assert_vip_customer_criteria)
[0m14:22:30.192196 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:22:30.204454 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m14:22:30.208095 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:22:30.209092 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:30.330268 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m14:22:30.336406 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:31.140079 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
[0m14:22:31.146825 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fe7eef2d-a886-4ce0-b995-6f66349e0711&page=queryresults
[0m14:22:31.154588 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'VIP','High Value','Medium Value','Low Value','No Orders'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:31.650385 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
[0m14:22:31.655884 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        purchase_frequency as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by purchase_frequency

)

select *
from all_values
where value_field not in (
    'Frequent','Repeat','One-Time','Never Purchased'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:31.682809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:86fa21c4-fedf-417b-94a1-238e8faf8fb4&page=queryresults
[0m14:22:32.059200 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
[0m14:22:32.079522 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_vip_customer_criteria
  
  Purpose: VIP customers must meet the defined criteria
  
  Business Rule: VIP = lifetime_revenue >= 500 AND lifetime_orders >= 3
  
  Test PASSES if query returns 0 rows
*/

with vip_customers as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where customer_segment = 'VIP'
),

invalid_vips as (
    select
        customer_id,
        lifetime_revenue,
        lifetime_orders,
        'VIP but does not meet criteria' as violation
    from vip_customers
    where lifetime_revenue < 500
       or lifetime_orders < 3
),

should_be_vips as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders,
        'Should be VIP but is not' as violation
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where lifetime_revenue >= 500
      and lifetime_orders >= 3
      and customer_segment != 'VIP'
)

select * from invalid_vips
union all
select customer_id, lifetime_revenue, lifetime_orders, violation from should_be_vips
  
  
    )
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:32.223067 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d3636c3a-1a79-4809-96b2-53e100456362&page=queryresults
[0m14:22:32.473305 [info ] [Thread-4 (]: 120 of 148 PASS accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 6.43s]
[0m14:22:32.476955 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:22:32.483462 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:22:32.489607 [info ] [Thread-4 (]: 124 of 148 START test dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [RUN]
[0m14:22:32.492508 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d)
[0m14:22:32.504832 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:22:32.558729 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m14:22:32.559728 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:22:32.593678 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:32.684460 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:478a3ab8-d4cb-4805-b133-47b06caad175&page=queryresults
[0m14:22:33.861367 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
[0m14:22:33.868913 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:34.342033 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:71baccf6-6c26-4a68-9ea8-954ec436d6f1&page=queryresults
[0m14:22:34.533924 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m14:22:34.533924 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m14:22:34.547798 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:34.554550 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:35.129410 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:53b441a7-1d1f-4939-8165-139852b67136&page=queryresults
[0m14:22:35.268299 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a08371ec-47bf-40ac-a3d8-099c2749fbbf&page=queryresults
[0m14:22:36.101330 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m14:22:36.110789 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:36.172009 [info ] [Thread-3 (]: 122 of 148 PASS accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [[32mPASS[0m in 6.19s]
[0m14:22:36.178312 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:22:36.178312 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:22:36.185728 [info ] [Thread-3 (]: 125 of 148 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [RUN]
[0m14:22:36.189995 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9)
[0m14:22:36.205452 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:22:36.202354 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m14:22:36.239946 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m14:22:36.254410 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:36.264690 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:22:36.273534 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:36.404714 [info ] [Thread-2 (]: 123 of 148 PASS assert_vip_customer_criteria ................................... [[32mPASS[0m in 6.29s]
[0m14:22:36.410109 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:22:36.413033 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:22:36.416757 [info ] [Thread-2 (]: 126 of 148 START test is_not_negative_dim_customers_avg_order_value ............ [RUN]
[0m14:22:36.421440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_vip_customer_criteria, now test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178)
[0m14:22:36.421440 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:22:36.452040 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m14:22:36.461291 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:22:36.483830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:36.664179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c035f00-6ce9-4a87-b098-21b0f8551311&page=queryresults
[0m14:22:36.873142 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ab8094d6-3549-4695-bebd-ccf75d23f7a6&page=queryresults
[0m14:22:37.925411 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
[0m14:22:37.936716 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and late_delivery_rate >= 0 and late_delivery_rate <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:38.159288 [info ] [Thread-1 (]: 121 of 148 PASS accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [[32mPASS[0m in 8.56s]
[0m14:22:38.166543 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:22:38.169758 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
[0m14:22:38.174602 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:22:38.183620 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    avg_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:38.188610 [info ] [Thread-1 (]: 127 of 148 START test is_not_negative_dim_customers_customer_lifespan_days ..... [RUN]
[0m14:22:38.198887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0, now test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e)
[0m14:22:38.205998 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:22:38.236632 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m14:22:38.246385 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:22:38.565641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:38.569299 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ba703859-c4ba-427b-aa86-8b5474767c20&page=queryresults
[0m14:22:38.568291 [info ] [Thread-4 (]: 124 of 148 PASS dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [[32mPASS[0m in 6.07s]
[0m14:22:38.618009 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:22:38.619673 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:22:38.621154 [info ] [Thread-4 (]: 128 of 148 START test is_not_negative_dim_customers_late_deliveries ............ [RUN]
[0m14:22:38.622175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d, now test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a)
[0m14:22:38.624172 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:22:38.634093 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m14:22:38.636090 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:22:38.639120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:39.245898 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c851bb44-76c9-4a7b-9f4d-f04d26e380ea&page=queryresults
[0m14:22:39.834786 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
[0m14:22:39.844012 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
[0m14:22:39.850231 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    customer_lifespan_days as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_lifespan_days < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:39.857794 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    late_deliveries as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where late_deliveries < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:40.358795 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1644c6dd-72cc-4692-8694-c38731eb81e2&page=queryresults
[0m14:22:40.368124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e54d0877-3ade-4193-afe8-232c4503afbf&page=queryresults
[0m14:22:40.591573 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m14:22:40.600398 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:41.199321 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:39e0bcfe-0ae6-4b61-853d-eda81bac7a44&page=queryresults
[0m14:22:41.296473 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m14:22:41.305399 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:41.965029 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a59ef2e7-2c83-4743-84d2-cc7d4ad874ef&page=queryresults
[0m14:22:42.160343 [info ] [Thread-3 (]: 125 of 148 PASS dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [[32mPASS[0m in 5.97s]
[0m14:22:42.170963 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:22:42.174719 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:22:42.178227 [info ] [Thread-3 (]: 129 of 148 START test is_not_negative_dim_customers_lifetime_items ............. [RUN]
[0m14:22:42.192582 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159)
[0m14:22:42.196210 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:22:42.267214 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m14:22:42.274361 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:22:42.296185 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:42.567723 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m14:22:42.577802 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:43.025004 [info ] [Thread-2 (]: 126 of 148 PASS is_not_negative_dim_customers_avg_order_value .................. [[32mPASS[0m in 6.60s]
[0m14:22:43.038056 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:22:43.043667 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:22:43.048431 [info ] [Thread-2 (]: 130 of 148 START test is_not_negative_dim_customers_lifetime_orders ............ [RUN]
[0m14:22:43.059774 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8)
[0m14:22:43.069561 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:22:43.118180 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m14:22:43.129041 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:22:43.172028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:43.249293 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:58ea0cf7-fb0b-4b4f-873c-b849ff869046&page=queryresults
[0m14:22:43.592716 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
[0m14:22:43.600182 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_items as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:44.070444 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3cd1a973-f8c0-4ac5-a12c-7f72517dd3c0&page=queryresults
[0m14:22:44.188740 [info ] [Thread-4 (]: 128 of 148 PASS is_not_negative_dim_customers_late_deliveries .................. [[32mPASS[0m in 5.57s]
[0m14:22:44.197312 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:22:44.202866 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:22:44.206332 [info ] [Thread-4 (]: 131 of 148 START test is_not_negative_dim_customers_lifetime_revenue ........... [RUN]
[0m14:22:44.211125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e)
[0m14:22:44.219941 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:22:44.254407 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m14:22:44.260213 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:22:44.277229 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:44.352213 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
[0m14:22:44.358913 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_orders as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:44.499007 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m14:22:44.506668 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:44.961926 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a0e31eed-06b2-47e7-a840-241e4dacaae3&page=queryresults
[0m14:22:45.018053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:27099403-248e-49c2-8899-0b2b1fe21f76&page=queryresults
[0m14:22:45.431534 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
[0m14:22:45.441532 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_revenue as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:45.927548 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:262a917d-20d4-467a-92f0-5d56cc5b2327&page=queryresults
[0m14:22:46.008605 [info ] [Thread-1 (]: 127 of 148 PASS is_not_negative_dim_customers_customer_lifespan_days ........... [[32mPASS[0m in 7.81s]
[0m14:22:46.016256 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:22:46.022469 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:22:46.026976 [info ] [Thread-1 (]: 132 of 148 START test is_not_negative_dim_customers_max_order_value ............ [RUN]
[0m14:22:46.034582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e, now test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c)
[0m14:22:46.040235 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:22:46.078702 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m14:22:46.099369 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:22:46.118264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:46.299239 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m14:22:46.306123 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:46.857660 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m14:22:46.869130 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:46.878274 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e65797f-04a6-4c17-84b2-8dd2c96324ca&page=queryresults
[0m14:22:47.418636 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
[0m14:22:47.433773 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    max_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:47.439556 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:626e10f0-6bd0-4373-8d62-b563c6d86590&page=queryresults
[0m14:22:47.951262 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:04bdebf8-817d-48ec-a211-1cfaaa3d936e&page=queryresults
[0m14:22:48.187636 [info ] [Thread-3 (]: 129 of 148 PASS is_not_negative_dim_customers_lifetime_items ................... [[32mPASS[0m in 5.99s]
[0m14:22:48.191615 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:22:48.198002 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:22:48.202435 [info ] [Thread-3 (]: 133 of 148 START test not_null_dim_customers_avg_order_value ................... [RUN]
[0m14:22:48.207409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159, now test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843)
[0m14:22:48.211332 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:22:48.256092 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m14:22:48.276406 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m14:22:48.287192 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:22:48.289803 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:48.309354 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:48.485758 [info ] [Thread-2 (]: 130 of 148 PASS is_not_negative_dim_customers_lifetime_orders .................. [[32mPASS[0m in 5.43s]
[0m14:22:48.490877 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:22:48.493286 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:22:48.496492 [info ] [Thread-2 (]: 134 of 148 START test not_null_dim_customers_customer_city ..................... [RUN]
[0m14:22:48.501887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8, now test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d)
[0m14:22:48.505338 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:22:48.538825 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m14:22:48.550858 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:22:48.566087 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:48.932723 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2c7a92c6-1cac-415e-b8c2-f7bf80a82a02&page=queryresults
[0m14:22:49.439435 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
[0m14:22:49.442538 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:49.656981 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
[0m14:22:49.664008 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:49.891543 [info ] [Thread-4 (]: 131 of 148 PASS is_not_negative_dim_customers_lifetime_revenue ................. [[32mPASS[0m in 5.68s]
[0m14:22:49.900650 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:22:49.900650 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:22:49.906838 [info ] [Thread-4 (]: 135 of 148 START test not_null_dim_customers_customer_id ....................... [RUN]
[0m14:22:49.917182 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6d978a1d-33d7-45d2-bf05-bb9c20914a08&page=queryresults
[0m14:22:49.923038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e, now test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m14:22:49.940423 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:22:49.984428 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:22:49.989419 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:22:50.006836 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:50.182056 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:66bcfc5c-86c5-413c-aec3-abed76f70b17&page=queryresults
[0m14:22:51.355965 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
[0m14:22:51.355965 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:51.915568 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m14:22:51.924822 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:51.933140 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:125ab601-a065-4201-a1d0-59e3f2fd1044&page=queryresults
[0m14:22:52.013661 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m14:22:52.023751 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:52.632136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c70462ee-beac-4dec-97e5-5d7947658c78&page=queryresults
[0m14:22:52.863621 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:558ca312-b757-4703-9c19-ddecfdd40f86&page=queryresults
[0m14:22:53.635322 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m14:22:53.665659 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:53.676529 [info ] [Thread-1 (]: 132 of 148 PASS is_not_negative_dim_customers_max_order_value .................. [[32mPASS[0m in 7.64s]
[0m14:22:53.688632 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:22:53.691701 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:22:53.697568 [info ] [Thread-1 (]: 136 of 148 START test not_null_dim_customers_customer_key ...................... [RUN]
[0m14:22:53.702860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c, now test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411)
[0m14:22:53.707572 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:22:53.749708 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m14:22:53.758731 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:22:53.780390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:54.077075 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:22:54.086424 [info ] [Thread-3 (]: 133 of 148 PASS not_null_dim_customers_avg_order_value ......................... [[32mPASS[0m in 5.88s]
[0m14:22:54.093753 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:22:54.098353 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:54.103755 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:22:54.114998 [info ] [Thread-3 (]: 137 of 148 START test not_null_dim_customers_customer_region ................... [RUN]
[0m14:22:54.120597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843, now test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2)
[0m14:22:54.120597 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:22:54.153039 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m14:22:54.163323 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:22:54.181742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:22:54.250959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8342de80-6859-4633-b8ee-6ea3f942188f&page=queryresults
[0m14:22:54.791905 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e21f0dc3-3115-4d8e-9388-d05dd91b683d&page=queryresults
[0m14:22:55.229317 [info ] [Thread-2 (]: 134 of 148 PASS not_null_dim_customers_customer_city ........................... [[32mPASS[0m in 6.73s]
[0m14:22:55.236247 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:22:55.239469 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:22:55.243204 [info ] [Thread-2 (]: 138 of 148 START test not_null_dim_customers_customer_segment .................. [RUN]
[0m14:22:55.250447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d, now test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m14:22:55.250447 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:22:55.286455 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m14:22:55.298293 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:22:55.329231 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
[0m14:22:55.339565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:22:55.345459 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:55.579084 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
[0m14:22:55.590012 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:55.815710 [info ] [Thread-4 (]: 135 of 148 PASS not_null_dim_customers_customer_id ............................. [[32mPASS[0m in 5.89s]
[0m14:22:55.824910 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:22:55.834403 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:22:55.851337 [info ] [Thread-4 (]: 139 of 148 START test not_null_dim_customers_customer_state .................... [RUN]
[0m14:22:55.859301 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa)
[0m14:22:55.868599 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:22:55.917707 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m14:22:55.917707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2db48745-9940-4f6d-8984-b8772a744b35&page=queryresults
[0m14:22:55.933096 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:22:55.937115 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:22:56.082467 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ff36e647-d4a5-4681-9030-a6a8860f799c&page=queryresults
[0m14:22:56.446531 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
[0m14:22:56.455564 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_segment is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:56.931621 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:adc8ee16-1a4d-4361-ac58-4626fa0e5c99&page=queryresults
[0m14:22:57.014442 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
[0m14:22:57.023339 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:22:57.660211 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:274263a2-a97e-4cbf-ba32-31fc800e9938&page=queryresults
[0m14:22:57.996546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m14:22:58.004029 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:58.086802 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m14:22:58.096622 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:58.688148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f6378254-5f1a-43e3-9c12-b47e6976029c&page=queryresults
[0m14:22:58.697747 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:11186548-af2b-4269-b5c5-95a4365aade3&page=queryresults
[0m14:22:59.102170 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m14:22:59.116477 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:59.887560 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m14:22:59.895792 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fc0daf7d-3c1a-4be7-8983-550fe89d4713&page=queryresults
[0m14:22:59.887560 [info ] [Thread-1 (]: 136 of 148 PASS not_null_dim_customers_customer_key ............................ [[32mPASS[0m in 6.19s]
[0m14:22:59.921753 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:22:59.929377 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:22:59.904027 [info ] [Thread-3 (]: 137 of 148 PASS not_null_dim_customers_customer_region ......................... [[32mPASS[0m in 5.78s]
[0m14:22:59.942662 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:22:59.953295 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:22:59.963712 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:22:59.956568 [info ] [Thread-1 (]: 140 of 148 START test not_null_dim_customers_customer_unique_id ................ [RUN]
[0m14:22:59.969662 [info ] [Thread-3 (]: 141 of 148 START test not_null_dim_customers_lifetime_items .................... [RUN]
[0m14:22:59.974482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m14:22:59.978247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a)
[0m14:22:59.988301 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:22:59.993067 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:23:00.030945 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m14:23:00.047442 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m14:23:00.068019 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:23:00.080018 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:23:00.096324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:00.114932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:23:00.444978 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:534ac85d-4b33-4180-a83f-f3a3ade1f4c4&page=queryresults
[0m14:23:00.887892 [info ] [Thread-2 (]: 138 of 148 PASS not_null_dim_customers_customer_segment ........................ [[32mPASS[0m in 5.64s]
[0m14:23:00.895218 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:23:00.900959 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:23:00.905559 [info ] [Thread-2 (]: 142 of 148 START test not_null_dim_customers_lifetime_orders ................... [RUN]
[0m14:23:00.914264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m14:23:00.922669 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:23:00.965640 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m14:23:00.966645 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:23:01.001376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:23:01.347977 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
[0m14:23:01.352458 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
[0m14:23:01.355726 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:01.365479 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:01.617370 [info ] [Thread-4 (]: 139 of 148 PASS not_null_dim_customers_customer_state .......................... [[32mPASS[0m in 5.76s]
[0m14:23:01.623604 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:23:01.625519 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:23:01.631450 [info ] [Thread-4 (]: 143 of 148 START test not_null_dim_customers_lifetime_revenue .................. [RUN]
[0m14:23:01.635874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105)
[0m14:23:01.641005 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:23:01.671570 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m14:23:01.688170 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:23:01.712488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:23:01.854019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fe2922d9-2838-4ed9-873f-47e3335c395e&page=queryresults
[0m14:23:01.898232 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b61247aa-2131-447a-a28d-daa359a462a9&page=queryresults
[0m14:23:02.112386 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
[0m14:23:02.123042 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:02.677959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:14f8290a-2e31-47ea-abcd-f83d65b81dc6&page=queryresults
[0m14:23:03.030225 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
[0m14:23:03.045279 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:03.611587 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:93213b56-1ac6-4b95-b658-9ba1badbc85e&page=queryresults
[0m14:23:04.012746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m14:23:04.020682 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m14:23:04.030350 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:04.041162 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:04.622952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7fa4884f-e817-4fd2-a27b-85e9bebc2f04&page=queryresults
[0m14:23:04.628859 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ac11f3ce-ab44-438d-ade5-4598db64038f&page=queryresults
[0m14:23:04.830510 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m14:23:04.845773 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:05.449315 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7594b7b0-5510-4fac-813d-38d0695a20dc&page=queryresults
[0m14:23:05.479687 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m14:23:05.486325 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:05.678688 [info ] [Thread-3 (]: 141 of 148 PASS not_null_dim_customers_lifetime_items .......................... [[32mPASS[0m in 5.70s]
[0m14:23:05.688678 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:23:05.699859 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:23:05.703412 [info ] [Thread-1 (]: 140 of 148 PASS not_null_dim_customers_customer_unique_id ...................... [[32mPASS[0m in 5.73s]
[0m14:23:05.720003 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:23:05.708149 [info ] [Thread-3 (]: 144 of 148 START test not_null_dim_customers_max_order_value ................... [RUN]
[0m14:23:05.724329 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:23:05.731257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a, now test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8)
[0m14:23:05.738361 [info ] [Thread-1 (]: 145 of 148 START test not_null_dim_customers_purchase_frequency ................ [RUN]
[0m14:23:05.748368 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:23:05.751712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093)
[0m14:23:05.800854 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m14:23:05.808545 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:23:05.844889 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m14:23:05.844889 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:23:05.872398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:23:05.879390 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:23:05.944914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:06.190258 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:beca0c88-9478-4f0f-b6db-e8c6d6e5558e&page=queryresults
[0m14:23:06.546839 [info ] [Thread-2 (]: 142 of 148 PASS not_null_dim_customers_lifetime_orders ......................... [[32mPASS[0m in 5.63s]
[0m14:23:06.555669 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:23:06.562602 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:23:06.563600 [info ] [Thread-2 (]: 146 of 148 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m14:23:06.627591 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m14:23:06.632293 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:23:06.677949 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:23:06.682975 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:23:06.703585 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:23:07.077050 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
[0m14:23:07.084586 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:07.193413 [info ] [Thread-4 (]: 143 of 148 PASS not_null_dim_customers_lifetime_revenue ........................ [[32mPASS[0m in 5.55s]
[0m14:23:07.200634 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:23:07.200634 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:23:07.207060 [info ] [Thread-4 (]: 147 of 148 START test unique_dim_customers_customer_id ......................... [RUN]
[0m14:23:07.214457 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105, now test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:23:07.214457 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:23:07.265029 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:23:07.273945 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:23:07.294810 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:23:08.299213 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3a5f4f04-9af2-4970-8a2f-37c560780791&page=queryresults
[0m14:23:08.302391 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
[0m14:23:08.321573 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where purchase_frequency is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:08.798683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5134270c-2057-43b0-98d6-bd741e7e69a7&page=queryresults
[0m14:23:08.960053 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
[0m14:23:08.969818 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:09.145250 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
[0m14:23:09.151514 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:09.538509 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m14:23:09.542265 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9e3755fe-331f-486c-ab82-b027a45a19af&page=queryresults
[0m14:23:09.551937 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:09.651148 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3b956d51-f18e-424d-8b88-524d2cd53e74&page=queryresults
[0m14:23:10.102222 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0a115921-95ac-4103-990b-d1b918c02e0e&page=queryresults
[0m14:23:10.910452 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m14:23:10.920190 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:11.248804 [info ] [Thread-3 (]: 144 of 148 PASS not_null_dim_customers_max_order_value ......................... [[32mPASS[0m in 5.52s]
[0m14:23:11.254075 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:23:11.254075 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:23:11.259025 [info ] [Thread-3 (]: 148 of 148 START test unique_dim_customers_customer_key ........................ [RUN]
[0m14:23:11.263108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8, now test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e)
[0m14:23:11.267773 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:23:11.302326 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m14:23:11.307427 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:23:11.328536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:23:11.442845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fbc898d1-26f1-476c-8c18-4d5b34c58097&page=queryresults
[0m14:23:11.481656 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:23:11.486185 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:11.809742 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:23:11.815105 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:12.052871 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2f490b6c-b40b-411d-8b16-1fa106885c27&page=queryresults
[0m14:23:12.404173 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
[0m14:23:12.417816 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:23:12.423597 [info ] [Thread-1 (]: 145 of 148 PASS not_null_dim_customers_purchase_frequency ...................... [[32mPASS[0m in 6.67s]
[0m14:23:12.440319 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:23:12.479106 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:44c6d36e-e49d-4cee-a47c-72557b306222&page=queryresults
[0m14:23:12.927600 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8e6f9db9-404c-4f11-9f9c-3f549855047a&page=queryresults
[0m14:23:13.449153 [info ] [Thread-2 (]: 146 of 148 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 6.82s]
[0m14:23:13.456013 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:23:13.839065 [info ] [Thread-4 (]: 147 of 148 PASS unique_dim_customers_customer_id ............................... [[32mPASS[0m in 6.63s]
[0m14:23:13.844931 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:23:15.167104 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m14:23:15.173341 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:23:15.884032 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f0ff904f-fbf5-4c38-9e7d-37fb46c3610d&page=queryresults
[0m14:23:17.322398 [info ] [Thread-3 (]: 148 of 148 PASS unique_dim_customers_customer_key .............................. [[32mPASS[0m in 6.06s]
[0m14:23:17.331818 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:23:17.351967 [info ] [MainThread]: 
[0m14:23:17.444724 [info ] [MainThread]: ============================================================
[0m14:23:17.447407 [info ] [MainThread]: DBT RUN COMPLETED
[0m14:23:17.449871 [info ] [MainThread]: Success: 12
[0m14:23:17.452904 [info ] [MainThread]: Errors: 1
[0m14:23:17.461394 [info ] [MainThread]: Skipped: 0
[0m14:23:17.464417 [info ] [MainThread]: Total: 148
[0m14:23:17.466395 [info ] [MainThread]: ============================================================
[0m14:23:17.468730 [info ] [MainThread]: FAILED MODELS:
[0m14:23:17.472196 [info ] [MainThread]:   - customers_snapshot: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m14:23:17.482141 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m14:23:17.485650 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m14:23:17.488377 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.13s]
[0m14:23:17.496775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:17.504701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:17.506429 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:23:17.512245 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:23:17.515467 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:23:17.516507 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:23:17.519148 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m14:23:17.520254 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m14:23:17.521672 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m14:23:17.526154 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m14:23:17.530539 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093' was properly closed.
[0m14:23:17.531577 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m14:23:17.533677 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e' was properly closed.
[0m14:23:17.534716 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m14:23:17.553465 [info ] [MainThread]: 
[0m14:23:17.555708 [info ] [MainThread]: Finished running 2 project hooks, 2 seeds, 1 snapshot, 3 table models, 132 data tests, 3 unit tests, 7 view models in 0 hours 5 minutes and 30.92 seconds (330.92s).
[0m14:23:17.652898 [debug] [MainThread]: Command end result
[0m14:23:17.830575 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:23:17.847694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:23:17.894642 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m14:23:17.896665 [info ] [MainThread]: 
[0m14:23:17.898354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 5 warnings:[0m
[0m14:23:17.899351 [info ] [MainThread]: 
[0m14:23:17.901591 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m14:23:17.903305 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m14:23:17.906226 [info ] [MainThread]: 
[0m14:23:17.913027 [warn ] [MainThread]: [33mWarning in test assert_orders_have_items (tests\singular\assert_orders_have_items.sql)[0m
[0m14:23:17.914325 [warn ] [MainThread]: Got 890 results, configured to warn if != 0
[0m14:23:17.915672 [info ] [MainThread]: 
[0m14:23:17.917863 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\tests\singular\assert_orders_have_items.sql
[0m14:23:17.918821 [info ] [MainThread]: 
[0m14:23:17.920506 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
  --------------------------------------------------------------------------------------------------
[0m14:23:17.922779 [info ] [MainThread]: 
[0m14:23:17.931213 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null (models\staging\_staging.yml)[0m
[0m14:23:17.933630 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m14:23:17.934627 [info ] [MainThread]: 
[0m14:23:17.937082 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43.sql
[0m14:23:17.938080 [info ] [MainThread]: 
[0m14:23:17.939077 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
  -----------------------------------------------------------------------------------------------------------------------------------------
[0m14:23:17.946122 [info ] [MainThread]: 
[0m14:23:17.948797 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models\staging\_staging.yml)[0m
[0m14:23:17.949796 [warn ] [MainThread]: Got 862 results, configured to warn if != 0
[0m14:23:17.951449 [info ] [MainThread]: 
[0m14:23:17.953443 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0.sql
[0m14:23:17.955438 [info ] [MainThread]: 
[0m14:23:17.958740 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m14:23:17.963971 [info ] [MainThread]: 
[0m14:23:17.965182 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\staging\_staging.yml)[0m
[0m14:23:17.970523 [warn ] [MainThread]: Got 902 results, configured to warn if != 0
[0m14:23:17.975341 [info ] [MainThread]: 
[0m14:23:17.978657 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m14:23:17.980033 [info ] [MainThread]: 
[0m14:23:17.982498 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
  -----------------------------------------------------------------------------------------------------------------------------------
[0m14:23:17.986543 [info ] [MainThread]: 
[0m14:23:17.988539 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models\staging\_staging.yml)[0m
[0m14:23:17.993328 [warn ] [MainThread]: Got 642 results, configured to warn if != 0
[0m14:23:17.995130 [info ] [MainThread]: 
[0m14:23:17.996480 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f.sql
[0m14:23:17.998175 [info ] [MainThread]: 
[0m14:23:18.003439 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m14:23:18.006287 [info ] [MainThread]: 
[0m14:23:18.010454 [info ] [MainThread]: Done. PASS=144 WARN=5 ERROR=1 SKIP=0 NO-OP=0 TOTAL=150
[0m14:23:18.014965 [debug] [MainThread]: Command `dbt build` failed at 14:23:18.014965 after 365.54 seconds
[0m14:23:18.016287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025236934310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025236934690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025236934390>]}
[0m14:23:18.017304 [debug] [MainThread]: Flushing usage events
[0m14:23:20.492565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:53.359275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F33F4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F33F5E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F33F6F90>]}


============================== 14:50:53.509412 | 58cf61e0-a82a-41d6-8f26-55af918753dd ==============================
[0m14:50:53.509412 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:50:53.515295 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --exclude resource_type:snapshot', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m14:52:53.556916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA08D072D0>]}
[0m14:52:53.759864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9EEAE4290>]}
[0m14:52:53.762422 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m14:52:55.969612 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:52:59.786199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:59.786199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:00.035007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA09530250>]}
[0m14:53:00.521804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:53:00.576533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:53:01.253167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F19A13D0>]}
[0m14:53:01.256699 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m14:53:01.297379 [info ] [MainThread]: 
[0m14:53:01.301542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:01.303534 [info ] [MainThread]: 
[0m14:53:01.305503 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:53:01.339934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:53:01.341933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:53:01.342888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:01.343916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:53:01.345710 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m14:53:01.345710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:01.349435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:01.352329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:03.908403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:05.795847 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m14:53:05.800750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:05.802421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m14:53:05.804833 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m14:53:05.807926 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m14:53:05.884791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:05.887288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:05.890240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:07.957717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_intermediate)
[0m14:53:07.964703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:08.090251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_staging, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m14:53:08.093562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:09.645917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F14080D0>]}
[0m14:53:09.713743 [info ] [MainThread]: ============================================================
[0m14:53:09.717482 [info ] [MainThread]: DBT RUN STARTED
[0m14:53:09.719359 [info ] [MainThread]: Target: dev
[0m14:53:09.722206 [info ] [MainThread]: Project: dbt_advanced_olist
[0m14:53:09.725491 [info ] [MainThread]: Time: 2025-12-24 14:53:09
[0m14:53:09.728210 [info ] [MainThread]: ============================================================
[0m14:53:09.732590 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m14:53:09.754055 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m14:53:09.759215 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.11s]
[0m14:53:09.761760 [info ] [MainThread]: 
[0m14:53:09.770243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:09.845549 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m14:53:09.849900 [debug] [Thread-2 (]: Began running node seed.dbt_advanced_olist.brazilian_states
[0m14:53:09.851859 [debug] [Thread-3 (]: Began running node seed.dbt_advanced_olist.order_status_codes
[0m14:53:09.852900 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:53:09.854620 [info ] [Thread-1 (]: 1 of 147 START sql table model dbt_dev_yourname_marts.dim_date ................. [RUN]
[0m14:53:09.857821 [info ] [Thread-2 (]: 2 of 147 START seed file dbt_dev_yourname_seeds.brazilian_states ............... [RUN]
[0m14:53:09.859891 [info ] [Thread-3 (]: 3 of 147 START seed file dbt_dev_yourname_seeds.order_status_codes ............. [RUN]
[0m14:53:09.866682 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m14:53:09.862486 [info ] [Thread-4 (]: 4 of 147 START test dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [RUN]
[0m14:53:09.870612 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.brazilian_states'
[0m14:53:09.873572 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.order_status_codes'
[0m14:53:09.875617 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m14:53:09.876618 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0'
[0m14:53:09.885273 [debug] [Thread-2 (]: Began compiling node seed.dbt_advanced_olist.brazilian_states
[0m14:53:09.887593 [debug] [Thread-3 (]: Began compiling node seed.dbt_advanced_olist.order_status_codes
[0m14:53:09.942044 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:53:09.968592 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m14:53:09.974693 [debug] [Thread-2 (]: Began executing node seed.dbt_advanced_olist.brazilian_states
[0m14:53:09.976688 [debug] [Thread-3 (]: Began executing node seed.dbt_advanced_olist.order_status_codes
[0m14:53:10.033830 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m14:53:10.033830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:53:10.157114 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:53:10.232422 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:53:10.601025 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:10.603437 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:11.762187 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
[0m14:53:11.771951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:68fd31cf-67eb-4cfc-8acb-8ee1a19f6a92&page=queryresults
[0m14:53:11.916618 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`raw_olist`.`customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:12.538990 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:edef5c46-ab16-453c-8f8e-4ef1e5c80b56&page=queryresults
[0m14:53:13.092096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m14:53:13.122579 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m14:53:13.617314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m14:53:13.635350 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(date_key, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m14:53:14.432725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2ad00107-7c2f-4efe-a614-323431905eec&page=queryresults
[0m14:53:14.891526 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m14:53:15.103812 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:15.916335 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d703474b-7837-4533-adf4-35cca173d259&page=queryresults
[0m14:53:17.445964 [debug] [Thread-3 (]: On seed.dbt_advanced_olist.order_status_codes: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes` set OPTIONS()
/* dbt 1.10.15 | model: order_status_codes | schema: dbt_dev_yourname_seeds */
[0m14:53:17.928282 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:760b52b2-9c1a-487f-bc02-250117133171&page=queryresults
[0m14:53:18.213054 [info ] [Thread-4 (]: 4 of 147 PASS dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [[32mPASS[0m in 8.33s]
[0m14:53:18.222292 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m14:53:18.226002 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:53:18.230854 [info ] [Thread-4 (]: 5 of 147 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [RUN]
[0m14:53:18.237816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb)
[0m14:53:18.241643 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:53:18.332190 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m14:53:18.335263 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:53:18.348350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:18.416412 [debug] [Thread-2 (]: On seed.dbt_advanced_olist.brazilian_states: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states` set OPTIONS()
/* dbt 1.10.15 | model: brazilian_states | schema: dbt_dev_yourname_seeds */
[0m14:53:18.733583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0A09E3D0>]}
[0m14:53:18.741068 [info ] [Thread-1 (]: 1 of 147 OK created sql table model dbt_dev_yourname_marts.dim_date ............ [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 8.87s]
[0m14:53:18.745828 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m14:53:18.749136 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:53:18.751615 [info ] [Thread-1 (]: 6 of 147 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [RUN]
[0m14:53:18.755727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_date, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d)
[0m14:53:18.758785 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:53:18.803740 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m14:53:18.822685 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:53:18.844981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:18.934420 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1a642b8d-4974-49cf-88f9-aa42333667a0&page=queryresults
[0m14:53:19.766071 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
[0m14:53:19.769979 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.brazilian_states"
[0m14:53:19.769979 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.order_status_codes"
[0m14:53:19.778044 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and freight_value >= 0 and freight_value <= 1000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:19.797685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0A4EF050>]}
[0m14:53:19.810439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0A4E0550>]}
[0m14:53:19.808143 [info ] [Thread-2 (]: 2 of 147 OK loaded seed file dbt_dev_yourname_seeds.brazilian_states ........... [[32mINSERT 27[0m in 9.93s]
[0m14:53:19.814819 [info ] [Thread-3 (]: 3 of 147 OK loaded seed file dbt_dev_yourname_seeds.order_status_codes ......... [[32mINSERT 8[0m in 9.94s]
[0m14:53:19.819651 [debug] [Thread-2 (]: Finished running node seed.dbt_advanced_olist.brazilian_states
[0m14:53:19.830494 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:53:19.825180 [debug] [Thread-3 (]: Finished running node seed.dbt_advanced_olist.order_status_codes
[0m14:53:19.850520 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:53:19.836364 [info ] [Thread-2 (]: 7 of 147 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [RUN]
[0m14:53:19.854128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.brazilian_states, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529)
[0m14:53:19.854128 [info ] [Thread-3 (]: 8 of 147 START test dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [RUN]
[0m14:53:19.857420 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:53:19.860220 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.order_status_codes, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936)
[0m14:53:19.874961 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:53:19.884280 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m14:53:19.907004 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:19.914591 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:53:19.966967 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:20.281368 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
[0m14:53:20.285933 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price >= 0 and price <= 10000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:20.455659 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:99746818-0da0-4b4a-9650-e6093f9114c4&page=queryresults
[0m14:53:20.867131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d32444ad-530e-4091-870f-31630e0fb296&page=queryresults
[0m14:53:21.733735 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
[0m14:53:21.750781 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and product_weight_g >= 0 and product_weight_g <= 100000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`products`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:22.378603 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m14:53:22.406638 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m14:53:22.409636 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:38721fe7-4e8b-4fa2-84df-d0d3f38b045e&page=queryresults
[0m14:53:22.420322 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:22.428211 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:53:22.797080 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
[0m14:53:22.801946 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
      
    
    

    
    OPTIONS()
    as (
      
    
  with relation_columns as (

        
        select
            cast('ORDER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CUSTOMER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_STATUS' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_PURCHASE_TIMESTAMP' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_APPROVED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CARRIER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CUSTOMER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_ESTIMATED_DELIVERY_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PURCHASE_TIMESTAMP'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:22.983591 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:856f7a51-a30f-4f71-8da9-7481f604f636&page=queryresults
[0m14:53:23.114638 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m14:53:23.123088 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:23.352642 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:66450922-460f-40d0-a426-629a7b1514d3&page=queryresults
[0m14:53:23.742062 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:af6e9bab-8476-4b9c-9444-087b974d09b6&page=queryresults
[0m14:53:24.065959 [info ] [Thread-4 (]: 5 of 147 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [[32mPASS[0m in 5.83s]
[0m14:53:24.072550 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m14:53:24.077995 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:53:24.084050 [info ] [Thread-4 (]: 9 of 147 START test source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:53:24.091468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb, now test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c)
[0m14:53:24.104831 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:53:24.215683 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m14:53:24.299740 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m14:53:24.307164 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:24.321436 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:53:24.347774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:25.153637 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1abf4c27-2138-47a7-8b2d-608c0005c367&page=queryresults
[0m14:53:25.168043 [info ] [Thread-1 (]: 6 of 147 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [[32mPASS[0m in 6.41s]
[0m14:53:25.174274 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m14:53:25.175656 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:53:25.177653 [info ] [Thread-1 (]: 10 of 147 START test source_not_null_raw_olist_customers_customer_city ......... [RUN]
[0m14:53:25.179969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a)
[0m14:53:25.181537 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:53:25.195776 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m14:53:25.523194 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:53:25.547677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:25.650551 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m14:53:25.658670 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:26.166334 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
[0m14:53:26.174041 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`raw_olist`.`orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:26.189040 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b3596ea1-7571-4d84-a985-3cb277bd15ff&page=queryresults
[0m14:53:26.625648 [info ] [Thread-2 (]: 7 of 147 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [[32mPASS[0m in 6.77s]
[0m14:53:26.632347 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m14:53:26.633552 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:53:26.635197 [info ] [Thread-2 (]: 11 of 147 START test source_not_null_raw_olist_customers_customer_id ........... [RUN]
[0m14:53:26.636770 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c)
[0m14:53:26.638788 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:53:26.651138 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m14:53:26.651138 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:53:26.666650 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:26.756724 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:21df5a3c-2877-4cd0-a9e1-bf9432fb06df&page=queryresults
[0m14:53:27.300414 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
[0m14:53:27.320661 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:27.679019 [info ] [Thread-3 (]: 8 of 147 PASS dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [[32mPASS[0m in 7.82s]
[0m14:53:27.683313 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m14:53:27.686137 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:53:27.687630 [info ] [Thread-3 (]: 12 of 147 START test source_not_null_raw_olist_customers_customer_state ........ [RUN]
[0m14:53:27.690483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de)
[0m14:53:27.690483 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:53:27.701529 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m14:53:27.881448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9b3a50c8-7e66-4541-acd1-82c82914ad85&page=queryresults
[0m14:53:27.979461 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:53:27.997851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:28.265162 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
[0m14:53:28.271038 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:28.861220 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c5e61abb-afae-44e9-9ef5-0c316376eb7d&page=queryresults
[0m14:53:28.928149 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m14:53:28.996934 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:29.280978 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
[0m14:53:29.289141 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:29.574422 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a1ce857e-30b5-4faf-b1b0-79012ea18b86&page=queryresults
[0m14:53:29.930223 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5f560555-342f-4100-8c3a-2f02b8f89c93&page=queryresults
[0m14:53:30.330244 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m14:53:30.432150 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:30.688351 [info ] [Thread-4 (]: 9 of 147 PASS source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 6.60s]
[0m14:53:30.694026 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m14:53:30.698049 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:53:30.700972 [info ] [Thread-4 (]: 13 of 147 START test source_not_null_raw_olist_customers_customer_unique_id .... [RUN]
[0m14:53:30.704166 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30)
[0m14:53:30.706592 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:53:30.721388 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m14:53:30.726546 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:53:30.734284 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:30.786548 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m14:53:30.871101 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:31.133114 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dbaa1f32-be1f-4113-9e7c-39452c271d72&page=queryresults
[0m14:53:31.469178 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:224de03a-f67a-455b-940b-daf3ecdd58e3&page=queryresults
[0m14:53:31.851995 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m14:53:31.857991 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:31.920669 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
[0m14:53:31.932703 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:32.204644 [info ] [Thread-1 (]: 10 of 147 PASS source_not_null_raw_olist_customers_customer_city ............... [[32mPASS[0m in 7.02s]
[0m14:53:32.211584 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m14:53:32.213671 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:53:32.216366 [info ] [Thread-1 (]: 14 of 147 START test source_not_null_raw_olist_order_items_freight_value ....... [RUN]
[0m14:53:32.218731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5)
[0m14:53:32.220725 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:53:32.238188 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m14:53:32.264663 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:53:32.288717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:32.454302 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:83f14bea-c45f-4e77-8241-1baa8dc0c69e&page=queryresults
[0m14:53:32.585443 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c1c8cdf7-60d8-434f-b9f6-943038435950&page=queryresults
[0m14:53:33.187725 [info ] [Thread-2 (]: 11 of 147 PASS source_not_null_raw_olist_customers_customer_id ................. [[32mPASS[0m in 6.55s]
[0m14:53:33.197576 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m14:53:33.202528 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:53:33.202528 [info ] [Thread-2 (]: 15 of 147 START test source_not_null_raw_olist_order_items_order_id ............ [RUN]
[0m14:53:33.216725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37)
[0m14:53:33.219187 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:53:33.254689 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m14:53:33.285674 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:53:33.305880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:33.592194 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
[0m14:53:33.598896 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where freight_value is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:33.734100 [info ] [Thread-3 (]: 12 of 147 PASS source_not_null_raw_olist_customers_customer_state .............. [[32mPASS[0m in 6.04s]
[0m14:53:33.740696 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m14:53:33.749544 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:53:33.753778 [info ] [Thread-3 (]: 16 of 147 START test source_not_null_raw_olist_order_items_order_item_id ....... [RUN]
[0m14:53:33.757535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c)
[0m14:53:33.765095 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:53:33.802011 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m14:53:33.817766 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:53:33.846422 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:34.310663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:05056070-c0e6-4106-92f9-52d2f58575ba&page=queryresults
[0m14:53:34.929615 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
[0m14:53:34.935026 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:35.430379 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
[0m14:53:35.439536 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_item_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:35.483927 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:84bd5194-2ed2-43dd-9efb-32f6498f9947&page=queryresults
[0m14:53:36.107892 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2d16719f-882c-42a4-bd0a-ee9eb667f85e&page=queryresults
[0m14:53:36.112980 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m14:53:36.128259 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m14:53:36.137086 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:36.142796 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:36.975491 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ec3d2753-7530-44d1-b931-ddc5da657e48&page=queryresults
[0m14:53:36.981199 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fc333a51-3b8b-445a-8755-d98f2d799ff7&page=queryresults
[0m14:53:37.820862 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m14:53:37.838817 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:38.316715 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m14:53:38.325760 [info ] [Thread-1 (]: 14 of 147 PASS source_not_null_raw_olist_order_items_freight_value ............. [[32mPASS[0m in 6.11s]
[0m14:53:38.334210 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m14:53:38.334210 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:53:38.343090 [info ] [Thread-1 (]: 17 of 147 START test source_not_null_raw_olist_order_items_price ............... [RUN]
[0m14:53:38.349619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9)
[0m14:53:38.356513 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:38.365524 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:53:38.423821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m14:53:38.433040 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:53:38.445601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:38.546075 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:61b7be6b-840a-49e2-b24b-d4c174537c91&page=queryresults
[0m14:53:38.543662 [info ] [Thread-4 (]: 13 of 147 PASS source_not_null_raw_olist_customers_customer_unique_id .......... [[32mPASS[0m in 7.84s]
[0m14:53:38.551756 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m14:53:38.553921 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:53:38.556453 [info ] [Thread-4 (]: 18 of 147 START test source_not_null_raw_olist_order_items_product_id .......... [RUN]
[0m14:53:38.562527 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29)
[0m14:53:38.563802 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:53:38.584256 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m14:53:38.592822 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:53:38.611411 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:39.545219 [info ] [Thread-2 (]: 15 of 147 PASS source_not_null_raw_olist_order_items_order_id .................. [[32mPASS[0m in 6.33s]
[0m14:53:39.554256 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m14:53:39.559144 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:53:39.564768 [info ] [Thread-2 (]: 19 of 147 START test source_not_null_raw_olist_orders_customer_id .............. [RUN]
[0m14:53:39.568361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02)
[0m14:53:39.579610 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:53:39.614485 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m14:53:39.623897 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:53:39.644204 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:39.805206 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
[0m14:53:39.810761 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
[0m14:53:39.816695 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:39.820340 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8dddea0b-1fb7-418e-b4ee-788d49db0732&page=queryresults
[0m14:53:39.827310 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where price is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:40.332384 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2b9e1037-bbd6-4a35-8c8b-472dc3933fda&page=queryresults
[0m14:53:40.396646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ca568f30-1098-454e-84e4-7d85db12b6e1&page=queryresults
[0m14:53:40.948404 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
[0m14:53:40.964394 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:40.954979 [info ] [Thread-3 (]: 16 of 147 PASS source_not_null_raw_olist_order_items_order_item_id ............. [[32mPASS[0m in 7.20s]
[0m14:53:40.981147 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m14:53:40.984664 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:53:40.997025 [info ] [Thread-3 (]: 20 of 147 START test source_not_null_raw_olist_orders_order_id ................. [RUN]
[0m14:53:41.001935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b)
[0m14:53:41.005210 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:53:41.054809 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m14:53:41.067449 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:53:41.095082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:41.479211 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b78ff74a-5d43-4fdd-8566-20fb28d506ed&page=queryresults
[0m14:53:42.497857 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
[0m14:53:42.502784 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:42.680408 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m14:53:42.687895 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:43.114553 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m14:53:43.116834 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:89df7c9e-14a1-4b5b-8d36-a9b96625ac6a&page=queryresults
[0m14:53:43.121508 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:43.605853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:64bfcc4a-cf30-4038-9664-4e7a91faadac&page=queryresults
[0m14:53:43.622104 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m14:53:43.626977 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:44.037247 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5f5df6d5-3858-4c08-9b60-d6b25966631c&page=queryresults
[0m14:53:44.365324 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6150377b-c2e0-4c71-baf3-cf237d347aa4&page=queryresults
[0m14:53:45.296484 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m14:53:45.288561 [info ] [Thread-1 (]: 17 of 147 PASS source_not_null_raw_olist_order_items_price ..................... [[32mPASS[0m in 6.94s]
[0m14:53:45.296484 [info ] [Thread-4 (]: 18 of 147 PASS source_not_null_raw_olist_order_items_product_id ................ [[32mPASS[0m in 6.73s]
[0m14:53:45.305826 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m14:53:45.312049 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:45.318622 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m14:53:45.321844 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:53:45.333366 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:53:45.337467 [info ] [Thread-1 (]: 21 of 147 START test source_not_null_raw_olist_orders_order_purchase_timestamp . [RUN]
[0m14:53:45.340356 [info ] [Thread-4 (]: 22 of 147 START test source_not_null_raw_olist_orders_order_status ............. [RUN]
[0m14:53:45.347818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5)
[0m14:53:45.351122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a)
[0m14:53:45.354917 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:53:45.360556 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:53:45.386627 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m14:53:45.406964 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m14:53:45.410803 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:53:45.413255 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:53:45.424905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:45.428105 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:45.532794 [info ] [Thread-2 (]: 19 of 147 PASS source_not_null_raw_olist_orders_customer_id .................... [[32mPASS[0m in 5.96s]
[0m14:53:45.536001 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m14:53:45.537235 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:53:45.538233 [info ] [Thread-2 (]: 23 of 147 START test source_not_null_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m14:53:45.540228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1)
[0m14:53:45.542996 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:53:45.547196 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m14:53:45.552845 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:53:45.558637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:46.649848 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:50ae81ce-0fd4-4b80-b7c7-3cc850b9653b&page=queryresults
[0m14:53:47.112919 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
[0m14:53:47.116049 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
[0m14:53:47.126540 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_purchase_timestamp is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:47.129039 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
[0m14:53:47.140905 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:47.150441 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_0 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:47.805921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9e0d7d77-0515-4431-8980-f67ebd7b650a&page=queryresults
[0m14:53:47.811798 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd1e08f8-a129-49d2-903c-b9bb84c0472d&page=queryresults
[0m14:53:47.835532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:46967529-1068-44f9-bf98-cd1169db0d25&page=queryresults
[0m14:53:48.361285 [info ] [Thread-3 (]: 20 of 147 PASS source_not_null_raw_olist_orders_order_id ....................... [[32mPASS[0m in 7.36s]
[0m14:53:48.362286 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m14:53:48.367089 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:53:48.368089 [info ] [Thread-3 (]: 24 of 147 START test source_not_null_raw_olist_product_category_name_translation_string_field_1  [RUN]
[0m14:53:48.372439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841)
[0m14:53:48.375802 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:53:48.389149 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m14:53:48.393274 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:53:48.403462 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:49.876476 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
[0m14:53:49.879345 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m14:53:49.879345 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_1 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:49.903697 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:50.226307 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m14:53:50.229375 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:50.453651 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d0b2c500-c325-45a4-975f-c62bd41e666f&page=queryresults
[0m14:53:50.524652 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8dbfa4d5-05ee-4242-b17a-c6f04129b3cc&page=queryresults
[0m14:53:50.819868 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d4cbdf3e-0e43-4e9c-85ea-fb9f5000c84f&page=queryresults
[0m14:53:51.568307 [info ] [Thread-2 (]: 23 of 147 PASS source_not_null_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 6.03s]
[0m14:53:51.580594 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m14:53:51.580594 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:53:51.586860 [info ] [Thread-2 (]: 25 of 147 START test source_not_null_raw_olist_products_product_id ............. [RUN]
[0m14:53:51.594574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1, now test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf)
[0m14:53:51.597392 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:53:51.624681 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m14:53:51.631035 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:53:51.659668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:52.334172 [info ] [Thread-4 (]: 22 of 147 PASS source_not_null_raw_olist_orders_order_status ................... [[32mPASS[0m in 6.99s]
[0m14:53:52.345800 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m14:53:52.353753 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:53:52.357782 [info ] [Thread-4 (]: 26 of 147 START test source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [RUN]
[0m14:53:52.360683 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5)
[0m14:53:52.362801 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:53:52.410641 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m14:53:52.420124 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:53:52.441472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:52.710130 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m14:53:52.725610 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:53.252042 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
[0m14:53:53.258710 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:53.264354 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:68540076-86bb-4dd2-aac8-075fe167a634&page=queryresults
[0m14:53:53.644741 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
[0m14:53:53.652817 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:53.833882 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c792a23-6835-48a5-85c0-84e9a9e38fa2&page=queryresults
[0m14:53:54.221478 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:45112ac1-4f6d-4262-a20a-b66e4706553b&page=queryresults
[0m14:53:54.314387 [info ] [Thread-3 (]: 24 of 147 PASS source_not_null_raw_olist_product_category_name_translation_string_field_1  [[32mPASS[0m in 5.95s]
[0m14:53:54.326672 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m14:53:54.331797 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:53:54.337406 [info ] [Thread-3 (]: 27 of 147 START test source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [RUN]
[0m14:53:54.343601 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8)
[0m14:53:54.343601 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:53:54.363607 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m14:53:54.367600 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:53:54.378929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:54.737077 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m14:53:54.743326 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:55.369355 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4f0f6e7e-15c0-4533-9e35-c15ed0402b07&page=queryresults
[0m14:53:56.195801 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m14:53:56.229882 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:56.921066 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
[0m14:53:56.941310 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m14:53:56.943346 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:56.943346 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f7ded833-1178-408a-8c3a-3a2edcf70a8f&page=queryresults
[0m14:53:56.931463 [info ] [Thread-1 (]: 21 of 147 PASS source_not_null_raw_olist_orders_order_purchase_timestamp ....... [[32mPASS[0m in 11.58s]
[0m14:53:56.963825 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:53:56.977208 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m14:53:56.988964 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:53:56.992957 [info ] [Thread-1 (]: 28 of 147 START test source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [RUN]
[0m14:53:56.997618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5, now test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543)
[0m14:53:56.998618 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:53:57.040230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m14:53:57.041233 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:53:57.061663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:57.722729 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3297c391-66b6-4660-a99c-cf3fd94c05ff&page=queryresults
[0m14:53:57.743707 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:03541dfb-3c74-4958-8b43-08adaae7c5d1&page=queryresults
[0m14:53:58.074001 [info ] [Thread-2 (]: 25 of 147 PASS source_not_null_raw_olist_products_product_id ................... [[32mPASS[0m in 6.48s]
[0m14:53:58.085260 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m14:53:58.094879 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:53:58.094879 [info ] [Thread-2 (]: 29 of 147 START test source_unique_raw_olist_customers_customer_id ............. [RUN]
[0m14:53:58.105807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf, now test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816)
[0m14:53:58.109436 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:53:58.158390 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m14:53:58.158390 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:53:58.174809 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:58.525241 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
[0m14:53:58.541071 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:58.778917 [info ] [Thread-4 (]: 26 of 147 PASS source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [[32mPASS[0m in 6.42s]
[0m14:53:58.784114 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m14:53:58.788957 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:53:58.794585 [info ] [Thread-4 (]: 30 of 147 START test source_unique_raw_olist_orders_order_id ................... [RUN]
[0m14:53:58.799733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5, now test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0)
[0m14:53:58.799733 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:53:58.825795 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m14:53:58.834468 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:53:58.858197 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:59.159848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:72024db8-64ce-4576-a3b5-9d68b5352e5d&page=queryresults
[0m14:53:59.621940 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
[0m14:53:59.628869 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:53:59.943146 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m14:53:59.954843 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:00.324705 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
[0m14:54:00.329165 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:00.540685 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c55beb7a-71f8-453e-b398-935ed5827fd5&page=queryresults
[0m14:54:00.784876 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f66824d1-35f6-4bdb-93ac-72729ed64a5e&page=queryresults
[0m14:54:00.876736 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7418229f-ce98-4b6e-8926-01267187159f&page=queryresults
[0m14:54:01.442159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m14:54:01.451599 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:01.529577 [info ] [Thread-3 (]: 27 of 147 PASS source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [[32mPASS[0m in 7.19s]
[0m14:54:01.539159 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m14:54:01.542795 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:54:01.548347 [info ] [Thread-3 (]: 31 of 147 START test source_unique_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m14:54:01.553675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8, now test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df)
[0m14:54:01.563671 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:54:01.600012 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m14:54:01.608133 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:54:01.626087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:02.263291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:af87c0af-2cbb-4b78-9e9d-9200c993a277&page=queryresults
[0m14:54:03.044033 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m14:54:03.050846 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:03.415399 [info ] [Thread-1 (]: 28 of 147 PASS source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [[32mPASS[0m in 6.42s]
[0m14:54:03.425116 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m14:54:03.427139 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:54:03.433078 [info ] [Thread-1 (]: 32 of 147 START test source_unique_raw_olist_products_product_id ............... [RUN]
[0m14:54:03.438569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543, now test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1)
[0m14:54:03.443324 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:54:03.472938 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m14:54:03.479726 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:54:03.503108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:03.745545 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:491ba538-c726-44cc-b522-5950abeef81b&page=queryresults
[0m14:54:03.920612 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
[0m14:54:03.925361 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select string_field_0 as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
  where string_field_0 is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:04.517985 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f0770c0e-da61-43f7-9ada-ca98453dae7b&page=queryresults
[0m14:54:04.943936 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
[0m14:54:04.959276 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:04.955291 [info ] [Thread-2 (]: 29 of 147 PASS source_unique_raw_olist_customers_customer_id ................... [[32mPASS[0m in 6.85s]
[0m14:54:04.967305 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m14:54:04.974147 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:54:04.977190 [info ] [Thread-2 (]: 33 of 147 START test accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [RUN]
[0m14:54:04.980874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816, now test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22)
[0m14:54:04.981870 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:54:05.027732 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m14:54:05.314649 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:54:05.326364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:05.564209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7607dc19-06c8-458a-abed-3faf8509361c&page=queryresults
[0m14:54:06.590863 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
[0m14:54:06.605339 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
    group by region

)

select *
from all_values
where value_field not in (
    'North','Northeast','Central-West','Southeast','South'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:06.611124 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m14:54:06.646446 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:07.177800 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ae6c85c1-069b-44bf-8997-df9cc87caf0e&page=queryresults
[0m14:54:07.230840 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:30a4e172-fd7f-4fcb-838a-99b38bfc7471&page=queryresults
[0m14:54:07.908449 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m14:54:07.926100 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:08.308393 [info ] [Thread-3 (]: 31 of 147 PASS source_unique_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 6.76s]
[0m14:54:08.312153 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m14:54:08.314233 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:54:08.317548 [info ] [Thread-3 (]: 34 of 147 START test not_null_brazilian_states_state_code ...................... [RUN]
[0m14:54:08.323858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df, now test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec)
[0m14:54:08.326054 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:54:08.344779 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m14:54:08.350167 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:54:08.369852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:08.577851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a0c048f4-c350-478b-b632-846f41defba6&page=queryresults
[0m14:54:09.591639 [info ] [Thread-1 (]: 32 of 147 PASS source_unique_raw_olist_products_product_id ..................... [[32mPASS[0m in 6.15s]
[0m14:54:09.599989 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m14:54:09.607049 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:54:09.615205 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
[0m14:54:09.628662 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
where state_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:09.619096 [info ] [Thread-1 (]: 35 of 147 START test unique_brazilian_states_state_code ........................ [RUN]
[0m14:54:09.652493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1, now test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855)
[0m14:54:09.660937 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:54:09.675867 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m14:54:09.684431 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:54:09.691947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:09.843694 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m14:54:09.852937 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:10.356939 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ea7fc8c-3b91-463d-891a-2c9ad7bda4f1&page=queryresults
[0m14:54:10.601591 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d654dfac-1d00-40da-addb-cbd1bc7613dc&page=queryresults
[0m14:54:10.966118 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
[0m14:54:10.975683 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select state_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
  where state_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:11.580094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f6861b23-ac71-4aab-9627-7940bd42fde9&page=queryresults
[0m14:54:11.706943 [info ] [Thread-4 (]: 30 of 147 PASS source_unique_raw_olist_orders_order_id ......................... [[32mPASS[0m in 12.91s]
[0m14:54:11.711848 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m14:54:11.716636 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:54:11.718279 [info ] [Thread-4 (]: 36 of 147 START test not_null_order_status_codes_status_code ................... [RUN]
[0m14:54:11.730411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0, now test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968)
[0m14:54:11.733964 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:54:11.793473 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m14:54:11.802025 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:54:11.828871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:12.504436 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m14:54:12.683577 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:13.049842 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
[0m14:54:13.059912 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
where status_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:13.249921 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:85a34ea8-8675-431e-bef6-a59ac76a59d9&page=queryresults
[0m14:54:13.631221 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3cd9231b-89f1-4302-9e0d-5c2836f97833&page=queryresults
[0m14:54:13.738710 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m14:54:13.777679 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:14.358363 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:513f044a-82a1-4264-b11a-ec4a3ad2e0c3&page=queryresults
[0m14:54:14.352968 [info ] [Thread-3 (]: 34 of 147 PASS not_null_brazilian_states_state_code ............................ [[32mPASS[0m in 6.03s]
[0m14:54:14.374553 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m14:54:14.378903 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:54:14.382029 [info ] [Thread-3 (]: 37 of 147 START test unique_order_status_codes_status_code ..................... [RUN]
[0m14:54:14.388030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec, now test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b)
[0m14:54:14.394767 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:54:14.445296 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m14:54:14.480594 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:54:14.491199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:15.525915 [info ] [Thread-1 (]: 35 of 147 PASS unique_brazilian_states_state_code .............................. [[32mPASS[0m in 5.87s]
[0m14:54:15.533147 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m14:54:15.540645 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_order_items
[0m14:54:15.545644 [info ] [Thread-1 (]: 38 of 147 START sql view model dbt_dev_yourname_staging.stg_order_items ........ [RUN]
[0m14:54:15.549587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855, now model.dbt_advanced_olist.stg_order_items)
[0m14:54:15.557818 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_order_items
[0m14:54:15.671368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_order_items"
[0m14:54:15.682324 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_order_items
[0m14:54:15.743052 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_order_items"
[0m14:54:15.753454 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_order_items: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_order_items
  
  Purpose: Clean order line item data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Rename columns
  - Calculate item total (price + freight)
  - Generate surrogate key for unique identification
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`order_items`
),

renamed as (
    select
        -- Surrogate Key (composite primary key)
        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,
        
        -- Foreign Keys
        order_id,
        product_id,
        seller_id,
        
        -- Item Position
        order_item_id as item_sequence,
        
        -- Pricing
        cast(price as numeric) as item_price,
        cast(freight_value as numeric) as item_freight,
        
        -- Derived: Total for this item
        cast(price as numeric) + cast(freight_value as numeric) as item_total,
        
        -- Shipping date
        cast(shipping_limit_date as timestamp) as shipping_limit_at

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_order_items | schema: dbt_dev_yourname_staging */;
[0m14:54:15.756381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:15.852003 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m14:54:15.856601 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:15.869113 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
[0m14:54:15.872463 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select status_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
  where status_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:16.359132 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9438e444-1e33-4591-894a-7f993a5566e7&page=queryresults
[0m14:54:16.462934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0ebc75ac-c41c-4215-a7c9-1c67206ead3c&page=queryresults
[0m14:54:17.009129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:30d89166-dbe5-420c-88f2-42a25e3dfc3f&page=queryresults
[0m14:54:17.592204 [info ] [Thread-4 (]: 36 of 147 PASS not_null_order_status_codes_status_code ......................... [[32mPASS[0m in 5.86s]
[0m14:54:17.596740 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m14:54:17.599120 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_customers
[0m14:54:17.604292 [info ] [Thread-4 (]: 39 of 147 START sql view model dbt_dev_yourname_staging.stg_customers .......... [RUN]
[0m14:54:17.608365 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968, now model.dbt_advanced_olist.stg_customers)
[0m14:54:17.611103 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_customers
[0m14:54:17.637938 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_customers"
[0m14:54:17.677523 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_customers
[0m14:54:17.693174 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_customers"
[0m14:54:17.698973 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_customers: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_customers
  
  Purpose: Clean and standardize customer data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Standardize location data
  - Clean state codes
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`customers`
),

renamed as (
    select
        -- Primary Key
        customer_id,
        
        -- Alternative Key (same customer across orders)
        customer_unique_id,
        
        -- Location
        lower(trim(customer_city)) as customer_city,
        upper(trim(customer_state)) as customer_state,
        cast(customer_zip_code_prefix as string) as customer_zip_code,
        
        -- Derived: Region classification
        case upper(trim(customer_state))
            when 'SP' then 'Southeast'
            when 'RJ' then 'Southeast'
            when 'MG' then 'Southeast'
            when 'ES' then 'Southeast'
            when 'PR' then 'South'
            when 'SC' then 'South'
            when 'RS' then 'South'
            when 'BA' then 'Northeast'
            when 'PE' then 'Northeast'
            when 'CE' then 'Northeast'
            when 'MA' then 'Northeast'
            when 'PB' then 'Northeast'
            when 'RN' then 'Northeast'
            when 'PI' then 'Northeast'
            when 'AL' then 'Northeast'
            when 'SE' then 'Northeast'
            when 'GO' then 'Central-West'
            when 'DF' then 'Central-West'
            when 'MT' then 'Central-West'
            when 'MS' then 'Central-West'
            else 'North'
        end as customer_region

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_customers | schema: dbt_dev_yourname_staging */;
[0m14:54:17.705472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:17.817151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0A9BE3D0>]}
[0m14:54:17.825874 [info ] [Thread-1 (]: 38 of 147 OK created sql view model dbt_dev_yourname_staging.stg_order_items ... [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m14:54:17.835616 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_order_items
[0m14:54:17.841010 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_product_categories
[0m14:54:17.846503 [info ] [Thread-1 (]: 40 of 147 START sql view model dbt_dev_yourname_staging.stg_product_categories . [RUN]
[0m14:54:17.850506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_order_items, now model.dbt_advanced_olist.stg_product_categories)
[0m14:54:17.854724 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_product_categories
[0m14:54:17.890742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_product_categories"
[0m14:54:17.895543 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_product_categories
[0m14:54:17.907401 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_product_categories"
[0m14:54:17.924752 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_product_categories: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  OPTIONS()
  as 
/*
  STAGING MODEL: stg_product_categories
  Purpose: Product category translation (Portuguese → English)
  Source: Olist Brazilian E-commerce
*/
with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
),
renamed as (
    select
        -- Portuguese name (join key)
        string_field_0 as category_name_pt,
        -- English translation
        string_field_1 as category_name_en,
        -- Derived: Category group
        case
            when string_field_1 in ('computers', 'computers_accessories', 'electronics', 'tablets_printing_image', 'telephony', 'fixed_telephony')
                then 'Electronics'
            when string_field_1 in ('furniture_decor', 'furniture_living_room', 'furniture_bedroom', 'furniture_mattress_and_upholstery', 'office_furniture', 'home_comfort', 'home_comfort_2', 'home_confort')
                then 'Furniture'
            when string_field_1 in ('health_beauty', 'perfumery', 'diapers_and_hygiene')
                then 'Health & Beauty'
            when string_field_1 in ('sports_leisure', 'toys', 'baby', 'fashion_bags_accessories', 'fashion_shoes', 'fashion_sport', 'fashion_underwear_beach', 'fashio_female_clothing', 'fashion_male_clothing', 'fashion_childrens_clothes')
                then 'Fashion & Lifestyle'
            when string_field_1 in ('housewares', 'kitchen_dining_laundry_garden_furniture', 'garden_tools', 'flowers', 'la_cuisine')
                then 'Home & Garden'
            else 'Other'
        end as category_group
    from source
)
select * from renamed
/* dbt 1.10.15 | model: stg_product_categories | schema: dbt_dev_yourname_staging */;
[0m14:54:17.928911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:18.178200 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m14:54:18.188493 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:19.043920 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7c6d6319-6bf1-4d2c-bcb9-6e955a4da544&page=queryresults
[0m14:54:19.054836 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b2ac25e3-5250-4250-b0b0-d52de94c4a30&page=queryresults
[0m14:54:19.261278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:27e902ec-6ffd-4a07-8624-7043a17e74c7&page=queryresults
[0m14:54:19.689242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0B07F710>]}
[0m14:54:19.695659 [info ] [Thread-4 (]: 39 of 147 OK created sql view model dbt_dev_yourname_staging.stg_customers ..... [[32mCREATE VIEW (0 processed)[0m in 2.08s]
[0m14:54:19.703404 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_customers
[0m14:54:19.707386 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_products
[0m14:54:19.711529 [info ] [Thread-4 (]: 41 of 147 START sql view model dbt_dev_yourname_staging.stg_products ........... [RUN]
[0m14:54:19.719644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_customers, now model.dbt_advanced_olist.stg_products)
[0m14:54:19.740104 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_products
[0m14:54:19.771724 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_products"
[0m14:54:19.790613 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_products
[0m14:54:19.807832 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_products"
[0m14:54:19.817776 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_products: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_products
  
  Purpose: Clean product catalog data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Calculate product volume
  - Classify product size
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`products`
),

renamed as (
    select
        -- Primary Key
        product_id,
        
        -- Category (Portuguese - join with translation table)
        product_category_name as category_name_pt,
        
        -- Dimensions
        cast(product_weight_g as numeric) as weight_grams,
        cast(product_length_cm as numeric) as length_cm,
        cast(product_height_cm as numeric) as height_cm,
        cast(product_width_cm as numeric) as width_cm,
        
        -- Derived: Volume in cubic cm
        cast(product_length_cm as numeric) 
            * cast(product_height_cm as numeric) 
            * cast(product_width_cm as numeric) as volume_cm3,
        
        -- Derived: Size classification
        case
            when cast(product_weight_g as numeric) < 500 then 'Small'
            when cast(product_weight_g as numeric) < 2000 then 'Medium'
            when cast(product_weight_g as numeric) < 10000 then 'Large'
            else 'Extra Large'
        end as size_category,
        
        -- Product description stats
        product_name_lenght as name_length,
        product_description_lenght as description_length,
        product_photos_qty as photo_count

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_products | schema: dbt_dev_yourname_staging */;
[0m14:54:19.820772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:19.920111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0B0DFD50>]}
[0m14:54:19.921112 [info ] [Thread-1 (]: 40 of 147 OK created sql view model dbt_dev_yourname_staging.stg_product_categories  [[32mCREATE VIEW (0 processed)[0m in 2.07s]
[0m14:54:19.926781 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_product_categories
[0m14:54:19.928141 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_orders
[0m14:54:19.930608 [info ] [Thread-1 (]: 42 of 147 START sql view model dbt_dev_yourname_staging.stg_orders ............. [RUN]
[0m14:54:19.933184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_product_categories, now model.dbt_advanced_olist.stg_orders)
[0m14:54:19.937272 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_orders
[0m14:54:19.955756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_orders"
[0m14:54:19.982451 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_orders
[0m14:54:19.991021 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_orders"
[0m14:54:20.007058 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_orders: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_orders
  
  Purpose: Clean and standardize raw order data
  Source: Olist Brazilian E-commerce (10K orders sample)
  
  Transformations:
  - Rename columns to consistent naming convention
  - Cast timestamps to proper types
  - Calculate delivery metrics
  - Add late delivery flag
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`orders`
),

renamed as (
    select
        -- Primary Key
        order_id,
        
        -- Foreign Keys
        customer_id,
        
        -- Order Status
        order_status,
        
        -- Timestamps (cast to proper types)
        cast(order_purchase_timestamp as timestamp) as ordered_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as shipped_at,
        cast(order_delivered_customer_date as timestamp) as delivered_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,
        
        -- Derived: Order date (for partitioning)
        date(cast(order_purchase_timestamp as timestamp)) as order_date,
        
        -- Derived: Delivery time in days
        case 
            when order_delivered_customer_date is not null 
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_purchase_timestamp as timestamp)),
                day
            )
        end as delivery_days,
        
        -- Derived: Is delivery late?
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then true
            else false
        end as is_late_delivery,
        
        -- Derived: Days late (if late)
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_estimated_delivery_date as timestamp)),
                day
            )
            else 0
        end as days_late

    from source
)

select * from renamed

-- Limit in dev for faster iteration
limit 1000
/* dbt 1.10.15 | model: stg_orders | schema: dbt_dev_yourname_staging */;
[0m14:54:20.009672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:20.103002 [info ] [Thread-3 (]: 37 of 147 PASS unique_order_status_codes_status_code ........................... [[32mPASS[0m in 5.72s]
[0m14:54:20.105703 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m14:54:20.108474 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:54:20.110341 [info ] [Thread-3 (]: 43 of 147 START test is_not_negative_stg_order_items_item_freight .............. [RUN]
[0m14:54:20.113234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b, now test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a)
[0m14:54:20.115435 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:54:20.139139 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m14:54:20.157054 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:54:20.175685 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:21.069768 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a1273887-353d-4d96-a5a2-18be604f3366&page=queryresults
[0m14:54:21.272926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:143ce12f-3f8b-4d66-9a99-b19f242a9c32&page=queryresults
[0m14:54:21.342567 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
[0m14:54:21.349898 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_freight as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:21.731188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0B000510>]}
[0m14:54:21.739770 [info ] [Thread-4 (]: 41 of 147 OK created sql view model dbt_dev_yourname_staging.stg_products ...... [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m14:54:21.743189 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_products
[0m14:54:21.746158 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:54:21.748665 [info ] [Thread-4 (]: 44 of 147 START test is_positive_stg_order_items_item_price .................... [RUN]
[0m14:54:21.753266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_products, now test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242)
[0m14:54:21.755264 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:54:21.773169 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m14:54:21.776127 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:54:21.788514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:21.883802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0B106150>]}
[0m14:54:21.887045 [info ] [Thread-1 (]: 42 of 147 OK created sql view model dbt_dev_yourname_staging.stg_orders ........ [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m14:54:21.890160 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_orders
[0m14:54:21.891393 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:54:21.893208 [info ] [Thread-1 (]: 45 of 147 START test is_positive_stg_order_items_item_total .................... [RUN]
[0m14:54:21.895793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_orders, now test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25)
[0m14:54:21.896793 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:54:21.933827 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m14:54:21.945228 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:54:21.960312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:21.967140 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:892d35e0-1309-4175-8077-f952992c7504&page=queryresults
[0m14:54:22.871123 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
[0m14:54:22.880349 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_price as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price <= 0
   or item_price is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:23.356470 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
[0m14:54:23.356470 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total <= 0
   or item_total is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:23.585996 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c14ac596-4afb-4aeb-a521-9d0c829654d1&page=queryresults
[0m14:54:23.978200 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0f0cbdda-0fc1-4c20-996b-d1696a61b9fe&page=queryresults
[0m14:54:24.214055 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m14:54:24.237743 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:24.999686 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a0b5ab6f-5cf9-4609-92eb-d83d38f034b3&page=queryresults
[0m14:54:25.716105 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m14:54:25.733154 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:26.060941 [info ] [Thread-3 (]: 43 of 147 PASS is_not_negative_stg_order_items_item_freight .................... [[32mPASS[0m in 5.95s]
[0m14:54:26.067354 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m14:54:26.071493 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:54:26.071493 [info ] [Thread-3 (]: 46 of 147 START test not_null_stg_order_items_item_freight ..................... [RUN]
[0m14:54:26.079007 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a, now test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5)
[0m14:54:26.084764 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:54:26.137524 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m14:54:26.145647 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:54:26.170226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:26.177905 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m14:54:26.270018 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:26.275754 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:901819c3-c610-4ca9-9f07-6ec796e6f692&page=queryresults
[0m14:54:26.824771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4f20453c-c3ba-4666-a0c7-730599adba02&page=queryresults
[0m14:54:27.420662 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
[0m14:54:27.428256 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:27.436628 [info ] [Thread-4 (]: 44 of 147 PASS is_positive_stg_order_items_item_price .......................... [[32mPASS[0m in 5.68s]
[0m14:54:27.448708 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m14:54:27.454580 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:54:27.472757 [info ] [Thread-4 (]: 47 of 147 START test not_null_stg_order_items_item_price ....................... [RUN]
[0m14:54:27.481138 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242, now test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556)
[0m14:54:27.510580 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:54:27.543413 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m14:54:27.555840 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:54:27.586429 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:27.818697 [info ] [Thread-1 (]: 45 of 147 PASS is_positive_stg_order_items_item_total .......................... [[32mPASS[0m in 5.92s]
[0m14:54:27.825427 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m14:54:27.825427 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:54:27.832600 [info ] [Thread-1 (]: 48 of 147 START test not_null_stg_order_items_item_total ....................... [RUN]
[0m14:54:27.838938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25, now test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2)
[0m14:54:27.843578 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:54:27.872082 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m14:54:27.891470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m14:54:27.902663 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:54:27.940602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:27.944213 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:28.041102 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:24e0b2d3-22f6-4285-b4cd-0fb926ce3556&page=queryresults
[0m14:54:28.493969 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e54cbc5d-24e4-47f8-97b6-d3e7ec04baaf&page=queryresults
[0m14:54:28.710164 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
[0m14:54:28.712158 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:29.052900 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
[0m14:54:29.052900 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:29.340410 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e3d2e941-4e55-4da7-ac9f-0c6bc08e81bf&page=queryresults
[0m14:54:29.490905 [info ] [Thread-2 (]: 33 of 147 PASS accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [[32mPASS[0m in 24.51s]
[0m14:54:29.509240 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m14:54:29.512792 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:54:29.520069 [info ] [Thread-2 (]: 49 of 147 START test not_null_stg_order_items_order_id ......................... [RUN]
[0m14:54:29.526541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22, now test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96)
[0m14:54:29.526541 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:54:29.570224 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m14:54:29.576030 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:54:29.599555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:29.728043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ad7ad570-7700-41c3-b67f-b348ee7614e2&page=queryresults
[0m14:54:30.218988 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m14:54:30.249784 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:30.747752 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
[0m14:54:30.752455 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:30.952329 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a5a75b9c-c761-43ed-90b8-b11737bad4f0&page=queryresults
[0m14:54:31.152149 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m14:54:31.159745 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:31.424679 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0eadf34d-4888-4095-bdcb-cb51f1565c5e&page=queryresults
[0m14:54:31.753774 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d72be7ae-004d-4b6e-a5de-89141860a825&page=queryresults
[0m14:54:32.022039 [info ] [Thread-3 (]: 46 of 147 PASS not_null_stg_order_items_item_freight ........................... [[32mPASS[0m in 5.94s]
[0m14:54:32.027416 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m14:54:32.031681 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:54:32.037696 [info ] [Thread-3 (]: 50 of 147 START test not_null_stg_order_items_order_item_key ................... [RUN]
[0m14:54:32.044796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5, now test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa)
[0m14:54:32.051122 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:54:32.103484 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m14:54:32.123888 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:54:32.141379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:32.152047 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m14:54:32.257144 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:32.770105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:45ef07f1-d2c2-4333-b263-b28001408c8b&page=queryresults
[0m14:54:32.899648 [info ] [Thread-4 (]: 47 of 147 PASS not_null_stg_order_items_item_price ............................. [[32mPASS[0m in 5.41s]
[0m14:54:32.903955 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m14:54:32.908261 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:54:32.911421 [info ] [Thread-4 (]: 51 of 147 START test not_null_stg_order_items_product_id ....................... [RUN]
[0m14:54:32.919460 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556, now test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6)
[0m14:54:32.922930 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:54:32.957261 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m14:54:32.963686 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:54:32.985810 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:33.444219 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
[0m14:54:33.451380 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_item_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:33.457008 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m14:54:33.472488 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:33.721788 [info ] [Thread-1 (]: 48 of 147 PASS not_null_stg_order_items_item_total ............................. [[32mPASS[0m in 5.88s]
[0m14:54:33.727742 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m14:54:33.735729 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:54:33.742210 [info ] [Thread-1 (]: 52 of 147 START test unique_stg_order_items_order_item_key ..................... [RUN]
[0m14:54:33.763493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2, now test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057)
[0m14:54:33.773140 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:54:33.811637 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m14:54:33.818649 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:54:33.833612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:34.013104 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:212ed111-54ba-4b10-bd56-1f2446d23925&page=queryresults
[0m14:54:34.089168 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c2bd226-9b1b-4d4d-b647-9523e9998a40&page=queryresults
[0m14:54:34.135032 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
[0m14:54:34.135032 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:34.736090 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:78c813b0-ecac-460a-a7df-84ec408aaabf&page=queryresults
[0m14:54:34.969287 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
[0m14:54:34.973786 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_item_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  where order_item_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:35.067710 [info ] [Thread-2 (]: 49 of 147 PASS not_null_stg_order_items_order_id ............................... [[32mPASS[0m in 5.54s]
[0m14:54:35.078396 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m14:54:35.083710 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:54:35.089420 [info ] [Thread-2 (]: 53 of 147 START test accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m14:54:35.098412 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96, now test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f)
[0m14:54:35.107409 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:54:35.150376 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m14:54:35.163062 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:54:35.449231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:35.561272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a981c8d1-4900-4fe6-b0e2-47c7af4fa370&page=queryresults
[0m14:54:36.157663 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m14:54:36.176185 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:36.713492 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ae76a8f3-012d-483d-b7b1-d62db402fd7c&page=queryresults
[0m14:54:36.726883 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
[0m14:54:36.736147 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:36.987609 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m14:54:37.021906 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:37.392354 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:47655e2b-4f5e-4351-9915-0c3473ee7954&page=queryresults
[0m14:54:37.590237 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e8749e06-c79a-446d-895a-59cb347ac55a&page=queryresults
[0m14:54:37.808292 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m14:54:37.815457 [info ] [Thread-3 (]: 50 of 147 PASS not_null_stg_order_items_order_item_key ......................... [[32mPASS[0m in 5.77s]
[0m14:54:37.827562 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m14:54:37.831687 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:54:37.837007 [info ] [Thread-3 (]: 54 of 147 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [RUN]
[0m14:54:37.842957 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789)
[0m14:54:37.846571 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:54:37.888164 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m14:54:37.899047 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:37.909776 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:54:37.934861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:38.535792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:32560ee2-cc67-4099-a043-317847b619f8&page=queryresults
[0m14:54:38.738042 [info ] [Thread-4 (]: 51 of 147 PASS not_null_stg_order_items_product_id ............................. [[32mPASS[0m in 5.82s]
[0m14:54:38.743162 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m14:54:38.747938 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:54:38.752953 [info ] [Thread-4 (]: 55 of 147 START test not_null_stg_customers_customer_id ........................ [RUN]
[0m14:54:38.757394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:54:38.765944 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:54:38.806286 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:54:38.819231 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:54:38.850576 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:39.334641 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m14:54:39.354860 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:39.450011 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
[0m14:54:39.461167 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:39.489375 [info ] [Thread-1 (]: 52 of 147 PASS unique_stg_order_items_order_item_key ........................... [[32mPASS[0m in 5.73s]
[0m14:54:39.495527 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m14:54:39.501213 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:54:39.505694 [info ] [Thread-1 (]: 56 of 147 START test not_null_stg_customers_customer_region .................... [RUN]
[0m14:54:39.511076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057, now test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e)
[0m14:54:39.516010 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:54:39.557834 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m14:54:39.570238 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:54:39.573321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:40.136019 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
[0m14:54:40.141203 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e9604270-375c-479b-abec-7561364b1105&page=queryresults
[0m14:54:40.143252 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd1e4439-81df-4e6a-9f74-c485c60c9a24&page=queryresults
[0m14:54:40.150056 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:40.849222 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bc10ffa5-5171-4b2b-93b6-90f75b74254f&page=queryresults
[0m14:54:41.239551 [info ] [Thread-2 (]: 53 of 147 PASS accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 6.14s]
[0m14:54:41.244257 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m14:54:41.251336 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:54:41.253912 [info ] [Thread-2 (]: 57 of 147 START test not_null_stg_customers_customer_state ..................... [RUN]
[0m14:54:41.261598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f, now test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397)
[0m14:54:41.269627 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:54:41.305658 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m14:54:41.321064 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:54:41.351530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:41.784949 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
[0m14:54:41.798500 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:42.448951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d3e98002-c9c5-45ed-aa24-8a3f364a5e6b&page=queryresults
[0m14:54:42.688513 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
[0m14:54:42.703663 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:42.934615 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:54:42.946620 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:43.325463 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0172c4ce-8218-4192-a828-39a10c5974ff&page=queryresults
[0m14:54:43.535644 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:04f1ffc2-819c-4e75-88b5-0b873aa23e25&page=queryresults
[0m14:54:44.496131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m14:54:44.500115 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:44.536070 [info ] [Thread-4 (]: 55 of 147 PASS not_null_stg_customers_customer_id .............................. [[32mPASS[0m in 5.78s]
[0m14:54:44.538959 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:54:44.543064 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:54:44.547859 [info ] [Thread-4 (]: 58 of 147 START test not_null_stg_customers_customer_unique_id ................. [RUN]
[0m14:54:44.554382 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba)
[0m14:54:44.560426 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:54:44.625005 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:54:44.782087 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:54:44.936711 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:45.106777 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3560ec70-14cf-47d7-8fd9-22d2d8c301b6&page=queryresults
[0m14:54:45.437271 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m14:54:45.445277 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:46.004009 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:35a79589-7812-4a48-9607-22932132b6c0&page=queryresults
[0m14:54:46.085325 [info ] [Thread-1 (]: 56 of 147 PASS not_null_stg_customers_customer_region .......................... [[32mPASS[0m in 6.57s]
[0m14:54:46.088427 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m14:54:46.091221 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:54:46.092390 [info ] [Thread-1 (]: 59 of 147 START test unique_stg_customers_customer_id .......................... [RUN]
[0m14:54:46.094680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e, now test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada)
[0m14:54:46.096709 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:54:46.113902 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m14:54:46.115945 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:54:46.130418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:46.196798 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
[0m14:54:46.201106 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:46.882264 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a6ae7b46-34fe-4d22-840a-e84f89aa0076&page=queryresults
[0m14:54:47.059127 [info ] [Thread-2 (]: 57 of 147 PASS not_null_stg_customers_customer_state ........................... [[32mPASS[0m in 5.80s]
[0m14:54:47.064729 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m14:54:47.066875 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:54:47.069866 [info ] [Thread-2 (]: 60 of 147 START test not_null_stg_product_categories_category_group ............ [RUN]
[0m14:54:47.072450 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397, now test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a)
[0m14:54:47.074186 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:54:47.092504 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m14:54:47.099117 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:54:47.115256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:47.420425 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
[0m14:54:47.424282 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:47.926030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:81035e7f-f8b8-42c7-930a-f0dc57ea065d&page=queryresults
[0m14:54:48.431466 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
[0m14:54:48.431466 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:49.045525 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:54:49.051729 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:49.091468 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a117679c-1065-46c2-8bd0-cbaa6aa30894&page=queryresults
[0m14:54:49.884916 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m14:54:49.888745 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:141997ef-2328-4b7a-bc1b-ab3fee62126b&page=queryresults
[0m14:54:49.899957 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:50.476331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7c5adac5-4499-40c1-a330-016250cbfc4e&page=queryresults
[0m14:54:51.118907 [info ] [Thread-4 (]: 58 of 147 PASS not_null_stg_customers_customer_unique_id ....................... [[32mPASS[0m in 6.56s]
[0m14:54:51.130886 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:54:51.135436 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:54:51.142000 [info ] [Thread-4 (]: 61 of 147 START test not_null_stg_product_categories_category_name_en .......... [RUN]
[0m14:54:51.150416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17)
[0m14:54:51.156951 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:54:51.194979 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m14:54:51.215319 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m14:54:51.222185 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:51.230268 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:54:51.260472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:51.452839 [info ] [Thread-1 (]: 59 of 147 PASS unique_stg_customers_customer_id ................................ [[32mPASS[0m in 5.36s]
[0m14:54:51.453841 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m14:54:51.465434 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:54:51.468570 [info ] [Thread-1 (]: 62 of 147 START test not_null_stg_product_categories_category_name_pt .......... [RUN]
[0m14:54:51.472942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c)
[0m14:54:51.474973 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:54:51.502844 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m14:54:51.508300 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:54:51.540026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:51.800698 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd016a54-ccf2-4cd4-a131-1c02648a1727&page=queryresults
[0m14:54:52.396512 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
[0m14:54:52.396512 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_en is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:52.627027 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
[0m14:54:52.631371 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_pt is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:52.855132 [info ] [Thread-2 (]: 60 of 147 PASS not_null_stg_product_categories_category_group .................. [[32mPASS[0m in 5.78s]
[0m14:54:52.863526 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m14:54:52.866567 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:54:52.871682 [info ] [Thread-2 (]: 63 of 147 START test unique_stg_product_categories_category_name_pt ............ [RUN]
[0m14:54:52.873716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a, now test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374)
[0m14:54:52.881270 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:54:52.909558 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m14:54:52.920388 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:54:52.950250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:52.952237 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:45e3815e-af83-4122-a9e0-1e5372549ddd&page=queryresults
[0m14:54:53.258896 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5b6db198-9f36-4f2d-a401-111e4754a407&page=queryresults
[0m14:54:54.316937 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
[0m14:54:54.316937 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select category_name_pt as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  where category_name_pt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:54.701006 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m14:54:54.714863 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:54.898571 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m14:54:54.906398 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:54.951659 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db2ba59d-d9de-4e86-ab2b-c174e4a42dd7&page=queryresults
[0m14:54:55.031609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m14:54:55.040879 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:55.419843 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:be349c75-fc65-4460-bce7-7c0a34720df5&page=queryresults
[0m14:54:55.524951 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a1b614ff-71bd-4c1a-8616-919aca831102&page=queryresults
[0m14:54:55.716786 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:46bb8f9c-a1eb-4642-913e-d36dc62c380d&page=queryresults
[0m14:54:56.497202 [info ] [Thread-3 (]: 54 of 147 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [[32mPASS[0m in 18.66s]
[0m14:54:56.511378 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m14:54:56.516414 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:54:56.516414 [info ] [Thread-3 (]: 64 of 147 START test accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [RUN]
[0m14:54:56.524252 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789, now test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b)
[0m14:54:56.528994 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:54:56.579673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m14:54:56.580672 [info ] [Thread-4 (]: 61 of 147 PASS not_null_stg_product_categories_category_name_en ................ [[32mPASS[0m in 5.43s]
[0m14:54:56.580672 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m14:54:56.589881 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:54:56.595362 [info ] [Thread-4 (]: 65 of 147 START test is_not_negative_stg_products_weight_grams ................. [RUN]
[0m14:54:56.600603 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17, now test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890)
[0m14:54:56.604297 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:54:56.604297 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:54:56.651809 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m14:54:56.663703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:54:56.666054 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:54:56.744670 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:54:56.833227 [info ] [Thread-1 (]: 62 of 147 PASS not_null_stg_product_categories_category_name_pt ................ [[32mPASS[0m in 5.36s]
[0m14:54:56.841278 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m14:54:56.843755 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:54:56.845730 [info ] [Thread-1 (]: 66 of 147 START test not_null_stg_products_product_id .......................... [RUN]
[0m14:54:56.847370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c, now test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3)
[0m14:54:56.849798 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:54:56.864065 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m14:54:56.868177 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:54:56.879229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:57.174637 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m14:54:57.186301 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:54:57.772979 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f92de627-cdd1-4bec-a82d-e51acd52b113&page=queryresults
[0m14:54:57.883579 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
[0m14:54:57.883579 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    weight_grams as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where weight_grams < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:58.205936 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
[0m14:54:58.210404 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        size_category as value_field,
        count(*) as n_records

    from (select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products` where size_category is not null) dbt_subquery
    group by size_category

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Extra Large'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:58.213486 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
[0m14:54:58.224659 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:54:58.429615 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f41b7c98-c477-4937-9130-68edb5c40aa9&page=queryresults
[0m14:54:58.789386 [info ] [Thread-2 (]: 63 of 147 PASS unique_stg_product_categories_category_name_pt .................. [[32mPASS[0m in 5.92s]
[0m14:54:58.798500 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m14:54:58.798500 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:54:58.807702 [info ] [Thread-2 (]: 67 of 147 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m14:54:58.813581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374, now test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m14:54:58.814578 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:54:58.846662 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m14:54:58.852003 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:54:58.870160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:54:59.435963 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c9880260-c3af-44f2-a6b7-344dac96fc06&page=queryresults
[0m14:54:59.452796 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:75f69f1e-e8dd-4ff1-bfe5-126c90e60aca&page=queryresults
[0m14:55:00.219892 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
[0m14:55:00.225954 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:00.834948 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m14:55:00.845168 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:00.849629 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ca42b74b-e486-4d00-8945-f65f65f89f1a&page=queryresults
[0m14:55:01.430508 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:475e6c68-1724-4cf7-a4d2-581ab5010edd&page=queryresults
[0m14:55:01.539367 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m14:55:01.548599 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:02.103380 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:79b0bbad-f522-4377-adbd-2f2c8605e521&page=queryresults
[0m14:55:02.116986 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m14:55:02.124476 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:02.505429 [info ] [Thread-4 (]: 65 of 147 PASS is_not_negative_stg_products_weight_grams ....................... [[32mPASS[0m in 5.90s]
[0m14:55:02.514804 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m14:55:02.518491 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:55:02.520215 [info ] [Thread-4 (]: 68 of 147 START test unique_stg_products_product_id ............................ [RUN]
[0m14:55:02.521212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890, now test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467)
[0m14:55:02.521212 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:55:02.547754 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m14:55:02.553155 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:55:02.569982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:02.800002 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a9f641e4-9750-4cc9-81be-a043102a912e&page=queryresults
[0m14:55:02.967854 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m14:55:02.972019 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:03.112592 [info ] [Thread-1 (]: 66 of 147 PASS not_null_stg_products_product_id ................................ [[32mPASS[0m in 6.27s]
[0m14:55:03.117123 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m14:55:03.118961 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:55:03.121541 [info ] [Thread-1 (]: 69 of 147 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:55:03.127642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3, now test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460)
[0m14:55:03.130498 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:55:03.147556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m14:55:03.161265 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:55:03.169575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:03.594558 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c58845dd-4ef2-4101-a069-fe9636886dab&page=queryresults
[0m14:55:03.763400 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
[0m14:55:03.768679 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:03.805560 [info ] [Thread-3 (]: 64 of 147 PASS accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [[32mPASS[0m in 7.29s]
[0m14:55:03.813683 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m14:55:03.813683 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:55:03.819259 [info ] [Thread-3 (]: 70 of 147 START test assert_delivery_dates_logical ............................. [RUN]
[0m14:55:03.820260 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b, now test.dbt_advanced_olist.assert_delivery_dates_logical)
[0m14:55:03.829401 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:55:03.856685 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m14:55:03.890393 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:55:03.905092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:04.392556 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2281388a-f876-4be1-abb2-25dfeec8cd7d&page=queryresults
[0m14:55:04.729294 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
[0m14:55:04.735170 [warn ] [Thread-2 (]: 67 of 147 WARN 642 relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[33mWARN 642[0m in 5.92s]
[0m14:55:04.736214 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:04.746616 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m14:55:04.752849 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.assert_orders_have_items
[0m14:55:04.759220 [info ] [Thread-2 (]: 71 of 147 START test assert_orders_have_items .................................. [RUN]
[0m14:55:04.762800 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_advanced_olist.assert_orders_have_items)
[0m14:55:04.763839 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.assert_orders_have_items
[0m14:55:04.776748 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m14:55:04.781466 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.assert_orders_have_items
[0m14:55:04.794359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:05.136455 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
[0m14:55:05.141465 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_delivery_dates_logical
  
  Purpose: Delivery dates should follow logical order
  
  Business Rules:
  - approved_at >= ordered_at
  - shipped_at >= approved_at (if exists)
  - delivered_at >= shipped_at (if exists)
  
  Test PASSES if query returns 0 rows
*/

with orders as (
    select
        order_id,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

date_violations as (
    select
        order_id,
        case
            when approved_at < ordered_at then 'Approved before ordered'
            when shipped_at < approved_at then 'Shipped before approved'
            when delivered_at < shipped_at then 'Delivered before shipped'
            when delivered_at < ordered_at then 'Delivered before ordered'
        end as violation_type,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from orders
    where 
        (approved_at is not null and approved_at < ordered_at)
        or (shipped_at is not null and approved_at is not null and shipped_at < approved_at)
        or (delivered_at is not null and shipped_at is not null and delivered_at < shipped_at)
        or (delivered_at is not null and delivered_at < ordered_at)
)

select * from date_violations
  
  
    )
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:05.347988 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b93008ac-7656-4715-8487-214572c87170&page=queryresults
[0m14:55:05.752099 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f412af6a-add3-430c-bbb1-cf02102313d6&page=queryresults
[0m14:55:06.095813 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
[0m14:55:06.112425 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

/*
  SINGULAR TEST: assert_orders_have_items
  Purpose: Every order should have at least one line item
  Business Rule: An order without items indicates data integrity issue
  Test PASSES if this query returns 0 rows
  Test FAILS if any orders exist without items
  
  Note: Sample data may have orphaned records - set to warn
*/
with orders as (
    select order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),
order_items as (
    select distinct order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),
orders_without_items as (
    select
        o.order_id
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    where oi.order_id is null
)
select
    order_id,
    'Order has no items' as failure_reason
from orders_without_items
  
  
    )
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:06.185705 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m14:55:06.194735 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:06.780671 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:219e6918-3638-40f3-9b0c-8eacdb4a88dd&page=queryresults
[0m14:55:06.780671 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d60d36e8-822d-4c6c-ad3b-f227cea17be7&page=queryresults
[0m14:55:07.429551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m14:55:07.436748 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:07.833914 [info ] [Thread-4 (]: 68 of 147 PASS unique_stg_products_product_id .................................. [[32mPASS[0m in 5.31s]
[0m14:55:07.834952 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m14:55:07.839587 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:55:07.844106 [info ] [Thread-4 (]: 72 of 147 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [RUN]
[0m14:55:07.846450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15)
[0m14:55:07.849459 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:55:07.860518 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m14:55:07.871814 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:55:07.886035 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:07.960407 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m14:55:07.986382 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:08.047381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:85bd7b58-ed9d-4124-871b-4e40d829797b&page=queryresults
[0m14:55:08.498040 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5685a499-1bb1-41cc-867a-dd07abfea119&page=queryresults
[0m14:55:08.825125 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m14:55:08.832316 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:09.128520 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
[0m14:55:09.143140 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_days >= 0 and delivery_days <= 180
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where
        delivery_days is not null
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:09.137913 [info ] [Thread-1 (]: 69 of 147 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 6.01s]
[0m14:55:09.148698 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m14:55:09.154370 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:55:09.157978 [info ] [Thread-1 (]: 73 of 147 START test not_null_stg_orders_customer_id ........................... [RUN]
[0m14:55:09.161072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:55:09.164296 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:55:09.179270 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:55:09.198034 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:55:09.212022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:09.649200 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:940cae7f-0c81-4fc3-a83f-ddfa26e06a17&page=queryresults
[0m14:55:09.648205 [info ] [Thread-3 (]: 70 of 147 PASS assert_delivery_dates_logical ................................... [[32mPASS[0m in 5.83s]
[0m14:55:09.659002 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m14:55:09.661464 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:55:09.665365 [info ] [Thread-3 (]: 74 of 147 START test not_null_stg_orders_is_late_delivery ...................... [RUN]
[0m14:55:09.665365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_delivery_dates_logical, now test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0)
[0m14:55:09.670253 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:55:09.688870 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m14:55:09.695084 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:55:09.709458 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:09.778773 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:82ed5f1c-b9a1-4185-bb31-739343da46df&page=queryresults
[0m14:55:10.420187 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
[0m14:55:10.430778 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:10.669815 [warn ] [Thread-2 (]: 71 of 147 WARN 890 assert_orders_have_items .................................... [[33mWARN 890[0m in 5.91s]
[0m14:55:10.680637 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.assert_orders_have_items
[0m14:55:10.684630 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:55:10.689263 [info ] [Thread-2 (]: 75 of 147 START test not_null_stg_orders_order_date ............................ [RUN]
[0m14:55:10.695037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_orders_have_items, now test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb)
[0m14:55:10.698134 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:55:10.727985 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m14:55:10.733702 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:55:10.762405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:10.856884 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
[0m14:55:10.860191 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where is_late_delivery is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:10.934157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1816f0b1-04ca-4bbf-99c1-4f6851b7b117&page=queryresults
[0m14:55:11.433605 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8ebc5230-2e6f-43b3-a8fa-ef4186ea0c47&page=queryresults
[0m14:55:11.996301 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
[0m14:55:11.996301 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:12.553300 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5dfa4e0b-0015-406d-99d8-5789a2033eb6&page=queryresults
[0m14:55:13.065709 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:55:13.072133 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:13.329083 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m14:55:13.335377 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:13.746829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:85a1f942-4f7b-4966-b279-2cc0374932e0&page=queryresults
[0m14:55:14.008449 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:14cc8dda-b3d7-4df6-b855-d66e4c14bd7d&page=queryresults
[0m14:55:14.405642 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m14:55:14.409690 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:14.933287 [info ] [Thread-1 (]: 73 of 147 PASS not_null_stg_orders_customer_id ................................. [[32mPASS[0m in 5.77s]
[0m14:55:14.934327 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:55:14.940482 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:55:14.944517 [info ] [Thread-1 (]: 76 of 147 START test not_null_stg_orders_order_id .............................. [RUN]
[0m14:55:14.952418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:55:14.951084 [info ] [Thread-3 (]: 74 of 147 PASS not_null_stg_orders_is_late_delivery ............................ [[32mPASS[0m in 5.28s]
[0m14:55:14.953415 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:55:14.959837 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m14:55:14.977613 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:55:14.977613 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:55:14.983862 [info ] [Thread-3 (]: 77 of 147 START test not_null_stg_orders_order_status .......................... [RUN]
[0m14:55:14.984858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0, now test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79)
[0m14:55:14.987921 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:55:15.002587 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m14:55:15.099185 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:55:15.101805 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:55:15.110617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:15.129269 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:15.348146 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:860d04f7-3a48-4fc2-b3e7-6237d9bfcfe3&page=queryresults
[0m14:55:16.400459 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
[0m14:55:16.400459 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
[0m14:55:16.411177 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:16.411177 [info ] [Thread-2 (]: 75 of 147 PASS not_null_stg_orders_order_date .................................. [[32mPASS[0m in 5.72s]
[0m14:55:16.422400 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:16.426628 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m14:55:16.434822 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:55:16.442482 [info ] [Thread-2 (]: 78 of 147 START test not_null_stg_orders_ordered_at ............................ [RUN]
[0m14:55:16.446286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca)
[0m14:55:16.449464 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:55:16.469417 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:55:16.474145 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:55:16.487727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:16.943293 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:05c17e8d-b00b-4062-815b-a9f6aa6b4e4d&page=queryresults
[0m14:55:17.328202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ad9e78fd-c316-43c5-ab56-189792b4e223&page=queryresults
[0m14:55:17.833757 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
[0m14:55:17.845712 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:18.449800 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f9067a32-46b4-4772-b48b-9ef127ef858b&page=queryresults
[0m14:55:19.116595 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m14:55:19.130214 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:19.844268 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:037959ff-d4f2-4322-b533-11f245fd8c06&page=queryresults
[0m14:55:20.089636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:55:20.096433 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:20.517076 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m14:55:20.528306 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:20.639343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4ef0c0a2-b9c7-481a-9958-2a38c76f21f1&page=queryresults
[0m14:55:20.846125 [info ] [Thread-3 (]: 77 of 147 PASS not_null_stg_orders_order_status ................................ [[32mPASS[0m in 5.86s]
[0m14:55:20.847120 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m14:55:20.857055 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:55:20.861399 [info ] [Thread-3 (]: 79 of 147 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:55:20.866614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79, now test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m14:55:20.867603 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:55:20.900770 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m14:55:20.909831 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:55:20.926047 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:21.075845 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9d94ec39-8129-4c22-b7bb-d7a96922c253&page=queryresults
[0m14:55:22.092324 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
[0m14:55:22.107804 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:22.173159 [info ] [Thread-1 (]: 76 of 147 PASS not_null_stg_orders_order_id .................................... [[32mPASS[0m in 7.22s]
[0m14:55:22.178486 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m14:55:22.178486 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:55:22.186671 [info ] [Thread-1 (]: 80 of 147 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:55:22.194875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:55:22.199619 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:55:22.242909 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:55:22.251948 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:55:22.274017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:22.696410 [info ] [Thread-2 (]: 78 of 147 PASS not_null_stg_orders_ordered_at .................................. [[32mPASS[0m in 6.25s]
[0m14:55:22.701042 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m14:55:22.708724 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:55:22.712465 [info ] [Thread-2 (]: 81 of 147 START test unique_stg_orders_order_id ................................ [RUN]
[0m14:55:22.717305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca, now test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a)
[0m14:55:22.723575 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9b1ccac3-ed23-41b2-b987-6d24948730aa&page=queryresults
[0m14:55:22.726843 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:55:22.748379 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m14:55:22.757034 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:55:22.778705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:23.543191 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
[0m14:55:23.551616 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:24.162591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:19025df6-b1f4-4ab8-8e18-77923b4df96d&page=queryresults
[0m14:55:24.164117 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
[0m14:55:24.195052 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:24.898364 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m14:55:24.903461 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:24.917676 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:03bf7370-016a-4333-a8ba-e266add8e96a&page=queryresults
[0m14:55:25.479425 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:92a8ae96-bb37-4339-9408-5a57fd520427&page=queryresults
[0m14:55:26.434814 [warn ] [Thread-3 (]: 79 of 147 WARN 862 relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mWARN 862[0m in 5.57s]
[0m14:55:26.440198 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m14:55:26.442278 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.int_products_enriched
[0m14:55:26.444273 [info ] [Thread-3 (]: 82 of 147 START sql view model dbt_dev_yourname_intermediate.int_products_enriched  [RUN]
[0m14:55:26.448345 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now model.dbt_advanced_olist.int_products_enriched)
[0m14:55:26.451155 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.int_products_enriched
[0m14:55:26.467751 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_products_enriched"
[0m14:55:26.470099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:55:26.474258 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:26.494349 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.int_products_enriched
[0m14:55:26.506135 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_products_enriched"
[0m14:55:26.516859 [debug] [Thread-3 (]: On model.dbt_advanced_olist.int_products_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_products_enriched
  
  Purpose: Enrich products with category translations and sales metrics
*/

with products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
),

categories as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Calculate product-level sales metrics
product_sales as (
    select
        product_id,
        count(distinct order_id) as times_ordered,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_selling_price,
        min(item_price) as min_selling_price,
        max(item_price) as max_selling_price
    from order_items
    group by 1
),

-- Join products with categories and sales
enriched as (
    select
        -- Product info
        p.product_id,
        p.category_name_pt,
        coalesce(c.category_name_en, 'Unknown') as category_name,
        coalesce(c.category_group, 'Other') as category_group,
        
        -- Dimensions
        p.weight_grams,
        p.length_cm,
        p.height_cm,
        p.width_cm,
        p.volume_cm3,
        p.size_category,
        
        -- Product listing quality
        p.name_length,
        p.description_length,
        p.photo_count,
        
        -- Derived: Listing quality score (0-100)
        (
            case when p.name_length > 0 then 20 else 0 end +
            case when p.description_length > 100 then 30 else p.description_length * 0.3 end +
            case when p.photo_count >= 3 then 50 else p.photo_count * 15 end
        ) as listing_quality_score,
        
        -- Sales metrics
        coalesce(ps.times_ordered, 0) as times_ordered,
        coalesce(ps.total_revenue, 0) as total_revenue,
        coalesce(ps.avg_selling_price, 0) as avg_selling_price,
        
        -- Derived: Product popularity tier
        case
            when coalesce(ps.times_ordered, 0) = 0 then 'Never Sold'
            when ps.times_ordered < 5 then 'Low'
            when ps.times_ordered < 20 then 'Medium'
            when ps.times_ordered < 50 then 'High'
            else 'Top Seller'
        end as popularity_tier

    from products p
    left join categories c on p.category_name_pt = c.category_name_pt
    left join product_sales ps on p.product_id = ps.product_id
)

select * from enriched
/* dbt 1.10.15 | model: int_products_enriched | schema: dbt_dev_yourname_intermediate */;
[0m14:55:26.523952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:27.029338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:050655d0-c8c2-4571-9215-632dfc2d7c4a&page=queryresults
[0m14:55:27.128667 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m14:55:27.141299 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:27.876240 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e11a79eb-a7ce-45a4-8371-da4424ba8a38&page=queryresults
[0m14:55:27.931826 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d1c15dc2-0ec3-4b75-be41-535a86ab81b3&page=queryresults
[0m14:55:28.293289 [warn ] [Thread-1 (]: 80 of 147 WARN 902 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 902[0m in 6.10s]
[0m14:55:28.307542 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:55:28.710942 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0A8450D0>]}
[0m14:55:28.717367 [info ] [Thread-3 (]: 82 of 147 OK created sql view model dbt_dev_yourname_intermediate.int_products_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m14:55:28.726767 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.int_products_enriched
[0m14:55:28.729747 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:55:28.732887 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:55:28.737314 [info ] [Thread-1 (]: 83 of 147 START test dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [RUN]
[0m14:55:28.737314 [info ] [Thread-3 (]: 84 of 147 START test not_null_int_products_enriched_category_name .............. [RUN]
[0m14:55:28.748946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd)
[0m14:55:28.751908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_products_enriched, now test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760)
[0m14:55:28.756433 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:55:28.760958 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:55:28.795007 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m14:55:28.828440 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m14:55:28.858985 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:55:28.870408 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:55:28.900130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:28.923503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:29.043286 [info ] [Thread-2 (]: 81 of 147 PASS unique_stg_orders_order_id ...................................... [[32mPASS[0m in 6.33s]
[0m14:55:29.045483 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m14:55:29.047744 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:55:29.049116 [info ] [Thread-2 (]: 85 of 147 START test not_null_int_products_enriched_product_id ................. [RUN]
[0m14:55:29.052507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a, now test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565)
[0m14:55:29.053505 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:55:29.058119 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m14:55:29.064593 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:55:29.073785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:30.082743 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
[0m14:55:30.088880 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and listing_quality_score >= 0 and listing_quality_score <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:30.092912 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
[0m14:55:30.105288 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where category_name is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:30.325538 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
[0m14:55:30.330418 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:30.756946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9abb1e00-6fc0-499c-a67d-b0d493638b2e&page=queryresults
[0m14:55:30.771040 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c38cc94-3feb-4509-8a45-ec3c3d4ed47b&page=queryresults
[0m14:55:30.925594 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:211ba113-bd8d-4afe-a1b2-f201c1e845a4&page=queryresults
[0m14:55:33.197097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m14:55:33.197097 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m14:55:33.222524 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:33.228284 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:33.810835 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7f4065bd-8362-442e-94d0-dd0317291aca&page=queryresults
[0m14:55:34.530265 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f396a33d-5432-462c-a358-ae9bfe72f361&page=queryresults
[0m14:55:34.540127 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m14:55:34.561191 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:34.943397 [info ] [Thread-3 (]: 84 of 147 PASS not_null_int_products_enriched_category_name .................... [[32mPASS[0m in 6.19s]
[0m14:55:34.953567 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m14:55:34.959660 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:55:34.963580 [info ] [Thread-3 (]: 86 of 147 START test unique_int_products_enriched_product_id ................... [RUN]
[0m14:55:34.967817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760, now test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117)
[0m14:55:34.971627 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:55:35.011488 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m14:55:35.022189 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:55:35.048503 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:35.138526 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:21ac4ec5-0965-4d72-8848-8fa9cd30a9cf&page=queryresults
[0m14:55:36.372782 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
[0m14:55:36.390389 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:55:36.381323 [info ] [Thread-1 (]: 83 of 147 PASS dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [[32mPASS[0m in 7.63s]
[0m14:55:36.399448 [info ] [Thread-2 (]: 85 of 147 PASS not_null_int_products_enriched_product_id ....................... [[32mPASS[0m in 7.35s]
[0m14:55:36.416298 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m14:55:36.428466 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m14:55:37.223581 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:14a551fb-785d-4b2f-b043-fdd193483ed2&page=queryresults
[0m14:55:40.155555 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m14:55:40.165047 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:40.776266 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0d1aa82c-f259-4c81-938d-ae99602a9fdb&page=queryresults
[0m14:55:42.004638 [info ] [Thread-3 (]: 86 of 147 PASS unique_int_products_enriched_product_id ......................... [[32mPASS[0m in 7.04s]
[0m14:55:42.010958 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m14:55:57.837204 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m14:55:57.851093 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:55:58.803438 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8a48606-4149-440f-b4c6-0e47b91f1a59&page=queryresults
[0m14:55:59.970141 [warn ] [Thread-4 (]: 72 of 147 WARN 1 dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [[33mWARN 1[0m in 52.12s]
[0m14:55:59.979289 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m14:56:00.003826 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m14:56:00.015856 [info ] [Thread-1 (]: 87 of 147 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [RUN]
[0m14:56:00.034670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd, now model.dbt_advanced_olist.int_orders_enriched)
[0m14:56:00.035665 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m14:56:00.109410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m14:56:00.117742 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m14:56:00.126750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m14:56:00.134302 [debug] [Thread-1 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m14:56:00.137661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:01.870428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9398a4a4-2d80-41a5-b506-943aa6dd46f0&page=queryresults
[0m14:56:02.586350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA099D0290>]}
[0m14:56:02.589465 [info ] [Thread-1 (]: 87 of 147 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.55s]
[0m14:56:02.598530 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m14:56:02.606225 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:56:02.612528 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:56:02.618495 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:56:02.623051 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:56:02.623051 [info ] [Thread-3 (]: 88 of 147 START test assert_order_total_matches_items .......................... [RUN]
[0m14:56:02.634539 [info ] [Thread-4 (]: 89 of 147 START test dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [RUN]
[0m14:56:02.635538 [info ] [Thread-2 (]: 90 of 147 START test is_not_negative_int_orders_enriched_order_total ........... [RUN]
[0m14:56:02.651901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117, now test.dbt_advanced_olist.assert_order_total_matches_items)
[0m14:56:02.643577 [info ] [Thread-1 (]: 91 of 147 START test not_null_int_orders_enriched_item_count ................... [RUN]
[0m14:56:02.651901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75)
[0m14:56:02.667358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565, now test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf)
[0m14:56:02.670813 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:56:02.683776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_orders_enriched, now test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101)
[0m14:56:02.685516 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:56:02.685516 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:56:02.743347 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:56:02.751171 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m14:56:02.775566 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m14:56:02.799585 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m14:56:02.833707 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m14:56:02.835703 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:56:02.842278 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:56:02.888255 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:02.857732 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:56:02.872353 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:02.857732 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:56:03.141934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:03.281597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:04.502184 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
[0m14:56:04.504116 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
[0m14:56:04.506912 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and item_count >= 0 and item_count <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:04.509391 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_order_total_matches_items
  
  Purpose: Order total should equal sum of item totals (within tolerance)
  
  Business Rule: Order total = sum(item_price + item_freight) for all items
  
  Tolerance: 1 BRL to account for rounding
  
  Test PASSES if query returns 0 rows
*/

with order_totals_from_items as (
    select
        order_id,
        sum(item_total) as calculated_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    group by 1
),

order_totals_from_orders as (
    select
        order_id,
        order_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

mismatches as (
    select
        o.order_id,
        o.order_total as reported_total,
        i.calculated_total,
        abs(o.order_total - i.calculated_total) as difference
    from order_totals_from_orders o
    inner join order_totals_from_items i on o.order_id = i.order_id
    where abs(o.order_total - i.calculated_total) > 1  -- 1 BRL tolerance
)

select
    order_id,
    reported_total,
    calculated_total,
    round(difference, 2) as difference_brl,
    'Order total does not match sum of items' as failure_reason
from mismatches
  
  
    )
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:04.731584 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
[0m14:56:04.737796 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
[0m14:56:04.740179 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:04.745121 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    order_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:05.252706 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1c848521-8221-494d-a3db-338be2734ee8&page=queryresults
[0m14:56:05.256183 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fab2dbd7-195c-42a1-85e3-e6f0e81b6d30&page=queryresults
[0m14:56:05.332923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e7e1dd64-5c05-4e0e-acbf-6404c6c35881&page=queryresults
[0m14:56:05.640825 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b6515555-6ceb-41e0-a34c-927a6be61855&page=queryresults
[0m14:56:07.153982 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m14:56:07.154979 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:07.721914 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m14:56:07.725064 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f447275f-cf23-441e-80d5-8c07d8123ef7&page=queryresults
[0m14:56:07.742394 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:07.831339 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m14:56:07.833435 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:08.113093 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m14:56:08.123730 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:08.322892 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:644938d6-900f-407a-8437-ab443891b497&page=queryresults
[0m14:56:08.835471 [info ] [Thread-4 (]: 89 of 147 PASS dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [[32mPASS[0m in 6.18s]
[0m14:56:08.847561 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m14:56:08.851381 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:56:08.855681 [info ] [Thread-4 (]: 92 of 147 START test not_null_int_orders_enriched_order_id ..................... [RUN]
[0m14:56:08.862488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e)
[0m14:56:08.866301 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:56:08.923513 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m14:56:08.927815 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:56:08.942370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:09.053458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:05744ead-f0e1-41db-b51d-9bea54b51b70&page=queryresults
[0m14:56:09.068430 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e5298d77-19e1-4487-b949-a9bc91f11b00&page=queryresults
[0m14:56:09.459244 [info ] [Thread-3 (]: 88 of 147 PASS assert_order_total_matches_items ................................ [[32mPASS[0m in 6.81s]
[0m14:56:09.465170 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m14:56:09.468714 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:56:09.468714 [info ] [Thread-3 (]: 93 of 147 START test not_null_int_orders_enriched_order_total .................. [RUN]
[0m14:56:09.475419 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_order_total_matches_items, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c)
[0m14:56:09.477309 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:56:09.502094 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m14:56:09.505748 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:56:09.520657 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:10.215071 [info ] [Thread-2 (]: 90 of 147 PASS is_not_negative_int_orders_enriched_order_total ................. [[32mPASS[0m in 7.55s]
[0m14:56:10.217063 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m14:56:10.223962 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:56:10.236425 [info ] [Thread-1 (]: 91 of 147 PASS not_null_int_orders_enriched_item_count ......................... [[32mPASS[0m in 7.56s]
[0m14:56:10.236425 [info ] [Thread-2 (]: 94 of 147 START test unique_int_orders_enriched_order_id ....................... [RUN]
[0m14:56:10.246273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf, now test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232)
[0m14:56:10.236425 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m14:56:10.255083 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:56:10.349406 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m14:56:10.361119 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:56:10.380441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:10.556986 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
[0m14:56:10.562650 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:11.069868 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
[0m14:56:11.081280 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:11.190853 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e5d3e2d0-43ff-4d73-88f5-d7b7df421f26&page=queryresults
[0m14:56:11.804411 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
[0m14:56:11.804411 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d7ddb037-e1fc-4664-8d16-9bb945491df7&page=queryresults
[0m14:56:11.816762 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:12.517092 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1d52794e-d614-4d69-a122-4c184faf23b5&page=queryresults
[0m14:56:13.746341 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m14:56:13.750826 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:14.216643 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m14:56:14.222451 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:14.341618 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c428b13-10ac-4944-bb09-c37bd06a1b95&page=queryresults
[0m14:56:14.766287 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m14:56:14.786508 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:14.787506 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3040af05-f4e1-442d-a47b-051ce2f69dbc&page=queryresults
[0m14:56:15.315356 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a565f80e-c978-4719-bf9e-035da0377cef&page=queryresults
[0m14:56:15.499013 [info ] [Thread-4 (]: 92 of 147 PASS not_null_int_orders_enriched_order_id ........................... [[32mPASS[0m in 6.63s]
[0m14:56:15.500178 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m14:56:15.838630 [info ] [Thread-3 (]: 93 of 147 PASS not_null_int_orders_enriched_order_total ........................ [[32mPASS[0m in 6.36s]
[0m14:56:15.838630 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m14:56:16.868335 [info ] [Thread-2 (]: 94 of 147 PASS unique_int_orders_enriched_order_id ............................. [[32mPASS[0m in 6.62s]
[0m14:56:16.873727 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m14:56:16.889086 [debug] [Thread-1 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:56:16.903474 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.fct_orders
[0m14:56:16.907636 [info ] [Thread-1 (]: 96 of 147 START unit_test dim_customers::test_customer_segment_vip ............. [RUN]
[0m14:56:16.924405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip)
[0m14:56:16.918583 [info ] [Thread-4 (]: 95 of 147 START sql table model dbt_dev_yourname_marts.fct_orders .............. [RUN]
[0m14:56:16.942974 [debug] [Thread-1 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:56:16.955202 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e, now model.dbt_advanced_olist.fct_orders)
[0m14:56:16.960142 [debug] [Thread-1 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:56:16.966920 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.fct_orders
[0m14:56:17.121706 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.fct_orders"
[0m14:56:17.197193 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.fct_orders
[0m14:56:17.216795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:17.229851 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:18.896861 [debug] [Thread-4 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m14:56:18.950648 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:56:19.488431 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:56:19.609781 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:56:19.856666 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_vip__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */;
[0m14:56:19.870337 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:968db2af-0fe7-4646-b4ff-be919130b08a&page=queryresults
[0m14:56:20.333428 [warn ] [Thread-4 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['subtotal', 'freight_total', 'order_total', 'avg_item_price']`
[0m14:56:20.338554 [debug] [Thread-4 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        select
    
      
    cast(null as string)
 as order_id, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as order_status, 
      
    cast(null as date)
 as order_date, 
      
    cast(null as timestamp)
 as ordered_at, 
      
    cast(null as timestamp)
 as approved_at, 
      
    cast(null as timestamp)
 as shipped_at, 
      
    cast(null as timestamp)
 as delivered_at, 
      
    cast(null as timestamp)
 as estimated_delivery_at, 
      
    cast(null as int64)
 as order_year, 
      
    cast(null as int64)
 as order_month, 
      
    cast(null as int64)
 as order_quarter, 
      
    cast(null as int64)
 as order_week, 
      
    cast(null as int64)
 as order_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as string)
 as primary_category, 
      
    cast(null as string)
 as primary_category_group, 
      
    cast(null as int64)
 as item_count, 
      
    cast(null as int64)
 as unique_products, 
      
    cast(null as numeric)
 as subtotal, 
      
    cast(null as numeric)
 as freight_total, 
      
    cast(null as numeric)
 as order_total, 
      
    cast(null as numeric)
 as avg_item_price, 
      
    cast(null as int64)
 as delivery_days, 
      
    cast(null as boolean)
 as is_late_delivery, 
      
    cast(null as int64)
 as days_late, 
      
    cast(null as string)
 as order_size_bucket, 
      
    cast(null as string)
 as delivery_sla_status, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m14:56:20.398097 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dab03c5f-d1a4-4722-adee-384215a71471&page=queryresults
[0m14:56:20.920373 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f831001d-b4e0-408a-9298-f8592a72b744&page=queryresults
[0m14:56:21.403177 [warn ] [Thread-4 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m14:56:21.441851 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.fct_orders"
[0m14:56:21.448662 [debug] [Thread-4 (]: On model.dbt_advanced_olist.fct_orders: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
        
  (
    order_id string not null primary key not enforced,
    customer_id string,
    order_status string,
    order_date date,
    ordered_at timestamp,
    approved_at timestamp,
    shipped_at timestamp,
    delivered_at timestamp,
    estimated_delivery_at timestamp,
    order_year int64,
    order_month int64,
    order_quarter int64,
    order_week int64,
    order_day_of_week int64,
    is_weekend boolean,
    customer_city string,
    customer_state string,
    customer_region string,
    primary_category string,
    primary_category_group string,
    item_count int64,
    unique_products int64,
    subtotal numeric,
    freight_total numeric,
    order_total numeric,
    avg_item_price numeric,
    delivery_days int64,
    is_late_delivery boolean,
    days_late int64,
    order_size_bucket string,
    delivery_sla_status string,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(order_date, month)
    cluster by order_status, customer_state

    
    OPTIONS()
    as (
      
    select order_id, customer_id, order_status, order_date, ordered_at, approved_at, shipped_at, delivered_at, estimated_delivery_at, order_year, order_month, order_quarter, order_week, order_day_of_week, is_weekend, customer_city, customer_state, customer_region, primary_category, primary_category_group, item_count, unique_products, subtotal, freight_total, order_total, avg_item_price, delivery_days, is_late_delivery, days_late, order_size_bucket, delivery_sla_status, _loaded_at
    from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */;
[0m14:56:22.350620 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:39306abf-2817-4ea8-88c5-6f8245acc06c&page=queryresults
[0m14:56:23.413190 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m14:56:23.527598 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''VIP''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */
[0m14:56:24.190530 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e36791c9-00e1-4cd5-9165-771fa2aa2e05&page=queryresults
[0m14:56:25.321723 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA09CAB150>]}
[0m14:56:25.323184 [info ] [Thread-4 (]: 95 of 147 OK created sql table model dbt_dev_yourname_marts.fct_orders ......... [[32mCREATE TABLE (0.0 rows, 2.8 MiB processed)[0m in 8.37s]
[0m14:56:25.327061 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.fct_orders
[0m14:56:25.331404 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:56:25.332541 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:56:25.334536 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:56:25.335640 [info ] [Thread-2 (]: 97 of 147 START test accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [RUN]
[0m14:56:25.336851 [info ] [Thread-3 (]: 98 of 147 START test accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [RUN]
[0m14:56:25.340393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232, now test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670)
[0m14:56:25.339603 [info ] [Thread-4 (]: 99 of 147 START test accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m14:56:25.343338 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c, now test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c)
[0m14:56:25.346092 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:56:25.348862 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.fct_orders, now test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969)
[0m14:56:25.349859 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:56:25.371846 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m14:56:25.371846 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:56:25.391532 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m14:56:25.404367 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m14:56:25.408124 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:56:25.410389 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:56:25.421090 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:25.422154 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:56:25.433524 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:25.495373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:25.754325 [info ] [Thread-1 (]: 96 of 147 PASS dim_customers::test_customer_segment_vip ........................ [[32mPASS[0m in 8.83s]
[0m14:56:25.757382 [debug] [Thread-1 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m14:56:25.763303 [debug] [Thread-1 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:56:25.767021 [info ] [Thread-1 (]: 116 of 147 START unit_test dim_customers::test_customer_segment_high_value ..... [RUN]
[0m14:56:25.770582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value)
[0m14:56:25.774933 [debug] [Thread-1 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:56:25.781578 [debug] [Thread-1 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:56:25.854183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:27.363571 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
[0m14:56:27.373257 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        delivery_sla_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by delivery_sla_status

)

select *
from all_values
where value_field not in (
    'Met','Missed','Canceled','In Progress'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:27.570615 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
[0m14:56:27.574254 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
[0m14:56:27.583721 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:27.587806 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_size_bucket as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_size_bucket

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Premium'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:28.096076 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3849e7b4-4cdd-41e4-8f4d-bfd118c3a626&page=queryresults
[0m14:56:28.132508 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:56:28.141209 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3988c11c-aded-4ecd-8b0a-de7c787de6a7&page=queryresults
[0m14:56:28.490732 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9d9c1da9-4cb3-42b2-84c0-85fc06550346&page=queryresults
[0m14:56:28.577758 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:56:28.735904 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:56:28.745585 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_high_value__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */;
[0m14:56:29.310223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f3f1eba2-a0af-4512-be9b-fbab3371fc93&page=queryresults
[0m14:56:29.823470 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m14:56:30.045778 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:30.641914 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m14:56:30.650536 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:30.671558 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b7515197-8d66-4783-9b3f-2d3d5a2d92ea&page=queryresults
[0m14:56:31.223401 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:25d44b80-e6c3-4505-a7a3-0de40f2c4d38&page=queryresults
[0m14:56:31.987905 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m14:56:31.997466 [info ] [Thread-2 (]: 97 of 147 PASS accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [[32mPASS[0m in 6.66s]
[0m14:56:32.005963 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m14:56:32.013038 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''High Value''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */
[0m14:56:32.019640 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:56:32.032455 [info ] [Thread-2 (]: 100 of 147 START test is_not_negative_fct_orders_freight_total ................. [RUN]
[0m14:56:32.037376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670, now test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20)
[0m14:56:32.040337 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:56:32.070431 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m14:56:32.081894 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:56:32.101863 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:32.384261 [info ] [Thread-3 (]: 98 of 147 PASS accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [[32mPASS[0m in 7.04s]
[0m14:56:32.402989 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m14:56:32.409035 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:56:32.415161 [info ] [Thread-3 (]: 101 of 147 START test is_not_negative_fct_orders_subtotal ...................... [RUN]
[0m14:56:32.422645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c, now test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4)
[0m14:56:32.430773 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:56:32.480833 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m14:56:32.485951 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:56:32.512002 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:32.692895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6af8a9db-9350-4abe-ba4b-0147af181a9f&page=queryresults
[0m14:56:33.411824 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
[0m14:56:33.422976 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    freight_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:33.614288 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
[0m14:56:33.619179 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    subtotal as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:33.928705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5c9e068a-a462-40aa-9a82-e6d4fda89706&page=queryresults
[0m14:56:34.123093 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:112f6756-7227-4681-9d41-0fa84a436e3a&page=queryresults
[0m14:56:34.649234 [info ] [Thread-1 (]: 116 of 147 PASS dim_customers::test_customer_segment_high_value ................ [[32mPASS[0m in 8.88s]
[0m14:56:34.655167 [debug] [Thread-1 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m14:56:34.659675 [debug] [Thread-1 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:56:34.664123 [info ] [Thread-1 (]: 117 of 147 START unit_test dim_customers::test_customer_segment_no_orders ...... [RUN]
[0m14:56:34.669481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders)
[0m14:56:34.676462 [debug] [Thread-1 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:56:34.683496 [debug] [Thread-1 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:56:34.754178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:36.177092 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:56:36.182814 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m14:56:36.208573 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:36.246947 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m14:56:36.258738 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:36.627529 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:56:36.783500 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:56:36.794959 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c6801351-f31c-428e-9a05-24913a77eab7&page=queryresults
[0m14:56:36.810442 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_no_orders__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */;
[0m14:56:36.863374 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ad7e0c2b-c3c6-4f74-887d-4eaade753a39&page=queryresults
[0m14:56:37.401037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:93224fdf-b164-45de-9b44-00e4e0216c84&page=queryresults
[0m14:56:37.821326 [info ] [Thread-2 (]: 100 of 147 PASS is_not_negative_fct_orders_freight_total ....................... [[32mPASS[0m in 5.78s]
[0m14:56:37.831599 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m14:56:37.841850 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:56:37.848511 [info ] [Thread-3 (]: 101 of 147 PASS is_not_negative_fct_orders_subtotal ............................ [[32mPASS[0m in 5.42s]
[0m14:56:37.863988 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m14:56:37.854460 [info ] [Thread-2 (]: 102 of 147 START test not_null_fct_orders_customer_id .......................... [RUN]
[0m14:56:37.869074 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:56:37.872612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20, now test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b)
[0m14:56:37.885307 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:56:37.879248 [info ] [Thread-3 (]: 103 of 147 START test not_null_fct_orders_delivery_sla_status .................. [RUN]
[0m14:56:37.902758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4, now test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0)
[0m14:56:37.934317 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:56:37.944410 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:56:37.963005 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m14:56:37.977036 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:56:37.981088 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:56:37.995067 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:38.016913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:38.942470 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m14:56:38.960560 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:39.528446 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
[0m14:56:39.528446 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
[0m14:56:39.544060 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:39.551408 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f15a7b8d-376c-4d81-903f-79d556acdc5a&page=queryresults
[0m14:56:39.560548 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where delivery_sla_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:39.667406 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m14:56:39.683972 [debug] [Thread-1 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''No Orders''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */
[0m14:56:40.161544 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5d081298-11a9-42de-b489-78f7abb440c2&page=queryresults
[0m14:56:40.175129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8775150-277c-4720-aa67-8e02591fec50&page=queryresults
[0m14:56:40.244521 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1aae2580-f2ef-4e99-a4d6-a35db3ebb093&page=queryresults
[0m14:56:40.580646 [info ] [Thread-4 (]: 99 of 147 PASS accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 15.23s]
[0m14:56:40.593411 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m14:56:40.593411 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:56:40.600117 [info ] [Thread-4 (]: 104 of 147 START test not_null_fct_orders_freight_total ........................ [RUN]
[0m14:56:40.604893 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969, now test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3)
[0m14:56:40.611589 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:56:40.666270 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m14:56:40.681143 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:56:40.709264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:41.562575 [info ] [Thread-1 (]: 117 of 147 PASS dim_customers::test_customer_segment_no_orders ................. [[32mPASS[0m in 6.89s]
[0m14:56:41.567340 [debug] [Thread-1 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m14:56:41.570903 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m14:56:41.577964 [info ] [Thread-1 (]: 118 of 147 START sql table model dbt_dev_yourname_marts.dim_customers .......... [RUN]
[0m14:56:41.582207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders, now model.dbt_advanced_olist.dim_customers)
[0m14:56:41.586430 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m14:56:41.628240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m14:56:41.677650 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m14:56:41.693119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:42.027801 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m14:56:42.035085 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
[0m14:56:42.049004 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:42.071340 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:42.365277 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m14:56:42.393266 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:42.501313 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:19bebaad-59ca-4abe-89d2-79bfd65afae2&page=queryresults
[0m14:56:42.660713 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e02ee40d-6f0f-4231-9448-04a9df7b4c6f&page=queryresults
[0m14:56:42.928877 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m14:56:42.951090 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dd13c067-ccfc-437f-8f87-8ea07eb0c26e&page=queryresults
[0m14:56:43.602581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:96918f40-a5fb-4e66-a66d-269f694c4719&page=queryresults
[0m14:56:43.754173 [info ] [Thread-2 (]: 102 of 147 PASS not_null_fct_orders_customer_id ................................ [[32mPASS[0m in 5.88s]
[0m14:56:43.762972 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m14:56:43.766228 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:56:43.768491 [info ] [Thread-2 (]: 105 of 147 START test not_null_fct_orders_item_count ........................... [RUN]
[0m14:56:43.775641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91)
[0m14:56:43.780968 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:56:43.816055 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m14:56:43.829147 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:56:43.853658 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:43.950725 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m14:56:43.965508 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m14:56:44.012137 [info ] [Thread-3 (]: 103 of 147 PASS not_null_fct_orders_delivery_sla_status ........................ [[32mPASS[0m in 6.11s]
[0m14:56:44.016260 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m14:56:44.018560 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:56:44.020222 [info ] [Thread-3 (]: 106 of 147 START test not_null_fct_orders_order_date ........................... [RUN]
[0m14:56:44.024165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0, now test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362)
[0m14:56:44.028051 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:56:44.045216 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m14:56:44.052478 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:56:44.087271 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:44.484023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e174b210-9058-4150-a0d9-07b09e83b9c5&page=queryresults
[0m14:56:44.580339 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m14:56:44.593462 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:44.825983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m14:56:44.854995 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m14:56:45.185908 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b7713ad9-9546-43d7-abdc-ca47a4374590&page=queryresults
[0m14:56:45.219917 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
[0m14:56:45.226915 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:45.351957 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
[0m14:56:45.355536 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:45.564677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5a62c556-7435-4f47-a447-99cff458ac1f&page=queryresults
[0m14:56:45.743559 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a40ca127-3e86-4ac0-82ba-bb86454dea05&page=queryresults
[0m14:56:46.162292 [info ] [Thread-4 (]: 104 of 147 PASS not_null_fct_orders_freight_total .............................. [[32mPASS[0m in 5.56s]
[0m14:56:46.170119 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m14:56:46.175107 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:56:46.180187 [info ] [Thread-4 (]: 107 of 147 START test not_null_fct_orders_order_id ............................. [RUN]
[0m14:56:46.186903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3, now test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0)
[0m14:56:46.193221 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:56:46.230997 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m14:56:46.246934 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:56:46.268519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:46.286758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d17d59be-3b80-4050-ae43-91959b01e422&page=queryresults
[0m14:56:47.538962 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
[0m14:56:47.548077 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:47.557846 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m14:56:47.585197 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:48.155913 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5044982a-e945-4eb7-9681-51579e8dbb41&page=queryresults
[0m14:56:48.234310 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m14:56:48.246054 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:48.493264 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0fbe60b9-cf6b-491e-862b-5b3ccd344c62&page=queryresults
[0m14:56:48.666779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cf61e0-a82a-41d6-8f26-55af918753dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA0B772550>]}
[0m14:56:48.667815 [info ] [Thread-1 (]: 118 of 147 OK created sql table model dbt_dev_yourname_marts.dim_customers ..... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 7.08s]
[0m14:56:48.679761 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m14:56:48.679761 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:56:48.696001 [info ] [Thread-1 (]: 108 of 147 START test not_null_fct_orders_order_status ......................... [RUN]
[0m14:56:48.699621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_customers, now test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b)
[0m14:56:48.700618 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:56:48.743796 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m14:56:48.749539 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:56:48.776360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:49.176136 [info ] [Thread-3 (]: 106 of 147 PASS not_null_fct_orders_order_date ................................. [[32mPASS[0m in 5.15s]
[0m14:56:49.188378 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m14:56:49.196425 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:56:49.202256 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:346fe738-e3db-4110-bca7-745dcea28c87&page=queryresults
[0m14:56:49.208681 [info ] [Thread-3 (]: 109 of 147 START test not_null_fct_orders_order_total .......................... [RUN]
[0m14:56:49.222562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362, now test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6)
[0m14:56:49.228641 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:56:49.276780 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m14:56:49.280692 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:56:49.291146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:50.109213 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
[0m14:56:50.114320 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:50.258094 [info ] [Thread-2 (]: 105 of 147 PASS not_null_fct_orders_item_count ................................. [[32mPASS[0m in 6.48s]
[0m14:56:50.264242 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m14:56:50.267035 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:56:50.269808 [info ] [Thread-2 (]: 110 of 147 START test not_null_fct_orders_ordered_at ........................... [RUN]
[0m14:56:50.277479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91, now test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9)
[0m14:56:50.280481 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:56:50.313340 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m14:56:50.327971 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:56:50.352830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:50.359494 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m14:56:50.433475 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
[0m14:56:50.437177 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:50.439892 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:50.714558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cd90fc38-6ecd-4504-bd0c-dfbfe5228dcb&page=queryresults
[0m14:56:50.935669 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9f067e38-3050-47b2-871d-99106ac4187d&page=queryresults
[0m14:56:51.261034 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e1d66012-e0eb-45cb-a945-6cb98d7c224f&page=queryresults
[0m14:56:52.032717 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
[0m14:56:52.043330 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:52.342585 [info ] [Thread-4 (]: 107 of 147 PASS not_null_fct_orders_order_id ................................... [[32mPASS[0m in 6.16s]
[0m14:56:52.351586 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m14:56:52.360421 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:56:52.367429 [info ] [Thread-4 (]: 111 of 147 START test not_null_fct_orders_primary_category ..................... [RUN]
[0m14:56:52.381481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67)
[0m14:56:52.382489 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:56:52.427358 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m14:56:52.432054 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:56:52.453953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:52.543229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dbad5882-9118-4d7d-b009-462cdbe450c9&page=queryresults
[0m14:56:52.694581 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m14:56:52.711104 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:53.090135 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m14:56:53.101393 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:53.274660 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:be90fd92-4379-45e2-a718-6bc82e746dca&page=queryresults
[0m14:56:53.925276 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
[0m14:56:53.937373 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:54.162908 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ec2ed3c4-e737-463d-8353-7efe49721d8b&page=queryresults
[0m14:56:54.491593 [info ] [Thread-1 (]: 108 of 147 PASS not_null_fct_orders_order_status ............................... [[32mPASS[0m in 5.79s]
[0m14:56:54.496591 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m14:56:54.499954 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:56:54.510852 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m14:56:54.500989 [info ] [Thread-1 (]: 112 of 147 START test not_null_fct_orders_primary_category_group ............... [RUN]
[0m14:56:54.522046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b, now test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed)
[0m14:56:54.534040 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:54.524036 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:56:54.592417 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m14:56:54.600369 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:56:54.615241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:55.179283 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:63eb54e8-1a5c-47f0-8c54-9b52b151e9a8&page=queryresults
[0m14:56:55.190255 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:448d9aed-b5dd-4a2d-bd37-7b4ea31eff57&page=queryresults
[0m14:56:55.607296 [info ] [Thread-3 (]: 109 of 147 PASS not_null_fct_orders_order_total ................................ [[32mPASS[0m in 6.39s]
[0m14:56:55.622614 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m14:56:55.625607 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:56:55.626603 [info ] [Thread-3 (]: 113 of 147 START test not_null_fct_orders_subtotal ............................. [RUN]
[0m14:56:55.631022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6, now test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0)
[0m14:56:55.633017 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:56:55.662821 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m14:56:55.673194 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:56:55.680445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:56:56.156111 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
[0m14:56:56.160062 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:56.482658 [info ] [Thread-2 (]: 110 of 147 PASS not_null_fct_orders_ordered_at ................................. [[32mPASS[0m in 6.21s]
[0m14:56:56.492232 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m14:56:56.495532 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:56:56.496530 [info ] [Thread-2 (]: 114 of 147 START test not_null_fct_orders_unique_products ...................... [RUN]
[0m14:56:56.502135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9, now test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7)
[0m14:56:56.507647 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:56:56.544558 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m14:56:56.559152 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:56:56.574566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:56:56.799331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f8c42562-901c-4f73-968e-cb057f9ad44c&page=queryresults
[0m14:56:57.357827 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m14:56:57.365165 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:58.198914 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
[0m14:56:58.209355 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:570ad56f-96bb-47cd-9403-9cad9cbac8ba&page=queryresults
[0m14:56:58.213595 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where unique_products is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:59.111104 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
[0m14:56:59.118521 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m14:56:59.126508 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2d6c540c-b0c8-4120-a605-caf6a5c6c48b&page=queryresults
[0m14:56:59.129890 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:56:59.158830 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:56:59.526222 [info ] [Thread-4 (]: 111 of 147 PASS not_null_fct_orders_primary_category ........................... [[32mPASS[0m in 7.15s]
[0m14:56:59.541174 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m14:56:59.546991 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:56:59.550833 [info ] [Thread-4 (]: 115 of 147 START test unique_fct_orders_order_id ............................... [RUN]
[0m14:56:59.558215 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67, now test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5)
[0m14:56:59.563688 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:56:59.609216 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m14:56:59.615502 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:56:59.647448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:56:59.740882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fe096b86-6ef0-4a0d-9ad0-f8b593ec7518&page=queryresults
[0m14:56:59.822572 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c8ed63e3-31a0-4ab1-9838-978229a6add5&page=queryresults
[0m14:57:00.859863 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
[0m14:57:00.872703 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:00.874883 [info ] [Thread-1 (]: 112 of 147 PASS not_null_fct_orders_primary_category_group ..................... [[32mPASS[0m in 6.35s]
[0m14:57:00.893879 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m14:57:00.897132 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:57:00.897132 [info ] [Thread-1 (]: 119 of 147 START test accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m14:57:00.906720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213)
[0m14:57:00.912282 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:57:00.947565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m14:57:00.959242 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:57:00.975164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:01.450994 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m14:57:01.463589 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cf027d85-ee43-47ae-b02e-015ca0333fc8&page=queryresults
[0m14:57:01.471154 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:02.039841 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:16f49754-c3d4-4f99-b765-7490c991682e&page=queryresults
[0m14:57:02.064704 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m14:57:02.069102 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:02.906502 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2dc536e7-9376-4808-ae02-c62d2fba097d&page=queryresults
[0m14:57:03.547007 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
[0m14:57:03.558695 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:03.864613 [info ] [Thread-2 (]: 114 of 147 PASS not_null_fct_orders_unique_products ............................ [[32mPASS[0m in 7.36s]
[0m14:57:03.870986 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m14:57:03.874846 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:57:03.878417 [info ] [Thread-2 (]: 120 of 147 START test accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [RUN]
[0m14:57:03.885425 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0)
[0m14:57:03.895024 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m14:57:03.898263 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:57:03.905559 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:03.956370 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m14:57:03.974747 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:57:03.990135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:04.125750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d0c10668-909d-4756-9216-6b4e333cfab8&page=queryresults
[0m14:57:04.250914 [info ] [Thread-3 (]: 113 of 147 PASS not_null_fct_orders_subtotal ................................... [[32mPASS[0m in 8.62s]
[0m14:57:04.257704 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m14:57:04.261049 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:57:04.265841 [info ] [Thread-3 (]: 121 of 147 START test accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [RUN]
[0m14:57:04.271649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0, now test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09)
[0m14:57:04.278471 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:57:04.333624 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m14:57:04.345530 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:57:04.370871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:04.517229 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:50161fa1-fea7-4650-9a5c-4fae32475a2e&page=queryresults
[0m14:57:05.415850 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
[0m14:57:05.440556 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'VIP','High Value','Medium Value','Low Value','No Orders'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:05.776346 [info ] [Thread-4 (]: 115 of 147 PASS unique_fct_orders_order_id ..................................... [[32mPASS[0m in 6.22s]
[0m14:57:05.794058 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m14:57:05.805068 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:57:05.811536 [info ] [Thread-4 (]: 122 of 147 START test assert_vip_customer_criteria ............................. [RUN]
[0m14:57:05.816416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_advanced_olist.assert_vip_customer_criteria)
[0m14:57:05.822609 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:57:05.860804 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m14:57:05.866685 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:57:05.890635 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:06.014214 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1db0d282-8d01-4cd5-baca-6c8cc3a62d18&page=queryresults
[0m14:57:06.191336 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m14:57:06.198250 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:06.612915 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
[0m14:57:06.618073 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        purchase_frequency as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by purchase_frequency

)

select *
from all_values
where value_field not in (
    'Frequent','Repeat','One-Time','Never Purchased'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:07.016038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e9c2947b-c2dc-40f8-9501-0be912c79223&page=queryresults
[0m14:57:07.290392 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a6ef398e-d5d5-4236-a3c1-fc91b2a5e526&page=queryresults
[0m14:57:08.080028 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m14:57:08.093289 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
[0m14:57:08.099475 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:08.106170 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_vip_customer_criteria
  
  Purpose: VIP customers must meet the defined criteria
  
  Business Rule: VIP = lifetime_revenue >= 500 AND lifetime_orders >= 3
  
  Test PASSES if query returns 0 rows
*/

with vip_customers as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where customer_segment = 'VIP'
),

invalid_vips as (
    select
        customer_id,
        lifetime_revenue,
        lifetime_orders,
        'VIP but does not meet criteria' as violation
    from vip_customers
    where lifetime_revenue < 500
       or lifetime_orders < 3
),

should_be_vips as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders,
        'Should be VIP but is not' as violation
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where lifetime_revenue >= 500
      and lifetime_orders >= 3
      and customer_segment != 'VIP'
)

select * from invalid_vips
union all
select customer_id, lifetime_revenue, lifetime_orders, violation from should_be_vips
  
  
    )
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:08.631770 [info ] [Thread-1 (]: 119 of 147 PASS accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 7.73s]
[0m14:57:08.643648 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m14:57:08.647043 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9ba61e01-775a-4e0b-a4ef-91e9ffee5e07&page=queryresults
[0m14:57:08.651926 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:57:08.667329 [info ] [Thread-1 (]: 123 of 147 START test dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [RUN]
[0m14:57:08.679377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d)
[0m14:57:08.684470 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:57:08.722710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m14:57:08.733055 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:57:08.765918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:08.853398 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d78bd72a-3061-471f-8f16-8f260b86901c&page=queryresults
[0m14:57:09.190382 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m14:57:09.192441 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:09.752564 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c167da2-9f02-4b81-a125-8245f06edff4&page=queryresults
[0m14:57:10.342200 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
[0m14:57:10.331361 [info ] [Thread-2 (]: 120 of 147 PASS accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [[32mPASS[0m in 6.45s]
[0m14:57:10.355336 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:10.364503 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m14:57:10.379129 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:57:10.382108 [info ] [Thread-2 (]: 124 of 147 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [RUN]
[0m14:57:10.391082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9)
[0m14:57:10.394417 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:57:10.428242 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m14:57:10.452093 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:57:10.470494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:10.821632 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m14:57:10.829390 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:10.872993 [info ] [Thread-3 (]: 121 of 147 PASS accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [[32mPASS[0m in 6.60s]
[0m14:57:10.881549 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m14:57:10.885911 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:57:10.888903 [info ] [Thread-3 (]: 125 of 147 START test is_not_negative_dim_customers_avg_order_value ............ [RUN]
[0m14:57:10.894441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09, now test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178)
[0m14:57:10.898899 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:57:10.940426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:00db6b27-02fe-4f29-aa17-07a48e01d193&page=queryresults
[0m14:57:10.940426 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m14:57:10.963416 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:57:10.988843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:11.474729 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c8d3406-288c-4632-bb3c-4de760db09e5&page=queryresults
[0m14:57:12.490962 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
[0m14:57:12.496533 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    avg_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:12.702820 [info ] [Thread-4 (]: 122 of 147 PASS assert_vip_customer_criteria ................................... [[32mPASS[0m in 6.89s]
[0m14:57:12.709718 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m14:57:12.709718 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:57:12.717165 [info ] [Thread-4 (]: 126 of 147 START test is_not_negative_dim_customers_customer_lifespan_days ..... [RUN]
[0m14:57:12.722888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_vip_customer_criteria, now test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e)
[0m14:57:12.726876 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:57:12.760784 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m14:57:12.772643 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:57:12.806146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:12.877391 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
[0m14:57:12.880520 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and late_delivery_rate >= 0 and late_delivery_rate <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:13.086412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m14:57:13.095292 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:13.586968 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa4f2406-3a91-403c-bc66-9b981ca83c5e&page=queryresults
[0m14:57:13.944728 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9aa863b3-fd41-4203-b8ce-b40a090848ae&page=queryresults
[0m14:57:14.127364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:641700cc-9798-4237-a4fc-01f24ee1fdf2&page=queryresults
[0m14:57:15.005879 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
[0m14:57:15.010326 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    customer_lifespan_days as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_lifespan_days < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:15.396826 [info ] [Thread-1 (]: 123 of 147 PASS dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [[32mPASS[0m in 6.72s]
[0m14:57:15.421786 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m14:57:15.429352 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:57:15.433244 [info ] [Thread-1 (]: 127 of 147 START test is_not_negative_dim_customers_late_deliveries ............ [RUN]
[0m14:57:15.443443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d, now test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a)
[0m14:57:15.444442 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:57:15.487341 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m14:57:15.496884 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:57:15.519317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:15.535896 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c8ec005-876e-4344-af33-8ecb26461104&page=queryresults
[0m14:57:15.773853 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m14:57:15.782399 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:16.040099 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m14:57:16.048126 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:16.304763 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4cce33d6-23b2-4725-9728-b3aa7bda8506&page=queryresults
[0m14:57:16.661822 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:945baab7-17a7-45c8-915d-8343632eed0b&page=queryresults
[0m14:57:16.787399 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
[0m14:57:16.794304 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    late_deliveries as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where late_deliveries < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:17.282197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cbf2c16a-1bca-41a9-86e9-64210f5e2db0&page=queryresults
[0m14:57:17.557285 [info ] [Thread-2 (]: 124 of 147 PASS dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [[32mPASS[0m in 7.17s]
[0m14:57:17.564325 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m14:57:17.571320 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m14:57:17.588520 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:57:17.595506 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:17.599737 [info ] [Thread-2 (]: 128 of 147 START test is_not_negative_dim_customers_lifetime_items ............. [RUN]
[0m14:57:17.612995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159)
[0m14:57:17.617268 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:57:17.654259 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m14:57:17.664449 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:57:17.687219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:17.670726 [info ] [Thread-3 (]: 125 of 147 PASS is_not_negative_dim_customers_avg_order_value .................. [[32mPASS[0m in 6.78s]
[0m14:57:17.696001 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m14:57:17.777345 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:57:17.780480 [info ] [Thread-3 (]: 129 of 147 START test is_not_negative_dim_customers_lifetime_orders ............ [RUN]
[0m14:57:17.783550 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8)
[0m14:57:17.786587 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:57:17.805634 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m14:57:17.808415 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:57:17.820243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:18.153709 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa09c7a9-9bfe-424f-a9a3-5008e3471dd1&page=queryresults
[0m14:57:19.072330 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
[0m14:57:19.072330 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
[0m14:57:19.088780 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_orders as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:19.095847 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_items as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:19.121925 [info ] [Thread-4 (]: 126 of 147 PASS is_not_negative_dim_customers_customer_lifespan_days ........... [[32mPASS[0m in 6.40s]
[0m14:57:19.125735 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m14:57:19.129837 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:57:19.134361 [info ] [Thread-4 (]: 130 of 147 START test is_not_negative_dim_customers_lifetime_revenue ........... [RUN]
[0m14:57:19.140414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e)
[0m14:57:19.145231 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:57:19.185782 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m14:57:19.189408 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:57:19.203141 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:19.475107 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m14:57:19.485207 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:19.545581 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e70c5b4c-840d-4e70-8d19-16a15f980dd9&page=queryresults
[0m14:57:19.560859 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7894d2a3-4a3a-4cca-afdd-6629d43a43e1&page=queryresults
[0m14:57:20.055489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2887ab95-1be9-4c43-b68f-3a093a5c9194&page=queryresults
[0m14:57:20.670949 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
[0m14:57:20.691415 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_revenue as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:21.074998 [info ] [Thread-1 (]: 127 of 147 PASS is_not_negative_dim_customers_late_deliveries .................. [[32mPASS[0m in 5.63s]
[0m14:57:21.085722 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m14:57:21.091740 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:57:21.095356 [info ] [Thread-1 (]: 131 of 147 START test is_not_negative_dim_customers_max_order_value ............ [RUN]
[0m14:57:21.100072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a, now test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c)
[0m14:57:21.111808 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:57:21.157227 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m14:57:21.169054 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:57:21.173045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:21.182418 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3b1ab604-4185-4cb1-81a4-c20ded4a3029&page=queryresults
[0m14:57:22.157470 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m14:57:22.163248 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m14:57:22.174834 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:22.179867 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:22.712492 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:da94e178-6ff7-4261-9b4b-150cdb483f4b&page=queryresults
[0m14:57:22.739437 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:70f8127f-6d30-4f5a-a18d-2e57c02a301d&page=queryresults
[0m14:57:23.302827 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
[0m14:57:23.322414 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    max_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:23.672889 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m14:57:23.703986 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:23.873441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b41b0d6e-dd5b-4c9e-98d2-d8335283c960&page=queryresults
[0m14:57:24.023571 [info ] [Thread-3 (]: 129 of 147 PASS is_not_negative_dim_customers_lifetime_orders .................. [[32mPASS[0m in 6.24s]
[0m14:57:24.028798 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m14:57:24.034868 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:57:24.044715 [info ] [Thread-3 (]: 132 of 147 START test not_null_dim_customers_avg_order_value ................... [RUN]
[0m14:57:24.056574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8, now test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843)
[0m14:57:24.052867 [info ] [Thread-2 (]: 128 of 147 PASS is_not_negative_dim_customers_lifetime_items ................... [[32mPASS[0m in 6.44s]
[0m14:57:24.072885 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m14:57:24.063118 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:57:24.076120 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:57:24.101819 [info ] [Thread-2 (]: 133 of 147 START test not_null_dim_customers_customer_city ..................... [RUN]
[0m14:57:24.128499 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m14:57:24.129705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159, now test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d)
[0m14:57:24.137400 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:57:24.140618 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:57:24.154285 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:24.170173 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m14:57:24.243459 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5f68dba5-2934-46e7-a62d-c32be96cecf0&page=queryresults
[0m14:57:24.246858 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:57:24.252320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:25.282322 [info ] [Thread-4 (]: 130 of 147 PASS is_not_negative_dim_customers_lifetime_revenue ................. [[32mPASS[0m in 6.14s]
[0m14:57:25.290261 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m14:57:25.294859 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:57:25.296654 [info ] [Thread-4 (]: 134 of 147 START test not_null_dim_customers_customer_id ....................... [RUN]
[0m14:57:25.303715 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e, now test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m14:57:25.307169 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:57:25.342019 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:57:25.350795 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:57:25.384470 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:25.565683 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
[0m14:57:25.570781 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:26.003970 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:25fa4362-e091-416f-8a51-5c6f6bcabf18&page=queryresults
[0m14:57:26.736195 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m14:57:26.744883 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:27.078518 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
[0m14:57:27.084777 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:27.676328 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ef087ed3-9551-4c3f-85b8-ef63f1a4f1db&page=queryresults
[0m14:57:27.821557 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
[0m14:57:27.835313 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:27.934667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1bf0a6a5-a07a-4c89-804c-eff92cf5c972&page=queryresults
[0m14:57:28.187646 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m14:57:28.195349 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:28.312510 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:69bc6751-bcd3-4f73-bfcf-1ca476245a74&page=queryresults
[0m14:57:28.674656 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c958e7e1-0360-4e25-bfc8-2935a46a39e7&page=queryresults
[0m14:57:28.974455 [info ] [Thread-1 (]: 131 of 147 PASS is_not_negative_dim_customers_max_order_value .................. [[32mPASS[0m in 7.87s]
[0m14:57:28.982667 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m14:57:28.990511 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:57:29.004528 [info ] [Thread-1 (]: 135 of 147 START test not_null_dim_customers_customer_key ...................... [RUN]
[0m14:57:29.008579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c, now test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411)
[0m14:57:29.008579 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:57:29.052550 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m14:57:29.076880 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:57:29.101849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:29.419544 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m14:57:29.432126 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:29.742155 [info ] [Thread-3 (]: 132 of 147 PASS not_null_dim_customers_avg_order_value ......................... [[32mPASS[0m in 5.69s]
[0m14:57:29.758252 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m14:57:29.764885 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:57:29.770987 [info ] [Thread-3 (]: 136 of 147 START test not_null_dim_customers_customer_region ................... [RUN]
[0m14:57:29.777831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843, now test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2)
[0m14:57:29.783818 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:57:29.839203 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m14:57:29.848275 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:57:29.867461 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:30.101121 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3ee9467d-70ab-4029-8ef5-5295191d129f&page=queryresults
[0m14:57:30.471361 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
[0m14:57:30.484390 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:30.502025 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m14:57:30.535805 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:31.039067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e6920030-fa67-429f-8854-615f07b01d15&page=queryresults
[0m14:57:31.227045 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5011dd21-f4dd-4356-b8ad-036ea674a99d&page=queryresults
[0m14:57:31.245036 [info ] [Thread-2 (]: 133 of 147 PASS not_null_dim_customers_customer_city ........................... [[32mPASS[0m in 7.11s]
[0m14:57:31.255425 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m14:57:31.260235 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:57:31.267033 [info ] [Thread-2 (]: 137 of 147 START test not_null_dim_customers_customer_segment .................. [RUN]
[0m14:57:31.274722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d, now test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m14:57:31.275762 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:57:31.318638 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
[0m14:57:31.321630 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m14:57:31.334873 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:31.359624 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:57:31.385059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:31.998677 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:97c7af05-7d85-4cd3-a656-db377251ea57&page=queryresults
[0m14:57:32.377734 [info ] [Thread-4 (]: 134 of 147 PASS not_null_dim_customers_customer_id ............................. [[32mPASS[0m in 7.08s]
[0m14:57:32.391202 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m14:57:32.397659 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:57:32.403864 [info ] [Thread-4 (]: 138 of 147 START test not_null_dim_customers_customer_state .................... [RUN]
[0m14:57:32.409496 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa)
[0m14:57:32.416997 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:57:32.471156 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m14:57:32.500878 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:57:32.518550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:33.282957 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m14:57:33.308504 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:33.375778 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
[0m14:57:33.385431 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_segment is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:33.909776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9fe3871f-8eab-435c-b86e-bc826126691d&page=queryresults
[0m14:57:34.102244 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m14:57:34.123466 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:34.886641 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:126d5a78-4ce2-4529-9874-fb00d96951eb&page=queryresults
[0m14:57:34.891643 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6561eb85-5ead-412a-832e-f4c294f64d53&page=queryresults
[0m14:57:34.923882 [info ] [Thread-1 (]: 135 of 147 PASS not_null_dim_customers_customer_key ............................ [[32mPASS[0m in 5.92s]
[0m14:57:34.931512 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m14:57:34.935797 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:57:34.937810 [info ] [Thread-1 (]: 139 of 147 START test not_null_dim_customers_customer_unique_id ................ [RUN]
[0m14:57:34.942265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m14:57:34.954725 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:57:34.986305 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m14:57:35.003727 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:57:35.034722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:35.553697 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
[0m14:57:35.569193 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:35.876127 [info ] [Thread-3 (]: 136 of 147 PASS not_null_dim_customers_customer_region ......................... [[32mPASS[0m in 6.09s]
[0m14:57:35.889219 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m14:57:35.894586 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:57:35.902201 [info ] [Thread-3 (]: 140 of 147 START test not_null_dim_customers_lifetime_items .................... [RUN]
[0m14:57:35.908797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a)
[0m14:57:35.911776 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:57:35.955933 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m14:57:35.968559 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:57:36.001234 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:36.101877 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c027c307-88aa-435c-9dad-687941d4a3ee&page=queryresults
[0m14:57:36.385514 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
[0m14:57:36.385514 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:37.020858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f16c16c-cd00-4a96-8c67-99e8171182bc&page=queryresults
[0m14:57:37.071393 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m14:57:37.091850 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:37.636087 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:45edb9e7-bb5d-442b-90d1-c9464e40d71e&page=queryresults
[0m14:57:37.997603 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
[0m14:57:37.998601 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:38.639441 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m14:57:38.643898 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:51c2658b-35f4-4d5f-8864-52ab7f5543d2&page=queryresults
[0m14:57:38.652718 [info ] [Thread-2 (]: 137 of 147 PASS not_null_dim_customers_customer_segment ........................ [[32mPASS[0m in 7.38s]
[0m14:57:38.664758 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:38.672186 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m14:57:38.687246 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:57:38.690575 [info ] [Thread-2 (]: 141 of 147 START test not_null_dim_customers_lifetime_orders ................... [RUN]
[0m14:57:38.696048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m14:57:38.703387 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:57:38.744577 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m14:57:38.752911 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:57:38.770538 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:39.102311 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m14:57:39.109214 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:39.204489 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c5c83b8-fefe-4151-8fce-059e58c993a2&page=queryresults
[0m14:57:40.074246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:dd8dab52-0bda-4f23-8bf3-a05d82d8308b&page=queryresults
[0m14:57:40.102410 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
[0m14:57:40.105132 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:40.305627 [info ] [Thread-4 (]: 138 of 147 PASS not_null_dim_customers_customer_state .......................... [[32mPASS[0m in 7.89s]
[0m14:57:40.312775 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m14:57:40.320058 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:57:40.327932 [info ] [Thread-4 (]: 142 of 147 START test not_null_dim_customers_lifetime_revenue .................. [RUN]
[0m14:57:40.336215 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105)
[0m14:57:40.342158 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:57:40.393807 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m14:57:40.402638 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:57:40.406719 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:40.536070 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:83149e03-bfc6-4763-9f97-d7729ce585f3&page=queryresults
[0m14:57:41.505813 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m14:57:41.515757 [info ] [Thread-1 (]: 139 of 147 PASS not_null_dim_customers_customer_unique_id ...................... [[32mPASS[0m in 6.57s]
[0m14:57:41.523401 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m14:57:41.526255 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:57:41.532551 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:41.538268 [info ] [Thread-1 (]: 143 of 147 START test not_null_dim_customers_max_order_value ................... [RUN]
[0m14:57:41.550756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8)
[0m14:57:41.558963 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:57:41.600856 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m14:57:41.603359 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:57:41.614474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:42.115782 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:91e22296-3f37-448f-92ae-ee5789ffc6e8&page=queryresults
[0m14:57:42.324752 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m14:57:42.330381 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:42.733218 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
[0m14:57:42.740893 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:42.833523 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:75500110-559a-4622-acd0-d7b086977f4d&page=queryresults
[0m14:57:43.515497 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
[0m14:57:43.520343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8eff69e5-23b4-4e6f-a588-d2662f3d12b6&page=queryresults
[0m14:57:43.535658 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:43.539015 [info ] [Thread-3 (]: 140 of 147 PASS not_null_dim_customers_lifetime_items .......................... [[32mPASS[0m in 7.63s]
[0m14:57:43.559237 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m14:57:43.567135 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:57:43.570893 [info ] [Thread-3 (]: 144 of 147 START test not_null_dim_customers_purchase_frequency ................ [RUN]
[0m14:57:43.574775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a, now test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093)
[0m14:57:43.577942 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:57:43.618396 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m14:57:43.623656 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:57:43.648569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:57:44.066474 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:805eca8e-a9ff-4de6-b6db-ccca6405fa18&page=queryresults
[0m14:57:44.674473 [info ] [Thread-2 (]: 141 of 147 PASS not_null_dim_customers_lifetime_orders ......................... [[32mPASS[0m in 5.98s]
[0m14:57:44.680575 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m14:57:44.682748 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:57:44.683747 [info ] [Thread-2 (]: 145 of 147 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m14:57:44.684880 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m14:57:44.687029 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:57:44.699162 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:57:44.704870 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:57:44.716014 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:57:45.327679 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m14:57:45.350737 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:45.850046 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
[0m14:57:45.857573 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:45.863454 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c38510e5-d531-473b-8514-bb8c9276de10&page=queryresults
[0m14:57:46.318139 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
[0m14:57:46.328550 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m14:57:46.340745 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b89aaea9-ddf8-4880-9219-dfb0478a5495&page=queryresults
[0m14:57:46.352321 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where purchase_frequency is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:46.375965 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:46.933218 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1885ac34-f033-47d0-81cb-2aa48aaefe4d&page=queryresults
[0m14:57:46.968429 [info ] [Thread-1 (]: 143 of 147 PASS not_null_dim_customers_max_order_value ......................... [[32mPASS[0m in 5.42s]
[0m14:57:46.975292 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m14:57:46.986839 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:57:46.993085 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:de8b727f-e220-4acb-8835-b7086bf3ffc3&page=queryresults
[0m14:57:47.000223 [info ] [Thread-1 (]: 146 of 147 START test unique_dim_customers_customer_id ......................... [RUN]
[0m14:57:47.023892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8, now test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd)
[0m14:57:47.027082 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:57:47.044908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:57:47.050718 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:57:47.063615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:47.913388 [info ] [Thread-4 (]: 142 of 147 PASS not_null_dim_customers_lifetime_revenue ........................ [[32mPASS[0m in 7.58s]
[0m14:57:47.920051 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m14:57:47.920051 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:57:47.927094 [info ] [Thread-4 (]: 147 of 147 START test unique_dim_customers_customer_key ........................ [RUN]
[0m14:57:47.933066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105, now test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e)
[0m14:57:47.946274 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:57:48.001911 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m14:57:48.014630 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:57:48.021360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:57:48.073230 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
[0m14:57:48.076811 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:48.298117 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m14:57:48.312236 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:48.589620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b31a6f68-6bd6-4f74-b864-4e38b7ce8750&page=queryresults
[0m14:57:48.838111 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:22ab6a71-a315-4f73-bd98-a9775de1a0e6&page=queryresults
[0m14:57:49.064248 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m14:57:49.072753 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:49.181796 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
[0m14:57:49.188317 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m14:57:49.633238 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0a2232df-7b41-4553-8c67-26be706ec85b&page=queryresults
[0m14:57:49.655250 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8ef5dcfd-cf5c-4ed1-a649-3da7d98c80f1&page=queryresults
[0m14:57:50.015197 [info ] [Thread-2 (]: 145 of 147 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 5.33s]
[0m14:57:50.026134 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m14:57:50.671388 [info ] [Thread-3 (]: 144 of 147 PASS not_null_dim_customers_purchase_frequency ...................... [[32mPASS[0m in 7.10s]
[0m14:57:50.681491 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m14:57:50.696995 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m14:57:50.706428 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:57:51.234889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f7b03dbb-c78e-454f-9779-1d18d72d85c3&page=queryresults
[0m14:57:52.367591 [info ] [Thread-1 (]: 146 of 147 PASS unique_dim_customers_customer_id ............................... [[32mPASS[0m in 5.34s]
[0m14:57:52.377511 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m14:58:47.043434 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m14:58:47.054791 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m14:58:47.754848 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ef7162b9-71a3-4419-8cff-aa9e4e2334a1&page=queryresults
[0m14:58:48.989848 [info ] [Thread-4 (]: 147 of 147 PASS unique_dim_customers_customer_key .............................. [[32mPASS[0m in 61.06s]
[0m14:58:48.997476 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m14:58:49.010026 [info ] [MainThread]: 
[0m14:58:49.119519 [info ] [MainThread]: ============================================================
[0m14:58:49.129630 [info ] [MainThread]: DBT RUN COMPLETED
[0m14:58:49.134573 [info ] [MainThread]: Success: 12
[0m14:58:49.138404 [info ] [MainThread]: Errors: 0
[0m14:58:49.142813 [info ] [MainThread]: Skipped: 0
[0m14:58:49.146641 [info ] [MainThread]: Total: 147
[0m14:58:49.154595 [info ] [MainThread]: ============================================================
[0m14:58:49.157101 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m14:58:49.164006 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m14:58:49.173033 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.15s]
[0m14:58:49.176532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:49.189756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:49.191835 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:58:49.193847 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:58:49.195707 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:58:49.196705 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m14:58:49.204382 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m14:58:49.206604 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m14:58:49.207712 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m14:58:49.209546 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m14:58:49.210585 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m14:58:49.212382 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m14:58:49.213409 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093' was properly closed.
[0m14:58:49.214680 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e' was properly closed.
[0m14:58:49.235684 [info ] [MainThread]: 
[0m14:58:49.243999 [info ] [MainThread]: Finished running 2 project hooks, 2 seeds, 3 table models, 132 data tests, 3 unit tests, 7 view models in 0 hours 5 minutes and 47.91 seconds (347.91s).
[0m14:58:49.336326 [debug] [MainThread]: Command end result
[0m14:58:49.507148 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m14:58:49.511867 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m14:58:49.565131 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m14:58:49.567125 [info ] [MainThread]: 
[0m14:58:49.569121 [info ] [MainThread]: [33mCompleted with 5 warnings:[0m
[0m14:58:49.570363 [info ] [MainThread]: 
[0m14:58:49.571933 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models\staging\_staging.yml)[0m
[0m14:58:49.574671 [warn ] [MainThread]: Got 642 results, configured to warn if != 0
[0m14:58:49.576832 [info ] [MainThread]: 
[0m14:58:49.578007 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f.sql
[0m14:58:49.583291 [info ] [MainThread]: 
[0m14:58:49.586507 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m14:58:49.591138 [info ] [MainThread]: 
[0m14:58:49.592137 [warn ] [MainThread]: [33mWarning in test assert_orders_have_items (tests\singular\assert_orders_have_items.sql)[0m
[0m14:58:49.594130 [warn ] [MainThread]: Got 890 results, configured to warn if != 0
[0m14:58:49.595126 [info ] [MainThread]: 
[0m14:58:49.596639 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\tests\singular\assert_orders_have_items.sql
[0m14:58:49.603181 [info ] [MainThread]: 
[0m14:58:49.605728 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
  --------------------------------------------------------------------------------------------------
[0m14:58:49.608935 [info ] [MainThread]: 
[0m14:58:49.611295 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models\staging\_staging.yml)[0m
[0m14:58:49.711321 [warn ] [MainThread]: Got 862 results, configured to warn if != 0
[0m14:58:49.750529 [info ] [MainThread]: 
[0m14:58:49.757387 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0.sql
[0m14:58:49.759677 [info ] [MainThread]: 
[0m14:58:49.760676 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m14:58:49.763981 [info ] [MainThread]: 
[0m14:58:49.768549 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\staging\_staging.yml)[0m
[0m14:58:49.771065 [warn ] [MainThread]: Got 902 results, configured to warn if != 0
[0m14:58:49.805921 [info ] [MainThread]: 
[0m14:58:49.808984 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m14:58:49.810490 [info ] [MainThread]: 
[0m14:58:49.812557 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
  -----------------------------------------------------------------------------------------------------------------------------------
[0m14:58:49.818390 [info ] [MainThread]: 
[0m14:58:49.821016 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null (models\staging\_staging.yml)[0m
[0m14:58:49.823010 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m14:58:49.824136 [info ] [MainThread]: 
[0m14:58:49.826525 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43.sql
[0m14:58:49.827515 [info ] [MainThread]: 
[0m14:58:49.830185 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
  -----------------------------------------------------------------------------------------------------------------------------------------
[0m14:58:49.835382 [info ] [MainThread]: 
[0m14:58:49.836664 [info ] [MainThread]: Done. PASS=144 WARN=5 ERROR=0 SKIP=0 NO-OP=0 TOTAL=149
[0m14:58:49.842141 [debug] [MainThread]: Command `dbt build` succeeded at 14:58:49.842141 after 476.95 seconds
[0m14:58:49.842990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9F1F5D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ED42BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ED4341D0>]}
[0m14:58:49.845032 [debug] [MainThread]: Flushing usage events
[0m14:58:51.702834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:27.928130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026641AF7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026641AF6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026641AF7410>]}


============================== 15:01:28.128842 | d2e9ed48-cf0d-43b6-bf5b-93d974c2ed95 ==============================
[0m15:01:28.128842 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:01:28.142644 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt ls --select state:modified+ --state prod-artifacts/', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m15:02:22.379030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e9ed48-cf0d-43b6-bf5b-93d974c2ed95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026657507290>]}
[0m15:02:22.569821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e9ed48-cf0d-43b6-bf5b-93d974c2ed95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663D2E4C50>]}
[0m15:02:22.571762 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:02:25.460686 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:02:29.479395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:29.479395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:29.760512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e9ed48-cf0d-43b6-bf5b-93d974c2ed95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026657554FD0>]}
[0m15:02:30.183796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:02:30.188371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:02:30.791389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e9ed48-cf0d-43b6-bf5b-93d974c2ed95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026657E749D0>]}
[0m15:02:30.792416 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m15:02:30.795113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e9ed48-cf0d-43b6-bf5b-93d974c2ed95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026657E4F4D0>]}
[0m15:02:30.796139 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m15:02:30.805319 [warn ] [MainThread]: No nodes selected!
[0m15:02:30.813964 [debug] [MainThread]: Command `dbt ls` succeeded at 15:02:30.811891 after 63.58 seconds
[0m15:02:30.816360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026641ADE0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026641B5F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266418F1150>]}
[0m15:02:30.817387 [debug] [MainThread]: Flushing usage events
[0m15:02:32.521383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:11.322391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4F6F4B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4F6F7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4F6F7390>]}


============================== 15:04:11.327338 | c0d88e00-b776-4bee-8f62-632d7c4ede76 ==============================
[0m15:04:11.327338 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:04:11.330196 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt build --select state:modified+ --state prod-artifacts/', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m15:04:18.678412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d88e00-b776-4bee-8f62-632d7c4ede76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD652C1F90>]}
[0m15:04:18.806497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0d88e00-b776-4bee-8f62-632d7c4ede76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4ADE4210>]}
[0m15:04:18.814072 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:04:20.369870 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:04:21.137294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:21.137294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:21.345065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0d88e00-b776-4bee-8f62-632d7c4ede76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD65C5F050>]}
[0m15:04:21.789424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:04:21.793870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:04:22.150806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0d88e00-b776-4bee-8f62-632d7c4ede76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD65D0B3D0>]}
[0m15:04:22.153846 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m15:04:22.157298 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m15:04:22.179613 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m15:04:22.190378 [warn ] [MainThread]: The selection criterion 'state:modified+' does not match any enabled nodes
[0m15:04:22.194055 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:04:22.197334 [debug] [MainThread]: Command end result
[0m15:04:22.368095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:04:22.373740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:04:22.380182 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m15:04:22.381210 [debug] [MainThread]: Command `dbt build` succeeded at 15:04:22.381210 after 11.20 seconds
[0m15:04:22.384432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4F75D150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD49734110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD49734410>]}
[0m15:04:22.386549 [debug] [MainThread]: Flushing usage events
[0m15:04:24.956508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:27.108627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C54DF70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C54DF5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C54DF6050>]}


============================== 15:21:27.208982 | f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e ==============================
[0m15:21:27.208982 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:21:27.216469 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m15:22:36.670958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6A671390>]}
[0m15:22:36.813494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C504CAD90>]}
[0m15:22:36.818537 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:22:39.383376 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:22:42.577933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:42.581626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:42.802327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6B3FAB90>]}
[0m15:22:43.298952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:22:43.303290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:22:44.754098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6B791490>]}
[0m15:22:44.754098 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m15:22:44.804845 [info ] [MainThread]: 
[0m15:22:44.807679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:44.811555 [info ] [MainThread]: 
[0m15:22:44.813937 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:22:44.856205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m15:22:44.857995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m15:22:44.863734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:44.864730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m15:22:44.866318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:44.867298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m15:22:44.868460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:44.870454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.712032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:48.712032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:50.441639 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m15:22:50.443855 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m15:22:50.446262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:50.447753 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m15:22:50.449752 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m15:22:50.451368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:50.521885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:50.525397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:51.902623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_staging, now list_big-query-dbt-481111_dbt_dev_yourname_intermediate)
[0m15:22:51.903666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_marts, now list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit)
[0m15:22:51.917338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:51.920453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:53.536931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6B6A6410>]}
[0m15:22:53.865755 [info ] [MainThread]: ============================================================
[0m15:22:54.461222 [info ] [MainThread]: DBT RUN STARTED
[0m15:22:54.468978 [info ] [MainThread]: Target: dev
[0m15:22:54.476768 [info ] [MainThread]: Project: dbt_advanced_olist
[0m15:22:54.483373 [info ] [MainThread]: Time: 2025-12-24 15:22:54
[0m15:22:54.486313 [info ] [MainThread]: ============================================================
[0m15:22:54.489266 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m15:22:54.495790 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m15:22:54.505505 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.97s]
[0m15:22:54.512258 [info ] [MainThread]: 
[0m15:22:54.513917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:56.669134 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m15:22:56.670179 [debug] [Thread-2 (]: Began running node seed.dbt_advanced_olist.brazilian_states
[0m15:22:56.675208 [debug] [Thread-3 (]: Began running node seed.dbt_advanced_olist.order_status_codes
[0m15:22:56.677875 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m15:22:56.678922 [info ] [Thread-1 (]: 1 of 148 START sql table model dbt_dev_yourname_marts.dim_date ................. [RUN]
[0m15:22:56.683769 [info ] [Thread-2 (]: 2 of 148 START seed file dbt_dev_yourname_seeds.brazilian_states ............... [RUN]
[0m15:22:56.687040 [info ] [Thread-3 (]: 3 of 148 START seed file dbt_dev_yourname_seeds.order_status_codes ............. [RUN]
[0m15:22:56.697890 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m15:22:56.693539 [info ] [Thread-4 (]: 4 of 148 START test dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [RUN]
[0m15:22:56.703163 [debug] [Thread-2 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.brazilian_states'
[0m15:22:56.707431 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_advanced_olist.order_status_codes'
[0m15:22:56.710877 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m15:22:56.718109 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0'
[0m15:22:56.721084 [debug] [Thread-2 (]: Began compiling node seed.dbt_advanced_olist.brazilian_states
[0m15:22:56.726781 [debug] [Thread-3 (]: Began compiling node seed.dbt_advanced_olist.order_status_codes
[0m15:22:56.793813 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m15:22:56.829138 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m15:22:56.834050 [debug] [Thread-2 (]: Began executing node seed.dbt_advanced_olist.brazilian_states
[0m15:22:56.835310 [debug] [Thread-3 (]: Began executing node seed.dbt_advanced_olist.order_status_codes
[0m15:22:56.878313 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m15:22:56.878313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:57.120883 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m15:22:57.190621 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:22:58.552952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e93107f4-0e65-4b84-b826-5e7728d16848&page=queryresults
[0m15:22:59.553267 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
[0m15:22:59.682576 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`raw_olist`.`customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:00.275842 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cf964964-23f1-4ff9-901a-5b5051c5ea69&page=queryresults
[0m15:23:02.290865 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:23:02.289868 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:02.574336 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0"
[0m15:23:02.676768 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_780c54815c04e3900f5557060f755bd0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:02.973978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m15:23:02.978786 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m15:23:03.278971 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8fdf968-3f7c-46ef-98c3-7c3855413b2f&page=queryresults
[0m15:23:03.380768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m15:23:03.395165 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(date_key, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m15:23:04.026166 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cc922d4d-8415-4262-bafe-b6592492957c&page=queryresults
[0m15:23:04.441266 [info ] [Thread-4 (]: 4 of 148 PASS dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2  [[32mPASS[0m in 7.72s]
[0m15:23:04.447955 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0
[0m15:23:04.451548 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m15:23:04.457595 [info ] [Thread-4 (]: 5 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [RUN]
[0m15:23:04.470001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_value_lengths_to_equal_raw_olist_customers_customer_state__2.85f448feb0, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb)
[0m15:23:04.479578 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m15:23:04.563300 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m15:23:04.603834 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m15:23:04.611148 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:05.930994 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
[0m15:23:05.940198 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and freight_value >= 0 and freight_value <= 1000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:06.691363 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5c769c64-a22c-4c93-9b64-4d43477fe63b&page=queryresults
[0m15:23:08.022957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6BEF5190>]}
[0m15:23:08.028131 [info ] [Thread-1 (]: 1 of 148 OK created sql table model dbt_dev_yourname_marts.dim_date ............ [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 11.25s]
[0m15:23:08.031406 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m15:23:08.035821 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m15:23:08.042388 [info ] [Thread-1 (]: 6 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [RUN]
[0m15:23:08.047279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_date, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d)
[0m15:23:08.048322 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m15:23:08.084350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m15:23:08.099301 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m15:23:08.135160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:08.238926 [debug] [Thread-2 (]: On seed.dbt_advanced_olist.brazilian_states: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states` set OPTIONS()
/* dbt 1.10.15 | model: brazilian_states | schema: dbt_dev_yourname_seeds */
[0m15:23:08.800627 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:90d07ed7-1106-4e12-87e6-23e68ffa1118&page=queryresults
[0m15:23:08.971152 [debug] [Thread-3 (]: On seed.dbt_advanced_olist.order_status_codes: 
    alter table `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes` set OPTIONS()
/* dbt 1.10.15 | model: order_status_codes | schema: dbt_dev_yourname_seeds */
[0m15:23:09.439974 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.brazilian_states"
[0m15:23:09.454879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6B7E6990>]}
[0m15:23:09.457337 [info ] [Thread-2 (]: 2 of 148 OK loaded seed file dbt_dev_yourname_seeds.brazilian_states ........... [[32mINSERT 27[0m in 12.75s]
[0m15:23:09.459314 [debug] [Thread-2 (]: Finished running node seed.dbt_advanced_olist.brazilian_states
[0m15:23:09.460746 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m15:23:09.462305 [info ] [Thread-2 (]: 7 of 148 START test dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [RUN]
[0m15:23:09.464969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.brazilian_states, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529)
[0m15:23:09.465968 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m15:23:09.477896 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m15:23:09.485451 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m15:23:09.497854 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:09.545705 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aeceb608-5b26-48f8-a1ed-5cc0963d95c3&page=queryresults
[0m15:23:09.732410 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb"
[0m15:23:09.744836 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_122f70483e90a241277775c7a726bcb8`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:10.175574 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_advanced_olist.order_status_codes"
[0m15:23:10.189838 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6BE05B50>]}
[0m15:23:10.192815 [info ] [Thread-3 (]: 3 of 148 OK loaded seed file dbt_dev_yourname_seeds.order_status_codes ......... [[32mINSERT 8[0m in 13.48s]
[0m15:23:10.196670 [debug] [Thread-3 (]: Finished running node seed.dbt_advanced_olist.order_status_codes
[0m15:23:10.199126 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m15:23:10.202415 [info ] [Thread-3 (]: 8 of 148 START test dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [RUN]
[0m15:23:10.210078 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_advanced_olist.order_status_codes, now test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936)
[0m15:23:10.214183 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m15:23:10.276606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:10.343153 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d9a03d7c-1640-45a2-af20-0e8a1cd9d4ae&page=queryresults
[0m15:23:10.495996 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
[0m15:23:10.500747 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and price >= 0 and price <= 10000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:10.892734 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
[0m15:23:10.907268 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and product_weight_g >= 0 and product_weight_g <= 100000
)
 as expression


    from `big-query-dbt-481111`.`raw_olist`.`products`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:11.055419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:40b55bda-1c78-4090-bc75-a4a0f4716950&page=queryresults
[0m15:23:11.295495 [info ] [Thread-4 (]: 5 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0  [[32mPASS[0m in 6.82s]
[0m15:23:11.301975 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb
[0m15:23:11.308442 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m15:23:11.315715 [info ] [Thread-4 (]: 9 of 148 START test source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m15:23:11.324183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_freight_value__1000__0.b0c05c76eb, now test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c)
[0m15:23:11.332242 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m15:23:11.423039 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m15:23:11.485454 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m15:23:11.507278 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:11.513993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1d235ff7-3049-4971-80a4-4eb2166e37e4&page=queryresults
[0m15:23:11.660017 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m15:23:11.670337 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m15:23:12.083531 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
[0m15:23:12.091305 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
      
    
    

    
    OPTIONS()
    as (
      
    
  with relation_columns as (

        
        select
            cast('ORDER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('CUSTOMER_ID' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_STATUS' as string) as relation_column,
            cast('STRING' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_PURCHASE_TIMESTAMP' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_APPROVED_AT' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CARRIER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_DELIVERED_CUSTOMER_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        union all
        
        select
            cast('ORDER_ESTIMATED_DELIVERY_DATE' as string) as relation_column,
            cast('TIMESTAMP' as string) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PURCHASE_TIMESTAMP'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:12.656698 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3ce8b6e0-d7ee-4fdf-9fd4-ed7cdfdef083&page=queryresults
[0m15:23:13.545224 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
[0m15:23:13.550154 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`raw_olist`.`orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:13.573626 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529"
[0m15:23:13.582669 [debug] [Thread-2 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a78560aacc85d511fc4654b1fd914313`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:13.909640 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d"
[0m15:23:13.938690 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_45b75121f164c929042f3ce7fc9a7e06`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:14.132019 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e853890a-2743-456d-b338-bbb9b79d935a&page=queryresults
[0m15:23:14.142575 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f458f387-8020-4dbf-a83c-40b30119fd4f&page=queryresults
[0m15:23:14.483594 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936"
[0m15:23:14.500021 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_source_expect_a974c660f7be6779f35cc5892e474c82`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:14.552024 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1a8eded3-0d4e-4e5e-b534-641ac5b5aa42&page=queryresults
[0m15:23:15.074569 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d6384737-d248-4cdc-a911-2e994a7b7bec&page=queryresults
[0m15:23:15.158288 [info ] [Thread-2 (]: 7 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0  [[32mPASS[0m in 5.69s]
[0m15:23:15.164906 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529
[0m15:23:15.170531 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m15:23:15.175610 [info ] [Thread-2 (]: 10 of 148 START test source_not_null_raw_olist_customers_customer_city ......... [RUN]
[0m15:23:15.180919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_products_product_weight_g__100000__0.390a622529, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a)
[0m15:23:15.183982 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m15:23:15.249096 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m15:23:15.260546 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m15:23:15.273312 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:15.859240 [info ] [Thread-1 (]: 6 of 148 PASS dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0  [[32mPASS[0m in 7.81s]
[0m15:23:15.885542 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d
[0m15:23:15.893029 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m15:23:15.896244 [info ] [Thread-1 (]: 11 of 148 START test source_not_null_raw_olist_customers_customer_id ........... [RUN]
[0m15:23:15.901372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_between_raw_olist_order_items_price__10000__0.e3096fc17d, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c)
[0m15:23:15.905660 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m15:23:15.945190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m15:23:15.962394 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m15:23:15.973048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:16.200769 [info ] [Thread-3 (]: 8 of 148 PASS dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp  [[32mPASS[0m in 5.99s]
[0m15:23:16.207961 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936
[0m15:23:16.210179 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m15:23:16.212174 [info ] [Thread-3 (]: 12 of 148 START test source_not_null_raw_olist_customers_customer_state ........ [RUN]
[0m15:23:16.216086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_source_expect_column_values_to_be_of_type_raw_olist_orders_order_purchase_timestamp__timestamp.95c69f3936, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de)
[0m15:23:16.217130 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m15:23:16.232048 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c"
[0m15:23:16.260506 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m15:23:16.271468 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_accepted_values_raw_oli_3aaab13a32ba6e449bc97a63ea11fa37`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:16.284238 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m15:23:16.304490 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:16.790565 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
[0m15:23:16.795484 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:16.994854 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:842f384a-f13c-4655-9599-31f359008873&page=queryresults
[0m15:23:17.343390 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ac4e9ae5-114b-43ae-9b73-b00b398b1606&page=queryresults
[0m15:23:17.597577 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
[0m15:23:17.609258 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:18.136962 [info ] [Thread-4 (]: 9 of 148 PASS source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 6.81s]
[0m15:23:18.146020 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c
[0m15:23:18.149232 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m15:23:18.155434 [info ] [Thread-4 (]: 13 of 148 START test source_not_null_raw_olist_customers_customer_unique_id .... [RUN]
[0m15:23:18.160657 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_accepted_values_raw_olist_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.75bf39134c, now test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30)
[0m15:23:18.163166 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m15:23:18.220394 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m15:23:18.260114 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m15:23:18.287918 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:18.384333 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6e66173d-6298-4dda-8537-fafb56fd9fe1&page=queryresults
[0m15:23:18.498047 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
[0m15:23:18.505565 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:19.063846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:078d2d24-5328-47eb-ad2e-886e433134d5&page=queryresults
[0m15:23:19.611567 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a"
[0m15:23:19.674849 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:20.109518 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de"
[0m15:23:20.122767 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:20.375681 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:293593d9-3eaf-4756-9388-1539b53d27ae&page=queryresults
[0m15:23:20.754588 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
[0m15:23:20.761291 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:32f7eb1c-8614-43a4-a9b6-0e367eabfd2f&page=queryresults
[0m15:23:20.765084 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:21.241603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c"
[0m15:23:21.275592 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:715ec977-b1b2-4964-8081-c268b91e5647&page=queryresults
[0m15:23:21.278274 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:21.553940 [info ] [Thread-2 (]: 10 of 148 PASS source_not_null_raw_olist_customers_customer_city ............... [[32mPASS[0m in 6.37s]
[0m15:23:21.566052 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a
[0m15:23:21.581930 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m15:23:21.595574 [info ] [Thread-2 (]: 14 of 148 START test source_not_null_raw_olist_order_items_freight_value ....... [RUN]
[0m15:23:21.607802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_city.10593c009a, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5)
[0m15:23:21.615454 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m15:23:21.661999 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m15:23:21.680795 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m15:23:21.712927 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:21.887446 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c22614f0-2414-4abc-aad6-0ffd7f1d1ae0&page=queryresults
[0m15:23:21.951778 [info ] [Thread-3 (]: 12 of 148 PASS source_not_null_raw_olist_customers_customer_state .............. [[32mPASS[0m in 5.73s]
[0m15:23:21.958228 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de
[0m15:23:21.967772 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m15:23:21.973570 [info ] [Thread-3 (]: 15 of 148 START test source_not_null_raw_olist_order_items_order_id ............ [RUN]
[0m15:23:21.978596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_state.f275bbf5de, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37)
[0m15:23:21.990901 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m15:23:22.058645 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m15:23:22.064676 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m15:23:22.086369 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:23.072976 [info ] [Thread-1 (]: 11 of 148 PASS source_not_null_raw_olist_customers_customer_id ................. [[32mPASS[0m in 7.17s]
[0m15:23:23.106313 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c
[0m15:23:23.106313 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m15:23:23.119222 [info ] [Thread-1 (]: 16 of 148 START test source_not_null_raw_olist_order_items_order_item_id ....... [RUN]
[0m15:23:23.146401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_id.23f91f0a3c, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c)
[0m15:23:23.152561 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m15:23:23.171557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m15:23:23.175435 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m15:23:23.221947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:23.222945 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
[0m15:23:23.319993 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where freight_value is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:23.405424 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30"
[0m15:23:23.439782 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:23.656275 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
[0m15:23:23.671376 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:24.005834 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:138dd497-2775-4779-9b9b-643e7932d1a7&page=queryresults
[0m15:23:24.066533 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa7e39ad-bdad-4c56-bd31-2647a9133590&page=queryresults
[0m15:23:24.180450 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cbb40ce6-830a-4df3-811f-61c113da247a&page=queryresults
[0m15:23:24.590406 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
[0m15:23:24.598453 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where order_item_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:25.085570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:76c8bcf5-aa0f-4fde-ad57-9f03c3864e86&page=queryresults
[0m15:23:25.308928 [info ] [Thread-4 (]: 13 of 148 PASS source_not_null_raw_olist_customers_customer_unique_id .......... [[32mPASS[0m in 7.15s]
[0m15:23:25.322330 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30
[0m15:23:25.326947 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m15:23:25.331029 [info ] [Thread-4 (]: 17 of 148 START test source_not_null_raw_olist_order_items_price ............... [RUN]
[0m15:23:25.341257 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_customers_customer_unique_id.9190387d30, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9)
[0m15:23:25.354459 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m15:23:25.421625 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m15:23:25.421625 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m15:23:25.445024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:26.176323 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5"
[0m15:23:26.204894 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_freight_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_freight_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:26.313818 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37"
[0m15:23:26.337746 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:26.833435 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
[0m15:23:26.840297 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:28adcf3e-f299-4ac0-9d05-1bacb1d6a82a&page=queryresults
[0m15:23:26.853681 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where price is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:26.891207 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8761f75d-be3a-43a1-be97-ad0b2349b573&page=queryresults
[0m15:23:27.221289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c"
[0m15:23:27.257395 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_order_item_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_order_item_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:27.438590 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:75945218-067b-450a-9b7f-57f106beb2c8&page=queryresults
[0m15:23:27.841353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:579da47c-3ff9-47c2-be3f-115a76010b5c&page=queryresults
[0m15:23:27.979356 [info ] [Thread-2 (]: 14 of 148 PASS source_not_null_raw_olist_order_items_freight_value ............. [[32mPASS[0m in 6.37s]
[0m15:23:27.990818 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5
[0m15:23:27.999717 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m15:23:28.006370 [info ] [Thread-3 (]: 15 of 148 PASS source_not_null_raw_olist_order_items_order_id .................. [[32mPASS[0m in 6.03s]
[0m15:23:28.031147 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37
[0m15:23:28.035051 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m15:23:28.013001 [info ] [Thread-2 (]: 18 of 148 START test source_not_null_raw_olist_order_items_product_id .......... [RUN]
[0m15:23:28.044513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_freight_value.827c606ed5, now test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29)
[0m15:23:28.041347 [info ] [Thread-3 (]: 19 of 148 START test source_not_null_raw_olist_orders_customer_id .............. [RUN]
[0m15:23:28.054720 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m15:23:28.057230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_id.2d0a332e37, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02)
[0m15:23:28.075939 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m15:23:28.078844 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m15:23:28.092566 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m15:23:28.095571 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m15:23:28.108484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:28.110432 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m15:23:28.161887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:29.491798 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9"
[0m15:23:29.506929 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:29.588381 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
[0m15:23:29.603849 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:29.638082 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
[0m15:23:29.640076 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:29.692510 [info ] [Thread-1 (]: 16 of 148 PASS source_not_null_raw_olist_order_items_order_item_id ............. [[32mPASS[0m in 6.55s]
[0m15:23:29.696181 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c
[0m15:23:29.701808 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m15:23:29.707180 [info ] [Thread-1 (]: 20 of 148 START test source_not_null_raw_olist_orders_order_id ................. [RUN]
[0m15:23:29.712950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_order_item_id.5f702d171c, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b)
[0m15:23:29.721718 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m15:23:29.771269 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m15:23:29.782327 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m15:23:29.807313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:30.110463 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2c3f43a6-a6ae-4f92-8389-a8cc6123ffed&page=queryresults
[0m15:23:30.254592 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:69b9086a-f5bc-4d72-b8b2-3207ae2c5d03&page=queryresults
[0m15:23:30.261801 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:840eba5b-063d-4274-8e68-6437fa086e92&page=queryresults
[0m15:23:31.260013 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
[0m15:23:31.260013 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:31.394630 [info ] [Thread-4 (]: 17 of 148 PASS source_not_null_raw_olist_order_items_price ..................... [[32mPASS[0m in 6.05s]
[0m15:23:31.401798 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9
[0m15:23:31.407468 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m15:23:31.409348 [info ] [Thread-4 (]: 21 of 148 START test source_not_null_raw_olist_orders_order_purchase_timestamp . [RUN]
[0m15:23:31.418764 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_price.e894147fe9, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5)
[0m15:23:31.423963 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m15:23:31.461713 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m15:23:31.495762 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m15:23:31.519390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:31.821961 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4441f817-9e3c-4264-9855-506393dc034d&page=queryresults
[0m15:23:32.166956 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02"
[0m15:23:32.173557 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:32.552728 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29"
[0m15:23:32.564652 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:32.781803 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:801136b2-e47a-43fa-9ee5-bc99feb266ee&page=queryresults
[0m15:23:32.935557 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
[0m15:23:32.942607 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_purchase_timestamp is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:33.174543 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:38a1fea2-9aac-40d4-818a-5aeb5ea276d5&page=queryresults
[0m15:23:33.720175 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b965e9e5-da90-4f92-ae22-66c4bad29951&page=queryresults
[0m15:23:33.863432 [info ] [Thread-3 (]: 19 of 148 PASS source_not_null_raw_olist_orders_customer_id .................... [[32mPASS[0m in 5.81s]
[0m15:23:33.870794 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02
[0m15:23:33.873252 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m15:23:33.876442 [info ] [Thread-3 (]: 22 of 148 START test source_not_null_raw_olist_orders_order_status ............. [RUN]
[0m15:23:33.879302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_customer_id.7080440c02, now test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a)
[0m15:23:33.885191 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m15:23:33.924755 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m15:23:33.938730 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m15:23:33.968238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:34.053532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b"
[0m15:23:34.061080 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:34.175464 [info ] [Thread-2 (]: 18 of 148 PASS source_not_null_raw_olist_order_items_product_id ................ [[32mPASS[0m in 6.13s]
[0m15:23:34.181026 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29
[0m15:23:34.187587 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m15:23:34.194355 [info ] [Thread-2 (]: 23 of 148 START test source_not_null_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m15:23:34.201936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_order_items_product_id.ddbed26f29, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1)
[0m15:23:34.211693 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m15:23:34.259349 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m15:23:34.275083 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m15:23:34.302047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:34.674619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:66fa8d3e-810d-439d-bb39-9f9ddaa60aba&page=queryresults
[0m15:23:35.238033 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
[0m15:23:35.253787 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:35.572155 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
[0m15:23:35.572155 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5"
[0m15:23:35.585528 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_0 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:35.594799 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_purchase_timestamp`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_purchase_timestamp | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:35.640731 [info ] [Thread-1 (]: 20 of 148 PASS source_not_null_raw_olist_orders_order_id ....................... [[32mPASS[0m in 5.93s]
[0m15:23:35.645636 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b
[0m15:23:35.650498 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m15:23:35.654873 [info ] [Thread-1 (]: 24 of 148 START test source_not_null_raw_olist_product_category_name_translation_string_field_1  [RUN]
[0m15:23:35.660955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_id.f279e24b4b, now test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841)
[0m15:23:35.661997 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m15:23:35.693248 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m15:23:35.735576 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m15:23:35.754911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:35.841476 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4df35a19-cfe1-43bf-bafd-e2ef03f776f0&page=queryresults
[0m15:23:36.125412 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f59f34aa-885d-4483-b2fd-bf200c175539&page=queryresults
[0m15:23:36.177021 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b06895ec-9575-461f-ae7b-acfbe07804ed&page=queryresults
[0m15:23:38.311995 [info ] [Thread-4 (]: 21 of 148 PASS source_not_null_raw_olist_orders_order_purchase_timestamp ....... [[32mPASS[0m in 6.89s]
[0m15:23:38.338717 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5
[0m15:23:38.344999 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m15:23:38.353249 [info ] [Thread-4 (]: 25 of 148 START test source_not_null_raw_olist_products_product_id ............. [RUN]
[0m15:23:38.362061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_purchase_timestamp.d52220c2e5, now test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf)
[0m15:23:38.371280 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m15:23:38.390532 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m15:23:38.403122 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m15:23:38.405354 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:38.996518 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1"
[0m15:23:39.012668 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_636edc0d847c30085d124dcdac732f5d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:39.407112 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a"
[0m15:23:39.418991 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:39.841411 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
[0m15:23:39.847041 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:41191ad2-97fe-4787-864b-c2e4900e0bfe&page=queryresults
[0m15:23:39.850581 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
where string_field_1 is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:41.306909 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ed063075-6f62-4787-80b5-3092bc22d734&page=queryresults
[0m15:23:41.306909 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
[0m15:23:41.325000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:95ec63f3-658f-4089-bf4a-8b2e020cb61a&page=queryresults
[0m15:23:41.334421 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`raw_olist`.`products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:41.884406 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:498c3560-1a37-4b99-bf04-ff3b7127d717&page=queryresults
[0m15:23:42.052682 [info ] [Thread-2 (]: 23 of 148 PASS source_not_null_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 7.85s]
[0m15:23:42.064925 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1
[0m15:23:42.072155 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m15:23:42.078990 [info ] [Thread-2 (]: 26 of 148 START test source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [RUN]
[0m15:23:42.092154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_0.b8a5e17ff1, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5)
[0m15:23:42.100939 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m15:23:42.154347 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m15:23:42.182456 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m15:23:42.200833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:42.415304 [info ] [Thread-3 (]: 22 of 148 PASS source_not_null_raw_olist_orders_order_status ................... [[32mPASS[0m in 8.53s]
[0m15:23:42.424257 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a
[0m15:23:42.436123 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m15:23:42.437119 [info ] [Thread-3 (]: 27 of 148 START test source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [RUN]
[0m15:23:42.454399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_orders_order_status.5f31858e0a, now test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8)
[0m15:23:42.462015 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m15:23:42.525758 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m15:23:42.559441 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m15:23:42.609416 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:43.200453 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841"
[0m15:23:43.200453 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_prod_db2261b570375e1f5d71be255596dd03`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_product_category_name_translation_string_field_1 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:43.384358 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
[0m15:23:43.392406 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:43.770397 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
[0m15:23:43.783030 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:43.790516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ecb87ad3-1157-4846-b6d4-c0b6d9fbf972&page=queryresults
[0m15:23:43.933131 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e9d974d3-f6f6-4149-88a7-35f6ea58aad1&page=queryresults
[0m15:23:44.016920 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf"
[0m15:23:44.026246 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_not_null_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_not_null_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:44.317269 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f11ac8e1-de1b-4d5e-8d6f-2abe2c20f54f&page=queryresults
[0m15:23:44.568640 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c53c84fd-0be3-4ca7-8ff2-ccc8e3d7ed06&page=queryresults
[0m15:23:44.758166 [info ] [Thread-1 (]: 24 of 148 PASS source_not_null_raw_olist_product_category_name_translation_string_field_1  [[32mPASS[0m in 9.10s]
[0m15:23:44.766233 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841
[0m15:23:44.772104 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m15:23:44.776430 [info ] [Thread-1 (]: 28 of 148 START test source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [RUN]
[0m15:23:44.785316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_product_category_name_translation_string_field_1.303212b841, now test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543)
[0m15:23:44.802840 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m15:23:44.860472 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m15:23:44.865169 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m15:23:44.870783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:45.618148 [info ] [Thread-4 (]: 25 of 148 PASS source_not_null_raw_olist_products_product_id ................... [[32mPASS[0m in 7.25s]
[0m15:23:45.626032 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf
[0m15:23:45.631468 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m15:23:45.631468 [info ] [Thread-4 (]: 29 of 148 START test source_unique_raw_olist_customers_customer_id ............. [RUN]
[0m15:23:45.639955 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_not_null_raw_olist_products_product_id.75dbe7ebdf, now test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816)
[0m15:23:45.640951 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m15:23:45.708764 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m15:23:45.717739 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m15:23:45.740851 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:46.212966 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
[0m15:23:46.223167 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`raw_olist`.`orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`raw_olist`.`customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:46.230510 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5"
[0m15:23:46.252032 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_02fac0b860d0e40fc42b92f874fdcb4b`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:46.710060 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8"
[0m15:23:46.755226 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_0ce611a7afc62c8655f9c0e4c89af0bd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:46.761512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cd082d64-1286-487b-98bd-f09bd2c64d7f&page=queryresults
[0m15:23:46.969882 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f9fb67c4-c2cb-4d6b-948b-384f6a68e56a&page=queryresults
[0m15:23:47.193623 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
[0m15:23:47.203473 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:47.582762 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea7c7de3-b43a-4184-bf26-c1ba011507a7&page=queryresults
[0m15:23:47.733558 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:54f9b89a-14b7-41c1-9dd3-1bf9ec66331b&page=queryresults
[0m15:23:48.116424 [info ] [Thread-2 (]: 26 of 148 PASS source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_  [[32mPASS[0m in 6.02s]
[0m15:23:48.128204 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5
[0m15:23:48.132968 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m15:23:48.136884 [info ] [Thread-2 (]: 30 of 148 START test source_unique_raw_olist_orders_order_id ................... [RUN]
[0m15:23:48.140723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_order_id__order_id__source_raw_olist_orders_.f4831b83e5, now test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0)
[0m15:23:48.141770 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m15:23:48.166683 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m15:23:48.276457 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m15:23:48.307024 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:48.569719 [info ] [Thread-3 (]: 27 of 148 PASS source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_  [[32mPASS[0m in 6.12s]
[0m15:23:48.574504 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8
[0m15:23:48.576417 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m15:23:48.578941 [info ] [Thread-3 (]: 31 of 148 START test source_unique_raw_olist_product_category_name_translation_string_field_0  [RUN]
[0m15:23:48.584186 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_order_items_product_id__product_id__source_raw_olist_products_.132a5b4eb8, now test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df)
[0m15:23:48.587493 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m15:23:48.600106 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m15:23:48.606340 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m15:23:48.615244 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:48.874003 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543"
[0m15:23:48.944280 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_relationships_raw_olist_2cc1224681e6ed71278f5568d3ae2f3a`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:49.633400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6aa66291-0a45-4091-829e-6072f11295e6&page=queryresults
[0m15:23:49.638044 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
[0m15:23:49.653343 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:50.068129 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
[0m15:23:50.076355 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select string_field_0 as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
  where string_field_0 is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:50.081775 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816"
[0m15:23:50.174944 [debug] [Thread-4 (]: On test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:50.279882 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bc65f017-a044-4fe9-bb83-53f7c23eab41&page=queryresults
[0m15:23:50.788653 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aeb62131-ac0c-43fa-84cd-ebd2f8402338&page=queryresults
[0m15:23:50.801511 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:683882a7-844d-4cfd-9333-7301c9ee39f4&page=queryresults
[0m15:23:50.794640 [info ] [Thread-1 (]: 28 of 148 PASS source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_  [[32mPASS[0m in 6.01s]
[0m15:23:50.820511 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543
[0m15:23:50.824366 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m15:23:50.830167 [info ] [Thread-1 (]: 32 of 148 START test source_unique_raw_olist_products_product_id ............... [RUN]
[0m15:23:50.838459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_relationships_raw_olist_orders_customer_id__customer_id__source_raw_olist_customers_.ec63a6b543, now test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1)
[0m15:23:50.841077 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m15:23:50.881676 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m15:23:50.928503 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m15:23:50.945055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:51.914585 [info ] [Thread-4 (]: 29 of 148 PASS source_unique_raw_olist_customers_customer_id ................... [[32mPASS[0m in 6.27s]
[0m15:23:51.917426 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816
[0m15:23:51.921414 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m15:23:51.924668 [info ] [Thread-4 (]: 33 of 148 START test accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [RUN]
[0m15:23:51.927407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_customers_customer_id.80838c6816, now test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22)
[0m15:23:51.931037 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m15:23:51.971263 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m15:23:52.034381 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m15:23:52.048018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:52.288157 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
[0m15:23:52.298303 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`raw_olist`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:52.423482 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0"
[0m15:23:52.761183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9e4fdbf1-dae5-498c-aaf6-0536d70ef9b4&page=queryresults
[0m15:23:53.550992 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
[0m15:23:53.550992 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df"
[0m15:23:53.563731 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
    group by region

)

select *
from all_values
where value_field not in (
    'North','Northeast','Central-West','Southeast','South'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:54.193792 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:342d2e7a-6473-481c-b5a1-467c526e5019&page=queryresults
[0m15:23:54.780072 [debug] [Thread-2 (]: On test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:54.796340 [debug] [Thread-3 (]: On test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_produc_11c3b793983c138c84181f28f2107efd`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_product_category_name_translation_string_field_0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:54.953706 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1"
[0m15:23:55.289427 [debug] [Thread-1 (]: On test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`source_unique_raw_olist_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: source_unique_raw_olist_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:55.358957 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e00cd97-13f7-4113-93b6-3b59b7488cec&page=queryresults
[0m15:23:55.592381 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e5b1f60b-b470-49a8-95ab-e2e721caa1d0&page=queryresults
[0m15:23:55.964800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a7898774-610f-4707-9067-61cc1a07e868&page=queryresults
[0m15:23:56.475436 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22"
[0m15:23:56.492171 [info ] [Thread-2 (]: 30 of 148 PASS source_unique_raw_olist_orders_order_id ......................... [[32mPASS[0m in 8.35s]
[0m15:23:56.504122 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0
[0m15:23:56.504122 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m15:23:56.512091 [info ] [Thread-2 (]: 34 of 148 START test not_null_brazilian_states_state_code ...................... [RUN]
[0m15:23:56.515919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_orders_order_id.5e4ef24fa0, now test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec)
[0m15:23:56.521767 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m15:23:56.556230 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m15:23:56.565726 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m15:23:56.591460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:23:56.672662 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_brazilian_stat_634542fd0e7cb5c45c00109c9ecc1b53`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:23:56.852924 [info ] [Thread-3 (]: 31 of 148 PASS source_unique_raw_olist_product_category_name_translation_string_field_0  [[32mPASS[0m in 8.27s]
[0m15:23:56.859081 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df
[0m15:23:56.862091 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m15:23:56.866276 [info ] [Thread-3 (]: 35 of 148 START test unique_brazilian_states_state_code ........................ [RUN]
[0m15:23:56.869560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_product_category_name_translation_string_field_0.6154aa31df, now test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855)
[0m15:23:56.874151 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m15:23:56.904517 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m15:23:57.037139 [info ] [Thread-1 (]: 32 of 148 PASS source_unique_raw_olist_products_product_id ..................... [[32mPASS[0m in 6.20s]
[0m15:23:57.043520 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1
[0m15:23:57.048977 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m15:23:57.052153 [info ] [Thread-1 (]: 36 of 148 START test not_null_order_status_codes_status_code ................... [RUN]
[0m15:23:57.055386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.source_unique_raw_olist_products_product_id.4d54aeaad1, now test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968)
[0m15:23:57.055386 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m15:23:57.088967 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m15:23:57.129638 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m15:23:57.158697 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m15:23:57.163776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:23:57.198130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:57.298503 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3d1c1a14-ae4c-403c-b3f6-a81b59ca7402&page=queryresults
[0m15:23:58.197509 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
[0m15:23:58.197509 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
where state_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:58.393547 [info ] [Thread-4 (]: 33 of 148 PASS accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South  [[32mPASS[0m in 6.47s]
[0m15:23:58.399598 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22
[0m15:23:58.405107 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m15:23:58.409639 [info ] [Thread-4 (]: 37 of 148 START test unique_order_status_codes_status_code ..................... [RUN]
[0m15:23:58.422058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_brazilian_states_region__North__Northeast__Central_West__Southeast__South.13ad41bc22, now test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b)
[0m15:23:58.455571 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m15:23:58.497740 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m15:23:58.510302 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m15:23:58.525530 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:58.752422 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
[0m15:23:58.752422 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
[0m15:23:58.762352 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:afc2b78e-5336-4df0-a1b0-d78f4074b449&page=queryresults
[0m15:23:58.766290 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
where status_code is null



  
  
    )
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:58.771912 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select state_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`brazilian_states`
  where state_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:23:59.284348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:890cc13f-a07b-4c9a-b5a0-f3da4d8fa736&page=queryresults
[0m15:23:59.302309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f785f7f1-343f-409f-a237-4bd00e6e4e5c&page=queryresults
[0m15:23:59.978301 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
[0m15:23:59.986152 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select status_code as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_seeds`.`order_status_codes`
  where status_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:00.462053 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fdb141ad-c908-4a5f-949f-e8dd35afa9ce&page=queryresults
[0m15:24:00.680498 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec"
[0m15:24:00.779408 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:01.403811 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8de1fe03-3a33-4577-a6e3-6f35494ee4fa&page=queryresults
[0m15:24:01.449823 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968"
[0m15:24:01.467120 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:01.495395 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855"
[0m15:24:01.732093 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_brazilian_states_state_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_brazilian_states_state_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:01.978854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:601c4d1f-9093-482f-a136-08d3188fd00f&page=queryresults
[0m15:24:02.358942 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c20d3b4-97b6-429b-9a36-1bb775f26139&page=queryresults
[0m15:24:02.567876 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b"
[0m15:24:02.571550 [info ] [Thread-2 (]: 34 of 148 PASS not_null_brazilian_states_state_code ............................ [[32mPASS[0m in 6.05s]
[0m15:24:02.578886 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_order_status_codes_status_code`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_order_status_codes_status_code | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:02.585694 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec
[0m15:24:02.599257 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_order_items
[0m15:24:02.604763 [info ] [Thread-2 (]: 38 of 148 START sql view model dbt_dev_yourname_staging.stg_order_items ........ [RUN]
[0m15:24:02.608321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_brazilian_states_state_code.f663a0b8ec, now model.dbt_advanced_olist.stg_order_items)
[0m15:24:02.613388 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_order_items
[0m15:24:02.705911 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_order_items"
[0m15:24:02.734121 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_order_items
[0m15:24:02.797430 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_order_items"
[0m15:24:02.804458 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_order_items: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_order_items
  
  Purpose: Clean order line item data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Rename columns
  - Calculate item total (price + freight)
  - Generate surrogate key for unique identification
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`order_items`
),

renamed as (
    select
        -- Surrogate Key (composite primary key)
        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,
        
        -- Foreign Keys
        order_id,
        product_id,
        seller_id,
        
        -- Item Position
        order_item_id as item_sequence,
        
        -- Pricing
        cast(price as numeric) as item_price,
        cast(freight_value as numeric) as item_freight,
        
        -- Derived: Total for this item
        cast(price as numeric) + cast(freight_value as numeric) as item_total,
        
        -- Shipping date
        cast(shipping_limit_date as timestamp) as shipping_limit_at

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_order_items | schema: dbt_dev_yourname_staging */;
[0m15:24:02.806533 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:03.136953 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:31e452eb-54cf-4973-b171-e099a0b0beda&page=queryresults
[0m15:24:03.391046 [info ] [Thread-3 (]: 35 of 148 PASS unique_brazilian_states_state_code .............................. [[32mPASS[0m in 6.52s]
[0m15:24:03.413707 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855
[0m15:24:03.419648 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.stg_customers
[0m15:24:03.426319 [info ] [Thread-3 (]: 39 of 148 START sql view model dbt_dev_yourname_staging.stg_customers .......... [RUN]
[0m15:24:03.436649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_brazilian_states_state_code.e8975ac855, now model.dbt_advanced_olist.stg_customers)
[0m15:24:03.447204 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.stg_customers
[0m15:24:03.480051 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_customers"
[0m15:24:03.488615 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.stg_customers
[0m15:24:03.495474 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_customers"
[0m15:24:03.503003 [debug] [Thread-3 (]: On model.dbt_advanced_olist.stg_customers: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_customers
  
  Purpose: Clean and standardize customer data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Standardize location data
  - Clean state codes
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`customers`
),

renamed as (
    select
        -- Primary Key
        customer_id,
        
        -- Alternative Key (same customer across orders)
        customer_unique_id,
        
        -- Location
        lower(trim(customer_city)) as customer_city,
        upper(trim(customer_state)) as customer_state,
        cast(customer_zip_code_prefix as string) as customer_zip_code,
        
        -- Derived: Region classification
        case upper(trim(customer_state))
            when 'SP' then 'Southeast'
            when 'RJ' then 'Southeast'
            when 'MG' then 'Southeast'
            when 'ES' then 'Southeast'
            when 'PR' then 'South'
            when 'SC' then 'South'
            when 'RS' then 'South'
            when 'BA' then 'Northeast'
            when 'PE' then 'Northeast'
            when 'CE' then 'Northeast'
            when 'MA' then 'Northeast'
            when 'PB' then 'Northeast'
            when 'RN' then 'Northeast'
            when 'PI' then 'Northeast'
            when 'AL' then 'Northeast'
            when 'SE' then 'Northeast'
            when 'GO' then 'Central-West'
            when 'DF' then 'Central-West'
            when 'MT' then 'Central-West'
            when 'MS' then 'Central-West'
            else 'North'
        end as customer_region

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_customers | schema: dbt_dev_yourname_staging */;
[0m15:24:03.504940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:03.691626 [info ] [Thread-1 (]: 36 of 148 PASS not_null_order_status_codes_status_code ......................... [[32mPASS[0m in 6.64s]
[0m15:24:03.695966 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968
[0m15:24:03.698074 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.stg_orders
[0m15:24:03.699618 [info ] [Thread-1 (]: 40 of 148 START sql view model dbt_dev_yourname_staging.stg_orders ............. [RUN]
[0m15:24:03.702488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_order_status_codes_status_code.6132396968, now model.dbt_advanced_olist.stg_orders)
[0m15:24:03.704098 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.stg_orders
[0m15:24:03.722859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_orders"
[0m15:24:03.728151 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.stg_orders
[0m15:24:03.731350 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_orders"
[0m15:24:03.769829 [debug] [Thread-1 (]: On model.dbt_advanced_olist.stg_orders: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_orders
  
  Purpose: Clean and standardize raw order data
  Source: Olist Brazilian E-commerce (10K orders sample)
  
  Transformations:
  - Rename columns to consistent naming convention
  - Cast timestamps to proper types
  - Calculate delivery metrics
  - Add late delivery flag
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`orders`
),

renamed as (
    select
        -- Primary Key
        order_id,
        
        -- Foreign Keys
        customer_id,
        
        -- Order Status
        order_status,
        
        -- Timestamps (cast to proper types)
        cast(order_purchase_timestamp as timestamp) as ordered_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as shipped_at,
        cast(order_delivered_customer_date as timestamp) as delivered_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,
        
        -- Derived: Order date (for partitioning)
        date(cast(order_purchase_timestamp as timestamp)) as order_date,
        
        -- Derived: Delivery time in days
        case 
            when order_delivered_customer_date is not null 
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_purchase_timestamp as timestamp)),
                day
            )
        end as delivery_days,
        
        -- Derived: Is delivery late?
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then true
            else false
        end as is_late_delivery,
        
        -- Derived: Days late (if late)
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_estimated_delivery_date as timestamp)),
                day
            )
            else 0
        end as days_late

    from source
)

select * from renamed

-- Limit in dev for faster iteration
limit 1000
/* dbt 1.10.15 | model: stg_orders | schema: dbt_dev_yourname_staging */;
[0m15:24:03.773439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:04.103653 [info ] [Thread-4 (]: 37 of 148 PASS unique_order_status_codes_status_code ........................... [[32mPASS[0m in 5.68s]
[0m15:24:04.108758 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b
[0m15:24:04.113203 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_product_categories
[0m15:24:04.117605 [info ] [Thread-4 (]: 41 of 148 START sql view model dbt_dev_yourname_staging.stg_product_categories . [RUN]
[0m15:24:04.122604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_order_status_codes_status_code.00c9e12b2b, now model.dbt_advanced_olist.stg_product_categories)
[0m15:24:04.127116 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_product_categories
[0m15:24:04.234087 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_product_categories"
[0m15:24:04.273063 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_product_categories
[0m15:24:04.291658 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_product_categories"
[0m15:24:04.302229 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_product_categories: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  OPTIONS()
  as 
/*
  STAGING MODEL: stg_product_categories
  Purpose: Product category translation (Portuguese → English)
  Source: Olist Brazilian E-commerce
*/
with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
),
renamed as (
    select
        -- Portuguese name (join key)
        string_field_0 as category_name_pt,
        -- English translation
        string_field_1 as category_name_en,
        -- Derived: Category group
        case
            when string_field_1 in ('computers', 'computers_accessories', 'electronics', 'tablets_printing_image', 'telephony', 'fixed_telephony')
                then 'Electronics'
            when string_field_1 in ('furniture_decor', 'furniture_living_room', 'furniture_bedroom', 'furniture_mattress_and_upholstery', 'office_furniture', 'home_comfort', 'home_comfort_2', 'home_confort')
                then 'Furniture'
            when string_field_1 in ('health_beauty', 'perfumery', 'diapers_and_hygiene')
                then 'Health & Beauty'
            when string_field_1 in ('sports_leisure', 'toys', 'baby', 'fashion_bags_accessories', 'fashion_shoes', 'fashion_sport', 'fashion_underwear_beach', 'fashio_female_clothing', 'fashion_male_clothing', 'fashion_childrens_clothes')
                then 'Fashion & Lifestyle'
            when string_field_1 in ('housewares', 'kitchen_dining_laundry_garden_furniture', 'garden_tools', 'flowers', 'la_cuisine')
                then 'Home & Garden'
            else 'Other'
        end as category_group
    from source
)
select * from renamed
/* dbt 1.10.15 | model: stg_product_categories | schema: dbt_dev_yourname_staging */;
[0m15:24:04.304536 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:04.366162 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:63533b2d-7164-4852-b631-e4934f1ce434&page=queryresults
[0m15:24:04.947196 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:41c82e80-6fb3-478b-b398-f74c38f5a467&page=queryresults
[0m15:24:05.346330 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6C9E8E90>]}
[0m15:24:05.352717 [info ] [Thread-2 (]: 38 of 148 OK created sql view model dbt_dev_yourname_staging.stg_order_items ... [[32mCREATE VIEW (0 processed)[0m in 2.74s]
[0m15:24:05.357809 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_order_items
[0m15:24:05.363127 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_products
[0m15:24:05.366671 [info ] [Thread-2 (]: 42 of 148 START sql view model dbt_dev_yourname_staging.stg_products ........... [RUN]
[0m15:24:05.371369 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_order_items, now model.dbt_advanced_olist.stg_products)
[0m15:24:05.373967 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_products
[0m15:24:05.419128 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_products"
[0m15:24:05.429269 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_products
[0m15:24:05.448187 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_products"
[0m15:24:05.456068 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_products: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_products
  
  Purpose: Clean product catalog data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Calculate product volume
  - Classify product size
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`products`
),

renamed as (
    select
        -- Primary Key
        product_id,
        
        -- Category (Portuguese - join with translation table)
        product_category_name as category_name_pt,
        
        -- Dimensions
        cast(product_weight_g as numeric) as weight_grams,
        cast(product_length_cm as numeric) as length_cm,
        cast(product_height_cm as numeric) as height_cm,
        cast(product_width_cm as numeric) as width_cm,
        
        -- Derived: Volume in cubic cm
        cast(product_length_cm as numeric) 
            * cast(product_height_cm as numeric) 
            * cast(product_width_cm as numeric) as volume_cm3,
        
        -- Derived: Size classification
        case
            when cast(product_weight_g as numeric) < 500 then 'Small'
            when cast(product_weight_g as numeric) < 2000 then 'Medium'
            when cast(product_weight_g as numeric) < 10000 then 'Large'
            else 'Extra Large'
        end as size_category,
        
        -- Product description stats
        product_name_lenght as name_length,
        product_description_lenght as description_length,
        product_photos_qty as photo_count

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_products | schema: dbt_dev_yourname_staging */;
[0m15:24:05.457925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:05.689404 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6C5B9A10>]}
[0m15:24:05.696599 [info ] [Thread-3 (]: 39 of 148 OK created sql view model dbt_dev_yourname_staging.stg_customers ..... [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m15:24:05.704890 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.stg_customers
[0m15:24:05.708257 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m15:24:05.718839 [info ] [Thread-3 (]: 43 of 148 START test is_not_negative_stg_order_items_item_freight .............. [RUN]
[0m15:24:05.738172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_customers, now test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a)
[0m15:24:05.738172 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m15:24:05.804215 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m15:24:05.823835 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9065ed69-dc9b-4695-9eda-0b654385c971&page=queryresults
[0m15:24:05.875489 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m15:24:05.894340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:06.564533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6C960650>]}
[0m15:24:06.568241 [info ] [Thread-1 (]: 40 of 148 OK created sql view model dbt_dev_yourname_staging.stg_orders ........ [[32mCREATE VIEW (0 processed)[0m in 2.86s]
[0m15:24:06.572457 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.stg_orders
[0m15:24:06.573767 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m15:24:06.574808 [info ] [Thread-1 (]: 44 of 148 START test is_positive_stg_order_items_item_price .................... [RUN]
[0m15:24:06.578324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_orders, now test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242)
[0m15:24:06.580888 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m15:24:06.597597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m15:24:06.600801 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m15:24:06.613762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:06.793450 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e03cec94-365a-46b5-85ac-794e0ae0cdb6&page=queryresults
[0m15:24:06.806576 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:32434057-1bc2-4eea-b827-58b181b5bc01&page=queryresults
[0m15:24:07.271040 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
[0m15:24:07.271040 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_freight as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:07.505183 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6B799B10>]}
[0m15:24:07.513081 [info ] [Thread-2 (]: 42 of 148 OK created sql view model dbt_dev_yourname_staging.stg_products ...... [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m15:24:07.520734 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_products
[0m15:24:07.542428 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m15:24:07.550231 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6C9FD610>]}
[0m15:24:07.555623 [info ] [Thread-2 (]: 45 of 148 START test is_positive_stg_order_items_item_total .................... [RUN]
[0m15:24:07.582231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_products, now test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25)
[0m15:24:07.569909 [info ] [Thread-4 (]: 41 of 148 OK created sql view model dbt_dev_yourname_staging.stg_product_categories  [[32mCREATE VIEW (0 processed)[0m in 3.43s]
[0m15:24:07.588634 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m15:24:07.598449 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_product_categories
[0m15:24:07.615930 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m15:24:07.621014 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m15:24:07.623189 [info ] [Thread-4 (]: 46 of 148 START test not_null_stg_order_items_item_freight ..................... [RUN]
[0m15:24:07.626264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_product_categories, now test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5)
[0m15:24:07.628512 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m15:24:07.643995 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m15:24:07.648314 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m15:24:07.651254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:07.715993 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m15:24:07.719603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:07.877031 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1625bd0b-2068-429b-ad9e-e23b0b1edc03&page=queryresults
[0m15:24:08.779511 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
[0m15:24:08.787594 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_price as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price <= 0
   or item_price is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:09.013831 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
[0m15:24:09.023033 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    item_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total <= 0
   or item_total is null
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:09.487025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d4668214-f598-422a-8f41-f0b9f8465b68&page=queryresults
[0m15:24:09.770183 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a"
[0m15:24:09.784609 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1a4095db-27ef-45d2-a87e-98bf54076be3&page=queryresults
[0m15:24:09.806202 [debug] [Thread-3 (]: On test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:09.919291 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
[0m15:24:09.926998 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_freight is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:10.363550 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8ed6766b-d723-4676-9478-f29642f38b01&page=queryresults
[0m15:24:10.668244 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1cf81bb8-8da2-45b6-94ae-9ffa29eb9c82&page=queryresults
[0m15:24:11.295223 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242"
[0m15:24:11.310564 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:11.674603 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25"
[0m15:24:11.715927 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_positive_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_positive_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:11.732974 [info ] [Thread-3 (]: 43 of 148 PASS is_not_negative_stg_order_items_item_freight .................... [[32mPASS[0m in 5.99s]
[0m15:24:11.737416 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a
[0m15:24:11.740636 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m15:24:11.744083 [info ] [Thread-3 (]: 47 of 148 START test not_null_stg_order_items_item_price ....................... [RUN]
[0m15:24:11.749556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_order_items_item_freight.f534cda85a, now test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556)
[0m15:24:11.753349 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m15:24:11.786719 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m15:24:11.798539 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m15:24:11.822195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:12.067452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f4cdb444-4860-4272-976e-e4403a39797f&page=queryresults
[0m15:24:12.294117 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8bc8628c-9de4-496d-a894-25fbe69665b2&page=queryresults
[0m15:24:12.815650 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5"
[0m15:24:12.901636 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_freight`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_freight | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:13.222239 [info ] [Thread-1 (]: 44 of 148 PASS is_positive_stg_order_items_item_price .......................... [[32mPASS[0m in 6.64s]
[0m15:24:13.234947 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242
[0m15:24:13.240533 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m15:24:13.249060 [info ] [Thread-1 (]: 48 of 148 START test not_null_stg_order_items_item_total ....................... [RUN]
[0m15:24:13.256387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_price.2ee220f242, now test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2)
[0m15:24:13.263876 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m15:24:13.288797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m15:24:13.294397 [info ] [Thread-2 (]: 45 of 148 PASS is_positive_stg_order_items_item_total .......................... [[32mPASS[0m in 5.71s]
[0m15:24:13.298194 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25
[0m15:24:13.300185 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m15:24:13.302050 [info ] [Thread-2 (]: 49 of 148 START test not_null_stg_order_items_order_id ......................... [RUN]
[0m15:24:13.304577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_positive_stg_order_items_item_total.e0b2113e25, now test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96)
[0m15:24:13.306103 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m15:24:13.320452 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m15:24:13.332054 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m15:24:13.333253 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m15:24:13.349348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:13.354134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:13.486267 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9e9c3338-c819-4d37-8723-bc8df579c926&page=queryresults
[0m15:24:13.962446 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
[0m15:24:13.963446 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_price is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:17.387691 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db907010-40e8-425a-bcf8-e4520843c0b0&page=queryresults
[0m15:24:17.395810 [info ] [Thread-4 (]: 46 of 148 PASS not_null_stg_order_items_item_freight ........................... [[32mPASS[0m in 9.77s]
[0m15:24:17.400699 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5
[0m15:24:17.401697 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m15:24:17.401697 [info ] [Thread-4 (]: 50 of 148 START test not_null_stg_order_items_order_item_key ................... [RUN]
[0m15:24:17.411198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_freight.30dfa576c5, now test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa)
[0m15:24:17.413304 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m15:24:17.436750 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m15:24:17.449009 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m15:24:17.469724 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:17.899119 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
[0m15:24:17.900116 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where item_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:17.970336 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
[0m15:24:17.977264 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:18.514651 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556"
[0m15:24:18.518793 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:83bb9283-0e1a-4ead-bd99-816db4f8fad1&page=queryresults
[0m15:24:18.545605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d583629a-0290-4ff8-ae1f-6c8a6a58e44f&page=queryresults
[0m15:24:18.773427 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_price`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_price | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:19.826104 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5ce8e110-fb3d-4050-93a0-b6a3fc6f6a90&page=queryresults
[0m15:24:20.415290 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2"
[0m15:24:20.420258 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96"
[0m15:24:20.504213 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_item_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_item_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:20.505211 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:20.794228 [info ] [Thread-3 (]: 47 of 148 PASS not_null_stg_order_items_item_price ............................. [[32mPASS[0m in 9.04s]
[0m15:24:20.799077 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556
[0m15:24:20.802263 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:24:20.806191 [info ] [Thread-3 (]: 51 of 148 START test not_null_stg_order_items_product_id ....................... [RUN]
[0m15:24:20.810783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_price.5947c07556, now test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6)
[0m15:24:20.815332 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:24:20.846385 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m15:24:20.852844 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:24:20.893856 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:20.897339 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
[0m15:24:20.993724 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where order_item_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:21.027397 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b6d252da-eddc-4c3f-a9a9-e3f7abb5b649&page=queryresults
[0m15:24:21.180888 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3c838c17-aa1f-4105-9915-a07090bc17d4&page=queryresults
[0m15:24:21.564507 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5fb19744-1050-419a-9a05-2af61fd27f04&page=queryresults
[0m15:24:22.366123 [info ] [Thread-1 (]: 48 of 148 PASS not_null_stg_order_items_item_total ............................. [[32mPASS[0m in 9.11s]
[0m15:24:22.367126 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2
[0m15:24:22.375077 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m15:24:22.378540 [info ] [Thread-1 (]: 52 of 148 START test unique_stg_order_items_order_item_key ..................... [RUN]
[0m15:24:22.378540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_item_total.0fe770e7e2, now test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057)
[0m15:24:22.390484 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m15:24:22.418032 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m15:24:22.478237 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
[0m15:24:22.481678 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:22.503702 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m15:24:22.528052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:22.731384 [info ] [Thread-2 (]: 49 of 148 PASS not_null_stg_order_items_order_id ............................... [[32mPASS[0m in 9.43s]
[0m15:24:22.731384 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96
[0m15:24:22.744009 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m15:24:22.747810 [info ] [Thread-2 (]: 53 of 148 START test accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m15:24:22.748814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_id.2063801f96, now test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f)
[0m15:24:22.758604 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m15:24:22.797805 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m15:24:22.834028 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m15:24:22.863984 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:23.071278 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1895e0a8-f1fa-4a73-bcce-3034625dc463&page=queryresults
[0m15:24:23.455907 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa"
[0m15:24:23.469647 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:24.048008 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5792b6de-d0f1-4923-82f0-42f939cb81cf&page=queryresults
[0m15:24:24.377340 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
[0m15:24:24.385079 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_item_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  where order_item_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:24.620294 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
[0m15:24:24.629088 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:24.974310 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6"
[0m15:24:24.982915 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_order_items_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_order_items_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:25.025647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:83ab0814-83ac-402e-8c12-3ddd489bd22a&page=queryresults
[0m15:24:25.038734 [info ] [Thread-4 (]: 50 of 148 PASS not_null_stg_order_items_order_item_key ......................... [[32mPASS[0m in 7.63s]
[0m15:24:25.045590 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa
[0m15:24:25.047537 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m15:24:25.049606 [info ] [Thread-4 (]: 54 of 148 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [RUN]
[0m15:24:25.049606 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_order_item_key.cc0317efaa, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789)
[0m15:24:25.060192 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m15:24:25.093878 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m15:24:25.128264 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:10cd2b21-90b7-4c1a-a4bd-ef6f89aa0d74&page=queryresults
[0m15:24:25.195270 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m15:24:25.212741 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:25.592012 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7c58c87b-e341-4581-b691-ed00d9e71d92&page=queryresults
[0m15:24:26.494617 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
[0m15:24:26.508256 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:26.730551 [info ] [Thread-3 (]: 51 of 148 PASS not_null_stg_order_items_product_id ............................. [[32mPASS[0m in 5.92s]
[0m15:24:26.735528 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6
[0m15:24:26.741829 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:24:26.748017 [info ] [Thread-3 (]: 55 of 148 START test not_null_stg_customers_customer_id ........................ [RUN]
[0m15:24:26.754384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_order_items_product_id.5154a8a6f6, now test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m15:24:26.760970 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:24:26.811337 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:24:27.095667 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:24:27.126886 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:27.280751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057"
[0m15:24:27.280751 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:08c0f3bf-ef0c-43c3-b790-4c7a0562e8d2&page=queryresults
[0m15:24:27.280751 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f"
[0m15:24:27.377129 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_order_items_order_item_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_order_items_order_item_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:27.386333 [debug] [Thread-2 (]: On test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_customers_b07cfbc5eceedfb5b95670a90cbdbf9d`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:28.027709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:64146d6c-b29e-497b-a506-e0d484d968f1&page=queryresults
[0m15:24:28.029761 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:430678be-46a8-4bf9-8de2-b78434e17a99&page=queryresults
[0m15:24:28.495009 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
[0m15:24:28.505874 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:29.229116 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:da0a943e-bdf9-43e2-ad1b-d55e1db0f5f6&page=queryresults
[0m15:24:29.243874 [info ] [Thread-1 (]: 52 of 148 PASS unique_stg_order_items_order_item_key ........................... [[32mPASS[0m in 6.86s]
[0m15:24:29.258116 [info ] [Thread-2 (]: 53 of 148 PASS accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 6.51s]
[0m15:24:29.270468 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057
[0m15:24:29.277883 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f
[0m15:24:29.281977 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m15:24:29.285045 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m15:24:29.290174 [info ] [Thread-1 (]: 56 of 148 START test not_null_stg_customers_customer_region .................... [RUN]
[0m15:24:29.294772 [info ] [Thread-2 (]: 57 of 148 START test not_null_stg_customers_customer_state ..................... [RUN]
[0m15:24:29.299726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_order_items_order_item_key.35c543b057, now test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e)
[0m15:24:29.299726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_customers_customer_region__Southeast__South__Northeast__Central_West__North.eb12d93b2f, now test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397)
[0m15:24:29.310570 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m15:24:29.316680 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m15:24:29.348721 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m15:24:29.377825 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m15:24:29.428114 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m15:24:29.428114 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m15:24:29.454511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:29.474396 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:29.691424 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789"
[0m15:24:29.697623 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_dcf48dd054cc1c7574aeb61260b5697e`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:30.675482 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a726850f-c635-49f1-98cb-a356b7bc3bff&page=queryresults
[0m15:24:31.097339 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:24:31.124103 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:31.157723 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
[0m15:24:31.164261 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:31.257493 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
[0m15:24:31.273142 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:31.809998 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:28024c70-43ec-4de7-8c89-8722d480bc00&page=queryresults
[0m15:24:31.818069 [info ] [Thread-4 (]: 54 of 148 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2  [[32mPASS[0m in 6.77s]
[0m15:24:31.825075 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789
[0m15:24:31.835152 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:24:31.842267 [info ] [Thread-4 (]: 58 of 148 START test not_null_stg_customers_customer_unique_id ................. [RUN]
[0m15:24:31.847884 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_stg_customers_customer_state__2.bfb037c789, now test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba)
[0m15:24:31.848882 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:24:31.890725 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:24:31.895760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:525dc5a0-ad67-4a56-8553-62d16a2fd16f&page=queryresults
[0m15:24:31.910486 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:24:31.928050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:32.028560 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8e258613-e9a2-445c-a9e5-1c0778d29516&page=queryresults
[0m15:24:33.176481 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
[0m15:24:33.176481 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:33.795695 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e14d7a8-7079-4314-836c-7c9c68f27195&page=queryresults
[0m15:24:33.795695 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e"
[0m15:24:33.855937 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:34.209936 [info ] [Thread-3 (]: 55 of 148 PASS not_null_stg_customers_customer_id .............................. [[32mPASS[0m in 7.46s]
[0m15:24:34.222292 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:24:34.226597 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m15:24:34.228719 [info ] [Thread-3 (]: 59 of 148 START test unique_stg_customers_customer_id .......................... [RUN]
[0m15:24:34.228719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada)
[0m15:24:34.248913 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m15:24:34.300359 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m15:24:34.364041 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m15:24:34.376096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:34.474147 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0002fa12-5812-4f41-8454-8a01ddc449bf&page=queryresults
[0m15:24:35.613441 [info ] [Thread-1 (]: 56 of 148 PASS not_null_stg_customers_customer_region .......................... [[32mPASS[0m in 6.31s]
[0m15:24:35.613441 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e
[0m15:24:35.621159 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m15:24:35.624496 [info ] [Thread-1 (]: 60 of 148 START test accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m15:24:35.626489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_region.c42cf3bd1e, now test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460)
[0m15:24:35.626489 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m15:24:35.662055 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:24:35.675857 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m15:24:35.693668 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
[0m15:24:35.693668 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:35.729072 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:35.773823 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m15:24:35.791550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:36.462838 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:79dba1d9-24f2-44f6-8361-c7d551c1fcd6&page=queryresults
[0m15:24:36.466560 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f9b8d8f9-00dd-48bf-9415-6cb43b78987b&page=queryresults
[0m15:24:37.513751 [info ] [Thread-4 (]: 58 of 148 PASS not_null_stg_customers_customer_unique_id ....................... [[32mPASS[0m in 5.67s]
[0m15:24:37.513751 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:24:37.525166 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m15:24:37.529949 [info ] [Thread-4 (]: 61 of 148 START test assert_delivery_dates_logical ............................. [RUN]
[0m15:24:37.537510 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_advanced_olist.assert_delivery_dates_logical)
[0m15:24:37.542121 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m15:24:37.612781 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m15:24:37.715017 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m15:24:37.737281 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:38.305985 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada"
[0m15:24:38.343226 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:38.910863 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0a936161-8a78-4908-9133-db3dac21e449&page=queryresults
[0m15:24:39.247722 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
[0m15:24:39.256045 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_delivery_dates_logical
  
  Purpose: Delivery dates should follow logical order
  
  Business Rules:
  - approved_at >= ordered_at
  - shipped_at >= approved_at (if exists)
  - delivered_at >= shipped_at (if exists)
  
  Test PASSES if query returns 0 rows
*/

with orders as (
    select
        order_id,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

date_violations as (
    select
        order_id,
        case
            when approved_at < ordered_at then 'Approved before ordered'
            when shipped_at < approved_at then 'Shipped before approved'
            when delivered_at < shipped_at then 'Delivered before shipped'
            when delivered_at < ordered_at then 'Delivered before ordered'
        end as violation_type,
        ordered_at,
        approved_at,
        shipped_at,
        delivered_at
    from orders
    where 
        (approved_at is not null and approved_at < ordered_at)
        or (shipped_at is not null and approved_at is not null and shipped_at < approved_at)
        or (delivered_at is not null and shipped_at is not null and delivered_at < shipped_at)
        or (delivered_at is not null and delivered_at < ordered_at)
)

select * from date_violations
  
  
    )
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:39.833288 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5e96aafd-6186-4a60-99ce-5a6482892075&page=queryresults
[0m15:24:40.044998 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
[0m15:24:40.059640 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:40.051972 [info ] [Thread-3 (]: 59 of 148 PASS unique_stg_customers_customer_id ................................ [[32mPASS[0m in 5.82s]
[0m15:24:40.076661 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada
[0m15:24:40.077661 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.assert_orders_have_items
[0m15:24:40.091371 [info ] [Thread-3 (]: 62 of 148 START test assert_orders_have_items .................................. [RUN]
[0m15:24:40.100607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_customers_customer_id.c7614daada, now test.dbt_advanced_olist.assert_orders_have_items)
[0m15:24:40.110432 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.assert_orders_have_items
[0m15:24:40.142889 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m15:24:40.160600 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.assert_orders_have_items
[0m15:24:40.190388 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:40.762538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5927a066-3a1e-43e9-8eb0-9e27de29ebb5&page=queryresults
[0m15:24:41.493791 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
[0m15:24:41.493791 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

/*
  SINGULAR TEST: assert_orders_have_items
  Purpose: Every order should have at least one line item
  Business Rule: An order without items indicates data integrity issue
  Test PASSES if this query returns 0 rows
  Test FAILS if any orders exist without items
  
  Note: Sample data may have orphaned records - set to warn
*/
with orders as (
    select order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),
order_items as (
    select distinct order_id from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),
orders_without_items as (
    select
        o.order_id
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    where oi.order_id is null
)
select
    order_id,
    'Order has no items' as failure_reason
from orders_without_items
  
  
    )
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:42.091475 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_delivery_dates_logical"
[0m15:24:42.157901 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:563986dd-ab06-4147-90a9-81bc5f46cf56&page=queryresults
[0m15:24:42.171698 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_delivery_dates_logical: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_delivery_dates_logical`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_delivery_dates_logical | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:42.699467 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8a7224c2-8b30-43f7-947d-2925404bfe70&page=queryresults
[0m15:24:42.914064 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460"
[0m15:24:42.943773 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_orders_c6af7e4dcb753aadce3be04d7b2feb42`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:43.625901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c05e4c5-a272-4db4-b93e-fbe343683284&page=queryresults
[0m15:24:43.639224 [info ] [Thread-4 (]: 61 of 148 PASS assert_delivery_dates_logical ................................... [[32mPASS[0m in 6.10s]
[0m15:24:43.652747 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.assert_delivery_dates_logical
[0m15:24:43.660951 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m15:24:43.660951 [info ] [Thread-4 (]: 63 of 148 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [RUN]
[0m15:24:43.668621 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_delivery_dates_logical, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15)
[0m15:24:43.673835 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m15:24:43.716618 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m15:24:43.726864 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m15:24:43.747761 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:44.357565 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_orders_have_items"
[0m15:24:44.396056 [debug] [Thread-3 (]: On test.dbt_advanced_olist.assert_orders_have_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_orders_have_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:44.754532 [info ] [Thread-1 (]: 60 of 148 PASS accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 9.13s]
[0m15:24:44.759729 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460
[0m15:24:44.766263 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:24:44.770416 [info ] [Thread-1 (]: 64 of 148 START test not_null_stg_orders_customer_id ........................... [RUN]
[0m15:24:44.780202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.04ca1cc460, now test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:24:44.784138 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:24:44.824356 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:24:44.830133 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:24:44.856058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:45.139259 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fe3fe4f7-fa36-40e2-ab7f-796113029970&page=queryresults
[0m15:24:45.494309 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
[0m15:24:45.508825 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_days >= 0 and delivery_days <= 180
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where
        delivery_days is not null
    
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:46.126395 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4c9338de-258e-4fe8-9ac6-b4e5aeb0a565&page=queryresults
[0m15:24:46.260856 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397"
[0m15:24:46.265611 [warn ] [Thread-3 (]: 62 of 148 WARN 890 assert_orders_have_items .................................... [[33mWARN 890[0m in 6.16s]
[0m15:24:46.274465 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.assert_orders_have_items
[0m15:24:46.274465 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m15:24:46.297916 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:46.287455 [info ] [Thread-3 (]: 65 of 148 START test not_null_stg_orders_is_late_delivery ...................... [RUN]
[0m15:24:46.312193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_orders_have_items, now test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0)
[0m15:24:46.329083 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m15:24:46.360065 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m15:24:46.377126 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m15:24:46.392515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:46.392515 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
[0m15:24:46.486621 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:46.875518 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5c0033f1-6b89-4558-91c7-e058e51d4444&page=queryresults
[0m15:24:47.075834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:267258de-dd54-4463-9574-dac7dd41292c&page=queryresults
[0m15:24:47.823744 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
[0m15:24:47.824741 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where is_late_delivery is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:48.026234 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15"
[0m15:24:48.036957 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:48.047635 [info ] [Thread-2 (]: 57 of 148 PASS not_null_stg_customers_customer_state ........................... [[32mPASS[0m in 18.75s]
[0m15:24:48.056694 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397
[0m15:24:48.056694 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m15:24:48.065914 [info ] [Thread-2 (]: 66 of 148 START test not_null_stg_orders_order_date ............................ [RUN]
[0m15:24:48.076858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_customers_customer_state.19ffa15397, now test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb)
[0m15:24:48.081442 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m15:24:48.124735 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:24:48.140732 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m15:24:48.156011 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:48.425128 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2e0d42eb-642f-4ffe-a2a9-a4c89e4b44a0&page=queryresults
[0m15:24:48.660710 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:08d2aa3e-bdf4-45c5-863c-276d50656a3c&page=queryresults
[0m15:24:48.971930 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:24:48.982109 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:49.520578 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aa19460c-83d1-47ad-9584-d97e574c2271&page=queryresults
[0m15:24:49.673028 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
[0m15:24:49.677221 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:49.766353 [warn ] [Thread-4 (]: 63 of 148 WARN 1 dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null  [[33mWARN 1[0m in 6.10s]
[0m15:24:49.774950 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15
[0m15:24:49.774950 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m15:24:49.785078 [info ] [Thread-4 (]: 67 of 148 START test not_null_stg_orders_order_id .............................. [RUN]
[0m15:24:49.791153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null.6a435e9b15, now test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:24:49.797737 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m15:24:49.857173 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:24:49.926448 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m15:24:49.954997 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:50.598745 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3dad6ae8-abef-4837-a72b-d935c8cf6627&page=queryresults
[0m15:24:51.190944 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0"
[0m15:24:51.202453 [info ] [Thread-1 (]: 64 of 148 PASS not_null_stg_orders_customer_id ................................. [[32mPASS[0m in 6.42s]
[0m15:24:51.209653 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:24:51.209653 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m15:24:51.218910 [info ] [Thread-1 (]: 68 of 148 START test not_null_stg_orders_order_status .......................... [RUN]
[0m15:24:51.235104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79)
[0m15:24:51.238455 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m15:24:51.271905 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m15:24:51.572634 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
[0m15:24:51.577671 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:51.590154 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_is_late_delivery`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_is_late_delivery | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:51.630630 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m15:24:51.646024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:52.143343 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:460d31d7-6246-4957-9d63-6aa553a86a90&page=queryresults
[0m15:24:52.143343 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:618b5fb1-6551-41c9-b9ea-e110dee8b1e9&page=queryresults
[0m15:24:52.338282 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:24:52.637992 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:53.156393 [info ] [Thread-3 (]: 65 of 148 PASS not_null_stg_orders_is_late_delivery ............................ [[32mPASS[0m in 6.84s]
[0m15:24:53.162699 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0
[0m15:24:53.168954 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m15:24:53.170949 [info ] [Thread-3 (]: 69 of 148 START test not_null_stg_orders_ordered_at ............................ [RUN]
[0m15:24:53.179361 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_is_late_delivery.8c21ef1ce0, now test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca)
[0m15:24:53.192408 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m15:24:53.255897 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m15:24:53.269298 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m15:24:53.286527 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:24:53.390135 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:34359a99-9ec8-4ba9-b2ac-0d5e6bbec237&page=queryresults
[0m15:24:53.879230 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
[0m15:24:53.888394 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:54.238047 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:24:54.338059 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:54.504970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d72c861c-c4fe-4010-a9ea-1f307d24d8ed&page=queryresults
[0m15:24:54.624302 [info ] [Thread-2 (]: 66 of 148 PASS not_null_stg_orders_order_date .................................. [[32mPASS[0m in 6.55s]
[0m15:24:54.631682 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb
[0m15:24:54.636196 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:24:54.640809 [info ] [Thread-2 (]: 70 of 148 START test relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:24:54.645773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54)
[0m15:24:54.652957 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:24:54.706308 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:24:54.737197 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:24:54.751410 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
[0m15:24:54.753610 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:54.753610 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:55.090734 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9f6d56dd-4e48-446f-8bc6-f2a5b3857b87&page=queryresults
[0m15:24:55.420896 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:560285c2-d6e2-4801-8dc2-f3f7dfba6892&page=queryresults
[0m15:24:55.955607 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
[0m15:24:55.955607 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select order_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where order_id is not null
),

parent as (
    select order_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:56.131753 [info ] [Thread-4 (]: 67 of 148 PASS not_null_stg_orders_order_id .................................... [[32mPASS[0m in 6.34s]
[0m15:24:56.137786 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64
[0m15:24:56.140957 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:24:56.140957 [info ] [Thread-4 (]: 71 of 148 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:24:56.149079 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:24:56.153581 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:24:56.194218 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:24:56.236583 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:24:56.253390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:24:56.524929 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7fa3e249-7404-43f9-affc-797c961d8d3d&page=queryresults
[0m15:24:57.858901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79"
[0m15:24:57.858901 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca"
[0m15:24:58.267863 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:58.274613 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:58.806060 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
[0m15:24:58.818780 [debug] [Thread-4 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:24:59.072745 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fe53826d-4a7b-474e-8c93-d670b3f0595b&page=queryresults
[0m15:24:59.076733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:883fce66-19cf-4bc5-8311-ca5f0f17ff5f&page=queryresults
[0m15:24:59.170957 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54"
[0m15:24:59.434110 [debug] [Thread-2 (]: On test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_order_id__order_id__ref_stg_orders_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:24:59.554568 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3dd6d89d-807a-4ba4-803f-8ac8b93e95b2&page=queryresults
[0m15:25:00.754010 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f13e78d3-ac90-401b-8dcf-6eaf6d413308&page=queryresults
[0m15:25:02.222677 [info ] [Thread-3 (]: 69 of 148 PASS not_null_stg_orders_ordered_at .................................. [[32mPASS[0m in 9.04s]
[0m15:25:02.231247 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca
[0m15:25:02.236437 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m15:25:02.241548 [info ] [Thread-3 (]: 72 of 148 START test unique_stg_orders_order_id ................................ [RUN]
[0m15:25:02.246195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_ordered_at.ed431172ca, now test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a)
[0m15:25:02.253205 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m15:25:02.304706 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m15:25:02.352591 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m15:25:02.371025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:03.123707 [info ] [Thread-1 (]: 68 of 148 PASS not_null_stg_orders_order_status ................................ [[32mPASS[0m in 11.89s]
[0m15:25:03.136465 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79
[0m15:25:03.137693 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m15:25:03.141084 [info ] [Thread-1 (]: 73 of 148 START test accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [RUN]
[0m15:25:03.142084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_orders_order_status.d7fcf15f79, now test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b)
[0m15:25:03.142084 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m15:25:03.171534 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m15:25:03.183457 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m15:25:03.203396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:07.156597 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:25:07.166869 [warn ] [Thread-2 (]: 70 of 148 WARN 862 relationships_stg_order_items_order_id__order_id__ref_stg_orders_  [[33mWARN 862[0m in 12.52s]
[0m15:25:07.175603 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54
[0m15:25:07.175603 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m15:25:07.182152 [info ] [Thread-2 (]: 74 of 148 START test is_not_negative_stg_products_weight_grams ................. [RUN]
[0m15:25:07.187533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_order_id__order_id__ref_stg_orders_.dbe9930c54, now test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890)
[0m15:25:07.191809 [debug] [Thread-4 (]: On test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:07.203494 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m15:25:07.254098 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m15:25:07.300889 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m15:25:07.320361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:08.304433 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4fc93f2b-e4c4-4099-a4c8-aaa3bb12bdcf&page=queryresults
[0m15:25:12.101200 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
[0m15:25:12.109653 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:12.222882 [warn ] [Thread-4 (]: 71 of 148 WARN 902 relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[33mWARN 902[0m in 16.08s]
[0m15:25:12.228077 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:25:12.233859 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m15:25:12.237010 [info ] [Thread-4 (]: 75 of 148 START test not_null_stg_products_product_id .......................... [RUN]
[0m15:25:12.240588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3)
[0m15:25:12.249198 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m15:25:12.292212 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m15:25:12.336989 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m15:25:12.359439 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:13.321452 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
[0m15:25:13.322448 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
[0m15:25:13.322448 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4f15e134-dbd7-44a1-9c3a-b7491de26cd0&page=queryresults
[0m15:25:13.338361 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    weight_grams as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where weight_grams < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:13.342463 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        size_category as value_field,
        count(*) as n_records

    from (select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products` where size_category is not null) dbt_subquery
    group by size_category

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Extra Large'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:14.375232 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b5a11f25-f7dc-4cbe-86c3-957a64582caf&page=queryresults
[0m15:25:14.382479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5daf5ddd-caad-4854-847a-5ebe773ee376&page=queryresults
[0m15:25:14.753476 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
[0m15:25:14.762621 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:15.382705 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a"
[0m15:25:15.402367 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fd17b9ac-4702-4c99-b68e-389fe3561a1d&page=queryresults
[0m15:25:15.419564 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:16.144721 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890"
[0m15:25:16.169352 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:57fe6876-fe69-4501-a450-a0405b119890&page=queryresults
[0m15:25:16.181336 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_stg_products_weight_grams`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_stg_products_weight_grams | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:16.309976 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b"
[0m15:25:16.529272 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_stg_products_6fcf4aab6b8b938367296091ab8a30a3`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:17.139881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:95917716-d821-45f2-bb8d-4419ef918933&page=queryresults
[0m15:25:17.150755 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:33a4aa47-e13a-4808-aeb6-b758ef5acdf0&page=queryresults
[0m15:25:17.466093 [info ] [Thread-3 (]: 72 of 148 PASS unique_stg_orders_order_id ...................................... [[32mPASS[0m in 15.22s]
[0m15:25:17.472943 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a
[0m15:25:17.472943 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:25:17.498979 [info ] [Thread-3 (]: 76 of 148 START test relationships_stg_order_items_product_id__product_id__ref_stg_products_  [RUN]
[0m15:25:17.524502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_orders_order_id.e3b841c71a, now test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c)
[0m15:25:17.530581 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:25:17.561807 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m15:25:17.578044 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:25:17.591238 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:17.827378 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3"
[0m15:25:17.864312 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:18.242101 [info ] [Thread-1 (]: 73 of 148 PASS accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large  [[32mPASS[0m in 15.10s]
[0m15:25:18.250335 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b
[0m15:25:18.244039 [info ] [Thread-2 (]: 74 of 148 PASS is_not_negative_stg_products_weight_grams ....................... [[32mPASS[0m in 11.06s]
[0m15:25:18.252450 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m15:25:18.257460 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890
[0m15:25:18.259455 [info ] [Thread-1 (]: 77 of 148 START test unique_stg_products_product_id ............................ [RUN]
[0m15:25:18.261084 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m15:25:18.262578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_stg_products_size_category__Small__Medium__Large__Extra_Large.5934d0bd1b, now test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467)
[0m15:25:18.267756 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m15:25:18.264573 [info ] [Thread-2 (]: 78 of 148 START test not_null_stg_product_categories_category_group ............ [RUN]
[0m15:25:18.292215 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m15:25:18.292215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_stg_products_weight_grams.0ad7423890, now test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a)
[0m15:25:18.298419 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m15:25:18.319648 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m15:25:18.373083 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m15:25:18.389471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:18.480889 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7ca9af9b-64e4-48f1-9bc4-3b096db68dda&page=queryresults
[0m15:25:18.484281 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m15:25:18.499290 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:19.139862 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
[0m15:25:19.149603 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select product_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    where product_id is not null
),

parent as (
    select product_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:19.771843 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:84921d43-3815-4b3e-9396-dbb635e153e6&page=queryresults
[0m15:25:19.889352 [info ] [Thread-4 (]: 75 of 148 PASS not_null_stg_products_product_id ................................ [[32mPASS[0m in 7.65s]
[0m15:25:19.896542 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3
[0m15:25:19.903503 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m15:25:19.910054 [info ] [Thread-4 (]: 79 of 148 START test not_null_stg_product_categories_category_name_en .......... [RUN]
[0m15:25:19.914578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_products_product_id.6373b0acf3, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17)
[0m15:25:19.919537 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m15:25:19.951230 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
[0m15:25:19.966960 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:19.970020 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m15:25:20.032613 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m15:25:20.048294 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:20.156200 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
[0m15:25:20.163979 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:20.903411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ba5b4666-160b-48df-b73c-5ab021ca77ac&page=queryresults
[0m15:25:20.908426 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:465e3ae4-096e-41f1-aff8-a1f9376ec9b0&page=queryresults
[0m15:25:21.821285 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
[0m15:25:21.824602 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_en is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:22.622969 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c"
[0m15:25:22.632384 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f44f5148-1bd8-4b47-991b-b6500d0ef6c7&page=queryresults
[0m15:25:22.712342 [debug] [Thread-3 (]: On test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_stg_order_items_product_id__product_id__ref_stg_products_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:23.112801 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a"
[0m15:25:23.153826 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:23.353016 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:96cac6bb-eae6-4af0-b226-edefd61f0401&page=queryresults
[0m15:25:23.493077 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467"
[0m15:25:23.522672 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_products_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_products_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:23.762778 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bdbb674f-2b58-41d1-98ca-4fb8d8afb822&page=queryresults
[0m15:25:24.108178 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:75c42249-7671-4f37-80c8-303089372533&page=queryresults
[0m15:25:24.691700 [warn ] [Thread-3 (]: 76 of 148 WARN 642 relationships_stg_order_items_product_id__product_id__ref_stg_products_  [[33mWARN 642[0m in 7.17s]
[0m15:25:24.698392 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c
[0m15:25:24.700559 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m15:25:24.702554 [info ] [Thread-3 (]: 80 of 148 START test not_null_stg_product_categories_category_name_pt .......... [RUN]
[0m15:25:24.705008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.relationships_stg_order_items_product_id__product_id__ref_stg_products_.886a82c26c, now test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c)
[0m15:25:24.706004 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m15:25:24.719236 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m15:25:24.749038 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m15:25:24.753573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:24.827533 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17"
[0m15:25:24.833041 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_en`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_en | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:25.016108 [info ] [Thread-2 (]: 78 of 148 PASS not_null_stg_product_categories_category_group .................. [[32mPASS[0m in 6.72s]
[0m15:25:25.023185 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a
[0m15:25:25.029187 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m15:25:25.034917 [info ] [Thread-2 (]: 81 of 148 START test unique_stg_product_categories_category_name_pt ............ [RUN]
[0m15:25:25.040219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_group.1d8eabbf9a, now test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374)
[0m15:25:25.041219 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m15:25:25.084968 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m15:25:25.094025 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m15:25:25.115191 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:25.399787 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6fdaff9b-e347-4708-b42e-8e336fe6f7de&page=queryresults
[0m15:25:25.615089 [info ] [Thread-1 (]: 77 of 148 PASS unique_stg_products_product_id .................................. [[32mPASS[0m in 7.35s]
[0m15:25:25.636226 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467
[0m15:25:25.639080 [debug] [Thread-1 (]: Began running node snapshot.dbt_advanced_olist.customers_snapshot
[0m15:25:25.641075 [info ] [Thread-1 (]: 82 of 148 START snapshot snapshots.customers_snapshot .......................... [RUN]
[0m15:25:25.652397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_products_product_id.7d950a1467, now snapshot.dbt_advanced_olist.customers_snapshot)
[0m15:25:25.654246 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_advanced_olist.customers_snapshot
[0m15:25:25.668204 [debug] [Thread-1 (]: Began executing node snapshot.dbt_advanced_olist.customers_snapshot
[0m15:25:25.818895 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        select customer_city, customer_state, customer_zip_code from (
                



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`

            ) subq
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m15:25:25.822436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:26.983754 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
[0m15:25:26.991434 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
where category_name_pt is null



  
  
    )
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:26.987953 [info ] [Thread-4 (]: 79 of 148 PASS not_null_stg_product_categories_category_name_en ................ [[32mPASS[0m in 7.07s]
[0m15:25:26.997894 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17
[0m15:25:26.999760 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m15:25:27.001756 [info ] [Thread-4 (]: 83 of 148 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [RUN]
[0m15:25:27.005968 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_en.f6871fab17, now model.dbt_advanced_olist.int_orders_enriched)
[0m15:25:27.008303 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m15:25:27.046050 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m15:25:27.131030 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m15:25:27.135020 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m15:25:27.238947 [debug] [Thread-4 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m15:25:27.239943 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:27.372314 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
[0m15:25:27.376043 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select category_name_pt as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  where category_name_pt is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:27.756725 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c7be3280-3c57-4ed2-88e0-d234e19a70a1&page=queryresults
[0m15:25:28.080558 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c9875f7-4082-4db8-92ba-ddf760b7c278&page=queryresults
[0m15:25:28.182803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6610ac55-6711-47d6-98b5-02e220f83af0&page=queryresults
[0m15:25:28.915564 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c134cc36-8977-41f7-aa52-deeedf7aa35e&page=queryresults
[0m15:25:29.584434 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c"
[0m15:25:29.586625 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6AA06890>]}
[0m15:25:29.590690 [info ] [Thread-4 (]: 83 of 148 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.58s]
[0m15:25:29.596674 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m15:25:29.600746 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m15:25:29.602471 [info ] [Thread-4 (]: 84 of 148 START test assert_order_total_matches_items .......................... [RUN]
[0m15:25:29.604163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_orders_enriched, now test.dbt_advanced_olist.assert_order_total_matches_items)
[0m15:25:29.607185 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.assert_order_total_matches_items
[0m15:25:29.618401 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m15:25:29.633015 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:29.640362 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.assert_order_total_matches_items
[0m15:25:29.650771 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:29.949484 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374"
[0m15:25:30.095214 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_stg_product_categories_category_name_pt`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_stg_product_categories_category_name_pt | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:30.116023 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: 
        
  
    

    create or replace table `big-query-dbt-481111`.`snapshots`.`customers_snapshot__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      
    
    with snapshot_query as (

        



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `big-query-dbt-481111`.`snapshots`.`customers_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    )
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */;
[0m15:25:30.159199 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a4ac6074-a965-4354-be51-f524f92dea00&page=queryresults
[0m15:25:30.787794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6d0b1a95-9231-46b3-bc62-fa9b4bfe1f20&page=queryresults
[0m15:25:30.849659 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f7af7a3-7353-44ce-a3d1-b7d745edf904&page=queryresults
[0m15:25:30.934987 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
[0m15:25:30.941032 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_order_total_matches_items
  
  Purpose: Order total should equal sum of item totals (within tolerance)
  
  Business Rule: Order total = sum(item_price + item_freight) for all items
  
  Tolerance: 1 BRL to account for rounding
  
  Test PASSES if query returns 0 rows
*/

with order_totals_from_items as (
    select
        order_id,
        sum(item_total) as calculated_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
    group by 1
),

order_totals_from_orders as (
    select
        order_id,
        order_total
    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

mismatches as (
    select
        o.order_id,
        o.order_total as reported_total,
        i.calculated_total,
        abs(o.order_total - i.calculated_total) as difference
    from order_totals_from_orders o
    inner join order_totals_from_items i on o.order_id = i.order_id
    where abs(o.order_total - i.calculated_total) > 1  -- 1 BRL tolerance
)

select
    order_id,
    reported_total,
    calculated_total,
    round(difference, 2) as difference_brl,
    'Order total does not match sum of items' as failure_reason
from mismatches
  
  
    )
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:31.147811 [info ] [Thread-3 (]: 80 of 148 PASS not_null_stg_product_categories_category_name_pt ................ [[32mPASS[0m in 6.44s]
[0m15:25:31.151602 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c
[0m15:25:31.153699 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m15:25:31.155500 [info ] [Thread-3 (]: 85 of 148 START test dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [RUN]
[0m15:25:31.158872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_stg_product_categories_category_name_pt.0008d2c77c, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75)
[0m15:25:31.161895 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m15:25:31.178883 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m15:25:31.334123 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m15:25:31.362558 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:31.740168 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fdbf0bab-2524-482e-8f4a-47f2ed787501&page=queryresults
[0m15:25:31.881724 [info ] [Thread-2 (]: 81 of 148 PASS unique_stg_product_categories_category_name_pt .................. [[32mPASS[0m in 6.84s]
[0m15:25:31.884745 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374
[0m15:25:31.886711 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m15:25:31.887708 [info ] [Thread-2 (]: 86 of 148 START test is_not_negative_int_orders_enriched_order_total ........... [RUN]
[0m15:25:31.890700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_stg_product_categories_category_name_pt.63a123e374, now test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf)
[0m15:25:31.891805 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m15:25:31.905727 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m15:25:31.979571 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m15:25:31.982769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:32.781526 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
[0m15:25:32.798878 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and item_count >= 0 and item_count <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:33.407059 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
[0m15:25:33.412040 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    order_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:33.537480 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:611735d2-d395-482f-abaa-2968e80b3a34&page=queryresults
[0m15:25:33.877090 [debug] [Thread-1 (]: BigQuery adapter: Adding columns ([]) to table `big-query-dbt-481111`.`snapshots`.`customers_snapshot`".
[0m15:25:34.024714 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bf5c1844-50eb-42fe-86e2-076e48333021&page=queryresults
[0m15:25:34.140411 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_order_total_matches_items"
[0m15:25:34.165182 [debug] [Thread-4 (]: On test.dbt_advanced_olist.assert_order_total_matches_items: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_order_total_matches_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_order_total_matches_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:34.723231 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:46af8a6a-5675-453d-b63f-1843130495a9&page=queryresults
[0m15:25:35.197000 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        
    
    with snapshot_query as (

        



/*
  SNAPSHOT: customers_snapshot
  
  Purpose: Track historical changes to customer data (SCD Type 2)
  
  Strategy: 'check' - monitors specified columns for changes
  
  Tracked columns:
  - customer_city
  - customer_state  
  - customer_zip_code
  
  Added columns:
  - dbt_valid_from: When this version became active
  - dbt_valid_to: When this version was superseded (NULL = current)
  - dbt_scd_id: Unique identifier for this version
  
  Usage:
    dbt snapshot
*/

select
    customer_id,
    customer_unique_id,
    customer_city,
    customer_state,
    customer_zip_code,
    customer_region,
    current_timestamp() as _snapshot_at

from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`


    ),

    snapshotted_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from `big-query-dbt-481111`.`snapshots`.`customers_snapshot`
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
  
  coalesce(nullif(
    current_timestamp()
, 
    current_timestamp()
), null)
  as dbt_valid_to
,
            to_hex(md5(concat(coalesce(cast(customer_id as string), ''), '|',coalesce(cast(
    current_timestamp()
 as string), '')))) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    
,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        customer_id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.`customer_city` != source_data.`customer_city`
        or
        (
            ((snapshotted_data.`customer_city` is null) and not (source_data.`customer_city` is null))
            or
            ((not snapshotted_data.`customer_city` is null) and (source_data.`customer_city` is null))
        ) or snapshotted_data.`customer_state` != source_data.`customer_state`
        or
        (
            ((snapshotted_data.`customer_state` is null) and not (source_data.`customer_state` is null))
            or
            ((not snapshotted_data.`customer_state` is null) and (source_data.`customer_state` is null))
        ) or snapshotted_data.`customer_zip_code` != source_data.`customer_zip_code`
        or
        (
            ((snapshotted_data.`customer_zip_code` is null) and not (source_data.`customer_zip_code` is null))
            or
            ((not snapshotted_data.`customer_zip_code` is null) and (source_data.`customer_zip_code` is null))
        ))
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            
    current_timestamp()
 as dbt_valid_from,
            
    current_timestamp()
 as dbt_updated_at,
            
    current_timestamp()
 as dbt_valid_to,
            snapshotted_data.dbt_scd_id
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m15:25:36.034184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:93919088-5d41-4515-bad1-3e60cc33ef41&page=queryresults
[0m15:25:36.056375 [info ] [Thread-4 (]: 84 of 148 PASS assert_order_total_matches_items ................................ [[32mPASS[0m in 6.45s]
[0m15:25:36.060155 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.assert_order_total_matches_items
[0m15:25:36.062181 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m15:25:36.064146 [info ] [Thread-4 (]: 87 of 148 START test not_null_int_orders_enriched_item_count ................... [RUN]
[0m15:25:36.066219 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_order_total_matches_items, now test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101)
[0m15:25:36.067246 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m15:25:36.083910 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m15:25:36.088900 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m15:25:36.102145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:36.105450 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75"
[0m15:25:36.183513 [debug] [Thread-3 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_d446a35bc287822feb55a79024ef5f04`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:36.428569 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: select * from (
        select 
    current_timestamp()
 as dbt_snapshot_time
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m15:25:36.434932 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf"
[0m15:25:36.505165 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:36.818852 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6e375c32-79fd-4144-86b5-e6d63a4ab71c&page=queryresults
[0m15:25:36.872977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b0d7a807-2411-4bd0-b8fb-c735f40bd65e&page=queryresults
[0m15:25:37.054079 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cdaae047-3722-4574-ad8b-098bd87950e2&page=queryresults
[0m15:25:37.174463 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_advanced_olist.customers_snapshot"
[0m15:25:37.226601 [debug] [Thread-1 (]: On snapshot.dbt_advanced_olist.customers_snapshot: 
      merge into `big-query-dbt-481111`.`snapshots`.`customers_snapshot` as DBT_INTERNAL_DEST
    using `big-query-dbt-481111`.`snapshots`.`customers_snapshot__dbt_tmp` as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert (`customer_id`, `customer_unique_id`, `customer_city`, `customer_state`, `customer_zip_code`, `customer_region`, `_snapshot_at`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
        values (`customer_id`, `customer_unique_id`, `customer_city`, `customer_state`, `customer_zip_code`, `customer_region`, `_snapshot_at`, `dbt_updated_at`, `dbt_valid_from`, `dbt_valid_to`, `dbt_scd_id`)
/* dbt 1.10.15 | model: customers_snapshot | schema: snapshots */
[0m15:25:37.364121 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
[0m15:25:37.373552 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:37.554082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d457ef87-df2d-4b8f-90ef-9a66f29ac214&page=queryresults
[0m15:25:37.819673 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d457ef87-df2d-4b8f-90ef-9a66f29ac214&page=queryresults
[0m15:25:37.954560 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2fe19ed6-5b1f-4b91-b52e-6b999fb45a80&page=queryresults
[0m15:25:37.959150 [info ] [Thread-3 (]: 85 of 148 PASS dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0  [[32mPASS[0m in 6.80s]
[0m15:25:37.977522 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75
[0m15:25:37.977522 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m15:25:37.977522 [info ] [Thread-3 (]: 88 of 148 START test not_null_int_orders_enriched_order_id ..................... [RUN]
[0m15:25:37.988678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_orders_enriched_item_count__100__0.c07d614d75, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e)
[0m15:25:37.991273 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m15:25:38.000023 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m15:25:38.113378 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m15:25:38.132386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:38.351598 [info ] [Thread-2 (]: 86 of 148 PASS is_not_negative_int_orders_enriched_order_total ................. [[32mPASS[0m in 6.46s]
[0m15:25:38.364060 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf
[0m15:25:38.367756 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m15:25:38.371644 [info ] [Thread-2 (]: 89 of 148 START test not_null_int_orders_enriched_order_total .................. [RUN]
[0m15:25:38.374382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_int_orders_enriched_order_total.044d3a36bf, now test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c)
[0m15:25:38.379250 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m15:25:38.399096 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m15:25:38.445355 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m15:25:38.463680 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:38.779519 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m15:25:38.782363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6CB662D0>]}
[0m15:25:38.785538 [error] [Thread-1 (]: 82 of 148 ERROR snapshotting snapshots.customers_snapshot ...................... [[31mERROR[0m in 13.13s]
[0m15:25:38.789629 [debug] [Thread-1 (]: Finished running node snapshot.dbt_advanced_olist.customers_snapshot
[0m15:25:38.793698 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m15:25:38.796770 [debug] [Thread-7 (]: Marking all children of 'snapshot.dbt_advanced_olist.customers_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql.
[0m15:25:38.799032 [info ] [Thread-1 (]: 90 of 148 START test unique_int_orders_enriched_order_id ....................... [RUN]
[0m15:25:38.803130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_advanced_olist.customers_snapshot, now test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232)
[0m15:25:38.804126 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m15:25:38.829259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m15:25:38.836721 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m15:25:38.855730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:40.231212 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
[0m15:25:40.245142 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:40.454318 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
[0m15:25:40.462837 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:40.763895 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101"
[0m15:25:40.801482 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:40.853033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:52e6d4d8-3b03-474f-a066-49f67aca9a8a&page=queryresults
[0m15:25:41.392453 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3e98eced-c615-46a5-865b-f05fbf715189&page=queryresults
[0m15:25:41.397037 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5cf02028-2f78-419b-8f7b-63a4feab5c64&page=queryresults
[0m15:25:41.736646 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
[0m15:25:41.745510 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:42.887892 [info ] [Thread-4 (]: 87 of 148 PASS not_null_int_orders_enriched_item_count ......................... [[32mPASS[0m in 6.82s]
[0m15:25:42.896146 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:984116a0-44c9-4f86-bb1d-ede4edac424f&page=queryresults
[0m15:25:42.904698 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101
[0m15:25:42.915973 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.int_products_enriched
[0m15:25:42.919597 [info ] [Thread-4 (]: 91 of 148 START sql view model dbt_dev_yourname_intermediate.int_products_enriched  [RUN]
[0m15:25:42.922571 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_item_count.7988001101, now model.dbt_advanced_olist.int_products_enriched)
[0m15:25:42.926986 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.int_products_enriched
[0m15:25:42.945804 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_products_enriched"
[0m15:25:43.039206 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.int_products_enriched
[0m15:25:43.056531 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_products_enriched"
[0m15:25:43.065206 [debug] [Thread-4 (]: On model.dbt_advanced_olist.int_products_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_products_enriched
  
  Purpose: Enrich products with category translations and sales metrics
*/

with products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
),

categories as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Calculate product-level sales metrics
product_sales as (
    select
        product_id,
        count(distinct order_id) as times_ordered,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_selling_price,
        min(item_price) as min_selling_price,
        max(item_price) as max_selling_price
    from order_items
    group by 1
),

-- Join products with categories and sales
enriched as (
    select
        -- Product info
        p.product_id,
        p.category_name_pt,
        coalesce(c.category_name_en, 'Unknown') as category_name,
        coalesce(c.category_group, 'Other') as category_group,
        
        -- Dimensions
        p.weight_grams,
        p.length_cm,
        p.height_cm,
        p.width_cm,
        p.volume_cm3,
        p.size_category,
        
        -- Product listing quality
        p.name_length,
        p.description_length,
        p.photo_count,
        
        -- Derived: Listing quality score (0-100)
        (
            case when p.name_length > 0 then 20 else 0 end +
            case when p.description_length > 100 then 30 else p.description_length * 0.3 end +
            case when p.photo_count >= 3 then 50 else p.photo_count * 15 end
        ) as listing_quality_score,
        
        -- Sales metrics
        coalesce(ps.times_ordered, 0) as times_ordered,
        coalesce(ps.total_revenue, 0) as total_revenue,
        coalesce(ps.avg_selling_price, 0) as avg_selling_price,
        
        -- Derived: Product popularity tier
        case
            when coalesce(ps.times_ordered, 0) = 0 then 'Never Sold'
            when ps.times_ordered < 5 then 'Low'
            when ps.times_ordered < 20 then 'Medium'
            when ps.times_ordered < 50 then 'High'
            else 'Top Seller'
        end as popularity_tier

    from products p
    left join categories c on p.category_name_pt = c.category_name_pt
    left join product_sales ps on p.product_id = ps.product_id
)

select * from enriched
/* dbt 1.10.15 | model: int_products_enriched | schema: dbt_dev_yourname_intermediate */;
[0m15:25:43.069384 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:43.634379 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232"
[0m15:25:43.679366 [debug] [Thread-1 (]: On test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:43.686028 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c"
[0m15:25:43.720711 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:44.245162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:764ce1d4-e289-4ab5-a4c4-0496a307ef2d&page=queryresults
[0m15:25:44.394045 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bfd57d79-38f6-46ac-b4fe-8dd8d41236c4&page=queryresults
[0m15:25:45.168113 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fa797496-6685-4794-95f7-caa64a24f88c&page=queryresults
[0m15:25:45.182769 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e"
[0m15:25:45.430340 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_orders_enriched_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_orders_enriched_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:45.687384 [info ] [Thread-1 (]: 90 of 148 PASS unique_int_orders_enriched_order_id ............................. [[32mPASS[0m in 6.88s]
[0m15:25:45.692481 [info ] [Thread-2 (]: 89 of 148 PASS not_null_int_orders_enriched_order_total ........................ [[32mPASS[0m in 7.32s]
[0m15:25:45.700917 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232
[0m15:25:45.705990 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c
[0m15:25:45.954781 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:662c8a0d-d45b-46c2-ae39-2ccb18160f89&page=queryresults
[0m15:25:45.988236 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6C46FC10>]}
[0m15:25:45.989238 [info ] [Thread-4 (]: 91 of 148 OK created sql view model dbt_dev_yourname_intermediate.int_products_enriched  [[32mCREATE VIEW (0 processed)[0m in 3.07s]
[0m15:25:46.003751 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.int_products_enriched
[0m15:25:46.008045 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m15:25:46.014010 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m15:25:46.017483 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m15:25:46.020143 [info ] [Thread-1 (]: 92 of 148 START test dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [RUN]
[0m15:25:46.023265 [info ] [Thread-2 (]: 93 of 148 START test not_null_int_products_enriched_category_name .............. [RUN]
[0m15:25:46.030038 [info ] [Thread-4 (]: 94 of 148 START test not_null_int_products_enriched_product_id ................. [RUN]
[0m15:25:46.035230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_orders_enriched_order_id.a2feb2a232, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd)
[0m15:25:46.038554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_total.43e7cc517c, now test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760)
[0m15:25:46.043407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_products_enriched, now test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565)
[0m15:25:46.047794 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m15:25:46.051592 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m15:25:46.055439 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m15:25:46.077994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m15:25:46.116941 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m15:25:46.146092 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m15:25:46.180401 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m15:25:46.182894 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m15:25:46.194322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:46.194322 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m15:25:46.203672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:46.247494 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:25:47.310633 [info ] [Thread-3 (]: 88 of 148 PASS not_null_int_orders_enriched_order_id ........................... [[32mPASS[0m in 9.32s]
[0m15:25:47.313926 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e
[0m15:25:47.315533 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m15:25:47.317340 [info ] [Thread-3 (]: 95 of 148 START test unique_int_products_enriched_product_id ................... [RUN]
[0m15:25:47.320376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_orders_enriched_order_id.1d0ad6982e, now test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117)
[0m15:25:47.321406 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m15:25:47.331160 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m15:25:47.334615 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m15:25:47.346087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:25:48.545743 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
[0m15:25:48.551327 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
[0m15:25:48.555286 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where category_name is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:48.570658 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
where product_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:48.627594 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
[0m15:25:48.630383 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and listing_quality_score >= 0 and listing_quality_score <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:49.310803 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:de16a30d-f9b4-46d1-9e30-0c59b54b88df&page=queryresults
[0m15:25:49.444005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:de34e141-4f7a-4297-b1eb-c6b5c71fc8b0&page=queryresults
[0m15:25:49.880026 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
[0m15:25:49.880026 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ba292e1b-37ba-4fd7-8ba1-79ac93b1229f&page=queryresults
[0m15:25:49.886520 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:25:50.796059 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4e08c47c-0e23-4498-a6e5-8814c40f54ad&page=queryresults
[0m15:25:51.504803 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd"
[0m15:25:51.526664 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_fb3d1af4626c7e40bd28b2baa1e41388`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:51.616595 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760"
[0m15:25:51.640488 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_category_name`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_category_name | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:52.132529 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565"
[0m15:25:52.140281 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:52.210373 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4a05e123-cb08-4a2a-88c7-b0360a75fb13&page=queryresults
[0m15:25:52.461770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0ce3cdc7-7ca1-470c-b256-e32d3eb697f2&page=queryresults
[0m15:25:52.668134 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:59ca03f9-5b95-406b-97ad-df6417b30956&page=queryresults
[0m15:25:52.691016 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117"
[0m15:25:52.694418 [debug] [Thread-3 (]: On test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_int_products_enriched_product_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_int_products_enriched_product_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:25:53.148347 [info ] [Thread-2 (]: 93 of 148 PASS not_null_int_products_enriched_category_name .................... [[32mPASS[0m in 7.11s]
[0m15:25:53.155098 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760
[0m15:25:53.157199 [debug] [Thread-2 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m15:25:53.160193 [info ] [Thread-2 (]: 96 of 148 START unit_test dim_customers::test_customer_segment_high_value ...... [RUN]
[0m15:25:53.162471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_category_name.3af4e1f760, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value)
[0m15:25:53.163546 [debug] [Thread-2 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m15:25:53.165042 [debug] [Thread-2 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m15:25:53.351614 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:25:53.517337 [info ] [Thread-1 (]: 92 of 148 PASS dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0  [[32mPASS[0m in 7.48s]
[0m15:25:53.527218 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd
[0m15:25:54.019577 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f6ea1fc2-f6be-4a05-bbad-cc5bba294103&page=queryresults
[0m15:25:54.227839 [info ] [Thread-4 (]: 94 of 148 PASS not_null_int_products_enriched_product_id ....................... [[32mPASS[0m in 8.18s]
[0m15:25:54.234661 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565
[0m15:25:54.783437 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m15:25:54.959961 [info ] [Thread-3 (]: 95 of 148 PASS unique_int_products_enriched_product_id ......................... [[32mPASS[0m in 7.64s]
[0m15:25:54.965496 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117
[0m15:25:54.967072 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.fct_orders
[0m15:25:54.969536 [info ] [Thread-1 (]: 97 of 148 START sql table model dbt_dev_yourname_marts.fct_orders .............. [RUN]
[0m15:25:54.972709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_int_products_enriched_listing_quality_score__100__0.7b6d3c55fd, now model.dbt_advanced_olist.fct_orders)
[0m15:25:54.972709 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.fct_orders
[0m15:25:54.992348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.fct_orders"
[0m15:25:54.995660 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.fct_orders
[0m15:25:55.010047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:55.211860 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m15:25:55.431061 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m15:25:55.475046 [debug] [Thread-2 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_high_value__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */;
[0m15:25:55.978724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:995742df-1f79-488e-95f6-8fff7312d7f3&page=queryresults
[0m15:25:56.422718 [debug] [Thread-1 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m15:25:57.214869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:99f0b1c8-5da7-4a15-9115-50f87b461ba7&page=queryresults
[0m15:25:57.622425 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['subtotal', 'freight_total', 'order_total', 'avg_item_price']`
[0m15:25:57.628519 [debug] [Thread-1 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        select
    
      
    cast(null as string)
 as order_id, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as order_status, 
      
    cast(null as date)
 as order_date, 
      
    cast(null as timestamp)
 as ordered_at, 
      
    cast(null as timestamp)
 as approved_at, 
      
    cast(null as timestamp)
 as shipped_at, 
      
    cast(null as timestamp)
 as delivered_at, 
      
    cast(null as timestamp)
 as estimated_delivery_at, 
      
    cast(null as int64)
 as order_year, 
      
    cast(null as int64)
 as order_month, 
      
    cast(null as int64)
 as order_quarter, 
      
    cast(null as int64)
 as order_week, 
      
    cast(null as int64)
 as order_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as string)
 as primary_category, 
      
    cast(null as string)
 as primary_category_group, 
      
    cast(null as int64)
 as item_count, 
      
    cast(null as int64)
 as unique_products, 
      
    cast(null as numeric)
 as subtotal, 
      
    cast(null as numeric)
 as freight_total, 
      
    cast(null as numeric)
 as order_total, 
      
    cast(null as numeric)
 as avg_item_price, 
      
    cast(null as int64)
 as delivery_days, 
      
    cast(null as boolean)
 as is_late_delivery, 
      
    cast(null as int64)
 as days_late, 
      
    cast(null as string)
 as order_size_bucket, 
      
    cast(null as string)
 as delivery_sla_status, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m15:25:58.110112 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:598f9cda-9f1b-487d-96a0-8f5f79879939&page=queryresults
[0m15:25:58.550353 [warn ] [Thread-1 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m15:25:58.606883 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.fct_orders"
[0m15:25:58.633304 [debug] [Thread-1 (]: On model.dbt_advanced_olist.fct_orders: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
        
  (
    order_id string not null primary key not enforced,
    customer_id string,
    order_status string,
    order_date date,
    ordered_at timestamp,
    approved_at timestamp,
    shipped_at timestamp,
    delivered_at timestamp,
    estimated_delivery_at timestamp,
    order_year int64,
    order_month int64,
    order_quarter int64,
    order_week int64,
    order_day_of_week int64,
    is_weekend boolean,
    customer_city string,
    customer_state string,
    customer_region string,
    primary_category string,
    primary_category_group string,
    item_count int64,
    unique_products int64,
    subtotal numeric,
    freight_total numeric,
    order_total numeric,
    avg_item_price numeric,
    delivery_days int64,
    is_late_delivery boolean,
    days_late int64,
    order_size_bucket string,
    delivery_sla_status string,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(order_date, month)
    cluster by order_status, customer_state

    
    OPTIONS()
    as (
      
    select order_id, customer_id, order_status, order_date, ordered_at, approved_at, shipped_at, delivered_at, estimated_delivery_at, order_year, order_month, order_quarter, order_week, order_day_of_week, is_weekend, customer_city, customer_state, customer_region, primary_category, primary_category_group, item_count, unique_products, subtotal, freight_total, order_total, avg_item_price, delivery_days, is_late_delivery, days_late, order_size_bucket, delivery_sla_status, _loaded_at
    from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */;
[0m15:25:58.693440 [debug] [Thread-2 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value"
[0m15:25:58.747607 [debug] [Thread-2 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(2 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(350.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''cu2''' as STRING) as `customer_unique_id`, safe_cast('''rio''' as STRING) as `customer_city`, safe_cast('''RJ''' as STRING) as `customer_state`, safe_cast('''20000''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c2''' as STRING) as `customer_id`, safe_cast('''High Value''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_high_value | schema: dbt_dev_yourname_marts */
[0m15:25:59.402408 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ef0d5750-7a63-40bf-81f5-f9c8d9165b0f&page=queryresults
[0m15:25:59.402408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:47ad244b-8867-4fa8-ac7c-79c48971e111&page=queryresults
[0m15:26:00.927092 [info ] [Thread-2 (]: 96 of 148 PASS dim_customers::test_customer_segment_high_value ................. [[32mPASS[0m in 7.77s]
[0m15:26:00.932211 [debug] [Thread-2 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value
[0m15:26:00.936335 [debug] [Thread-2 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m15:26:00.937332 [info ] [Thread-2 (]: 98 of 148 START unit_test dim_customers::test_customer_segment_vip ............. [RUN]
[0m15:26:00.948426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_high_value, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip)
[0m15:26:00.952459 [debug] [Thread-2 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m15:26:00.961526 [debug] [Thread-2 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m15:26:01.084880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:03.842130 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m15:26:04.548465 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m15:26:04.674788 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m15:26:04.708018 [debug] [Thread-2 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_vip__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */;
[0m15:26:05.346830 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0c61a396-3db1-469b-86e4-09f934f348ac&page=queryresults
[0m15:26:06.215885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6C3D2190>]}
[0m15:26:06.220375 [info ] [Thread-1 (]: 97 of 148 OK created sql table model dbt_dev_yourname_marts.fct_orders ......... [[32mCREATE TABLE (0.0 rows, 2.8 MiB processed)[0m in 11.24s]
[0m15:26:06.229523 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.fct_orders
[0m15:26:06.233979 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m15:26:06.241827 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m15:26:06.237446 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m15:26:06.245582 [info ] [Thread-3 (]: 99 of 148 START test accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [RUN]
[0m15:26:06.249864 [info ] [Thread-1 (]: 101 of 148 START test accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [RUN]
[0m15:26:06.254851 [info ] [Thread-4 (]: 100 of 148 START test accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [RUN]
[0m15:26:06.264027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_int_products_enriched_product_id.86e7845117, now test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670)
[0m15:26:06.266091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.fct_orders, now test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969)
[0m15:26:06.267089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_int_products_enriched_product_id.d204ef6565, now test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c)
[0m15:26:06.272871 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m15:26:06.276602 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m15:26:06.279047 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m15:26:06.294992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m15:26:06.309988 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m15:26:06.326926 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m15:26:06.330552 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m15:26:06.340939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:06.401566 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m15:26:06.403064 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m15:26:06.408076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:06.423538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:07.498773 [debug] [Thread-2 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip"
[0m15:26:07.507385 [debug] [Thread-2 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast('''o1''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-01-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o2''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-02-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(200.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
union all
select safe_cast('''o3''' as STRING) as `order_id`, safe_cast('''delivered''' as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast('''2017-03-01''' as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(5 as INT64) as `delivery_days`, safe_cast(False as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast('''Southeast''' as STRING) as `customer_region`, safe_cast(1 as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(150.0 as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''cu1''' as STRING) as `customer_unique_id`, safe_cast('''sao paulo''' as STRING) as `customer_city`, safe_cast('''SP''' as STRING) as `customer_state`, safe_cast('''01310''' as STRING) as `customer_zip_code`, safe_cast('''Southeast''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c1''' as STRING) as `customer_id`, safe_cast('''VIP''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_vip | schema: dbt_dev_yourname_marts */
[0m15:26:07.574324 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
[0m15:26:07.577822 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_size_bucket as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_size_bucket

)

select *
from all_values
where value_field not in (
    'Small','Medium','Large','Premium'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:07.617840 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
[0m15:26:07.624231 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','shipped','processing','canceled','invoiced','unavailable','created','approved'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:07.641159 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
[0m15:26:07.641159 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        delivery_sla_status as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    group by delivery_sla_status

)

select *
from all_values
where value_field not in (
    'Met','Missed','Canceled','In Progress'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:08.212609 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3f7f4f6e-7617-4c46-a3af-21aacd3a2e17&page=queryresults
[0m15:26:08.216770 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9b12689e-79c8-4d97-821a-c65399624eed&page=queryresults
[0m15:26:08.220148 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8f70ccef-2205-4c3a-987e-69fbcf5aa719&page=queryresults
[0m15:26:08.230824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d9df6aca-5fbd-4af4-81d2-370ec9902fd4&page=queryresults
[0m15:26:09.788961 [info ] [Thread-2 (]: 98 of 148 PASS dim_customers::test_customer_segment_vip ........................ [[32mPASS[0m in 8.84s]
[0m15:26:09.792936 [debug] [Thread-2 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip
[0m15:26:09.796385 [debug] [Thread-2 (]: Began running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m15:26:09.799655 [info ] [Thread-2 (]: 118 of 148 START unit_test dim_customers::test_customer_segment_no_orders ...... [RUN]
[0m15:26:09.807784 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_vip, now unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders)
[0m15:26:09.813395 [debug] [Thread-2 (]: Began compiling node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m15:26:09.816914 [debug] [Thread-2 (]: Began executing node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m15:26:09.892023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:10.089326 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c"
[0m15:26:10.108684 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670"
[0m15:26:10.114442 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_f8356b7e587f1d3db3642bc91f7d0991`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:10.130628 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969"
[0m15:26:10.135037 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_7909a4876bb36a1a0914d80ac96df889`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:10.146529 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_fct_orders_d67581fad1311f491218b2ec34af4be7`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:10.663636 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ab0fc9ba-a1e1-4e67-813d-86d432438054&page=queryresults
[0m15:26:10.689695 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8508804-6fee-4517-9a0a-52960d7536cc&page=queryresults
[0m15:26:10.825409 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:26dc9002-ee1e-4666-93c8-e102ebf1f50d&page=queryresults
[0m15:26:11.206419 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m15:26:11.589997 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m15:26:11.641585 [info ] [Thread-4 (]: 100 of 148 PASS accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium  [[32mPASS[0m in 5.37s]
[0m15:26:11.655052 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c
[0m15:26:11.667123 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m15:26:11.688883 [info ] [Thread-4 (]: 102 of 148 START test is_not_negative_fct_orders_freight_total ................. [RUN]
[0m15:26:11.731636 [debug] [Thread-2 (]: Writing injected SQL for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m15:26:11.737157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_size_bucket__Small__Medium__Large__Premium.9c5bb5048c, now test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20)
[0m15:26:11.741364 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m15:26:11.764749 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m15:26:11.773719 [debug] [Thread-2 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: 
    
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`test_customer_segment_no_orders__dbt_tmp`
      
    
    

    
    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0

    )
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */;
[0m15:26:11.780927 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m15:26:11.789869 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:11.866949 [info ] [Thread-1 (]: 101 of 148 PASS accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved  [[32mPASS[0m in 5.60s]
[0m15:26:11.873128 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969
[0m15:26:11.875091 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m15:26:11.877193 [info ] [Thread-1 (]: 103 of 148 START test is_not_negative_fct_orders_subtotal ...................... [RUN]
[0m15:26:11.884394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_order_status__delivered__shipped__processing__canceled__invoiced__unavailable__created__approved.a899492969, now test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4)
[0m15:26:11.887428 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m15:26:11.908982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m15:26:11.916674 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m15:26:11.913681 [info ] [Thread-3 (]: 99 of 148 PASS accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress  [[32mPASS[0m in 5.65s]
[0m15:26:11.930250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:11.933821 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670
[0m15:26:11.937536 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m15:26:11.940792 [info ] [Thread-3 (]: 104 of 148 START test not_null_fct_orders_customer_id .......................... [RUN]
[0m15:26:11.998975 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_fct_orders_delivery_sla_status__Met__Missed__Canceled__In_Progress.3153cc9670, now test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b)
[0m15:26:12.002041 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m15:26:12.016512 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:26:12.110872 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m15:26:12.133530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:12.272437 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c9d4f1b7-a16b-4176-8c59-81e80dca8d80&page=queryresults
[0m15:26:12.976030 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
[0m15:26:12.986665 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    freight_total as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:13.210482 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
[0m15:26:13.214558 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    subtotal as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:13.325267 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
[0m15:26:13.331725 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:13.529446 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0fcfb299-8e38-4da1-a5db-357559307ee8&page=queryresults
[0m15:26:13.738677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c110c297-1898-4508-ade4-8934c799254f&page=queryresults
[0m15:26:13.807227 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:db946fb0-d7a3-4f81-8d2d-4a4231bb013d&page=queryresults
[0m15:26:14.979450 [debug] [Thread-2 (]: Writing runtime sql for node "unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders"
[0m15:26:14.988664 [debug] [Thread-2 (]: On unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders: -- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    `customer_id`,`customer_segment`, '''actual''' as `actual_or_expected`
  from (
    

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with  __dbt__cte__int_orders_enriched as (

-- Fixture for int_orders_enriched
select safe_cast(null as STRING) as `order_id`, safe_cast(null as STRING) as `order_status`, safe_cast(null as TIMESTAMP) as `ordered_at`, safe_cast(null as DATE) as `order_date`, safe_cast(null as TIMESTAMP) as `approved_at`, safe_cast(null as TIMESTAMP) as `shipped_at`, safe_cast(null as TIMESTAMP) as `delivered_at`, safe_cast(null as TIMESTAMP) as `estimated_delivery_at`, safe_cast(null as INT64) as `delivery_days`, safe_cast(null as BOOLEAN) as `is_late_delivery`, safe_cast(null as INT64) as `days_late`, safe_cast(null as STRING) as `customer_id`, safe_cast(null as STRING) as `customer_unique_id`, safe_cast(null as STRING) as `customer_city`, safe_cast(null as STRING) as `customer_state`, safe_cast(null as STRING) as `customer_region`, safe_cast(null as INT64) as `item_count`, safe_cast(null as INT64) as `unique_products`, safe_cast(null as NUMERIC) as `subtotal`, safe_cast(null as NUMERIC) as `freight_total`, safe_cast(null as NUMERIC) as `order_total`, safe_cast(null as NUMERIC) as `avg_item_price`, safe_cast(null as NUMERIC) as `max_item_price`, safe_cast(null as STRING) as `order_size_bucket`, safe_cast(null as INT64) as `order_year`, safe_cast(null as INT64) as `order_month`, safe_cast(null as INT64) as `order_quarter`, safe_cast(null as INT64) as `order_week`, safe_cast(null as INT64) as `order_day_of_week`, safe_cast(null as BOOLEAN) as `is_weekend`
    limit 0
),  __dbt__cte__stg_customers as (

-- Fixture for stg_customers
select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''cu3''' as STRING) as `customer_unique_id`, safe_cast('''brasilia''' as STRING) as `customer_city`, safe_cast('''DF''' as STRING) as `customer_state`, safe_cast('''70000''' as STRING) as `customer_zip_code`, safe_cast('''Central-West''' as STRING) as `customer_region`
), orders as (
    select * from __dbt__cte__int_orders_enriched
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from __dbt__cte__stg_customers
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    `customer_id`, `customer_segment`, '''expected''' as `actual_or_expected`
  from (
    select safe_cast('''c3''' as STRING) as `customer_id`, safe_cast('''No Orders''' as STRING) as `customer_segment`
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
/* dbt 1.10.15 | model: test_customer_segment_no_orders | schema: dbt_dev_yourname_marts */
[0m15:26:15.396387 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20"
[0m15:26:15.421316 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:15.464076 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:13e6eea1-c611-4000-ad13-63b3c5dc9048&page=queryresults
[0m15:26:15.971227 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:83350563-3acd-46c1-9d74-f7bb7403007e&page=queryresults
[0m15:26:16.041193 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4"
[0m15:26:16.061090 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:16.627567 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b"
[0m15:26:16.629731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:8d9e9e42-f239-4d88-a74b-b8eda30e3c6e&page=queryresults
[0m15:26:16.640364 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:17.153655 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f744b3d5-4995-4956-96f9-43a0692f04c3&page=queryresults
[0m15:26:17.328245 [info ] [Thread-2 (]: 118 of 148 PASS dim_customers::test_customer_segment_no_orders ................. [[32mPASS[0m in 7.52s]
[0m15:26:17.333171 [debug] [Thread-2 (]: Finished running node unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders
[0m15:26:17.338706 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m15:26:17.343177 [info ] [Thread-2 (]: 119 of 148 START sql table model dbt_dev_yourname_marts.dim_customers .......... [RUN]
[0m15:26:17.346557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly unit_test.dbt_advanced_olist.dim_customers.test_customer_segment_no_orders, now model.dbt_advanced_olist.dim_customers)
[0m15:26:17.349350 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m15:26:17.381674 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m15:26:17.400548 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m15:26:17.415086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:17.495378 [info ] [Thread-4 (]: 102 of 148 PASS is_not_negative_fct_orders_freight_total ....................... [[32mPASS[0m in 5.76s]
[0m15:26:17.503237 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20
[0m15:26:17.505302 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m15:26:17.506550 [info ] [Thread-4 (]: 105 of 148 START test not_null_fct_orders_delivery_sla_status .................. [RUN]
[0m15:26:17.508865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_freight_total.25b2d2fa20, now test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0)
[0m15:26:17.509860 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m15:26:17.521504 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m15:26:17.524987 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m15:26:17.528355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:17.575145 [info ] [Thread-1 (]: 103 of 148 PASS is_not_negative_fct_orders_subtotal ............................ [[32mPASS[0m in 5.69s]
[0m15:26:17.577173 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4
[0m15:26:17.578284 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m15:26:17.579282 [info ] [Thread-1 (]: 106 of 148 START test not_null_fct_orders_freight_total ........................ [RUN]
[0m15:26:17.580307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_fct_orders_subtotal.b9f11262a4, now test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3)
[0m15:26:17.582301 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m15:26:17.587438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m15:26:17.592494 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m15:26:17.601539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:18.559120 [debug] [Thread-2 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m15:26:18.609488 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
[0m15:26:18.616456 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where delivery_sla_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:18.710461 [info ] [Thread-3 (]: 104 of 148 PASS not_null_fct_orders_customer_id ................................ [[32mPASS[0m in 6.71s]
[0m15:26:18.716141 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b
[0m15:26:18.721451 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m15:26:18.725563 [info ] [Thread-3 (]: 107 of 148 START test not_null_fct_orders_item_count ........................... [RUN]
[0m15:26:18.729743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_customer_id.16fe324f7b, now test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91)
[0m15:26:18.733376 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m15:26:18.741552 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
[0m15:26:18.766588 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m15:26:18.772592 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where freight_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:18.782254 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m15:26:18.804398 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:19.080177 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2d5ae809-3f97-48e1-b8e4-4a1c03449a64&page=queryresults
[0m15:26:19.304735 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:58ca148e-77b1-4acb-8015-371dbf8433f2&page=queryresults
[0m15:26:19.315079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:77c0bce3-3a49-4c5e-b452-7ba8a01eab8a&page=queryresults
[0m15:26:19.621230 [warn ] [Thread-2 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m15:26:19.624556 [debug] [Thread-2 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m15:26:20.087189 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
[0m15:26:20.089506 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:77ba01e6-bc13-400f-9402-2b545a777a3c&page=queryresults
[0m15:26:20.092526 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where item_count is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:20.509435 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m15:26:20.537856 [debug] [Thread-2 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m15:26:20.573234 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:96070818-7dfb-44e8-b5a7-411ba911ecea&page=queryresults
[0m15:26:21.117677 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1c7a6c5a-0c1d-413c-9e2a-941a11ff3a03&page=queryresults
[0m15:26:21.223293 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3"
[0m15:26:21.302790 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_freight_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_freight_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:21.928813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f0ad0d66-86ca-474f-baff-d2fcb1ab8443&page=queryresults
[0m15:26:23.172852 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0"
[0m15:26:23.179440 [info ] [Thread-1 (]: 106 of 148 PASS not_null_fct_orders_freight_total .............................. [[32mPASS[0m in 5.60s]
[0m15:26:23.187156 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3
[0m15:26:23.192142 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_delivery_sla_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_delivery_sla_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:23.192142 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m15:26:23.206253 [info ] [Thread-1 (]: 108 of 148 START test not_null_fct_orders_order_date ........................... [RUN]
[0m15:26:23.212278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_freight_total.1ac554f3d3, now test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362)
[0m15:26:23.215496 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m15:26:23.237291 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m15:26:23.242991 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m15:26:23.261592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:23.351536 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91"
[0m15:26:23.357540 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_item_count`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_item_count | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:23.796829 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e7af5f-b1e3-40f4-ba03-f0a399a91f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C6D1B5590>]}
[0m15:26:23.797826 [info ] [Thread-2 (]: 119 of 148 OK created sql table model dbt_dev_yourname_marts.dim_customers ..... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 6.45s]
[0m15:26:23.802418 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m15:26:23.804482 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m15:26:23.804482 [info ] [Thread-2 (]: 109 of 148 START test not_null_fct_orders_order_id ............................. [RUN]
[0m15:26:23.809559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.dim_customers, now test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0)
[0m15:26:23.813676 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m15:26:23.826825 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m15:26:23.833674 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m15:26:23.839886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:23.915548 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b30c1759-2ecb-49e0-8cac-57dd28e265c2&page=queryresults
[0m15:26:24.486339 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
[0m15:26:24.486339 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_date is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:24.555359 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1ff80300-b5a5-4caa-8d55-6b84e975a65b&page=queryresults
[0m15:26:24.921483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:282a685a-68db-45ce-9502-64e59db5d1fb&page=queryresults
[0m15:26:24.939042 [info ] [Thread-3 (]: 107 of 148 PASS not_null_fct_orders_item_count ................................. [[32mPASS[0m in 6.21s]
[0m15:26:24.942855 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91
[0m15:26:24.943902 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m15:26:24.946503 [info ] [Thread-3 (]: 110 of 148 START test not_null_fct_orders_order_status ......................... [RUN]
[0m15:26:24.947542 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_item_count.78596f8f91, now test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b)
[0m15:26:24.952171 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m15:26:24.966009 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m15:26:24.982136 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m15:26:24.987436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:25.138903 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
[0m15:26:25.150189 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:25.479771 [info ] [Thread-4 (]: 105 of 148 PASS not_null_fct_orders_delivery_sla_status ........................ [[32mPASS[0m in 7.97s]
[0m15:26:25.482875 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0
[0m15:26:25.484700 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m15:26:25.487113 [info ] [Thread-4 (]: 111 of 148 START test not_null_fct_orders_order_total .......................... [RUN]
[0m15:26:25.490337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_delivery_sla_status.29eaaa17b0, now test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6)
[0m15:26:25.492840 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m15:26:25.511072 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m15:26:25.516173 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m15:26:25.535608 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:25.804304 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:18362ea4-ffb2-4ccb-a76d-4e2154ac1a38&page=queryresults
[0m15:26:26.135592 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
[0m15:26:26.144486 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_status is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:26.556790 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e4408fba-6629-4b74-ab76-14c461188a4e&page=queryresults
[0m15:26:26.842100 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
[0m15:26:26.855792 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where order_total is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:26.855792 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362"
[0m15:26:26.877345 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_date`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_date | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:27.400517 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7334c11c-ba9a-4904-9212-e040ce3a199e&page=queryresults
[0m15:26:27.469476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:61eb6e9d-c201-46b6-9ef3-35f6192a33c2&page=queryresults
[0m15:26:27.547219 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0"
[0m15:26:27.556722 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:28.108317 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:020c710a-e31c-466a-9887-84be845fc7d6&page=queryresults
[0m15:26:28.403590 [info ] [Thread-1 (]: 108 of 148 PASS not_null_fct_orders_order_date ................................. [[32mPASS[0m in 5.19s]
[0m15:26:28.418249 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362
[0m15:26:28.420772 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m15:26:28.422778 [info ] [Thread-1 (]: 112 of 148 START test not_null_fct_orders_ordered_at ........................... [RUN]
[0m15:26:28.422778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_date.84f0a76362, now test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9)
[0m15:26:28.422778 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m15:26:28.452568 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m15:26:28.469412 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m15:26:28.486743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:28.585935 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b"
[0m15:26:28.593530 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_status`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_status | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:29.026776 [info ] [Thread-2 (]: 109 of 148 PASS not_null_fct_orders_order_id ................................... [[32mPASS[0m in 5.22s]
[0m15:26:29.032705 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0
[0m15:26:29.035697 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m15:26:29.036695 [info ] [Thread-2 (]: 113 of 148 START test not_null_fct_orders_primary_category ..................... [RUN]
[0m15:26:29.045844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_id.4e687af8d0, now test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67)
[0m15:26:29.051567 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m15:26:29.078060 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m15:26:29.085689 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m15:26:29.102410 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:29.104943 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ebc5e967-6fe5-4ce4-ab68-b8c93431525f&page=queryresults
[0m15:26:29.452317 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6"
[0m15:26:29.457160 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_order_total`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_order_total | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:29.843335 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
[0m15:26:29.843335 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where ordered_at is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:29.973565 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c62b2dcd-aebc-4c26-8d8e-37cec9b19836&page=queryresults
[0m15:26:30.160230 [info ] [Thread-3 (]: 110 of 148 PASS not_null_fct_orders_order_status ............................... [[32mPASS[0m in 5.21s]
[0m15:26:30.161227 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b
[0m15:26:30.168238 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m15:26:30.171165 [info ] [Thread-3 (]: 114 of 148 START test not_null_fct_orders_primary_category_group ............... [RUN]
[0m15:26:30.171165 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_status.b83f07f66b, now test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed)
[0m15:26:30.175375 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m15:26:30.194643 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m15:26:30.203071 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m15:26:30.214115 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:30.299730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2b089640-44f3-4c1f-ad1f-14d5726c8db4&page=queryresults
[0m15:26:30.529522 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
[0m15:26:30.537364 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:30.968483 [info ] [Thread-4 (]: 111 of 148 PASS not_null_fct_orders_order_total ................................ [[32mPASS[0m in 5.48s]
[0m15:26:30.974101 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6
[0m15:26:30.978407 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m15:26:30.982410 [info ] [Thread-4 (]: 115 of 148 START test not_null_fct_orders_subtotal ............................. [RUN]
[0m15:26:30.989255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_order_total.d5d9d1a2f6, now test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0)
[0m15:26:30.990787 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m15:26:31.016956 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m15:26:31.024385 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m15:26:31.037870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:31.111795 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:3b6012ca-22ce-44ff-92d2-6f63fcf7638a&page=queryresults
[0m15:26:32.154684 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
[0m15:26:32.170091 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where primary_category_group is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:32.619605 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d3fdb970-cf31-4ba8-9e15-52884ab49136&page=queryresults
[0m15:26:32.985804 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
[0m15:26:32.995854 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9"
[0m15:26:33.004220 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where subtotal is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:33.021561 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_ordered_at`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_ordered_at | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:33.055749 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67"
[0m15:26:33.092139 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:33.601915 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:79c37123-9fff-4b4c-a9b8-3f175421b0f2&page=queryresults
[0m15:26:33.604218 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8b5789c-e631-435c-a1ba-8cf0f397ef02&page=queryresults
[0m15:26:33.660870 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f19f2ba9-226d-427f-aa79-4699f03ff22a&page=queryresults
[0m15:26:34.445677 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed"
[0m15:26:34.451964 [debug] [Thread-3 (]: On test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_primary_category_group`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_primary_category_group | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:34.625787 [info ] [Thread-1 (]: 112 of 148 PASS not_null_fct_orders_ordered_at ................................. [[32mPASS[0m in 6.20s]
[0m15:26:34.627508 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9
[0m15:26:34.632550 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m15:26:34.636079 [info ] [Thread-1 (]: 116 of 148 START test not_null_fct_orders_unique_products ...................... [RUN]
[0m15:26:34.639943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_ordered_at.997e0ff7d9, now test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7)
[0m15:26:34.641370 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m15:26:34.658795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m15:26:34.670663 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m15:26:34.667389 [info ] [Thread-2 (]: 113 of 148 PASS not_null_fct_orders_primary_category ........................... [[32mPASS[0m in 5.62s]
[0m15:26:34.684886 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67
[0m15:26:34.688527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:34.688527 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m15:26:34.758518 [info ] [Thread-2 (]: 117 of 148 START test unique_fct_orders_order_id ............................... [RUN]
[0m15:26:34.762990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category.2f3ccc5d67, now test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5)
[0m15:26:34.765539 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m15:26:34.783825 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m15:26:34.788518 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m15:26:34.802857 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:34.990188 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b9a43f14-b056-4ef8-81c2-9c23d05ddb6d&page=queryresults
[0m15:26:35.547582 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0"
[0m15:26:35.553545 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_subtotal`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_subtotal | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:35.775048 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
[0m15:26:35.775048 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
where unique_products is null



  
  
    )
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:35.888971 [info ] [Thread-3 (]: 114 of 148 PASS not_null_fct_orders_primary_category_group ..................... [[32mPASS[0m in 5.72s]
[0m15:26:35.888971 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed
[0m15:26:35.894642 [debug] [Thread-3 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m15:26:35.895638 [info ] [Thread-3 (]: 120 of 148 START test accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [RUN]
[0m15:26:35.903285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_primary_category_group.aa45e1cfed, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213)
[0m15:26:35.904338 [debug] [Thread-3 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m15:26:35.934734 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m15:26:35.963739 [debug] [Thread-3 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m15:26:35.973013 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:26:36.243985 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f08d51c-bee7-4eeb-8a01-32e39488d66a&page=queryresults
[0m15:26:36.255544 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:563b1d93-2fef-4269-bc05-695e944bcdf5&page=queryresults
[0m15:26:36.366580 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
[0m15:26:36.371997 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:36.816329 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4010b4bc-32df-4d31-b9ec-96ddfcc865e8&page=queryresults
[0m15:26:37.179882 [info ] [Thread-4 (]: 115 of 148 PASS not_null_fct_orders_subtotal ................................... [[32mPASS[0m in 6.19s]
[0m15:26:37.188443 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0
[0m15:26:37.189441 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m15:26:37.194997 [info ] [Thread-4 (]: 121 of 148 START test accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [RUN]
[0m15:26:37.202742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_subtotal.76199d91d0, now test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0)
[0m15:26:37.205232 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m15:26:37.253198 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m15:26:37.261652 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m15:26:37.286104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:37.956885 [debug] [Thread-3 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
[0m15:26:38.032985 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_region as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_region

)

select *
from all_values
where value_field not in (
    'Southeast','South','Northeast','Central-West','North'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:38.350839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7"
[0m15:26:38.353497 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_fct_orders_unique_products`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_fct_orders_unique_products | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:38.520714 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b73fa7a6-46eb-4e3b-8ec6-10824475dede&page=queryresults
[0m15:26:38.843899 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5"
[0m15:26:38.852445 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_fct_orders_order_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_fct_orders_order_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:38.915683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5cf33fc5-4e20-4bf7-80a1-64dd90f7ec83&page=queryresults
[0m15:26:39.141138 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
[0m15:26:39.150852 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'VIP','High Value','Medium Value','Low Value','No Orders'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:39.389947 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:aba7065d-8078-441e-8c11-5157d4ea4f83&page=queryresults
[0m15:26:39.751498 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c30f6ee2-9ae1-47a5-ae92-d6631a238f9d&page=queryresults
[0m15:26:39.839552 [info ] [Thread-1 (]: 116 of 148 PASS not_null_fct_orders_unique_products ............................ [[32mPASS[0m in 5.20s]
[0m15:26:39.844371 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7
[0m15:26:39.849481 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m15:26:39.854604 [info ] [Thread-1 (]: 122 of 148 START test accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [RUN]
[0m15:26:39.856705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_fct_orders_unique_products.d7d45bbfa7, now test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09)
[0m15:26:39.862308 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m15:26:39.909803 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m15:26:39.946980 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m15:26:39.958627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:40.470019 [info ] [Thread-2 (]: 117 of 148 PASS unique_fct_orders_order_id ..................................... [[32mPASS[0m in 5.71s]
[0m15:26:40.482719 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5
[0m15:26:40.488688 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m15:26:40.493782 [info ] [Thread-2 (]: 123 of 148 START test assert_vip_customer_criteria ............................. [RUN]
[0m15:26:40.499544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.unique_fct_orders_order_id.523ddb6ce5, now test.dbt_advanced_olist.assert_vip_customer_criteria)
[0m15:26:40.505340 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m15:26:40.526108 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m15:26:40.544942 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m15:26:40.556143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:41.527365 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
[0m15:26:41.533834 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with all_values as (

    select
        purchase_frequency as value_field,
        count(*) as n_records

    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    group by purchase_frequency

)

select *
from all_values
where value_field not in (
    'Frequent','Repeat','One-Time','Never Purchased'
)



  
  
    )
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:41.803009 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0"
[0m15:26:41.807582 [debug] [Thread-4 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_3e1b7f0e14f3db765f997aa38f5db476`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:42.013860 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
[0m15:26:42.018927 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
      
    
    

    
    OPTIONS()
    as (
      
    
  /*
  SINGULAR TEST: assert_vip_customer_criteria
  
  Purpose: VIP customers must meet the defined criteria
  
  Business Rule: VIP = lifetime_revenue >= 500 AND lifetime_orders >= 3
  
  Test PASSES if query returns 0 rows
*/

with vip_customers as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where customer_segment = 'VIP'
),

invalid_vips as (
    select
        customer_id,
        lifetime_revenue,
        lifetime_orders,
        'VIP but does not meet criteria' as violation
    from vip_customers
    where lifetime_revenue < 500
       or lifetime_orders < 3
),

should_be_vips as (
    select
        customer_id,
        customer_segment,
        lifetime_revenue,
        lifetime_orders,
        'Should be VIP but is not' as violation
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    where lifetime_revenue >= 500
      and lifetime_orders >= 3
      and customer_segment != 'VIP'
)

select * from invalid_vips
union all
select customer_id, lifetime_revenue, lifetime_orders, violation from should_be_vips
  
  
    )
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:42.046225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1c918fed-4ce6-4695-ac86-80f12bc5afbb&page=queryresults
[0m15:26:42.412622 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:165d7216-11f0-47de-ad2e-1f08b172deb5&page=queryresults
[0m15:26:42.456062 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:40617dfe-f7a1-433c-83de-220b48e87619&page=queryresults
[0m15:26:43.553355 [info ] [Thread-4 (]: 121 of 148 PASS accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders  [[32mPASS[0m in 6.35s]
[0m15:26:43.557532 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0
[0m15:26:43.561285 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m15:26:43.565897 [info ] [Thread-4 (]: 124 of 148 START test dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [RUN]
[0m15:26:43.569225 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_customer_segment__VIP__High_Value__Medium_Value__Low_Value__No_Orders.7ff4f0b3d0, now test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d)
[0m15:26:43.572757 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m15:26:43.618766 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m15:26:43.636954 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m15:26:43.655755 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:44.074594 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09"
[0m15:26:44.081072 [debug] [Thread-1 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_50ece6237dae17986984341ab1f04342`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:44.867157 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
[0m15:26:44.871182 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a5f58c01-ba72-405c-8e34-4be6be931212&page=queryresults
[0m15:26:44.876848 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
      
    
    

    
    OPTIONS()
    as (
      
    
  




    with grouped_expression as (
    select
        
        
    
  

    length(
        customer_state
    ) = 2 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:45.281600 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.assert_vip_customer_criteria"
[0m15:26:45.310727 [debug] [Thread-2 (]: On test.dbt_advanced_olist.assert_vip_customer_criteria: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_vip_customer_criteria`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: assert_vip_customer_criteria | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:45.482670 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:59f28f80-1df4-4afe-8df8-dc49c6d75c7c&page=queryresults
[0m15:26:45.828050 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a6a486c9-6f4e-4f97-801a-8082b2501b7b&page=queryresults
[0m15:26:45.922121 [info ] [Thread-1 (]: 122 of 148 PASS accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased  [[32mPASS[0m in 6.07s]
[0m15:26:45.927905 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09
[0m15:26:45.931796 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m15:26:45.937050 [info ] [Thread-1 (]: 125 of 148 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [RUN]
[0m15:26:45.944853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.accepted_values_dim_customers_purchase_frequency__Frequent__Repeat__One_Time__Never_Purchased.14d2d50a09, now test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9)
[0m15:26:45.944853 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m15:26:45.987272 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m15:26:46.005575 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m15:26:46.018860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:46.844175 [info ] [Thread-2 (]: 123 of 148 PASS assert_vip_customer_criteria ................................... [[32mPASS[0m in 6.34s]
[0m15:26:46.855141 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.assert_vip_customer_criteria
[0m15:26:46.859268 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m15:26:46.869099 [info ] [Thread-2 (]: 126 of 148 START test is_not_negative_dim_customers_avg_order_value ............ [RUN]
[0m15:26:46.877799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.assert_vip_customer_criteria, now test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178)
[0m15:26:46.883194 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m15:26:46.922579 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m15:26:46.934506 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m15:26:46.960879 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:47.534953 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d"
[0m15:26:47.548543 [debug] [Thread-4 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_82146f675c554db3ed45feb3211e7102`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:47.719417 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
[0m15:26:47.719417 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
      
    
    

    
    OPTIONS()
    as (
      
    
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and late_delivery_rate >= 0 and late_delivery_rate <= 100
)
 as expression


    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  
    )
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:48.352867 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
[0m15:26:48.360431 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:df3a3fab-f641-4211-97ac-cdc864143ea7&page=queryresults
[0m15:26:48.364339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:591816f9-30dd-4f65-a151-1d740c964d7f&page=queryresults
[0m15:26:48.374023 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    avg_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:48.985893 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:21bbe39e-54ff-426b-acba-d7589ab57e24&page=queryresults
[0m15:26:49.434255 [info ] [Thread-4 (]: 124 of 148 PASS dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2  [[32mPASS[0m in 5.86s]
[0m15:26:49.442551 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d
[0m15:26:49.449303 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m15:26:49.457905 [info ] [Thread-4 (]: 127 of 148 START test is_not_negative_dim_customers_customer_lifespan_days ..... [RUN]
[0m15:26:49.467630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_value_lengths_to_equal_dim_customers_customer_state__2.5d870bd63d, now test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e)
[0m15:26:49.475826 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m15:26:49.556255 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m15:26:49.559454 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m15:26:49.570402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:50.501845 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9"
[0m15:26:50.516065 [debug] [Thread-1 (]: On test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_aaa015c6d3359922ba0f4662e04bf3c5`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0 | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:51.008999 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
[0m15:26:51.020691 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    customer_lifespan_days as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_lifespan_days < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:51.036848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5db3cc88-94c6-49f0-9c7d-aabcc1d85ad7&page=queryresults
[0m15:26:51.404196 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178"
[0m15:26:51.416417 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:51.472916 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:698a7d61-388f-4ff4-b5ed-25baa297d461&page=queryresults
[0m15:26:51.963251 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d1899b3c-6231-4144-a9bf-83f6cb628068&page=queryresults
[0m15:26:52.052611 [info ] [Thread-1 (]: 125 of 148 PASS dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0  [[32mPASS[0m in 6.11s]
[0m15:26:52.061110 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9
[0m15:26:52.067356 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m15:26:52.070602 [info ] [Thread-1 (]: 128 of 148 START test is_not_negative_dim_customers_late_deliveries ............ [RUN]
[0m15:26:52.076161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.dbt_expectations_expect_column_values_to_be_between_dim_customers_late_delivery_rate__100__0.e1b070fbf9, now test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a)
[0m15:26:52.082295 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m15:26:52.115754 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m15:26:52.123223 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m15:26:52.148642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:52.933555 [info ] [Thread-2 (]: 126 of 148 PASS is_not_negative_dim_customers_avg_order_value .................. [[32mPASS[0m in 6.05s]
[0m15:26:52.938365 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178
[0m15:26:52.941427 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m15:26:52.945111 [info ] [Thread-2 (]: 129 of 148 START test is_not_negative_dim_customers_lifetime_items ............. [RUN]
[0m15:26:52.952379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_avg_order_value.ff39a13178, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159)
[0m15:26:52.953985 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m15:26:53.000015 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m15:26:53.032716 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m15:26:53.049237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:53.191791 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
[0m15:26:53.197392 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    late_deliveries as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where late_deliveries < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:53.439941 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e"
[0m15:26:53.464209 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_customer_lifespan_days`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_customer_lifespan_days | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:53.660586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:04fb55e3-68f7-49a5-afa5-87292af0810e&page=queryresults
[0m15:26:54.079598 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:31776339-6341-4901-bac3-63e63a47b9c4&page=queryresults
[0m15:26:54.176324 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
[0m15:26:54.181823 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_items as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:54.698703 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1626ca37-7436-4eca-80f8-00680df18efb&page=queryresults
[0m15:26:55.215383 [info ] [Thread-4 (]: 127 of 148 PASS is_not_negative_dim_customers_customer_lifespan_days ........... [[32mPASS[0m in 5.75s]
[0m15:26:55.222034 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e
[0m15:26:55.222034 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m15:26:55.229103 [info ] [Thread-4 (]: 130 of 148 START test is_not_negative_dim_customers_lifetime_orders ............ [RUN]
[0m15:26:55.237365 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_customer_lifespan_days.b0bfc10c8e, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8)
[0m15:26:55.245534 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m15:26:55.285944 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m15:26:55.298109 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m15:26:55.316774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:26:56.478441 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a"
[0m15:26:56.488749 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_late_deliveries`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_late_deliveries | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:56.783020 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159"
[0m15:26:56.790338 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:26:56.914328 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
[0m15:26:56.921862 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_orders as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:57.000407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e30308ff-8401-4023-8986-705a1dba7114&page=queryresults
[0m15:26:57.373032 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8b8d758-a865-4248-bc5d-0265ccd8d878&page=queryresults
[0m15:26:57.565216 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:47b83304-c0e8-423c-8437-72df88f40138&page=queryresults
[0m15:26:58.185332 [info ] [Thread-1 (]: 128 of 148 PASS is_not_negative_dim_customers_late_deliveries .................. [[32mPASS[0m in 6.11s]
[0m15:26:58.191102 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a
[0m15:26:58.197158 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m15:26:58.204174 [info ] [Thread-1 (]: 131 of 148 START test is_not_negative_dim_customers_lifetime_revenue ........... [RUN]
[0m15:26:58.209511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_late_deliveries.5eb6daea2a, now test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e)
[0m15:26:58.219114 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m15:26:58.301558 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m15:26:58.368766 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m15:26:58.391032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:58.623605 [info ] [Thread-2 (]: 129 of 148 PASS is_not_negative_dim_customers_lifetime_items ................... [[32mPASS[0m in 5.67s]
[0m15:26:58.634905 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159
[0m15:26:58.641432 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m15:26:58.647596 [info ] [Thread-2 (]: 132 of 148 START test is_not_negative_dim_customers_max_order_value ............ [RUN]
[0m15:26:58.658018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_items.fec05b8159, now test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c)
[0m15:26:58.664575 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m15:26:58.716514 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m15:26:58.730569 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m15:26:58.744654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:59.598468 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
[0m15:26:59.615298 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    lifetime_revenue as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:59.907909 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
[0m15:26:59.920612 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  

select
    max_order_value as failing_value,
    count(*) as row_count
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value < 0
group by 1


  
  
    )
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:26:59.934641 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8"
[0m15:26:59.952224 [debug] [Thread-4 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:00.084191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b7f00953-669b-45db-9e1d-c1fdc877ae73&page=queryresults
[0m15:27:00.436811 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9fddd02e-6bda-4025-a9dd-c325b539ca6e&page=queryresults
[0m15:27:00.489256 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:162b9f88-360c-4d3d-9f5c-7ae88010ea0b&page=queryresults
[0m15:27:01.422012 [info ] [Thread-4 (]: 130 of 148 PASS is_not_negative_dim_customers_lifetime_orders .................. [[32mPASS[0m in 6.18s]
[0m15:27:01.427493 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8
[0m15:27:01.431665 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m15:27:01.433046 [info ] [Thread-4 (]: 133 of 148 START test not_null_dim_customers_avg_order_value ................... [RUN]
[0m15:27:01.437903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_orders.575213f9a8, now test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843)
[0m15:27:01.441626 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m15:27:01.470426 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m15:27:01.474836 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m15:27:01.502723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:27:02.232477 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c"
[0m15:27:02.232477 [debug] [Thread-2 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:02.262213 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e"
[0m15:27:02.349958 [debug] [Thread-1 (]: On test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`is_not_negative_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: is_not_negative_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:02.624708 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
[0m15:27:02.630073 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where avg_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:02.784019 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6c5ac254-8d0a-4065-8739-0d506fcef9a0&page=queryresults
[0m15:27:02.873441 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9c9bcffb-5ba6-4dbb-a4a2-4e12e46e05e2&page=queryresults
[0m15:27:03.102188 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5c7a7a36-df24-460a-971f-c24124cc1739&page=queryresults
[0m15:27:03.716129 [info ] [Thread-2 (]: 132 of 148 PASS is_not_negative_dim_customers_max_order_value .................. [[32mPASS[0m in 5.06s]
[0m15:27:03.724088 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c
[0m15:27:03.728751 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m15:27:03.734601 [info ] [Thread-2 (]: 134 of 148 START test not_null_dim_customers_customer_city ..................... [RUN]
[0m15:27:03.738911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_max_order_value.38e466a12c, now test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d)
[0m15:27:03.751829 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m15:27:03.799236 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m15:27:03.900634 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m15:27:03.949882 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:27:03.937890 [info ] [Thread-1 (]: 131 of 148 PASS is_not_negative_dim_customers_lifetime_revenue ................. [[32mPASS[0m in 5.73s]
[0m15:27:03.975059 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e
[0m15:27:03.981814 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:27:03.986166 [info ] [Thread-1 (]: 135 of 148 START test not_null_dim_customers_customer_id ....................... [RUN]
[0m15:27:04.054401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.is_not_negative_dim_customers_lifetime_revenue.9ef8f96b2e, now test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m15:27:04.056910 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:27:04.066064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:27:04.070642 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:27:04.082266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:05.021252 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843"
[0m15:27:05.063977 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_avg_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_avg_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:05.166174 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
[0m15:27:05.171207 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:05.367173 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
[0m15:27:05.376000 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_city is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:05.587906 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:02a34981-54c1-41a2-948f-3ed8f01d18a7&page=queryresults
[0m15:27:05.755942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1abfa068-7115-4508-ad42-203998f301dd&page=queryresults
[0m15:27:05.799033 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6d6aac25-3de0-4d63-b042-ef18c6590006&page=queryresults
[0m15:27:06.704917 [info ] [Thread-4 (]: 133 of 148 PASS not_null_dim_customers_avg_order_value ......................... [[32mPASS[0m in 5.27s]
[0m15:27:06.708473 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843
[0m15:27:06.711138 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m15:27:06.713134 [info ] [Thread-4 (]: 136 of 148 START test not_null_dim_customers_customer_key ...................... [RUN]
[0m15:27:06.715435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_avg_order_value.af3b7b4843, now test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411)
[0m15:27:06.717510 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m15:27:06.735598 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m15:27:06.748871 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m15:27:06.766165 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:27:07.802502 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d"
[0m15:27:07.814133 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:27:07.962917 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_city`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_city | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:07.980008 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:08.213779 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
[0m15:27:08.218846 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_key is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:08.532423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b52dff3b-3309-4e05-9f48-26b84424af13&page=queryresults
[0m15:27:08.573937 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:379f6306-0eb8-40e8-aab5-ea9e885e10f2&page=queryresults
[0m15:27:08.702549 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a38dad59-06bd-4ef5-bd2b-46428060c5ec&page=queryresults
[0m15:27:09.540559 [info ] [Thread-1 (]: 135 of 148 PASS not_null_dim_customers_customer_id ............................. [[32mPASS[0m in 5.48s]
[0m15:27:09.547590 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:27:09.550828 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m15:27:09.553317 [info ] [Thread-1 (]: 137 of 148 START test not_null_dim_customers_customer_region ................... [RUN]
[0m15:27:09.559995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2)
[0m15:27:09.565656 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m15:27:09.613762 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m15:27:09.667052 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m15:27:09.698804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:10.268761 [info ] [Thread-2 (]: 134 of 148 PASS not_null_dim_customers_customer_city ........................... [[32mPASS[0m in 6.53s]
[0m15:27:10.275896 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d
[0m15:27:10.284135 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:27:10.295996 [info ] [Thread-2 (]: 138 of 148 START test not_null_dim_customers_customer_segment .................. [RUN]
[0m15:27:10.321286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_city.f59e32635d, now test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m15:27:10.327256 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:27:10.367750 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:27:10.401504 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:27:10.415755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:27:10.832156 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
[0m15:27:10.832156 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_region is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:10.848972 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411"
[0m15:27:10.886162 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:11.299266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:ea1ef8c5-2925-4213-a6b4-22caa88e24b3&page=queryresults
[0m15:27:11.563308 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6ecaa339-18d3-44a5-962e-149ab1080c62&page=queryresults
[0m15:27:12.546454 [info ] [Thread-4 (]: 136 of 148 PASS not_null_dim_customers_customer_key ............................ [[32mPASS[0m in 5.83s]
[0m15:27:12.564740 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411
[0m15:27:12.568058 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m15:27:12.569499 [info ] [Thread-4 (]: 139 of 148 START test not_null_dim_customers_customer_state .................... [RUN]
[0m15:27:12.571875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa)
[0m15:27:12.572860 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m15:27:12.589277 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m15:27:12.603389 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m15:27:12.622472 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:27:12.717661 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
[0m15:27:12.723086 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_segment is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:13.252829 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:453f542b-f02f-4e6a-997e-3b1b6f6a3ad1&page=queryresults
[0m15:27:13.312845 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2"
[0m15:27:13.330016 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_region`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_region | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:13.703446 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
[0m15:27:13.711537 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_state is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:13.946207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2d88ff59-209f-4d0d-b659-df86c6560f6b&page=queryresults
[0m15:27:14.182627 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c0bf5084-92d6-421d-98f8-8bb59b9deca8&page=queryresults
[0m15:27:14.981474 [info ] [Thread-1 (]: 137 of 148 PASS not_null_dim_customers_customer_region ......................... [[32mPASS[0m in 5.42s]
[0m15:27:14.987877 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2
[0m15:27:14.991168 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:27:14.994671 [info ] [Thread-1 (]: 140 of 148 START test not_null_dim_customers_customer_unique_id ................ [RUN]
[0m15:27:14.998408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_region.b476de1bf2, now test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m15:27:15.001558 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:27:15.036165 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:27:15.063974 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:27:15.082540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:15.638225 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:27:15.789676 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_segment`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_segment | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:16.108782 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa"
[0m15:27:16.149949 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_state`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_state | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:16.379994 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
[0m15:27:16.386080 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where customer_unique_id is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:16.388790 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:b8118a10-a480-423a-9581-f540e7751eed&page=queryresults
[0m15:27:16.694530 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7ee0069d-8015-4c6a-9477-a8a55a919398&page=queryresults
[0m15:27:16.840213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:58d532f3-81bd-4517-b73f-b2037723d204&page=queryresults
[0m15:27:17.345703 [info ] [Thread-2 (]: 138 of 148 PASS not_null_dim_customers_customer_segment ........................ [[32mPASS[0m in 7.02s]
[0m15:27:17.349660 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:27:17.353842 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m15:27:17.360109 [info ] [Thread-2 (]: 141 of 148 START test not_null_dim_customers_lifetime_items .................... [RUN]
[0m15:27:17.366737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a)
[0m15:27:17.367732 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m15:27:17.427614 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m15:27:17.461300 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m15:27:17.466292 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:27:17.646674 [info ] [Thread-4 (]: 139 of 148 PASS not_null_dim_customers_customer_state .......................... [[32mPASS[0m in 5.08s]
[0m15:27:17.652449 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa
[0m15:27:17.655082 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:27:17.661054 [info ] [Thread-4 (]: 142 of 148 START test not_null_dim_customers_lifetime_orders ................... [RUN]
[0m15:27:17.674670 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_state.7c7083b6aa, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m15:27:17.679039 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:27:17.718908 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:27:17.767092 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:27:17.793151 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:27:18.663067 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
[0m15:27:18.674380 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_items is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:18.770054 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:27:18.808308 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_customer_unique_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_customer_unique_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:19.068271 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
[0m15:27:19.068271 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_orders is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:19.467169 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c076af7d-7d60-422f-9bfb-978211d2cf61&page=queryresults
[0m15:27:19.586264 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9f187757-aae1-484d-afa1-e1c318e2c4d5&page=queryresults
[0m15:27:19.592211 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:92f431dd-bba5-4361-9e17-7969db11085a&page=queryresults
[0m15:27:20.500357 [info ] [Thread-1 (]: 140 of 148 PASS not_null_dim_customers_customer_unique_id ...................... [[32mPASS[0m in 5.50s]
[0m15:27:20.506209 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:27:20.512370 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m15:27:20.516115 [info ] [Thread-1 (]: 143 of 148 START test not_null_dim_customers_lifetime_revenue .................. [RUN]
[0m15:27:20.518857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105)
[0m15:27:20.536668 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m15:27:20.595876 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m15:27:20.643582 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m15:27:20.661116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:21.265402 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a"
[0m15:27:21.302148 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_items`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_items | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:21.408492 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:27:21.477496 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_orders`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_orders | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:21.825710 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
[0m15:27:21.832442 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where lifetime_revenue is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:21.862684 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d4a88a64-1538-4e8c-a890-043566352ff1&page=queryresults
[0m15:27:22.009077 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:cf5af3e3-9b0c-4aee-9440-dc8e6f01b2fe&page=queryresults
[0m15:27:22.293742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:517ff269-fbd7-412f-a0f4-e084b4505ace&page=queryresults
[0m15:27:23.094770 [info ] [Thread-2 (]: 141 of 148 PASS not_null_dim_customers_lifetime_items .......................... [[32mPASS[0m in 5.73s]
[0m15:27:23.106416 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a
[0m15:27:23.099656 [info ] [Thread-4 (]: 142 of 148 PASS not_null_dim_customers_lifetime_orders ......................... [[32mPASS[0m in 5.42s]
[0m15:27:23.113769 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m15:27:23.118899 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:27:23.129388 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m15:27:23.123789 [info ] [Thread-2 (]: 144 of 148 START test not_null_dim_customers_max_order_value ................... [RUN]
[0m15:27:23.145011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_items.d66f01e58a, now test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8)
[0m15:27:23.149827 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m15:27:23.131913 [info ] [Thread-4 (]: 145 of 148 START test not_null_dim_customers_purchase_frequency ................ [RUN]
[0m15:27:23.169737 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093)
[0m15:27:23.180848 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m15:27:23.209812 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m15:27:23.225213 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m15:27:23.233505 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m15:27:23.246038 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:27:23.247681 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m15:27:23.311803 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:27:24.109779 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105"
[0m15:27:24.165831 [debug] [Thread-1 (]: On test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_lifetime_revenue`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_lifetime_revenue | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:24.801602 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
[0m15:27:24.810650 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
[0m15:27:24.819713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:fac7003c-9f8b-4aa9-a9b0-c13c12857823&page=queryresults
[0m15:27:24.823149 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where max_order_value is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:24.832050 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    



select *
from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
where purchase_frequency is null



  
  
    )
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:25.278687 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0d20c3d2-a185-4dfc-8cda-89edebec0720&page=queryresults
[0m15:27:25.323598 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:51467a43-5c8f-4946-b287-bf4a427ddb4a&page=queryresults
[0m15:27:25.848948 [info ] [Thread-1 (]: 143 of 148 PASS not_null_dim_customers_lifetime_revenue ........................ [[32mPASS[0m in 5.33s]
[0m15:27:25.854378 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105
[0m15:27:25.860019 [debug] [Thread-1 (]: Began running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m15:27:25.863264 [info ] [Thread-1 (]: 146 of 148 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m15:27:25.867885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_lifetime_revenue.e461788105, now test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m15:27:25.869533 [debug] [Thread-1 (]: Began compiling node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m15:27:25.930091 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m15:27:25.956003 [debug] [Thread-1 (]: Began executing node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m15:27:25.976456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.260479 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093"
[0m15:27:27.288926 [debug] [Thread-4 (]: On test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_purchase_frequency`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_purchase_frequency | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:27.297932 [debug] [Thread-1 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
[0m15:27:27.310463 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
    )
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:27.325851 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8"
[0m15:27:27.344459 [debug] [Thread-2 (]: On test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`not_null_dim_customers_max_order_value`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: not_null_dim_customers_max_order_value | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:27.875834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f8ac2f6-1b8f-48bc-becc-d55160a2eedd&page=queryresults
[0m15:27:27.879346 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:15c62a3a-4e0c-4673-b656-ee5b1abfcef2&page=queryresults
[0m15:27:27.880611 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a8e82669-5a2c-4b6e-84fa-2dda5dc99508&page=queryresults
[0m15:27:28.907497 [info ] [Thread-2 (]: 144 of 148 PASS not_null_dim_customers_max_order_value ......................... [[32mPASS[0m in 5.76s]
[0m15:27:28.915654 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8
[0m15:27:28.910962 [info ] [Thread-4 (]: 145 of 148 PASS not_null_dim_customers_purchase_frequency ...................... [[32mPASS[0m in 5.74s]
[0m15:27:28.919303 [debug] [Thread-2 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:27:28.926269 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093
[0m15:27:28.934047 [debug] [Thread-4 (]: Began running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m15:27:28.930219 [info ] [Thread-2 (]: 147 of 148 START test unique_dim_customers_customer_id ......................... [RUN]
[0m15:27:28.948042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_max_order_value.1b3d14ffc8, now test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd)
[0m15:27:28.942500 [info ] [Thread-4 (]: 148 of 148 START test unique_dim_customers_customer_key ........................ [RUN]
[0m15:27:28.952838 [debug] [Thread-2 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:27:28.957660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_advanced_olist.not_null_dim_customers_purchase_frequency.ebce250093, now test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e)
[0m15:27:29.008934 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:27:29.012717 [debug] [Thread-4 (]: Began compiling node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m15:27:29.058824 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m15:27:29.061919 [debug] [Thread-2 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:27:29.076207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:27:29.076207 [debug] [Thread-4 (]: Began executing node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m15:27:29.134681 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:27:29.805264 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m15:27:29.813725 [debug] [Thread-1 (]: On test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: relationships_fct_orders_customer_id__customer_id__ref_dim_customers_ | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:30.156501 [debug] [Thread-4 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
[0m15:27:30.159493 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_key as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:30.250543 [debug] [Thread-2 (]: Applying CREATE to: `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
[0m15:27:30.259066 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
        
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
      
    
    

    
    OPTIONS()
    as (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
    )
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */;
[0m15:27:30.363703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:778a014f-535f-45df-8aca-e8cae404198e&page=queryresults
[0m15:27:30.613435 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:f606a5a2-ddc9-4610-95f9-e0827f816e4a&page=queryresults
[0m15:27:30.709785 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:26ec152e-34b2-4a15-8d03-1c05794f790a&page=queryresults
[0m15:27:31.346394 [info ] [Thread-1 (]: 146 of 148 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 5.48s]
[0m15:27:31.351110 [debug] [Thread-1 (]: Finished running node test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m15:27:32.990704 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e"
[0m15:27:33.000638 [debug] [Thread-4 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_key`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_key | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:33.557468 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:5be398ff-f2df-4633-84a9-2e13e45de928&page=queryresults
[0m15:27:33.780498 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:27:33.789137 [debug] [Thread-2 (]: On test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`unique_dim_customers_customer_id`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: unique_dim_customers_customer_id | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:27:34.317002 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:04146370-8ded-4f58-8085-36198611e124&page=queryresults
[0m15:27:34.525000 [info ] [Thread-4 (]: 148 of 148 PASS unique_dim_customers_customer_key .............................. [[32mPASS[0m in 5.57s]
[0m15:27:34.532292 [debug] [Thread-4 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e
[0m15:27:35.663719 [info ] [Thread-2 (]: 147 of 148 PASS unique_dim_customers_customer_id ............................... [[32mPASS[0m in 6.72s]
[0m15:27:35.675291 [debug] [Thread-2 (]: Finished running node test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:28:06.742315 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213"
[0m15:28:06.772078 [debug] [Thread-3 (]: On test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213: 
    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`accepted_values_dim_customers_a1022b189f04aceea8c6c92948a87094`
    
      
    ) dbt_internal_test
/* dbt 1.10.15 | model: accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North | schema: dbt_dev_yourname_dbt_test__audit */
[0m15:28:07.420859 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2911f7a5-acce-4a80-8253-1e1ef8f9a1fe&page=queryresults
[0m15:28:08.573230 [info ] [Thread-3 (]: 120 of 148 PASS accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North  [[32mPASS[0m in 92.67s]
[0m15:28:08.584167 [debug] [Thread-3 (]: Finished running node test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213
[0m15:28:08.686534 [info ] [MainThread]: 
[0m15:28:08.809123 [info ] [MainThread]: ============================================================
[0m15:28:08.814920 [info ] [MainThread]: DBT RUN COMPLETED
[0m15:28:08.819786 [info ] [MainThread]: Success: 12
[0m15:28:08.820784 [info ] [MainThread]: Errors: 1
[0m15:28:08.837504 [info ] [MainThread]: Skipped: 0
[0m15:28:08.843910 [info ] [MainThread]: Total: 148
[0m15:28:08.853739 [info ] [MainThread]: ============================================================
[0m15:28:08.855730 [info ] [MainThread]: FAILED MODELS:
[0m15:28:08.860133 [info ] [MainThread]:   - customers_snapshot: Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m15:28:08.868854 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m15:28:08.873694 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m15:28:08.874690 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.18s]
[0m15:28:08.884623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:08.892884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:08.895814 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m15:28:08.904521 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m15:28:08.909152 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m15:28:08.910150 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m15:28:08.918717 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m15:28:08.922635 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m15:28:08.924628 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m15:28:08.925629 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m15:28:08.927732 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m15:28:08.928732 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m15:28:08.935273 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.accepted_values_dim_customers_customer_region__Southeast__South__Northeast__Central_West__North.22a2fcc213' was properly closed.
[0m15:28:08.938609 [debug] [MainThread]: Connection 'test.dbt_advanced_olist.unique_dim_customers_customer_key.ad8156656e' was properly closed.
[0m15:28:08.955559 [info ] [MainThread]: 
[0m15:28:08.958568 [info ] [MainThread]: Finished running 2 project hooks, 2 seeds, 1 snapshot, 3 table models, 132 data tests, 3 unit tests, 7 view models in 0 hours 5 minutes and 24.13 seconds (324.13s).
[0m15:28:09.076217 [debug] [MainThread]: Command end result
[0m15:28:09.405415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:28:09.451592 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:28:09.508334 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m15:28:09.509330 [info ] [MainThread]: 
[0m15:28:09.514554 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 5 warnings:[0m
[0m15:28:09.516896 [info ] [MainThread]: 
[0m15:28:09.517892 [error] [MainThread]: [31mFailure in snapshot customers_snapshot (snapshots\customers_snapshot.sql)[0m
[0m15:28:09.524823 [error] [MainThread]:   Database Error in snapshot customers_snapshot (snapshots\customers_snapshot.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target\run\dbt_advanced_olist\snapshots\customers_snapshot.sql
[0m15:28:09.525822 [info ] [MainThread]: 
[0m15:28:09.539017 [warn ] [MainThread]: [33mWarning in test assert_orders_have_items (tests\singular\assert_orders_have_items.sql)[0m
[0m15:28:09.542191 [warn ] [MainThread]: Got 890 results, configured to warn if != 0
[0m15:28:09.545583 [info ] [MainThread]: 
[0m15:28:09.550296 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\tests\singular\assert_orders_have_items.sql
[0m15:28:09.557186 [info ] [MainThread]: 
[0m15:28:09.558184 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`assert_orders_have_items`
  --------------------------------------------------------------------------------------------------
[0m15:28:09.570512 [info ] [MainThread]: 
[0m15:28:09.571542 [warn ] [MainThread]: [33mWarning in test dbt_expectations_expect_column_values_to_be_between_stg_orders_delivery_days__180__0__delivery_days_is_not_null (models\staging\_staging.yml)[0m
[0m15:28:09.571542 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m15:28:09.580145 [info ] [MainThread]: 
[0m15:28:09.585563 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43.sql
[0m15:28:09.592215 [info ] [MainThread]: 
[0m15:28:09.593217 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`dbt_expectations_expect_column_e06a859eac122a301337d7c216ff4e43`
  -----------------------------------------------------------------------------------------------------------------------------------------
[0m15:28:09.611773 [info ] [MainThread]: 
[0m15:28:09.624509 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_order_id__order_id__ref_stg_orders_ (models\staging\_staging.yml)[0m
[0m15:28:09.626610 [warn ] [MainThread]: Got 862 results, configured to warn if != 0
[0m15:28:09.626610 [info ] [MainThread]: 
[0m15:28:09.639838 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0.sql
[0m15:28:09.642176 [info ] [MainThread]: 
[0m15:28:09.645037 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_b3d7cdbd08ebfad01e3226c01c10bba0`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m15:28:09.651929 [info ] [MainThread]: 
[0m15:28:09.651929 [warn ] [MainThread]: [33mWarning in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\staging\_staging.yml)[0m
[0m15:28:09.666445 [warn ] [MainThread]: Got 902 results, configured to warn if != 0
[0m15:28:09.671989 [info ] [MainThread]: 
[0m15:28:09.672979 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m15:28:09.672979 [info ] [MainThread]: 
[0m15:28:09.684342 [info ] [MainThread]:   See test failures:
  -----------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0`
  -----------------------------------------------------------------------------------------------------------------------------------
[0m15:28:09.693593 [info ] [MainThread]: 
[0m15:28:09.694591 [warn ] [MainThread]: [33mWarning in test relationships_stg_order_items_product_id__product_id__ref_stg_products_ (models\staging\_staging.yml)[0m
[0m15:28:09.703504 [warn ] [MainThread]: Got 642 results, configured to warn if != 0
[0m15:28:09.705662 [info ] [MainThread]: 
[0m15:28:09.706659 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\_staging.yml\relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f.sql
[0m15:28:09.716998 [info ] [MainThread]: 
[0m15:28:09.717994 [info ] [MainThread]:   See test failures:
  ----------------------------------------------------------------------------------------------------------------------------------------
  select * from `big-query-dbt-481111`.`dbt_dev_yourname_dbt_test__audit`.`relationships_stg_order_items_85fcc371bcae46211ede4a7fca07283f`
  ----------------------------------------------------------------------------------------------------------------------------------------
[0m15:28:09.724986 [info ] [MainThread]: 
[0m15:28:09.735896 [info ] [MainThread]: Done. PASS=144 WARN=5 ERROR=1 SKIP=0 NO-OP=0 TOTAL=150
[0m15:28:09.741379 [debug] [MainThread]: Command `dbt build` failed at 15:28:09.741379 after 402.99 seconds
[0m15:28:09.741379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C5505DB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C5505C490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C5505C510>]}
[0m15:28:09.753784 [debug] [MainThread]: Flushing usage events
[0m15:28:12.382082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:04.816201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A20F56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A20F6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A20F4910>]}


============================== 15:37:05.224369 | 3d7548cb-26d7-495f-bdf6-6d85a2055a3b ==============================
[0m15:37:05.224369 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:37:05.232302 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'invocation_command': 'dbt run --select int_orders_enriched+', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m15:39:05.107709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B7941390>]}
[0m15:39:05.282256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689D7E4250>]}
[0m15:39:05.292954 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:39:08.465422 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:39:15.309649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:15.331404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:15.713422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B8458D50>]}
[0m15:39:16.262072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:39:16.342164 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:39:17.656766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B81EC3D0>]}
[0m15:39:17.659664 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m15:39:17.664410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A20EFE90>]}
[0m15:39:17.683159 [info ] [MainThread]: 
[0m15:39:17.692500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:17.695906 [info ] [MainThread]: 
[0m15:39:17.700654 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:17.875056 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m15:39:17.879125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:17.880876 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m15:39:17.885007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:21.974084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m15:39:21.975939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m15:39:21.977572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:21.979565 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m15:39:21.982108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:21.983615 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m15:39:22.042925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:22.094678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:23.389886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_snapshots, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m15:39:23.397575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:23.499717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m15:39:23.538391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:26.547870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B8121ED0>]}
[0m15:39:26.642664 [info ] [MainThread]: ============================================================
[0m15:39:26.646654 [info ] [MainThread]: DBT RUN STARTED
[0m15:39:26.649510 [info ] [MainThread]: Target: dev
[0m15:39:26.658017 [info ] [MainThread]: Project: dbt_advanced_olist
[0m15:39:26.661659 [info ] [MainThread]: Time: 2025-12-24 15:39:26
[0m15:39:26.664873 [info ] [MainThread]: ============================================================
[0m15:39:26.672424 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m15:39:26.688790 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m15:39:26.695895 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.14s]
[0m15:39:26.697907 [info ] [MainThread]: 
[0m15:39:26.698915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:26.765800 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m15:39:26.769689 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched .. [RUN]
[0m15:39:26.773851 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.int_orders_enriched'
[0m15:39:26.776678 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m15:39:26.808699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m15:39:26.816007 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m15:39:26.938472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m15:39:26.943310 [debug] [Thread-1 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m15:39:26.945900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:28.975693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:4acfd001-9463-4c5f-8968-9bfb30029029&page=queryresults
[0m15:39:30.771053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B7D1A2D0>]}
[0m15:39:30.772050 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 3.99s]
[0m15:39:30.774051 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m15:39:30.787725 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m15:39:30.790763 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.fct_orders
[0m15:39:30.794167 [info ] [Thread-3 (]: 2 of 3 START sql table model dbt_dev_yourname_marts.dim_customers .............. [RUN]
[0m15:39:30.795715 [info ] [Thread-4 (]: 3 of 3 START sql table model dbt_dev_yourname_marts.fct_orders ................. [RUN]
[0m15:39:30.799288 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_customers'
[0m15:39:30.803018 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.fct_orders'
[0m15:39:30.805783 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m15:39:30.808335 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.fct_orders
[0m15:39:30.857610 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m15:39:30.875405 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.fct_orders"
[0m15:39:30.939896 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m15:39:30.941588 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.fct_orders
[0m15:39:31.007955 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:39:31.017093 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:39:32.577019 [debug] [Thread-4 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m15:39:32.568509 [debug] [Thread-3 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m15:39:33.485664 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f212698-aeb5-409a-93f3-8d2b65dc4dec&page=queryresults
[0m15:39:33.486741 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:7bdee89e-e05c-457b-8888-218c33fd31f5&page=queryresults
[0m15:39:34.005169 [warn ] [Thread-3 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m15:39:34.023775 [debug] [Thread-3 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m15:39:34.018638 [warn ] [Thread-4 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['subtotal', 'freight_total', 'order_total', 'avg_item_price']`
[0m15:39:34.029499 [debug] [Thread-4 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        select
    
      
    cast(null as string)
 as order_id, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as order_status, 
      
    cast(null as date)
 as order_date, 
      
    cast(null as timestamp)
 as ordered_at, 
      
    cast(null as timestamp)
 as approved_at, 
      
    cast(null as timestamp)
 as shipped_at, 
      
    cast(null as timestamp)
 as delivered_at, 
      
    cast(null as timestamp)
 as estimated_delivery_at, 
      
    cast(null as int64)
 as order_year, 
      
    cast(null as int64)
 as order_month, 
      
    cast(null as int64)
 as order_quarter, 
      
    cast(null as int64)
 as order_week, 
      
    cast(null as int64)
 as order_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as string)
 as primary_category, 
      
    cast(null as string)
 as primary_category_group, 
      
    cast(null as int64)
 as item_count, 
      
    cast(null as int64)
 as unique_products, 
      
    cast(null as numeric)
 as subtotal, 
      
    cast(null as numeric)
 as freight_total, 
      
    cast(null as numeric)
 as order_total, 
      
    cast(null as numeric)
 as avg_item_price, 
      
    cast(null as int64)
 as delivery_days, 
      
    cast(null as boolean)
 as is_late_delivery, 
      
    cast(null as int64)
 as days_late, 
      
    cast(null as string)
 as order_size_bucket, 
      
    cast(null as string)
 as delivery_sla_status, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m15:39:34.711562 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d5e39325-9d02-4799-bd62-f350974afc05&page=queryresults
[0m15:39:34.711562 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:74fef377-22df-4f4b-b84a-a6d816594857&page=queryresults
[0m15:39:35.185120 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m15:39:35.177785 [warn ] [Thread-4 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m15:39:35.193353 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.fct_orders"
[0m15:39:35.202978 [debug] [Thread-3 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m15:39:35.222681 [debug] [Thread-4 (]: On model.dbt_advanced_olist.fct_orders: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
        
  (
    order_id string not null primary key not enforced,
    customer_id string,
    order_status string,
    order_date date,
    ordered_at timestamp,
    approved_at timestamp,
    shipped_at timestamp,
    delivered_at timestamp,
    estimated_delivery_at timestamp,
    order_year int64,
    order_month int64,
    order_quarter int64,
    order_week int64,
    order_day_of_week int64,
    is_weekend boolean,
    customer_city string,
    customer_state string,
    customer_region string,
    primary_category string,
    primary_category_group string,
    item_count int64,
    unique_products int64,
    subtotal numeric,
    freight_total numeric,
    order_total numeric,
    avg_item_price numeric,
    delivery_days int64,
    is_late_delivery boolean,
    days_late int64,
    order_size_bucket string,
    delivery_sla_status string,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(order_date, month)
    cluster by order_status, customer_state

    
    OPTIONS()
    as (
      
    select order_id, customer_id, order_status, order_date, ordered_at, approved_at, shipped_at, delivered_at, estimated_delivery_at, order_year, order_month, order_quarter, order_week, order_day_of_week, is_weekend, customer_city, customer_state, customer_region, primary_category, primary_category_group, item_count, unique_products, subtotal, freight_total, order_total, avg_item_price, delivery_days, is_late_delivery, days_late, order_size_bucket, delivery_sla_status, _loaded_at
    from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */;
[0m15:39:35.935036 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:373cff9d-f16f-4414-a5bc-4c49ade8ce89&page=queryresults
[0m15:39:36.756969 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:e232be9c-28ed-4c8c-b6cb-e95d39aed653&page=queryresults
[0m15:39:38.716600 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B814ED90>]}
[0m15:39:38.723729 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dbt_dev_yourname_marts.dim_customers ......... [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 7.92s]
[0m15:39:38.731009 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m15:39:39.840000 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7548cb-26d7-495f-bdf6-6d85a2055a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268B926F810>]}
[0m15:39:39.840000 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dbt_dev_yourname_marts.fct_orders ............ [[32mCREATE TABLE (0.0 rows, 2.8 MiB processed)[0m in 9.04s]
[0m15:39:39.853204 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.fct_orders
[0m15:39:39.862228 [info ] [MainThread]: 
[0m15:39:39.967908 [info ] [MainThread]: ============================================================
[0m15:39:39.978319 [info ] [MainThread]: DBT RUN COMPLETED
[0m15:39:39.981323 [info ] [MainThread]: Success: 3
[0m15:39:39.986270 [info ] [MainThread]: Errors: 0
[0m15:39:39.988997 [info ] [MainThread]: Skipped: 0
[0m15:39:39.993891 [info ] [MainThread]: Total: 3
[0m15:39:39.996392 [info ] [MainThread]: ============================================================
[0m15:39:39.997630 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m15:39:40.002608 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m15:39:40.007485 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.13s]
[0m15:39:40.008260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:40.011698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:40.011698 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m15:39:40.011698 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m15:39:40.014169 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m15:39:40.020009 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m15:39:40.021004 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m15:39:40.024237 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m15:39:40.026262 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.int_orders_enriched' was properly closed.
[0m15:39:40.027157 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_customers' was properly closed.
[0m15:39:40.028687 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.fct_orders' was properly closed.
[0m15:39:40.050848 [info ] [MainThread]: 
[0m15:39:40.054776 [info ] [MainThread]: Finished running 2 project hooks, 2 table models, 1 view model in 0 hours 0 minutes and 22.33 seconds (22.33s).
[0m15:39:40.059327 [debug] [MainThread]: Command end result
[0m15:39:40.273910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m15:39:40.278018 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m15:39:40.291867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m15:39:40.292862 [info ] [MainThread]: 
[0m15:39:40.294859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:40.295971 [info ] [MainThread]: 
[0m15:39:40.297409 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:39:40.301929 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:40.301929 after 156.90 seconds
[0m15:39:40.302959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A1BF3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268A1EE5ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002689C2EE190>]}
[0m15:39:40.304931 [debug] [MainThread]: Flushing usage events
[0m15:39:45.053768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:40.958590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8197F6E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8197F5B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8197F6A90>]}


============================== 18:17:41.796340 | 4feeeb64-9a2e-4c0d-9bf3-332bdeed89c9 ==============================
[0m18:17:41.796340 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:17:41.809307 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select test_date_macro', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m18:29:45.538662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4feeeb64-9a2e-4c0d-9bf3-332bdeed89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B82F1C9A90>]}
[0m18:29:45.704601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4feeeb64-9a2e-4c0d-9bf3-332bdeed89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B814EF5210>]}
[0m18:29:45.766061 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:30:13.670703 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:30:35.974011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:35.976005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:36.225958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4feeeb64-9a2e-4c0d-9bf3-332bdeed89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B82FE19F90>]}
[0m18:30:36.906698 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m18:30:37.040073 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m18:30:38.457558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4feeeb64-9a2e-4c0d-9bf3-332bdeed89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B82F828910>]}
[0m18:30:38.457558 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m18:30:38.457558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4feeeb64-9a2e-4c0d-9bf3-332bdeed89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8197EFF50>]}
[0m18:30:38.480239 [warn ] [MainThread]: The selection criterion 'test_date_macro' does not match any enabled nodes
[0m18:30:38.493204 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:30:38.510160 [debug] [MainThread]: Command end result
[0m18:30:38.696031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m18:30:38.700021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m18:30:38.723352 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m18:30:38.726338 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:38.726338 after 780.01 seconds
[0m18:30:38.727335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B813834950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B813834450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B813834CD0>]}
[0m18:30:38.728402 [debug] [MainThread]: Flushing usage events
[0m18:30:40.373088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:40.480993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AF5F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AF6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AF6D50>]}


============================== 18:34:40.712369 | 76c94b03-26b1-402c-aaf0-449d25aaf092 ==============================
[0m18:34:40.712369 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:34:40.714364 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --exclude resource_type:snapshot', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m18:36:22.499097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76c94b03-26b1-402c-aaf0-449d25aaf092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA60FF710>]}
[0m18:36:22.624999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76c94b03-26b1-402c-aaf0-449d25aaf092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA22E4410>]}
[0m18:36:22.640869 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m18:36:25.289578 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:36:31.467091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:31.472677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:31.672581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76c94b03-26b1-402c-aaf0-449d25aaf092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBD16A0D0>]}
[0m18:36:32.044016 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m18:36:32.048004 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m18:36:32.994155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76c94b03-26b1-402c-aaf0-449d25aaf092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BBD4E0450>]}
[0m18:36:32.996184 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m18:36:32.998144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76c94b03-26b1-402c-aaf0-449d25aaf092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AF6F90>]}
[0m18:36:33.012745 [info ] [MainThread]: 
[0m18:36:33.013743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:33.015739 [info ] [MainThread]: 
[0m18:36:33.026750 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:36:33.033312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m18:36:33.034313 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m18:36:33.036888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:33.038881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m18:36:33.040876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:33.042870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:34.623097 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: ConnectionError(MaxRetryError('HTTPSConnectionPool(host=\'bigquery.googleapis.com\', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBD161590>: Failed to resolve \'bigquery.googleapis.com\' ([Errno 11002] getaddrinfo failed)"))'))
[0m18:36:34.627088 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: ConnectionError(MaxRetryError('HTTPSConnectionPool(host=\'bigquery.googleapis.com\', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBC586190>: Failed to resolve \'bigquery.googleapis.com\' ([Errno 11002] getaddrinfo failed)"))'))
[0m18:36:34.629081 [debug] [ThreadPool]: BigQuery adapter: Retry attempt 1 of 1 after error: ConnectionError(MaxRetryError('HTTPSConnectionPool(host=\'bigquery.googleapis.com\', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBC584A10>: Failed to resolve \'bigquery.googleapis.com\' ([Errno 11002] getaddrinfo failed)"))'))
[0m18:36:34.631074 [warn ] [ThreadPool]: BigQuery adapter: Reopening connection after ConnectionError(MaxRetryError('HTTPSConnectionPool(host=\'bigquery.googleapis.com\', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBD161590>: Failed to resolve \'bigquery.googleapis.com\' ([Errno 11002] getaddrinfo failed)"))'))
[0m18:36:34.633069 [warn ] [ThreadPool]: BigQuery adapter: Reopening connection after ConnectionError(MaxRetryError('HTTPSConnectionPool(host=\'bigquery.googleapis.com\', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBC586190>: Failed to resolve \'bigquery.googleapis.com\' ([Errno 11002] getaddrinfo failed)"))'))
[0m18:36:34.640091 [warn ] [ThreadPool]: BigQuery adapter: Reopening connection after ConnectionError(MaxRetryError('HTTPSConnectionPool(host=\'bigquery.googleapis.com\', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBC584A10>: Failed to resolve \'bigquery.googleapis.com\' ([Errno 11002] getaddrinfo failed)"))'))
[0m18:36:34.866761 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
list dataset
[0m18:36:34.867765 [debug] [ThreadPool]: BigQuery adapter: HTTPSConnectionPool(host='bigquery.googleapis.com', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBD59DA10>: Failed to resolve 'bigquery.googleapis.com' ([Errno 11002] getaddrinfo failed)"))
[0m18:36:34.975204 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
list dataset
[0m18:36:34.977247 [debug] [ThreadPool]: BigQuery adapter: HTTPSConnectionPool(host='bigquery.googleapis.com', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBCC392D0>: Failed to resolve 'bigquery.googleapis.com' ([Errno 11002] getaddrinfo failed)"))
[0m18:36:35.627802 [debug] [ThreadPool]: BigQuery adapter: Unhandled error while running:
list dataset
[0m18:36:35.629796 [debug] [ThreadPool]: BigQuery adapter: HTTPSConnectionPool(host='bigquery.googleapis.com', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBD1D4E10>: Failed to resolve 'bigquery.googleapis.com' ([Errno 11002] getaddrinfo failed)"))
[0m18:36:35.633940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:35.644493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:35.646488 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m18:36:35.649480 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m18:36:35.651574 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m18:36:35.670911 [info ] [MainThread]: 
[0m18:36:35.674899 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m18:36:35.682351 [error] [MainThread]: Encountered an error:
Database Error
  HTTPSConnectionPool(host='bigquery.googleapis.com', port=443): Max retries exceeded with url: /bigquery/v2/projects/big-query-dbt-481111/datasets?maxResults=10000&prettyPrint=false (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x0000024BBD59DA10>: Failed to resolve 'bigquery.googleapis.com' ([Errno 11002] getaddrinfo failed)"))
[0m18:36:35.693111 [debug] [MainThread]: Command `dbt run` failed at 18:36:35.693111 after 116.16 seconds
[0m18:36:35.698086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AE2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AE1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BA6AE3150>]}
[0m18:36:35.700083 [debug] [MainThread]: Flushing usage events
[0m18:36:36.995111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:55.527145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9764F55D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9764F4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9764F6A90>]}


============================== 20:29:56.232434 | a030cfdd-4735-4468-bfe9-a8304d146edb ==============================
[0m20:29:56.232434 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:29:56.800306 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --exclude resource_type:snapshot', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m20:33:12.575141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E97651CE10>]}
[0m20:33:12.795866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E971BE4610>]}
[0m20:33:12.797859 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m20:33:16.162793 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:26.435988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:26.444241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:26.808541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98CADF550>]}
[0m20:33:27.336951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m20:33:27.383086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m20:33:28.620055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98C051990>]}
[0m20:33:28.620055 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m20:33:28.629222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98C735750>]}
[0m20:33:28.674603 [info ] [MainThread]: 
[0m20:33:28.694915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:28.706035 [info ] [MainThread]: 
[0m20:33:28.708029 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:33:28.792754 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m20:33:28.795488 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m20:33:28.800061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:28.803099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m20:33:28.804096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:28.805643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:36.055697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m20:33:36.057745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:36.060174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m20:33:36.153267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m20:33:36.154957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:36.158459 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m20:33:36.160271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:36.219418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:37.315411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_staging, now list_big-query-dbt-481111_dbt_dev_yourname_intermediate)
[0m20:33:37.321859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:37.448317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_marts, now list_big-query-dbt-481111_snapshots)
[0m20:33:37.459478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:38.967406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98CC9BA10>]}
[0m20:33:39.100584 [info ] [MainThread]: ============================================================
[0m20:33:39.102945 [info ] [MainThread]: DBT RUN STARTED
[0m20:33:39.104622 [info ] [MainThread]: Target: dev
[0m20:33:39.108288 [info ] [MainThread]: Project: dbt_advanced_olist
[0m20:33:39.109791 [info ] [MainThread]: Time: 2025-12-24 20:33:39
[0m20:33:39.120990 [info ] [MainThread]: ============================================================
[0m20:33:39.120990 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m20:33:39.138063 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m20:33:39.154264 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.18s]
[0m20:33:39.208727 [info ] [MainThread]: 
[0m20:33:39.218571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:39.454989 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.dim_date
[0m20:33:39.455988 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_customers
[0m20:33:39.456983 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.stg_order_items
[0m20:33:39.458687 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_orders
[0m20:33:39.460043 [info ] [Thread-1 (]: 1 of 10 START sql table model dbt_dev_yourname_marts.dim_date .................. [RUN]
[0m20:33:39.463643 [info ] [Thread-2 (]: 2 of 10 START sql view model dbt_dev_yourname_staging.stg_customers ............ [RUN]
[0m20:33:39.466488 [info ] [Thread-3 (]: 3 of 10 START sql view model dbt_dev_yourname_staging.stg_order_items .......... [RUN]
[0m20:33:39.470917 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.dim_date'
[0m20:33:39.469122 [info ] [Thread-4 (]: 4 of 10 START sql view model dbt_dev_yourname_staging.stg_orders ............... [RUN]
[0m20:33:39.473809 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.stg_customers'
[0m20:33:39.476519 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.stg_order_items'
[0m20:33:39.483779 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.dim_date
[0m20:33:39.486772 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.stg_orders'
[0m20:33:39.488385 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_customers
[0m20:33:39.489893 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.stg_order_items
[0m20:33:39.503097 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_orders
[0m20:33:39.550419 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_customers"
[0m20:33:39.706306 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 

        select 

    datetime_diff(
        cast(cast('2019-01-01' as date) as datetime),
        cast(cast('2016-01-01' as date) as datetime),
        day
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */
[0m20:33:39.734345 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_orders"
[0m20:33:39.756683 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_order_items"
[0m20:33:39.758745 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:41.407505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:42558b84-f05a-458a-a028-c391ab69d728&page=queryresults
[0m20:33:42.305599 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_customers
[0m20:33:42.306596 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.stg_order_items
[0m20:33:42.473798 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_customers"
[0m20:33:42.480782 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_order_items"
[0m20:33:42.713016 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_orders
[0m20:33:42.732031 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_orders"
[0m20:33:43.853437 [debug] [Thread-3 (]: On model.dbt_advanced_olist.stg_order_items: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_order_items
  
  Purpose: Clean order line item data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Rename columns
  - Calculate item total (price + freight)
  - Generate surrogate key for unique identification
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`order_items`
),

renamed as (
    select
        -- Surrogate Key (composite primary key)
        to_hex(md5(cast(coalesce(cast(order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_item_id as string), '_dbt_utils_surrogate_key_null_') as string))) as order_item_key,
        
        -- Foreign Keys
        order_id,
        product_id,
        seller_id,
        
        -- Item Position
        order_item_id as item_sequence,
        
        -- Pricing
        cast(price as numeric) as item_price,
        cast(freight_value as numeric) as item_freight,
        
        -- Derived: Total for this item
        cast(price as numeric) + cast(freight_value as numeric) as item_total,
        
        -- Shipping date
        cast(shipping_limit_date as timestamp) as shipping_limit_at

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_order_items | schema: dbt_dev_yourname_staging */;
[0m20:33:43.858941 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:43.870106 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_customers: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_customers
  
  Purpose: Clean and standardize customer data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Standardize location data
  - Clean state codes
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`customers`
),

renamed as (
    select
        -- Primary Key
        customer_id,
        
        -- Alternative Key (same customer across orders)
        customer_unique_id,
        
        -- Location
        lower(trim(customer_city)) as customer_city,
        upper(trim(customer_state)) as customer_state,
        cast(customer_zip_code_prefix as string) as customer_zip_code,
        
        -- Derived: Region classification
        case upper(trim(customer_state))
            when 'SP' then 'Southeast'
            when 'RJ' then 'Southeast'
            when 'MG' then 'Southeast'
            when 'ES' then 'Southeast'
            when 'PR' then 'South'
            when 'SC' then 'South'
            when 'RS' then 'South'
            when 'BA' then 'Northeast'
            when 'PE' then 'Northeast'
            when 'CE' then 'Northeast'
            when 'MA' then 'Northeast'
            when 'PB' then 'Northeast'
            when 'RN' then 'Northeast'
            when 'PI' then 'Northeast'
            when 'AL' then 'Northeast'
            when 'SE' then 'Northeast'
            when 'GO' then 'Central-West'
            when 'DF' then 'Central-West'
            when 'MT' then 'Central-West'
            when 'MS' then 'Central-West'
            else 'North'
        end as customer_region

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_customers | schema: dbt_dev_yourname_staging */;
[0m20:33:43.881375 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_orders: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_orders
  
  Purpose: Clean and standardize raw order data
  Source: Olist Brazilian E-commerce (10K orders sample)
  
  Transformations:
  - Rename columns to consistent naming convention
  - Cast timestamps to proper types
  - Calculate delivery metrics
  - Add late delivery flag
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`orders`
),

renamed as (
    select
        -- Primary Key
        order_id,
        
        -- Foreign Keys
        customer_id,
        
        -- Order Status
        order_status,
        
        -- Timestamps (cast to proper types)
        cast(order_purchase_timestamp as timestamp) as ordered_at,
        cast(order_approved_at as timestamp) as approved_at,
        cast(order_delivered_carrier_date as timestamp) as shipped_at,
        cast(order_delivered_customer_date as timestamp) as delivered_at,
        cast(order_estimated_delivery_date as timestamp) as estimated_delivery_at,
        
        -- Derived: Order date (for partitioning)
        date(cast(order_purchase_timestamp as timestamp)) as order_date,
        
        -- Derived: Delivery time in days
        case 
            when order_delivered_customer_date is not null 
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_purchase_timestamp as timestamp)),
                day
            )
        end as delivery_days,
        
        -- Derived: Is delivery late?
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then true
            else false
        end as is_late_delivery,
        
        -- Derived: Days late (if late)
        case
            when order_delivered_customer_date is not null 
                and cast(order_delivered_customer_date as timestamp) > cast(order_estimated_delivery_date as timestamp)
            then date_diff(
                date(cast(order_delivered_customer_date as timestamp)),
                date(cast(order_estimated_delivery_date as timestamp)),
                day
            )
            else 0
        end as days_late

    from source
)

select * from renamed

-- Limit in dev for faster iteration
limit 1000
/* dbt 1.10.15 | model: stg_orders | schema: dbt_dev_yourname_staging */;
[0m20:33:43.980803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:33:44.066055 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:45.605770 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:86b8005e-7ca0-4d14-a569-25b0e3b774fc&page=queryresults
[0m20:33:45.610142 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:c3e16153-96bf-4c70-b0c3-13873584498a&page=queryresults
[0m20:33:45.615132 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:bec16214-5a52-48cf-8a03-eff2b0677dd2&page=queryresults
[0m20:33:48.940733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98BDB0190>]}
[0m20:33:48.942131 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98D2E7850>]}
[0m20:33:48.943549 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98C7F8A50>]}
[0m20:33:48.948620 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dbt_dev_yourname_staging.stg_customers ....... [[32mCREATE VIEW (0 processed)[0m in 9.46s]
[0m20:33:48.951126 [info ] [Thread-4 (]: 4 of 10 OK created sql view model dbt_dev_yourname_staging.stg_orders .......... [[32mCREATE VIEW (0 processed)[0m in 9.45s]
[0m20:33:48.964849 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_orders
[0m20:33:48.956719 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_customers
[0m20:33:48.954123 [info ] [Thread-3 (]: 3 of 10 OK created sql view model dbt_dev_yourname_staging.stg_order_items ..... [[32mCREATE VIEW (0 processed)[0m in 9.46s]
[0m20:33:48.970935 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.stg_product_categories
[0m20:33:48.973568 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.stg_products
[0m20:33:48.979563 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.stg_order_items
[0m20:33:48.983012 [info ] [Thread-4 (]: 5 of 10 START sql view model dbt_dev_yourname_staging.stg_product_categories ... [RUN]
[0m20:33:48.988654 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_orders, now model.dbt_advanced_olist.stg_product_categories)
[0m20:33:48.997824 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.stg_product_categories
[0m20:33:49.018380 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.int_orders_enriched
[0m20:33:48.984009 [info ] [Thread-2 (]: 6 of 10 START sql view model dbt_dev_yourname_staging.stg_products ............. [RUN]
[0m20:33:49.113790 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_product_categories"
[0m20:33:49.120549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_customers, now model.dbt_advanced_olist.stg_products)
[0m20:33:49.117840 [info ] [Thread-3 (]: 7 of 10 START sql view model dbt_dev_yourname_intermediate.int_orders_enriched . [RUN]
[0m20:33:49.124498 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.stg_products
[0m20:33:49.128612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_order_items, now model.dbt_advanced_olist.int_orders_enriched)
[0m20:33:49.147318 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.int_orders_enriched
[0m20:33:49.150310 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.stg_products"
[0m20:33:49.181527 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_orders_enriched"
[0m20:33:49.184577 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.stg_product_categories
[0m20:33:49.206756 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_product_categories"
[0m20:33:49.209164 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.stg_products
[0m20:33:49.214003 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.int_orders_enriched
[0m20:33:49.234073 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.stg_products"
[0m20:33:49.245579 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_orders_enriched"
[0m20:33:49.308576 [debug] [Thread-4 (]: On model.dbt_advanced_olist.stg_product_categories: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
  OPTIONS()
  as 
/*
  STAGING MODEL: stg_product_categories
  Purpose: Product category translation (Portuguese → English)
  Source: Olist Brazilian E-commerce
*/
with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`product_category_name_translation`
),
renamed as (
    select
        -- Portuguese name (join key)
        string_field_0 as category_name_pt,
        -- English translation
        string_field_1 as category_name_en,
        -- Derived: Category group
        case
            when string_field_1 in ('computers', 'computers_accessories', 'electronics', 'tablets_printing_image', 'telephony', 'fixed_telephony')
                then 'Electronics'
            when string_field_1 in ('furniture_decor', 'furniture_living_room', 'furniture_bedroom', 'furniture_mattress_and_upholstery', 'office_furniture', 'home_comfort', 'home_comfort_2', 'home_confort')
                then 'Furniture'
            when string_field_1 in ('health_beauty', 'perfumery', 'diapers_and_hygiene')
                then 'Health & Beauty'
            when string_field_1 in ('sports_leisure', 'toys', 'baby', 'fashion_bags_accessories', 'fashion_shoes', 'fashion_sport', 'fashion_underwear_beach', 'fashio_female_clothing', 'fashion_male_clothing', 'fashion_childrens_clothes')
                then 'Fashion & Lifestyle'
            when string_field_1 in ('housewares', 'kitchen_dining_laundry_garden_furniture', 'garden_tools', 'flowers', 'la_cuisine')
                then 'Home & Garden'
            else 'Other'
        end as category_group
    from source
)
select * from renamed
/* dbt 1.10.15 | model: stg_product_categories | schema: dbt_dev_yourname_staging */;
[0m20:33:49.314232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:49.421644 [debug] [Thread-2 (]: On model.dbt_advanced_olist.stg_products: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
  OPTIONS()
  as 

/*
  STAGING MODEL: stg_products
  
  Purpose: Clean product catalog data
  Source: Olist Brazilian E-commerce
  
  Transformations:
  - Calculate product volume
  - Classify product size
*/

with source as (
    select * from `big-query-dbt-481111`.`raw_olist`.`products`
),

renamed as (
    select
        -- Primary Key
        product_id,
        
        -- Category (Portuguese - join with translation table)
        product_category_name as category_name_pt,
        
        -- Dimensions
        cast(product_weight_g as numeric) as weight_grams,
        cast(product_length_cm as numeric) as length_cm,
        cast(product_height_cm as numeric) as height_cm,
        cast(product_width_cm as numeric) as width_cm,
        
        -- Derived: Volume in cubic cm
        cast(product_length_cm as numeric) 
            * cast(product_height_cm as numeric) 
            * cast(product_width_cm as numeric) as volume_cm3,
        
        -- Derived: Size classification
        case
            when cast(product_weight_g as numeric) < 500 then 'Small'
            when cast(product_weight_g as numeric) < 2000 then 'Medium'
            when cast(product_weight_g as numeric) < 10000 then 'Large'
            else 'Extra Large'
        end as size_category,
        
        -- Product description stats
        product_name_lenght as name_length,
        product_description_lenght as description_length,
        product_photos_qty as photo_count

    from source
)

select * from renamed

limit 1000
/* dbt 1.10.15 | model: stg_products | schema: dbt_dev_yourname_staging */;
[0m20:33:49.425940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:49.435906 [debug] [Thread-3 (]: On model.dbt_advanced_olist.int_orders_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_orders_enriched
  
  Purpose: Enrich orders with aggregated item data and customer info
  
  Joins:
  - stg_orders (base)
  - stg_order_items (aggregated)
  - stg_customers (customer details)
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_orders`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Aggregate order items to order level
order_totals as (
    select
        order_id,
        count(*) as item_count,
        count(distinct product_id) as unique_products,
        sum(item_price) as subtotal,
        sum(item_freight) as freight_total,
        sum(item_total) as order_total,
        avg(item_price) as avg_item_price,
        max(item_price) as max_item_price
    from order_items
    group by 1
),

-- Join everything together
enriched as (
    select
        -- Order info
        o.order_id,
        o.order_status,
        o.ordered_at,
        o.order_date,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Customer info
        o.customer_id,
        c.customer_unique_id,
        c.customer_city,
        c.customer_state,
        c.customer_region,
        
        -- Order totals
        coalesce(ot.item_count, 0) as item_count,
        coalesce(ot.unique_products, 0) as unique_products,
        coalesce(ot.subtotal, 0) as subtotal,
        coalesce(ot.freight_total, 0) as freight_total,
        coalesce(ot.order_total, 0) as order_total,
        coalesce(ot.avg_item_price, 0) as avg_item_price,
        coalesce(ot.max_item_price, 0) as max_item_price,
        
        -- Derived: Order size bucket
        case
            when coalesce(ot.order_total, 0) < 50 then 'Small'
            when coalesce(ot.order_total, 0) < 200 then 'Medium'
            when coalesce(ot.order_total, 0) < 500 then 'Large'
            else 'Premium'
        end as order_size_bucket,
        
        -- Time components (using macro)
        extract(year from o.order_date) as order_year,
    extract(month from o.order_date) as order_month,
    extract(quarter from o.order_date) as order_quarter,
    extract(week from o.order_date) as order_week,
    extract(dayofweek from o.order_date) as order_day_of_week,
    case 
        when extract(dayofweek from o.order_date) in (1, 7) then true 
        else false 
    end as is_weekend


    from orders o
    left join customers c on o.customer_id = c.customer_id
    left join order_totals ot on o.order_id = ot.order_id
)

select * from enriched
/* dbt 1.10.15 | model: int_orders_enriched | schema: dbt_dev_yourname_intermediate */;
[0m20:33:49.506386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:49.672870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_date"
[0m20:33:49.791296 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.dim_date
[0m20:33:50.338890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_date"
[0m20:33:50.397370 [debug] [Thread-1 (]: On model.dbt_advanced_olist.dim_date: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_date`
      
    partition by date_trunc(date_key, month)
    

    
    OPTIONS()
    as (
      

with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
    
    

    )

    select *
    from unioned
    where generated_number <= 1096
    order by generated_number



),

all_periods as (

    select (
        

        datetime_add(
            cast( cast('2016-01-01' as date) as datetime),
        interval row_number() over (order by 1) - 1 day
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2019-01-01' as date)

)

select * from filtered


),

final as (
    select
        cast(date_day as date) as date_key,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dayofweek from date_day) as day_of_week,
        format_date('%A', date_day) as day_name,
        format_date('%B', date_day) as month_name,
        case 
            when extract(dayofweek from date_day) in (1, 7) then true 
            else false 
        end as is_weekend
    from date_spine
)

select * from final
    )
/* dbt 1.10.15 | model: dim_date | schema: dbt_dev_yourname_marts */;
[0m20:33:50.728538 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:28deb716-4cdf-46ee-8ed8-f260bd23c2f0&page=queryresults
[0m20:33:50.836746 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:78aff1af-d1f5-4c57-8f74-82e0ee9c57b1&page=queryresults
[0m20:33:50.946098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:89da7026-3bda-4d53-ade5-0c6c770757f9&page=queryresults
[0m20:33:51.001617 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:6f3dc24d-aaef-4b79-bc6e-c777f9e42224&page=queryresults
[0m20:33:51.339378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98C7B2350>]}
[0m20:33:51.346600 [info ] [Thread-4 (]: 5 of 10 OK created sql view model dbt_dev_yourname_staging.stg_product_categories  [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m20:33:51.350979 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.stg_product_categories
[0m20:33:51.524481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E974CFA850>]}
[0m20:33:51.531625 [info ] [Thread-2 (]: 6 of 10 OK created sql view model dbt_dev_yourname_staging.stg_products ........ [[32mCREATE VIEW (0 processed)[0m in 2.40s]
[0m20:33:51.541225 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.stg_products
[0m20:33:51.552226 [debug] [Thread-4 (]: Began running node model.dbt_advanced_olist.int_products_enriched
[0m20:33:51.557774 [info ] [Thread-4 (]: 8 of 10 START sql view model dbt_dev_yourname_intermediate.int_products_enriched  [RUN]
[0m20:33:51.571119 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_product_categories, now model.dbt_advanced_olist.int_products_enriched)
[0m20:33:51.575701 [debug] [Thread-4 (]: Began compiling node model.dbt_advanced_olist.int_products_enriched
[0m20:33:51.618019 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_advanced_olist.int_products_enriched"
[0m20:33:51.620011 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98D4CD0D0>]}
[0m20:33:51.622024 [info ] [Thread-3 (]: 7 of 10 OK created sql view model dbt_dev_yourname_intermediate.int_orders_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.49s]
[0m20:33:51.624169 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.int_orders_enriched
[0m20:33:51.628884 [debug] [Thread-2 (]: Began running node model.dbt_advanced_olist.dim_customers
[0m20:33:51.631028 [info ] [Thread-2 (]: 9 of 10 START sql table model dbt_dev_yourname_marts.dim_customers ............. [RUN]
[0m20:33:51.633620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.stg_products, now model.dbt_advanced_olist.dim_customers)
[0m20:33:51.634645 [debug] [Thread-2 (]: Began compiling node model.dbt_advanced_olist.dim_customers
[0m20:33:51.646871 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_advanced_olist.dim_customers"
[0m20:33:51.920605 [debug] [Thread-4 (]: Began executing node model.dbt_advanced_olist.int_products_enriched
[0m20:33:51.967676 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_advanced_olist.int_products_enriched"
[0m20:33:51.980067 [debug] [Thread-4 (]: On model.dbt_advanced_olist.int_products_enriched: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
  OPTIONS()
  as 

/*
  INTERMEDIATE MODEL: int_products_enriched
  
  Purpose: Enrich products with category translations and sales metrics
*/

with products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_products`
),

categories as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_product_categories`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Calculate product-level sales metrics
product_sales as (
    select
        product_id,
        count(distinct order_id) as times_ordered,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_selling_price,
        min(item_price) as min_selling_price,
        max(item_price) as max_selling_price
    from order_items
    group by 1
),

-- Join products with categories and sales
enriched as (
    select
        -- Product info
        p.product_id,
        p.category_name_pt,
        coalesce(c.category_name_en, 'Unknown') as category_name,
        coalesce(c.category_group, 'Other') as category_group,
        
        -- Dimensions
        p.weight_grams,
        p.length_cm,
        p.height_cm,
        p.width_cm,
        p.volume_cm3,
        p.size_category,
        
        -- Product listing quality
        p.name_length,
        p.description_length,
        p.photo_count,
        
        -- Derived: Listing quality score (0-100)
        (
            case when p.name_length > 0 then 20 else 0 end +
            case when p.description_length > 100 then 30 else p.description_length * 0.3 end +
            case when p.photo_count >= 3 then 50 else p.photo_count * 15 end
        ) as listing_quality_score,
        
        -- Sales metrics
        coalesce(ps.times_ordered, 0) as times_ordered,
        coalesce(ps.total_revenue, 0) as total_revenue,
        coalesce(ps.avg_selling_price, 0) as avg_selling_price,
        
        -- Derived: Product popularity tier
        case
            when coalesce(ps.times_ordered, 0) = 0 then 'Never Sold'
            when ps.times_ordered < 5 then 'Low'
            when ps.times_ordered < 20 then 'Medium'
            when ps.times_ordered < 50 then 'High'
            else 'Top Seller'
        end as popularity_tier

    from products p
    left join categories c on p.category_name_pt = c.category_name_pt
    left join product_sales ps on p.product_id = ps.product_id
)

select * from enriched
/* dbt 1.10.15 | model: int_products_enriched | schema: dbt_dev_yourname_intermediate */;
[0m20:33:51.985313 [debug] [Thread-2 (]: Began executing node model.dbt_advanced_olist.dim_customers
[0m20:33:51.987750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:51.995861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:53.415253 [debug] [Thread-2 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m20:33:53.429822 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:21a81e4b-de0f-4596-906a-5052a7c7279e&page=queryresults
[0m20:33:54.236269 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:eb6e8760-a1e2-4617-87df-86d56b296ce6&page=queryresults
[0m20:33:54.237268 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98CB173D0>]}
[0m20:33:54.278660 [info ] [Thread-4 (]: 8 of 10 OK created sql view model dbt_dev_yourname_intermediate.int_products_enriched  [[32mCREATE VIEW (0 processed)[0m in 2.67s]
[0m20:33:54.287354 [debug] [Thread-4 (]: Finished running node model.dbt_advanced_olist.int_products_enriched
[0m20:33:54.294221 [debug] [Thread-3 (]: Began running node model.dbt_advanced_olist.fct_orders
[0m20:33:54.303236 [info ] [Thread-3 (]: 10 of 10 START sql table model dbt_dev_yourname_marts.fct_orders ............... [RUN]
[0m20:33:54.311683 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_advanced_olist.int_orders_enriched, now model.dbt_advanced_olist.fct_orders)
[0m20:33:54.321301 [debug] [Thread-3 (]: Began compiling node model.dbt_advanced_olist.fct_orders
[0m20:33:54.365128 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_advanced_olist.fct_orders"
[0m20:33:54.368247 [debug] [Thread-3 (]: Began executing node model.dbt_advanced_olist.fct_orders
[0m20:33:54.379838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:54.697647 [warn ] [Thread-2 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['lifetime_revenue', 'avg_order_value', 'max_order_value']`
[0m20:33:54.709184 [debug] [Thread-2 (]: On model.dbt_advanced_olist.dim_customers: select * from (
        select
    
      
    cast(null as string)
 as customer_key, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as customer_unique_id, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_zip_code, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as int64)
 as lifetime_orders, 
      
    cast(null as numeric)
 as lifetime_revenue, 
      
    cast(null as numeric)
 as avg_order_value, 
      
    cast(null as numeric)
 as max_order_value, 
      
    cast(null as int64)
 as lifetime_items, 
      
    cast(null as date)
 as first_order_date, 
      
    cast(null as date)
 as last_order_date, 
      
    cast(null as int64)
 as customer_lifespan_days, 
      
    cast(null as float64)
 as avg_delivery_days, 
      
    cast(null as int64)
 as late_deliveries, 
      
    cast(null as string)
 as customer_segment, 
      
    cast(null as string)
 as purchase_frequency, 
      
    cast(null as float64)
 as late_delivery_rate, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */
[0m20:33:55.177225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98C817850>]}
[0m20:33:55.184755 [info ] [Thread-1 (]: 1 of 10 OK created sql table model dbt_dev_yourname_marts.dim_date ............. [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 15.70s]
[0m20:33:55.193371 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.dim_date
[0m20:33:55.334806 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:9ab18793-2a39-42e9-be71-98e73e3c480e&page=queryresults
[0m20:33:55.750337 [debug] [Thread-3 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m20:33:58.238135 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_advanced_olist.dim_customers"
[0m20:33:58.335099 [debug] [Thread-2 (]: On model.dbt_advanced_olist.dim_customers: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`dim_customers`
        
  (
    customer_key string,
    customer_id string not null,
    customer_unique_id string,
    customer_city string,
    customer_state string,
    customer_zip_code string,
    customer_region string,
    lifetime_orders int64,
    lifetime_revenue numeric,
    avg_order_value numeric,
    max_order_value numeric,
    lifetime_items int64,
    first_order_date date,
    last_order_date date,
    customer_lifespan_days int64,
    avg_delivery_days float64,
    late_deliveries int64,
    customer_segment string,
    purchase_frequency string,
    late_delivery_rate float64,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(first_order_date, month)
    cluster by customer_state, customer_segment

    
    OPTIONS()
    as (
      
    select customer_key, customer_id, customer_unique_id, customer_city, customer_state, customer_zip_code, customer_region, lifetime_orders, lifetime_revenue, avg_order_value, max_order_value, lifetime_items, first_order_date, last_order_date, customer_lifespan_days, avg_delivery_days, late_deliveries, customer_segment, purchase_frequency, late_delivery_rate, _loaded_at
    from (
        

/*
  MART: dim_customers
  
  Purpose: Customer dimension with lifetime metrics and segmentation
  
  Business Logic:
  - One row per customer
  - Lifetime value calculated from delivered orders only
  - Customer segments based on value and frequency
  
  Data Contract: Enforced in _marts.yml
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
    where order_status = 'delivered'  -- Only count completed orders
),

customers as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_customers`
),

-- Calculate customer metrics
customer_metrics as (
    select
        customer_id,
        customer_unique_id,
        
        -- Order counts
        count(distinct order_id) as lifetime_orders,
        
        -- Revenue metrics
        sum(order_total) as lifetime_revenue,
        avg(order_total) as avg_order_value,
        max(order_total) as max_order_value,
        sum(item_count) as lifetime_items,
        
        -- Time metrics
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        date_diff(max(order_date), min(order_date), day) as customer_lifespan_days,
        
        -- Delivery metrics
        avg(delivery_days) as avg_delivery_days,
        sum(case when is_late_delivery then 1 else 0 end) as late_deliveries,
        
        -- Favorite region (most orders)
        max(customer_region) as primary_region

    from orders
    group by 1, 2
),

-- Build final dimension
final as (
    select
        -- Surrogate Key
        to_hex(md5(cast(coalesce(cast(c.customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,
        
        -- Natural Keys
        c.customer_id,
        c.customer_unique_id,
        
        -- Location
        c.customer_city,
        c.customer_state,
        c.customer_zip_code,
        c.customer_region,
        
        -- Metrics (with defaults for customers without orders)
        coalesce(m.lifetime_orders, 0) as lifetime_orders,
        coalesce(m.lifetime_revenue, 0) as lifetime_revenue,
        coalesce(m.avg_order_value, 0) as avg_order_value,
        coalesce(m.max_order_value, 0) as max_order_value,
        coalesce(m.lifetime_items, 0) as lifetime_items,
        m.first_order_date,
        m.last_order_date,
        coalesce(m.customer_lifespan_days, 0) as customer_lifespan_days,
        coalesce(m.avg_delivery_days, 0) as avg_delivery_days,
        coalesce(m.late_deliveries, 0) as late_deliveries,
        
        -- Customer Segmentation
        case
            when coalesce(m.lifetime_revenue, 0) >= 400 and coalesce(m.lifetime_orders, 0) >= 3 then 'VIP'
            when coalesce(m.lifetime_revenue, 0) >= 300 then 'High Value'
            when coalesce(m.lifetime_revenue, 0) >= 100 then 'Medium Value'
            when coalesce(m.lifetime_revenue, 0) > 0 then 'Low Value'
            else 'No Orders'
        end as customer_segment,
        
        -- Frequency Classification
        case
            when coalesce(m.lifetime_orders, 0) >= 5 then 'Frequent'
            when coalesce(m.lifetime_orders, 0) >= 2 then 'Repeat'
            when coalesce(m.lifetime_orders, 0) = 1 then 'One-Time'
            else 'Never Purchased'
        end as purchase_frequency,
        
        -- Risk: Late delivery rate
        case
            when coalesce(m.lifetime_orders, 0) = 0 then 0
            else round(coalesce(m.late_deliveries, 0) * 100.0 / m.lifetime_orders, 2)
        end as late_delivery_rate,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from customers c
    left join customer_metrics m on c.customer_id = m.customer_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: dim_customers | schema: dbt_dev_yourname_marts */;
[0m20:33:58.496147 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:a4aed618-dca3-4747-887f-71192d15f906&page=queryresults
[0m20:33:58.967453 [warn ] [Thread-3 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['subtotal', 'freight_total', 'order_total', 'avg_item_price']`
[0m20:33:58.973133 [debug] [Thread-3 (]: On model.dbt_advanced_olist.fct_orders: select * from (
        select
    
      
    cast(null as string)
 as order_id, 
      
    cast(null as string)
 as customer_id, 
      
    cast(null as string)
 as order_status, 
      
    cast(null as date)
 as order_date, 
      
    cast(null as timestamp)
 as ordered_at, 
      
    cast(null as timestamp)
 as approved_at, 
      
    cast(null as timestamp)
 as shipped_at, 
      
    cast(null as timestamp)
 as delivered_at, 
      
    cast(null as timestamp)
 as estimated_delivery_at, 
      
    cast(null as int64)
 as order_year, 
      
    cast(null as int64)
 as order_month, 
      
    cast(null as int64)
 as order_quarter, 
      
    cast(null as int64)
 as order_week, 
      
    cast(null as int64)
 as order_day_of_week, 
      
    cast(null as boolean)
 as is_weekend, 
      
    cast(null as string)
 as customer_city, 
      
    cast(null as string)
 as customer_state, 
      
    cast(null as string)
 as customer_region, 
      
    cast(null as string)
 as primary_category, 
      
    cast(null as string)
 as primary_category_group, 
      
    cast(null as int64)
 as item_count, 
      
    cast(null as int64)
 as unique_products, 
      
    cast(null as numeric)
 as subtotal, 
      
    cast(null as numeric)
 as freight_total, 
      
    cast(null as numeric)
 as order_total, 
      
    cast(null as numeric)
 as avg_item_price, 
      
    cast(null as int64)
 as delivery_days, 
      
    cast(null as boolean)
 as is_late_delivery, 
      
    cast(null as int64)
 as days_late, 
      
    cast(null as string)
 as order_size_bucket, 
      
    cast(null as string)
 as delivery_sla_status, 
      
    cast(null as timestamp)
 as _loaded_at
    ) as __dbt_sbq
    where false and current_timestamp() = current_timestamp()
    limit 0
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */
[0m20:33:59.176398 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:d996f492-a1c3-40ad-8dac-34385ca8b0c4&page=queryresults
[0m20:33:59.534535 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:1354d1f8-1a04-4892-b1e3-6fc3343e7183&page=queryresults
[0m20:33:59.933002 [warn ] [Thread-3 (]: [[33mWARNING[0m]: The constraint type primary_key is not enforced by bigquery.
The constraint will be included in this model's DDL statement, but it will not
guarantee anything about the underlying data. Set 'warn_unenforced: false' on
this constraint to ignore this warning.
[0m20:33:59.972349 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_advanced_olist.fct_orders"
[0m20:34:00.030129 [debug] [Thread-3 (]: On model.dbt_advanced_olist.fct_orders: 
  
    

    create or replace table `big-query-dbt-481111`.`dbt_dev_yourname_marts`.`fct_orders`
        
  (
    order_id string not null primary key not enforced,
    customer_id string,
    order_status string,
    order_date date,
    ordered_at timestamp,
    approved_at timestamp,
    shipped_at timestamp,
    delivered_at timestamp,
    estimated_delivery_at timestamp,
    order_year int64,
    order_month int64,
    order_quarter int64,
    order_week int64,
    order_day_of_week int64,
    is_weekend boolean,
    customer_city string,
    customer_state string,
    customer_region string,
    primary_category string,
    primary_category_group string,
    item_count int64,
    unique_products int64,
    subtotal numeric,
    freight_total numeric,
    order_total numeric,
    avg_item_price numeric,
    delivery_days int64,
    is_late_delivery boolean,
    days_late int64,
    order_size_bucket string,
    delivery_sla_status string,
    _loaded_at timestamp
    
    )

      
    partition by date_trunc(order_date, month)
    cluster by order_status, customer_state

    
    OPTIONS()
    as (
      
    select order_id, customer_id, order_status, order_date, ordered_at, approved_at, shipped_at, delivered_at, estimated_delivery_at, order_year, order_month, order_quarter, order_week, order_day_of_week, is_weekend, customer_city, customer_state, customer_region, primary_category, primary_category_group, item_count, unique_products, subtotal, freight_total, order_total, avg_item_price, delivery_days, is_late_delivery, days_late, order_size_bucket, delivery_sla_status, _loaded_at
    from (
        

/*
  MART: fct_orders
  
  Purpose: Order fact table for analytics and BI
  
  Features:
  - Incremental materialization for large datasets
  - Partitioned by order_date for BigQuery efficiency
  - Clustered for common filter patterns
  
  Grain: One row per order
*/

with orders as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_orders_enriched`
),

products as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_intermediate`.`int_products_enriched`
),

order_items as (
    select * from `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`stg_order_items`
),

-- Get primary category per order (highest value item)
order_categories as (
    select
        oi.order_id,
        p.category_name,
        p.category_group,
        row_number() over (
            partition by oi.order_id 
            order by oi.item_total desc
        ) as rank
    from order_items oi
    left join products p on oi.product_id = p.product_id
),

primary_category as (
    select
        order_id,
        category_name as primary_category,
        category_group as primary_category_group
    from order_categories
    where rank = 1
),

-- Build fact table
final as (
    select
        -- Keys
        o.order_id,
        o.customer_id,
        
        -- Order Details
        o.order_status,
        o.order_date,
        o.ordered_at,
        o.approved_at,
        o.shipped_at,
        o.delivered_at,
        o.estimated_delivery_at,
        
        -- Time dimensions
        o.order_year,
        o.order_month,
        o.order_quarter,
        o.order_week,
        o.order_day_of_week,
        o.is_weekend,
        
        -- Customer Location
        o.customer_city,
        o.customer_state,
        o.customer_region,
        
        -- Product Info
        coalesce(pc.primary_category, 'Unknown') as primary_category,
        coalesce(pc.primary_category_group, 'Other') as primary_category_group,
        
        -- Measures
        o.item_count,
        o.unique_products,
        o.subtotal,
        o.freight_total,
        o.order_total,
        o.avg_item_price,
        
        -- Delivery Metrics
        o.delivery_days,
        o.is_late_delivery,
        o.days_late,
        
        -- Derived Classifications
        o.order_size_bucket,
        
        -- SLA Compliance
        case
            when o.order_status = 'delivered' and not o.is_late_delivery then 'Met'
            when o.order_status = 'delivered' and o.is_late_delivery then 'Missed'
            when o.order_status = 'canceled' then 'Canceled'
            else 'In Progress'
        end as delivery_sla_status,
        
        -- Metadata
        current_timestamp() as _loaded_at

    from orders o
    left join primary_category pc on o.order_id = pc.order_id
)

select * from final
    ) as model_subq
    )
/* dbt 1.10.15 | model: fct_orders | schema: dbt_dev_yourname_marts */;
[0m20:34:00.966019 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0381f202-0527-492a-9b32-0cd068f5c5e9&page=queryresults
[0m20:34:02.707833 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98D3DF050>]}
[0m20:34:02.710823 [info ] [Thread-2 (]: 9 of 10 OK created sql table model dbt_dev_yourname_marts.dim_customers ........ [[32mCREATE TABLE (909.0 rows, 2.4 MiB processed)[0m in 11.07s]
[0m20:34:02.713814 [debug] [Thread-2 (]: Finished running node model.dbt_advanced_olist.dim_customers
[0m20:34:04.368373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a030cfdd-4735-4468-bfe9-a8304d146edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98D54C910>]}
[0m20:34:04.369373 [info ] [Thread-3 (]: 10 of 10 OK created sql table model dbt_dev_yourname_marts.fct_orders .......... [[32mCREATE TABLE (0.0 rows, 2.8 MiB processed)[0m in 10.06s]
[0m20:34:04.375493 [debug] [Thread-3 (]: Finished running node model.dbt_advanced_olist.fct_orders
[0m20:34:04.413387 [info ] [MainThread]: 
[0m20:34:04.451882 [info ] [MainThread]: ============================================================
[0m20:34:04.454131 [info ] [MainThread]: DBT RUN COMPLETED
[0m20:34:04.455562 [info ] [MainThread]: Success: 10
[0m20:34:04.463098 [info ] [MainThread]: Errors: 0
[0m20:34:04.465584 [info ] [MainThread]: Skipped: 0
[0m20:34:04.466584 [info ] [MainThread]: Total: 10
[0m20:34:04.468923 [info ] [MainThread]: ============================================================
[0m20:34:04.470917 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m20:34:04.471745 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m20:34:04.480059 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.06s]
[0m20:34:04.481461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:04.483471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:04.487426 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m20:34:04.488423 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m20:34:04.492778 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m20:34:04.495058 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m20:34:04.497052 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m20:34:04.498051 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m20:34:04.499047 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m20:34:04.501045 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_date' was properly closed.
[0m20:34:04.501045 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.dim_customers' was properly closed.
[0m20:34:04.504344 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.fct_orders' was properly closed.
[0m20:34:04.505483 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.int_products_enriched' was properly closed.
[0m20:34:04.548436 [info ] [MainThread]: 
[0m20:34:04.550857 [info ] [MainThread]: Finished running 2 project hooks, 3 table models, 7 view models in 0 hours 0 minutes and 35.80 seconds (35.80s).
[0m20:34:04.560867 [debug] [MainThread]: Command end result
[0m20:34:04.788512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m20:34:04.796480 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m20:34:04.816861 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m20:34:04.818854 [info ] [MainThread]: 
[0m20:34:04.820848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:34:04.821845 [info ] [MainThread]: 
[0m20:34:04.825650 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m20:34:04.830711 [debug] [MainThread]: Command `dbt run` succeeded at 20:34:04.830711 after 257.97 seconds
[0m20:34:04.832454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E970534790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E970534250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E970534310>]}
[0m20:34:04.834812 [debug] [MainThread]: Flushing usage events
[0m20:34:07.229608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:47.815572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FCF4A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FCF6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9FCF5650>]}


============================== 21:03:48.086811 | 64391abd-1c23-4277-adf7-98a962c12f57 ==============================
[0m21:03:48.086811 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:03:48.094408 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select test_date_macro', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m21:08:16.151289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64391abd-1c23-4277-adf7-98a962c12f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB555D950>]}
[0m21:08:16.326350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64391abd-1c23-4277-adf7-98a962c12f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9B4E4710>]}
[0m21:08:16.348161 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:08:23.101972 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:08:28.347283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:28.354488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:28.771627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64391abd-1c23-4277-adf7-98a962c12f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB55712D0>]}
[0m21:08:29.617873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:08:29.640858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:08:30.217997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64391abd-1c23-4277-adf7-98a962c12f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FB5DD0690>]}
[0m21:08:30.217997 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 961 macros, 3 unit tests
[0m21:08:30.223891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64391abd-1c23-4277-adf7-98a962c12f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9BE561D0>]}
[0m21:08:30.230836 [warn ] [MainThread]: The selection criterion 'test_date_macro' does not match any enabled nodes
[0m21:08:30.235623 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:08:30.246819 [debug] [MainThread]: Command end result
[0m21:08:30.487539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:08:30.493117 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:08:30.502260 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m21:08:30.505250 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:30.504252 after 285.00 seconds
[0m21:08:30.505250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F99D34610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F99D34450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F99D34510>]}
[0m21:08:30.507141 [debug] [MainThread]: Flushing usage events
[0m21:08:37.210845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:38.419811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C255F5DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C255F6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C255F4890>]}


============================== 21:23:38.609103 | ff801a30-657d-4e4a-a652-cb5dc509a225 ==============================
[0m21:23:38.609103 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:23:38.614629 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt compile --select test_date_macro', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m21:24:43.590300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff801a30-657d-4e4a-a652-cb5dc509a225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3B207050>]}
[0m21:24:43.812549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff801a30-657d-4e4a-a652-cb5dc509a225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C20DE4810>]}
[0m21:24:43.817685 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:24:46.187260 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:24:49.813006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:24:49.821107 [debug] [MainThread]: Partial parsing: added file: dbt_advanced_olist://models\staging\test_date_macro.sql
[0m21:24:49.821107 [debug] [MainThread]: Partial parsing: added file: dbt_advanced_olist://macros\macros\generate_date_columns.sql
[0m21:24:50.828163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff801a30-657d-4e4a-a652-cb5dc509a225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3B9E6C90>]}
[0m21:24:51.327743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:24:51.345179 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:24:51.913529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff801a30-657d-4e4a-a652-cb5dc509a225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3BA65B50>]}
[0m21:24:51.914526 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 962 macros, 3 unit tests
[0m21:24:51.919675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff801a30-657d-4e4a-a652-cb5dc509a225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3B9C2FD0>]}
[0m21:24:51.937003 [info ] [MainThread]: 
[0m21:24:51.943738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:51.949444 [info ] [MainThread]: 
[0m21:24:51.954205 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:24:52.027914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m21:24:52.030397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m21:24:52.031704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:52.032730 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m21:24:52.033935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:52.033935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging'
[0m21:24:52.036712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:52.037774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:47.892705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_staging, now list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit)
[0m21:25:47.899509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_marts, now list_big-query-dbt-481111_dbt_dev_yourname_intermediate)
[0m21:25:47.909436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:47.910997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:49.576924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff801a30-657d-4e4a-a652-cb5dc509a225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3BA37110>]}
[0m21:25:49.581066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:50.719740 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.test_date_macro
[0m21:25:50.719740 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.test_date_macro'
[0m21:25:50.727947 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.test_date_macro
[0m21:25:50.787503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.test_date_macro"
[0m21:25:51.331765 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.test_date_macro
[0m21:25:51.334963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:25:51.342409 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.test_date_macro
[0m21:25:51.586746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:51.588708 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m21:25:51.589703 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m21:25:51.589703 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m21:25:51.596145 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m21:25:51.598338 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.test_date_macro' was properly closed.
[0m21:25:51.603416 [debug] [MainThread]: Command end result
[0m21:25:52.055915 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:25:52.069121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:25:52.701171 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m21:25:52.702174 [info ] [MainThread]: Compiled node 'test_date_macro' is:


with sample_dates as (
    select date('2017-01-15') as test_date
    union all
    select date('2017-06-21') as test_date
)

select
    test_date,
    

    extract(year from test_date) as test_year,
    extract(month from test_date) as test_month,
    extract(quarter from test_date) as test_quarter,
    extract(week from test_date) as test_week,
    extract(dayofweek from test_date) as test_day_of_week,
    case 
        when extract(dayofweek from test_date) in (1, 7) then true 
        else false 
    end as is_weekend


from sample_dates
```
[0m21:25:52.802246 [debug] [MainThread]: Command `dbt compile` succeeded at 21:25:52.802246 after 135.14 seconds
[0m21:25:52.805208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C255E2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C1F634250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C1F634450>]}
[0m21:25:52.806208 [debug] [MainThread]: Flushing usage events
[0m21:25:58.463130 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:32:18.333369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEEF4A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEEF4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEEF68D0>]}


============================== 21:32:18.494838 | 92f87cd0-a0bc-429c-99bf-a9c7ed34937e ==============================
[0m21:32:18.494838 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:32:18.512064 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select test_date_macro', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m21:34:46.415243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D4A01C10>]}
[0m21:34:46.684200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BA6E4350>]}
[0m21:34:46.691343 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:34:56.660461 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:35:18.744158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:18.744158 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:19.165340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D56A1F90>]}
[0m21:35:19.735094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:35:19.943317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:35:23.567014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D4FBC790>]}
[0m21:35:23.573254 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 962 macros, 3 unit tests
[0m21:35:23.576391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEEEFBD0>]}
[0m21:35:23.612657 [info ] [MainThread]: 
[0m21:35:23.626237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:23.632640 [info ] [MainThread]: 
[0m21:35:23.635743 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:23.756467 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m21:35:23.759108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:29.228067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m21:35:29.229111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m21:35:29.232768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m21:35:29.234542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:29.238064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m21:35:29.241346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:29.242384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:29.253376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:30.478069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_intermediate, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m21:35:30.479105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:30.590061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m21:35:30.593051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:31.858158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEBDEA10>]}
[0m21:35:32.213341 [info ] [MainThread]: ============================================================
[0m21:35:32.220869 [info ] [MainThread]: DBT RUN STARTED
[0m21:35:32.225218 [info ] [MainThread]: Target: dev
[0m21:35:32.239340 [info ] [MainThread]: Project: dbt_advanced_olist
[0m21:35:32.244223 [info ] [MainThread]: Time: 2025-12-24 21:35:32
[0m21:35:32.256877 [info ] [MainThread]: ============================================================
[0m21:35:32.276774 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m21:35:32.317106 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m21:35:32.324511 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.47s]
[0m21:35:32.327499 [info ] [MainThread]: 
[0m21:35:32.329495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:32.510904 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.test_date_macro
[0m21:35:32.513844 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_yourname_staging.test_date_macro ........... [RUN]
[0m21:35:32.522813 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.test_date_macro'
[0m21:35:32.528273 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.test_date_macro
[0m21:35:32.556973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.test_date_macro"
[0m21:35:32.564829 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.test_date_macro
[0m21:35:32.755950 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.test_date_macro"
[0m21:35:32.974810 [debug] [Thread-1 (]: On model.dbt_advanced_olist.test_date_macro: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`test_date_macro`
  OPTIONS()
  as 

with sample_dates as (
    select date('2017-01-15') as test_date
    union all
    select date('2017-06-21') as test_date
)

select
    test_date,
    

    extract(year from test_date) as test_year,
    extract(month from test_date) as test_month,
    extract(quarter from test_date) as test_quarter,
    extract(week from test_date) as test_week,
    extract(dayofweek from test_date) as test_day_of_week,
    case 
        when extract(dayofweek from test_date) in (1, 7) then true 
        else false 
    end as is_weekend


from sample_dates
```
/* dbt 1.10.15 | model: test_date_macro | schema: dbt_dev_yourname_staging */;
[0m21:35:32.977802 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:34.398137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2a562e84-33a8-48f5-828b-9b031132da24&page=queryresults
[0m21:35:34.399254 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:2a562e84-33a8-48f5-828b-9b031132da24&page=queryresults
[0m21:35:35.626276 [debug] [Thread-1 (]: Database Error in model test_date_macro (models\staging\test_date_macro.sql)
  Syntax error: Invalid empty identifier at [29:1]
  compiled code at target\run\dbt_advanced_olist\models\staging\test_date_macro.sql
[0m21:35:35.646466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92f87cd0-a0bc-429c-99bf-a9c7ed34937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D4F4EB90>]}
[0m21:35:35.657350 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dev_yourname_staging.test_date_macro .. [[31mERROR[0m in 3.11s]
[0m21:35:35.677080 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.test_date_macro
[0m21:35:35.691097 [debug] [Thread-7 (]: Marking all children of 'model.dbt_advanced_olist.test_date_macro' to be skipped because of status 'error'.  Reason: Database Error in model test_date_macro (models\staging\test_date_macro.sql)
  Syntax error: Invalid empty identifier at [29:1]
  compiled code at target\run\dbt_advanced_olist\models\staging\test_date_macro.sql.
[0m21:35:35.791254 [info ] [MainThread]: 
[0m21:35:35.839078 [info ] [MainThread]: ============================================================
[0m21:35:35.845242 [info ] [MainThread]: DBT RUN COMPLETED
[0m21:35:35.847235 [info ] [MainThread]: Success: 0
[0m21:35:35.848248 [info ] [MainThread]: Errors: 1
[0m21:35:35.855089 [info ] [MainThread]: Skipped: 0
[0m21:35:35.857988 [info ] [MainThread]: Total: 1
[0m21:35:35.860600 [info ] [MainThread]: ============================================================
[0m21:35:35.862473 [info ] [MainThread]: FAILED MODELS:
[0m21:35:35.864574 [info ] [MainThread]:   - test_date_macro: Database Error in model test_date_macro (models\staging\test_date_macro.sql)
  Syntax error: Invalid empty identifier at [29:1]
  compiled code at target\run\dbt_advanced_olist\models\staging\test_date_macro.sql
[0m21:35:35.867175 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m21:35:35.872345 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m21:35:35.877306 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.08s]
[0m21:35:35.878302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:35.880415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:35.880415 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m21:35:35.888890 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m21:35:35.892892 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m21:35:35.893963 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m21:35:35.895104 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m21:35:35.897097 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.test_date_macro' was properly closed.
[0m21:35:35.970508 [info ] [MainThread]: 
[0m21:35:35.977210 [info ] [MainThread]: Finished running 2 project hooks, 1 view model in 0 hours 0 minutes and 12.26 seconds (12.26s).
[0m21:35:35.992615 [debug] [MainThread]: Command end result
[0m21:35:36.257839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:35:36.263837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:35:36.278802 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m21:35:36.280226 [info ] [MainThread]: 
[0m21:35:36.282256 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:35:36.283257 [info ] [MainThread]: 
[0m21:35:36.288305 [error] [MainThread]: [31mFailure in model test_date_macro (models\staging\test_date_macro.sql)[0m
[0m21:35:36.291391 [error] [MainThread]:   Database Error in model test_date_macro (models\staging\test_date_macro.sql)
  Syntax error: Invalid empty identifier at [29:1]
  compiled code at target\run\dbt_advanced_olist\models\staging\test_date_macro.sql
[0m21:35:36.293473 [info ] [MainThread]: 
[0m21:35:36.298359 [info ] [MainThread]:   compiled code at target\compiled\dbt_advanced_olist\models\staging\test_date_macro.sql
[0m21:35:36.308272 [info ] [MainThread]: 
[0m21:35:36.312199 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:35:36.315711 [debug] [MainThread]: Command `dbt run` failed at 21:35:36.315711 after 200.01 seconds
[0m21:35:36.316845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEF5DA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEF57ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BEF57E10>]}
[0m21:35:36.321349 [debug] [MainThread]: Flushing usage events
[0m21:35:38.050146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:01.923226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A0A6F5B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A0A2F17D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A0A6F4390>]}


============================== 21:45:02.229946 | fdc443b9-db97-4cff-bf49-d49429e67756 ==============================
[0m21:45:02.229946 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:45:02.241460 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'invocation_command': 'dbt run --select test_date_macro', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m21:46:04.235732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A200C9B50>]}
[0m21:46:04.473877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A05DE4090>]}
[0m21:46:04.476553 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:46:06.681310 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:46:10.473832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:10.478978 [debug] [MainThread]: Partial parsing: updated file: dbt_advanced_olist://models\staging\test_date_macro.sql
[0m21:46:11.438293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A20772210>]}
[0m21:46:11.982270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:46:11.990186 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:46:12.526645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A20005F90>]}
[0m21:46:12.528955 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 962 macros, 3 unit tests
[0m21:46:12.531212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A20792A50>]}
[0m21:46:12.538775 [info ] [MainThread]: 
[0m21:46:12.549289 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:46:12.554841 [info ] [MainThread]: 
[0m21:46:12.560082 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:12.594241 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111'
[0m21:46:12.596726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:15.118849 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m21:46:15.123737 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts'
[0m21:46:15.124960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:15.128198 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m21:46:15.130169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m21:46:15.132143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:15.203256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:15.210103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:16.678888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_intermediate, now list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit)
[0m21:46:16.693563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:16.698137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_marts, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m21:46:16.811692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:18.255950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A05CC75D0>]}
[0m21:46:18.290872 [info ] [MainThread]: ============================================================
[0m21:46:18.292870 [info ] [MainThread]: DBT RUN STARTED
[0m21:46:18.293864 [info ] [MainThread]: Target: dev
[0m21:46:18.295859 [info ] [MainThread]: Project: dbt_advanced_olist
[0m21:46:18.298190 [info ] [MainThread]: Time: 2025-12-24 21:46:18
[0m21:46:18.301363 [info ] [MainThread]: ============================================================
[0m21:46:18.305422 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-start-0"
[0m21:46:18.325917 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-start.0 ........................... [RUN]
[0m21:46:18.328221 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-start.0 .............................. [[32mOK[0m in 0.07s]
[0m21:46:18.330299 [info ] [MainThread]: 
[0m21:46:18.333536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:18.408540 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.test_date_macro
[0m21:46:18.411330 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dev_yourname_staging.test_date_macro ........... [RUN]
[0m21:46:18.413605 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.test_date_macro'
[0m21:46:18.416596 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.test_date_macro
[0m21:46:18.442808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.test_date_macro"
[0m21:46:18.464662 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.test_date_macro
[0m21:46:18.587921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_advanced_olist.test_date_macro"
[0m21:46:18.622910 [debug] [Thread-1 (]: On model.dbt_advanced_olist.test_date_macro: 

  create or replace view `big-query-dbt-481111`.`dbt_dev_yourname_staging`.`test_date_macro`
  OPTIONS()
  as 

with sample_dates as (
    select date('2017-01-15') as test_date
    union all
    select date('2017-06-21') as test_date
)

select
    test_date,
    

    extract(year from test_date) as test_year,
    extract(month from test_date) as test_month,
    extract(quarter from test_date) as test_quarter,
    extract(week from test_date) as test_week,
    extract(dayofweek from test_date) as test_day_of_week,
    case 
        when extract(dayofweek from test_date) in (1, 7) then true 
        else false 
    end as is_weekend


from sample_dates
/* dbt 1.10.15 | model: test_date_macro | schema: dbt_dev_yourname_staging */;
[0m21:46:18.625927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:46:20.290222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:639b9b18-6879-4b45-8370-a8c608b7d376&page=queryresults
[0m21:46:22.503833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc443b9-db97-4cff-bf49-d49429e67756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A21682850>]}
[0m21:46:22.513014 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dev_yourname_staging.test_date_macro ...... [[32mCREATE VIEW (0 processed)[0m in 4.09s]
[0m21:46:22.520152 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.test_date_macro
[0m21:46:22.555088 [info ] [MainThread]: 
[0m21:46:22.589099 [info ] [MainThread]: ============================================================
[0m21:46:22.593934 [info ] [MainThread]: DBT RUN COMPLETED
[0m21:46:22.595880 [info ] [MainThread]: Success: 1
[0m21:46:22.598199 [info ] [MainThread]: Errors: 0
[0m21:46:22.606046 [info ] [MainThread]: Skipped: 0
[0m21:46:22.609318 [info ] [MainThread]: Total: 1
[0m21:46:22.611213 [info ] [MainThread]: ============================================================
[0m21:46:22.612211 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_advanced_olist.dbt_advanced_olist-on-run-end-0"
[0m21:46:22.614245 [info ] [MainThread]: 1 of 1 START hook: dbt_advanced_olist.on-run-end.0 ............................. [RUN]
[0m21:46:22.619274 [info ] [MainThread]: 1 of 1 OK hook: dbt_advanced_olist.on-run-end.0 ................................ [[32mOK[0m in 0.06s]
[0m21:46:22.623008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:22.627619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:22.629738 [debug] [MainThread]: Connection 'list_big-query-dbt-481111' was properly closed.
[0m21:46:22.629738 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m21:46:22.631255 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m21:46:22.632253 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds' was properly closed.
[0m21:46:22.635874 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_snapshots' was properly closed.
[0m21:46:22.638329 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.test_date_macro' was properly closed.
[0m21:46:22.656366 [info ] [MainThread]: 
[0m21:46:22.657578 [info ] [MainThread]: Finished running 2 project hooks, 1 view model in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m21:46:22.663819 [debug] [MainThread]: Command end result
[0m21:46:22.877569 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:46:22.882816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:46:22.895746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m21:46:22.897089 [info ] [MainThread]: 
[0m21:46:22.898086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:46:22.902640 [info ] [MainThread]: 
[0m21:46:22.905837 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:46:22.909107 [debug] [MainThread]: Command `dbt run` succeeded at 21:46:22.909107 after 82.05 seconds
[0m21:46:22.911091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A0A1F3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A04734610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A04734450>]}
[0m21:46:22.912090 [debug] [MainThread]: Flushing usage events
[0m21:46:24.555070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:47:40.076125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2AF5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2AF6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB2AF4750>]}


============================== 21:47:40.081673 | 17f0fa05-9cb3-4f6e-8075-950a47924d24 ==============================
[0m21:47:40.081673 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:47:40.086373 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\HP\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt show --select test_date_macro', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\HP\\Desktop\\Anthonette\\Final\\Advance\\new advance\\23 Dec\\dbt_advanced_olist - Copy\\logs'}
[0m21:48:27.449025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17f0fa05-9cb3-4f6e-8075-950a47924d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC840FD50>]}
[0m21:48:27.755691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17f0fa05-9cb3-4f6e-8075-950a47924d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAE204110>]}
[0m21:48:38.731251 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:48:41.332840 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:48:56.662971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:56.662971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:56.910088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17f0fa05-9cb3-4f6e-8075-950a47924d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC851E150>]}
[0m21:48:57.530319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:48:57.546747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:48:57.613039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17f0fa05-9cb3-4f6e-8075-950a47924d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAE6B7B90>]}
[0m21:48:57.614064 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 analysis, 132 data tests, 2 seeds, 2 operations, 5 sources, 962 macros, 3 unit tests
[0m21:48:57.617234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f0fa05-9cb3-4f6e-8075-950a47924d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB10DF810>]}
[0m21:48:57.625584 [info ] [MainThread]: 
[0m21:48:57.627533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:57.629521 [info ] [MainThread]: 
[0m21:48:57.630518 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:48:57.680881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_snapshots'
[0m21:48:57.682376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_seeds'
[0m21:48:57.684386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:57.686177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate'
[0m21:48:57.691592 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit'
[0m21:48:57.693178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:57.696827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:57.698266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:00.298193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_dbt_dev_yourname_seeds, now list_big-query-dbt-481111_dbt_dev_yourname_marts)
[0m21:49:00.300776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_big-query-dbt-481111_snapshots, now list_big-query-dbt-481111_dbt_dev_yourname_staging)
[0m21:49:00.307877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:00.338981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:49:02.166409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f0fa05-9cb3-4f6e-8075-950a47924d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CAE17D710>]}
[0m21:49:02.174853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:02.298303 [debug] [Thread-1 (]: Began running node model.dbt_advanced_olist.test_date_macro
[0m21:49:02.300466 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_advanced_olist.test_date_macro'
[0m21:49:02.306173 [debug] [Thread-1 (]: Began compiling node model.dbt_advanced_olist.test_date_macro
[0m21:49:02.349841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_advanced_olist.test_date_macro"
[0m21:49:02.373665 [debug] [Thread-1 (]: Began executing node model.dbt_advanced_olist.test_date_macro
[0m21:49:02.410014 [debug] [Thread-1 (]: On model.dbt_advanced_olist.test_date_macro: 
  
  

with sample_dates as (
    select date('2017-01-15') as test_date
    union all
    select date('2017-06-21') as test_date
)

select
    test_date,
    

    extract(year from test_date) as test_year,
    extract(month from test_date) as test_month,
    extract(quarter from test_date) as test_quarter,
    extract(week from test_date) as test_week,
    extract(dayofweek from test_date) as test_day_of_week,
    case 
        when extract(dayofweek from test_date) in (1, 7) then true 
        else false 
    end as is_weekend


from sample_dates
  
  limit 5
/* dbt 1.10.15 | model: test_date_macro | schema: dbt_dev_yourname_staging */
[0m21:49:02.421493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:49:04.177838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=big-query-dbt-481111&j=bq:US:0df8c14b-233e-404a-b562-86580d1bb4a2&page=queryresults
[0m21:49:07.057571 [debug] [Thread-1 (]: Finished running node model.dbt_advanced_olist.test_date_macro
[0m21:49:07.088644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:07.089644 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_staging' was properly closed.
[0m21:49:07.090641 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_marts' was properly closed.
[0m21:49:07.094194 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_intermediate' was properly closed.
[0m21:49:07.096051 [debug] [MainThread]: Connection 'list_big-query-dbt-481111_dbt_dev_yourname_dbt_test__audit' was properly closed.
[0m21:49:07.097786 [debug] [MainThread]: Connection 'model.dbt_advanced_olist.test_date_macro' was properly closed.
[0m21:49:07.099884 [debug] [MainThread]: Command end result
[0m21:49:07.369813 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\manifest.json
[0m21:49:07.376726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\semantic_manifest.json
[0m21:49:07.396997 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\HP\Desktop\Anthonette\Final\Advance\new advance\23 Dec\dbt_advanced_olist - Copy\target\run_results.json
[0m21:49:07.398990 [info ] [MainThread]: Previewing node 'test_date_macro':
|  test_date | test_year | test_month | test_quarter | test_week | test_day_of_week | ... |
| ---------- | --------- | ---------- | ------------ | --------- | ---------------- | --- |
| 2017-01-15 |      2017 |          1 |            1 |         3 |                1 | ... |
| 2017-06-21 |      2017 |          6 |            2 |        25 |                4 | ... |

[0m21:49:07.407539 [debug] [MainThread]: Command `dbt show` succeeded at 21:49:07.406654 after 87.52 seconds
[0m21:49:07.409576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB165D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CACCEE190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CACCEE250>]}
[0m21:49:07.411345 [debug] [MainThread]: Flushing usage events
[0m21:49:08.478414 [debug] [MainThread]: An error was encountered while trying to flush usage events
